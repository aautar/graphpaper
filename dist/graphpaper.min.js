"use strict";var _slicedToArray=function(){function a(d,f){var g=[],h=!0,k=!1,l=void 0;try{for(var n,m=d[Symbol.iterator]();!(h=(n=m.next()).done)&&(g.push(n.value),!(f&&g.length===f));h=!0);}catch(o){k=!0,l=o}finally{try{!h&&m["return"]&&m["return"]()}finally{if(k)throw l}}return g}return function(d,f){if(Array.isArray(d))return d;if(Symbol.iterator in Object(d))return a(d,f);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),GraphPaper=function(a){"use strict";function f(A,B){this.__x=A,this.__y=B}function g(A,B){this.getType=function(){return A},this.getIntersectionPoint=function(){return B}}function h(A,B){this.__startPoint=A,this.__endPoint=B}function k(A,B,C,D){this.getLeft=function(){return A},this.getTop=function(){return B},this.getRight=function(){return C},this.getBottom=function(){return D},this.getPoints=function(){return[new f(A,B),new f(C,B),new f(C,D),new f(A,D)]},this.getLines=function(){return[new h(new f(A,B),new f(C,B)),new h(new f(C,B),new f(C,D)),new h(new f(C,D),new f(A,D)),new h(new f(A,D),new f(A,B))]},this.getPointsScaledToGrid=function(E){var F=new f(A+0.5*(C-A),B+0.5*(D-B)),G=(C-F.getX()+E)/(C-F.getX()),H=(D-F.getY()+E)/(D-F.getY()),I=[new f((A-F.getX())*G+F.getX(),(B-F.getY())*H+F.getY()),new f((C-F.getX())*G+F.getX(),(B-F.getY())*H+F.getY()),new f((C-F.getX())*G+F.getX(),(D-F.getY())*H+F.getY()),new f((A-F.getX())*G+F.getX(),(D-F.getY())*H+F.getY())];return I},this.checkIntersect=function(E){return!(D<E.getTop())&&!(B>E.getBottom())&&!(C<E.getLeft())&&!(A>E.getRight())},this.checkIsPointWithin=function(E){return E.getX()>=A&&E.getX()<=C&&E.getY()>=B&&E.getY()<=D},this.checkIsWithin=function(E){return D<=E.getBottom()&&B>=E.getTop()&&C<=E.getRight()&&A>=E.getLeft()}}function l(A){var B=this,C=[];this.push=function(E){for(var F=0;F<C.length;F++)if(E.isEqual(C[F]))return!1;return C.push(E),!0},this.findPointClosestTo=function(E){var F=null,G=Number.MAX_SAFE_INTEGER;return C.forEach(function(H){var I=new h(E,H);I.getLength()<G&&(F=H,G=I.getLength())}),F},this.findDistanceToPointClosestTo=function(E){var F=Number.MAX_SAFE_INTEGER;return C.forEach(function(G){var H=new h(E,G);H.getLength()<F&&(F=H.getLength())}),F},this.findPointsCloseTo=function(E,F){var G=new l;return C.forEach(function(H){var I=new h(E,H);I.getLength()<=F&&G.push(H)}),G},this.toArray=function(){return C},this.toFloat64Array=function(){for(var E=new Float64Array(2*C.length),F=0;F<C.length;F++)E[0+2*F]=C[F].getX(),E[1+2*F]=C[F].getY();return E};this.count=function(){return C.length},A&&Array.isArray(A)?A.forEach(B.push):A&&"[object Float64Array]"===Object.prototype.toString.call(A)&&function D(E){C.length=0;for(var F=0;F<E.length;F+=2)C.push(new f(E[F],E[F+1]))}(A)}function m(A){var B=this,C=[];this.push=function(E){var F=!1;return(C.forEach(function(G){E.isEqual(G)&&(F=!0)}),!F)&&(C.push(E),!0)},this.toArray=function(){return C},this.count=function(){return C.length},this.toFloat64Array=function(){for(var E=new Float64Array(4*C.length),F=0;F<C.length;F++)E[0+4*F]=C[F].getStartPoint().getX(),E[1+4*F]=C[F].getStartPoint().getY(),E[2+4*F]=C[F].getEndPoint().getX(),E[3+4*F]=C[F].getEndPoint().getY();return E};A&&Array.isArray(A)?A.forEach(B.push):A&&"[object Float64Array]"===Object.prototype.toString.call(A)&&function D(E){C.length=0;for(var F=0;F<E.length;F+=4)C.push(new h(new f(E[F],E[F+1]),new f(E[F+2],E[F+3])))}(A)}function n(A,B,C){var D=this;this.getObjectId=function(){return B.getId()},this.getX=function(){return D.getCentroid().getX()},this.getY=function(){return D.getCentroid().getY()},this.getWidth=function(){var E=A.getBoundingClientRect();return E.right-E.left},this.getHeight=function(){var E=A.getBoundingClientRect();return E.bottom-E.top},this.getCentroid=function(){var E=A.getBoundingClientRect(),F=C.getPageOffset();return new f(E.left+F.getX()+0.5*D.getWidth(),E.top+F.getY()+0.5*D.getHeight())},this.getRoutingPoints=function(E){var F=D.getCentroid(),G=0.5*D.getWidth(),H=0.5*D.getHeight();return[new f(F.getX()+G+E,F.getY()),new f(F.getX()-G-E,F.getY()),new f(F.getX(),F.getY()+H+E),new f(F.getX(),F.getY()-H-E)]},this.getBoundingRectange=function(){var E=D.getCentroid(),F=0.5*D.getWidth(),G=0.5*D.getHeight();return new k(E.getX()-F,E.getY()-G,E.getX()+F,E.getY()+G)}}function o(A,B,C,D,E){var G=this;"undefined"==typeof D&&(D="#000"),"undefined"==typeof E&&(E="2px");var H=document.createElementNS("http://www.w3.org/2000/svg","path");H.setAttribute("d","M0 0 L0 0"),H.style.stroke=D,H.style.strokeWidth=E;this.appendPathToContainerDomElement=function(){C.appendChild(H)},this.refresh=function(I){H.setAttribute("d",I)},this.getId=function(){var I=[A.getObjectId(),B.getObjectId()].sort();return I.join(":")},this.getDescriptor=function(){return{id:G.getId(),anchor_start_centroid:A.getCentroid().toString(),anchor_end_centroid:B.getCentroid().toString()}}}function q(A,B,C){this.getSize=function(){return A},this.getStyle=function(){return C},this.getSvgImageTile=function(){return C===z.LINE?"<svg xmlns=\"http://www.w3.org/2000/svg\" width=\""+A+"\" height=\""+A+"\"><rect width=\""+A+"\" height=\"1\" x=\"0\" y=\""+(A-1)+"\" style=\"fill:"+B+"\" /><rect width=\"1\" height=\""+A+"\" x=\""+(A-1)+"\" y=\"0\" style=\"fill:"+B+"\" /></svg>":"<svg xmlns=\"http://www.w3.org/2000/svg\" width=\""+A+"\" height=\""+A+"\"><rect width=\"1\" height=\"1\" x=\""+(A-1)+"\" y=\""+(A-1)+"\" style=\"fill:"+B+"\" /></svg>"}}function u(A){var B=this,C=[];this.getId=function(){return A},this.getObjectIndex=function(D){return B.getObjectIndexById(D.getId())},this.getObjectIndexById=function(D){for(var E=0;E<C.length;E++)if(C[E].getId()===D)return E;return null},this.addObject=function(D){return null===B.getObjectIndex(D)&&(C.push(D),!0)},this.getObjects=function(){return C},this.getObjectIds=function(){var D=[];return C.forEach(function(E){D.push(E.getId())}),D},this.removeObjectById=function(D){var E=B.getObjectIndexById(D);return null!==E&&(C.splice(E,1),!0)},this.removeAllObjects=function(){C.length=0}}f.prototype.getX=function(){return this.__x},f.prototype.getY=function(){return this.__y},f.prototype.isEqual=function(A){return this.__x===A.getX()&&this.__y===A.getY()},f.prototype.getCartesianPoint=function(A,B){return new f(this.__x-0.5*A,-this.__y+0.5*B)},f.prototype.toString=function(){return this.__x+" "+this.__y};var w=Object.freeze({PARALLEL:"parallel",COINCIDENT:"coincident",LINE:"line",LINESEG:"lineseg"});h.prototype.getStartPoint=function(){return this.__startPoint},h.prototype.getEndPoint=function(){return this.__endPoint},h.prototype.isEqual=function(A){return this.getStartPoint().isEqual(A.getStartPoint())&&this.getEndPoint().isEqual(A.getEndPoint())},h.prototype.getLength=function(){return Math.sqrt(Math.pow(this.__endPoint.getX()-this.__startPoint.getX(),2)+Math.pow(this.__endPoint.getY()-this.__startPoint.getY(),2))},h.prototype.computeIntersectionType=function(A){var B=this.__startPoint.getX(),C=this.__startPoint.getY(),D=this.__endPoint.getX(),E=this.__endPoint.getY(),F=A.getStartPoint().getX(),G=A.getStartPoint().getY(),H=A.getEndPoint().getX(),I=A.getEndPoint().getY(),J=(I-G)*(D-B)-(H-F)*(E-C),K=(H-F)*(C-G)-(I-G)*(B-F),L=(D-B)*(C-G)-(E-C)*(B-F);if(0==J)return 0==J&&0==K&&0==L?w.COINCIDENT:w.PARALLEL;var M=K/J,N=L/J;return 1<M||0>M||1<N||0>N?w.LINE:w.LINESEG},h.prototype.computeIntersection=function(A){var B=this.__startPoint.getX(),C=this.__startPoint.getY(),D=this.__endPoint.getX(),E=this.__endPoint.getY(),F=A.getStartPoint().getX(),G=A.getStartPoint().getY(),H=A.getEndPoint().getX(),I=A.getEndPoint().getY(),J=(I-G)*(D-B)-(H-F)*(E-C),K=(H-F)*(C-G)-(I-G)*(B-F),L=(D-B)*(C-G)-(E-C)*(B-F);if(0==J)return 0==J&&0==K&&0==L?new g(w.COINCIDENT,null):new g(w.PARALLEL,null);var M=K/J,N=L/J,O=_startPoint.getX()+M*(_endPoint.getX()-_startPoint.getX()),P=_startPoint.getY()+M*(_endPoint.getY()-_startPoint.getY());return 1<M||0>M||1<N||0>N?new g(w.LINE,new f(O,P)):new g(w.LINESEG,new f(O,P))};var z={LINE:"line",DOT:"dot"};return a.Dimensions=function(A,B){this.getWidth=function(){return A},this.getHeight=function(){return B}},a.Rectangle=k,a.Point=f,a.LINE_INTERSECTION_TYPE=w,a.LineIntersection=g,a.Line=h,a.CanvasObject=function(A,B,C,D,E,F,G,H,I){var L=this,N=[];this.x=parseInt(B),this.y=parseInt(C),this.width=parseInt(D),this.height=parseInt(E),this.isDeleted=!1,this.addNonInteractableConnectorAnchor=function(O){N.push(new n(O,L,F))},this.addInteractableConnectorAnchor=function(O){var P=new n(O,L,F);O.addEventListener("click",function(){F.addConnectionAnchorToSelectionStack(P)}),N.push(P)},this.getConnectorAnchorRoutingPoints=function(O){var P=L.getBoundingRectange(),Q=[];return N.forEach(function(R){var S=R.getRoutingPoints(O);S.forEach(function(T){P.checkIsPointWithin(T)||Q.push(T)})}),Q},this.getConnectorAnchors=function(){return N},this.getTranslateHandleOffsetX=function(){return-(H.offsetLeft+0.5*H.offsetWidth)},this.getTranslateHandleOffsetY=function(){return-(H.offsetTop+0.5*H.offsetHeight)},this.getId=function(){return A},this.getX=function(){return L.x},this.setX=function(O){L.x=O},this.getY=function(){return L.y},this.setY=function(O){L.y=O},this.translate=function(O,P){L.x=O,L.y=P,G.style.left=parseInt(L.x)+"px",G.style.top=parseInt(L.y)+"px"},this.getWidth=function(){return L.width},this.getHeight=function(){return L.height},this.resize=function(O,P){L.width=O,L.height=P,G.style.width=parseInt(L.width)+"px",G.style.height=parseInt(L.height)+"px"},this.getIsDeleted=function(){return L.isDeleted},this.getDomElement=function(){return G},this.handleSiblingObjectChange=function(){},this.getBoundingRectange=function(){var O=parseInt(L.x),P=parseInt(L.y),Q=O+parseInt(L.width),R=P+parseInt(L.height);return new k(O,P,Q,R)},this.getBoundingPoints=function(){var O=new f(L.getX(),L.getY()),P=new f(L.getX()+L.getWidth(),L.getY()),Q=new f(L.getX(),L.getY()+L.getWidth()),R=new f(L.getX()+L.getWidth(),L.getY()+L.getWidth());return[O,P,Q,R]};var J=function moveStart(){},K=function resizeStart(){};this.setMoveStartCallback=function(O){J=O},this.setResizeStartCallback=function(O){K=O},H.addEventListener("touchstart",function(O){J(L,O.touches[0].pageX,O.touches[0].pageY,!0)}),H.addEventListener("mousedown",function(O){J(L,O.pageX,O.pageY,!1)}),I.addEventListener("mousedown",function(O){O.which!==1||K(L,O.pageX,O.pageY)})},a.Canvas=function(A,B,C){var T=this,U={DBLCLICK:"dblclick",CLICK:"click",OBJECT_ADDED:"object-added",OBJECT_RESIZED:"object-resized",OBJECT_TRANSLATED:"object-translated"},V=B.document.createElementNS("http://www.w3.org/2000/svg","svg");V.style.width="100%",V.style.height="100%";var W=A.appendChild(V),D=null,E="transform 0.55s ease-in-out, transform-origin 0.55s ease-in-out",F=0,G=0,H=0,I=0,J=1,K=1,L=[],X=[],Y=[],N=null,O=null,P=0,Q=0,R={lastTouchX:null,lastTouchY:null,lastTouchTime:null},Z=[],$=new Map;this.getCurrentPointVisibilityMap=function(){return null},this.setGrid=function(ka){D=ka,A.style.background="url('data:image/svg+xml;base64,"+B.btoa(D.getSvgImageTile())+"') repeat"},this.getGrid=function(){return D},this.getGridSize=function(){return D.getSize()};var _=function(){var ka=new l;return X.forEach(function(la){var ma=la.getBoundingRectange().getPointsScaledToGrid(T.getGridSize());ma.forEach(function(na){ka.push(na)})}),X.forEach(function(la){var ma=la.getConnectorAnchorRoutingPoints(T.getGridSize());ma.forEach(function(na){ka.push(na)})}),ka},aa=function(){var ka=new l;return X.forEach(function(la){var ma=la.getConnectorAnchorRoutingPoints(T.getGridSize());ma.forEach(function(na){ka.push(na)})}),ka},ba=function(){var ka=[];return X.forEach(function(la){var ma=la.getBoundingRectange().getLines();ma.forEach(function(oa){ka.push(oa)});var na=la.getConnectorAnchors();na.forEach(function(oa){var pa=oa.getBoundingRectange().getLines();pa.forEach(function(qa){ka.push(qa)})})}),new m(ka)},ca=function(){var ka=[];Y.forEach(function(oa){ka.push(oa.getDescriptor())});var la=aa().toFloat64Array(),ma=_().toFloat64Array(),na=ba().toFloat64Array();C.postMessage({gridSize:T.getGridSize(),connectorDescriptors:ka,routingPoints:ma.buffer,boundaryLines:na.buffer,anchorPoints:la.buffer},[ma.buffer,na.buffer,la.buffer])};C.onmessage=function(ka){console.log(ka.data.metrics);var la=ka.data.connectorDescriptors,ma=function(na){for(var oa=0;oa<la.length;oa++)if(la[oa].id===na)return la[oa];return null};Y.forEach(function(na){var oa=ma(na.getId());oa&&na.refresh(oa.svgPath)})};var S=function makeNewConnector(ka,la,ma){return new o(ka,la,ma)};this.setConnectorFactory=function(ka){S=ka},this.getTransitionCss=function(){return E},this.setTransitionCss=function(ka){E=ka,A.style.transition=E},this.getTransformOriginX=function(){return F},this.getTransformOriginY=function(){return G},this.getScaleFactor=function(){return J},this.getTranslateX=function(){return H},this.getTranslateY=function(){return I},this.setTransformOrigin=function(ka,la){F=ka,G=la,A.style.transformOrigin=F+"px "+G+"px"},this.scale=function(ka,la){if(la=la||!1,la){var ma=T.getGridSize()*ka,na=Math.round(ma);ka=na/T.getGridSize()}return J=ka,K=1/J,L.push("scale3d("+J+","+J+","+J+")"),T},this.translate=function(ka,la){return H=ka,I=la,L.push("translate3d("+H+"px,"+I+"px,0)"),T},this.applyTransform=function(){A.style.transform=L.join(" "),L.length=0},this.resetTransform=function(){J=1,K=1,H=0,I=0,A.style.transform="none"},this.getPageOffset=function(){return new f(window.pageXOffset,window.pageYOffset)},this.snapToGrid=function(ka){var la=Math.round(ka/T.getGridSize())*T.getGridSize();return Math.max(0,la-1)},this.getOffsetLeft=function(){return A.offsetLeft},this.getOffsetTop=function(){return A.offsetTop},this.getWidth=function(){return A.offsetWidth},this.getHeight=function(){return A.offsetHeight},this.getObjectsAroundPoint=function(ka,la){var ma=[],na=new k(ka,la,ka+1,la+1);return X.forEach(function(oa){!oa.getIsDeleted()&&na.checkIntersect(oa.getBoundingRectange())&&ma.push(oa)}),ma},this.calcBoundingBox=function(){var ka=null,la=null,ma=null,na=null;return X.forEach(function(oa){var ra=parseInt(oa.getX()),sa=parseInt(oa.getY()),ta=ra+parseInt(oa.getWidth()),ua=sa+parseInt(oa.getHeight());(null==la||ra<la)&&(la=ra),(null==ka||sa<ka)&&(ka=sa),(null==ma||ua>ma)&&(ma=ua),(null==na||ta>na)&&(na=ta)}),new k(la,ka,na,ma)},this.getAllObjects=function(){return X},this.publishSiblingObjectChange=function(ka,la){X.forEach(function(ma){ma.handleSiblingObjectChange(ka,la)})},this.getObjectById=function(ka){var la=null;return X.forEach(function(ma){null==la&&ma.getId()===ka&&(la=ma)}),la},this.addObject=function(ka){ka.setResizeStartCallback(ea),ka.setMoveStartCallback(fa),X.push(ka),ca(),ja(U.OBJECT_ADDED,{object:ka})},this.getConnector=function(ka){for(var la=0;la<Y.length;la++)if(Y[la].getId()===ka)return Y[la];return null},this.addConnectionAnchorToSelectionStack=function(ka){if(Z.push(ka),2===Z.length){var la=S(Z[0],Z[1],W),ma=T.getConnector(la.getId());Z.length=0,null===ma&&(Y.push(la),la.appendPathToContainerDomElement(),ca())}};var da=function(ka,la){var ma=T.getObjectsAroundPoint(ka,la),na={targetPoint:new f(ka,la),objectsAroundPoint:ma};ja(U.DBLCLICK,na)};this.initInteractionHandlers=function(ka,la){A.addEventListener("dblclick",function(ma){da(ma.pageX,ma.pageY)}),A.addEventListener("click",function(ma){var na=!1;ma.target!==A&&(na=!0);var oa={targetPoint:new f(ma.pageX,ma.pageY),canvasObjectClicked:na};ja(U.CLICK,oa)}),A.addEventListener("touchend",function(ma){if(0>=ma.changedTouches.length)return!1;var na=!1,oa=ma.changedTouches[0].pageX,pa=ma.changedTouches[0].pageY,qa=new Date().getTime();if(null!==R.lastTouchTime){var ra=R.lastTouchTime,ta=R.lastTouchX,ua=R.lastTouchY,va=Math.sqrt(Math.pow(oa-ta,2)+Math.pow(pa-ua,2));qa-ra<=ka&&va<=la&&(na=!0,da(oa,pa),R.lastTouchTime=null,R.lastTouchX=null,R.lastTouchY=null)}na||(R.lastTouchTime=qa,R.lastTouchX=oa,R.lastTouchY=pa)})};var ea=function(ka){O=ka.getId()},fa=function(ka,la,ma){N=ka.getId(),P=la,Q=ma},ga=function(ka,la){var ma=T.getObjectById(N),na=T.snapToGrid(ka+ma.getTranslateHandleOffsetX()),oa=T.snapToGrid(la+ma.getTranslateHandleOffsetY());ma.translate(na,oa),ja(U.OBJECT_TRANSLATED,{object:ma}),ca()},ha=function(ka,la){var ma=T.getObjectById(N),na=T.snapToGrid(ka+ma.getTranslateHandleOffsetX()),oa=T.snapToGrid(la+ma.getTranslateHandleOffsetY()),pa=P,qa=Q;pa==na&&qa==oa||(ma.translate(na,oa),ja(U.OBJECT_TRANSLATED,{object:ma}))},ia=function(ka,la){var ma=T.getObjectById(O),na=T.snapToGrid(ka),oa=T.snapToGrid(la),pa=ma.getY(),qa=ma.getX();ma.resize(na-qa+1,oa-pa+1),ca(),ja(U.OBJECT_RESIZED,{object:ma})};this.initTransformationHandlers=function(){A.addEventListener("touchmove",function(ka){null!==N&&(ga(ka.touches[0].pageX*K,ka.touches[0].pageY*K),ka.preventDefault())}),A.addEventListener("mousemove",function(ka){null!==N&&ga(ka.pageX*K,ka.pageY*K),null!==O&&ia(ka.pageX*K,ka.pageY*K)}),A.addEventListener("touchend",function(){if(null!==N){T.getObjectById(N);N=null,O=null}}),A.addEventListener("mouseup",function(ka){1===ka.which&&(null!==N&&ha(ka.pageX*K,ka.pageY*K),N=null,O=null)}),A.addEventListener("mousedown",function(ka){(null!==N||null!==O)&&(ka.preventDefault(),ka.stopPropagation())})};var ja=function(ka,la){for(var oa,ma=$.get(ka)||[],na=0;na<ma.length;na++)oa=ma[na],oa(la)};this.off=function(ka,la){for(var ma=$.get(ka)||[],na=0;na<ma.length;na++)if(ma[na]===la){ma.splice(na,1);break}$.set(ka,ma)},this.on=function(ka,la){var ma=$.get(ka)||[];ma.push(la),$.set(ka,ma)},T.setGrid(new q(12,"#424242",z.DOT)),T.resetTransform(),T.setTransformOrigin(0,0),T.setTransitionCss(E)},a.Cluster=u,a.BoxClusterDetector=function(A){var B=this,C=function(F,G){for(var H=0;H<G.length;H++)if(G[H].getId()===F.getId())return H;return-1},D=function(F,G){for(var I,H=0;H<F.length;H++)I=C(F[H],G),-1!==I&&G.splice(I,1);return G},E=function(F){var G=0,H=null;return F.forEach(function(I,J){I>G&&(G=I,H=J)}),H};this.areObjectsClose=function(F,G){var H=new k(F.x-A,F.y-A,F.x+F.width+A,F.y+F.height+A),I=new k(G.x-A,G.y-A,G.x+G.width+A,G.y+G.height+A);return H.checkIntersect(I)},this.getAllObjectsCloseTo=function(F,G){for(var H=[],I=0;I<G.length;I++)F.getId()!==G[I].getId()&&B.areObjectsClose(F,G[I])&&H.push(G[I]);return H},this.getClusterObjectsFromSeed=function(F,G,H){var I=B.getAllObjectsCloseTo(F,G);return 0===I.length?[]:void(D(I.concat([F]),G),I.forEach(function(J){H.push(J),B.getClusterObjectsFromSeed(J,G,H)}))},this.findIntersectingClustersForObjects=function(F,G){var H=new Map;return G.forEach(function(I){for(var J=I.getObjects(),K=0;K<J.length;K++)for(var L=0;L<F.length;L++)if(J[K].getId()===F[L].getId())if(H.has(I)){var M=H.get(I);H.set(I,M+1)}else H.set(I,1)}),H},this.removeObjectFromClusters=function(F,G){G.forEach(function(H){H.removeObjectById(F.getId())})},this.computeClusters=function(F,G,H){for(var I=G.map(function(O){return O}),J=F.map(function(O){return O});0<J.length;){var K=J.pop(),L=[K];if(B.getClusterObjectsFromSeed(K,J,L),1<L.length){var M=B.findIntersectingClustersForObjects(L,I);0===M.size?function(){var O=new u(H());L.forEach(function(P){O.addObject(P)}),I.push(O)}():function(){var O=E(M);O.removeAllObjects(),L.forEach(function(P){B.removeObjectFromClusters(P,I),O.addObject(P)})}(),D(L,J)}else B.removeObjectFromClusters(K,I)}var N=I.filter(function(O){return!!(2<=O.getObjects().length)});return N}},a.Connector=o,a.ConnectorAnchor=n,a.PointVisibilityMap=function(A,B){var C=this,D=B.toArray(),E=new Map,F=function(J){for(var L,K=0;K<D.length;K++)if(L=D[K].computeIntersectionType(J),L===w.LINESEG)return!0;return!1},H=function(J){var K=Number.MAX_SAFE_INTEGER,L=null,_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var P,O=J.entries()[Symbol.iterator]();!(_iteratorNormalCompletion=(P=O.next()).done);_iteratorNormalCompletion=!0){var _step$value=_slicedToArray(P.value,2),M=_step$value[0],N=_step$value[1];N<K&&(L=M,K=N)}}catch(Q){_didIteratorError=!0,_iteratorError=Q}finally{try{!_iteratorNormalCompletion&&O.return&&O.return()}finally{if(_didIteratorError)throw _iteratorError}}return null===L?null:{cost:K,point:L}},I=function(J,K,L,M){var O=new Map,N=E.get(L);N=N.filter(function(Q){for(var R=0;R<K.length;R++)if(Q.isEqual(K[R]))return!1;return!0}),N.forEach(function(Q){var R=new h(L,Q).getLength()+J,S=new h(Q,M).getLength();O.set(Q,R+S)});var P=H(O);return null===P?null:P};this.findPointClosestTo=function(J){var K=null,L=Number.MAX_SAFE_INTEGER;return E.forEach(function(M,N){var O=new h(J,N);O.getLength()<L&&(K=N,L=O.getLength())}),K},this.findVisiblePointClosestTo=function(J){var K=null,L=Number.MAX_SAFE_INTEGER;return E.forEach(function(M,N){var O=new h(J,N);!F(O)&&O.getLength()<L&&(K=N,L=O.getLength())}),K},this.computeRoute=function(J,K){var N=C.findVisiblePointClosestTo(J);if(null===N)return new l;for(var P,L=0,O=[N],M=N;(P=I(L,O,M,K),null!==P)&&(L+=new h(M,P.point).getLength(),O.push(P.point),M=P.point,!(1>new h(M,K).getLength())););return new l(O)},function G(){for(var J=A.toArray(),K=0;K<J.length;K++)E.set(J[K],[]);for(var L=0;L<J.length;L++)for(var N,M=L+1;M<J.length;M++)if(N=new h(J[L],J[M]),!F(N)){var O=E.get(J[L]);O.push(J[M]),E.set(J[L],O);var P=E.get(J[M]);P.push(J[L]),E.set(J[M],P)}}()},a.GRID_STYLE=z,a.Grid=q,a}({});