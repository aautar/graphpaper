"use strict";var _slicedToArray=function(){function t(n,o){var g=[],s=!0,a=!1,h=void 0;try{for(var u,l=n[Symbol.iterator]();!(s=(u=l.next()).done)&&(g.push(u.value),!(o&&g.length===o));s=!0);}catch(f){a=!0,h=f}finally{try{!s&&l["return"]&&l["return"]()}finally{if(a)throw h}}return g}return function(n,o){if(Array.isArray(n))return n;if(Symbol.iterator in Object(n))return t(n,o);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),GraphPaper=function(t){"use strict";function o(P,X){this.__x=P,this.__y=X}function g(P,X){this.getType=function(){return P},this.getIntersectionPoint=function(){return X}}function s(P,X){if("undefined"==typeof P||null===P)throw"Line missing _startPoint";if("undefined"==typeof X||null===X)throw"Line missing _endPoint";this.__startPoint=P,this.__endPoint=X}function a(P,X,L,O){this.getLeft=function(){return P},this.getTop=function(){return X},this.getRight=function(){return L},this.getBottom=function(){return O},this.getPoints=function(){return[new o(P,X),new o(L,X),new o(L,O),new o(P,O)]},this.getLines=function(){return[new s(new o(P,X),new o(L,X)),new s(new o(L,X),new o(L,O)),new s(new o(L,O),new o(P,O)),new s(new o(P,O),new o(P,X))]},this.getPointsScaledToGrid=function(Y){var S=new o(P+0.5*(L-P),X+0.5*(O-X)),v=(L-S.getX()+Y)/(L-S.getX()),w=(O-S.getY()+Y)/(O-S.getY()),B=[new o((P-S.getX())*v+S.getX(),(X-S.getY())*w+S.getY()),new o((L-S.getX())*v+S.getX(),(X-S.getY())*w+S.getY()),new o((L-S.getX())*v+S.getX(),(O-S.getY())*w+S.getY()),new o((P-S.getX())*v+S.getX(),(O-S.getY())*w+S.getY())];return B},this.checkIntersect=function(Y){return!(O<Y.getTop())&&!(X>Y.getBottom())&&!(L<Y.getLeft())&&!(P>Y.getRight())},this.checkIsPointWithin=function(Y){return Y.getX()>=P&&Y.getX()<=L&&Y.getY()>=X&&Y.getY()<=O},this.checkIsWithin=function(Y){return O<=Y.getBottom()&&X>=Y.getTop()&&L<=Y.getRight()&&P>=Y.getLeft()}}function h(P){var X=this,L=[];this.push=function(Y){for(var S=0;S<L.length;S++)if(Y.isEqual(L[S]))return!1;return L.push(Y),!0},this.findPointClosestTo=function(Y){var S=null,v=Number.MAX_SAFE_INTEGER;return L.forEach(function(w){var B=new s(Y,w);B.getLength()<v&&(S=w,v=B.getLength())}),S},this.findDistanceToPointClosestTo=function(Y){var S=Number.MAX_SAFE_INTEGER;return L.forEach(function(v){var w=new s(Y,v);w.getLength()<S&&(S=w.getLength())}),S},this.findPointsCloseTo=function(Y,S){var v=new h;return L.forEach(function(w){var B=new s(Y,w);B.getLength()<=S&&v.push(w)}),v},this.toArray=function(){return L},this.toFloat64Array=function(){for(var Y=new Float64Array(2*L.length),S=0;S<L.length;S++)Y[0+2*S]=L[S].getX(),Y[1+2*S]=L[S].getY();return Y};this.count=function(){return L.length},P&&Array.isArray(P)?P.forEach(X.push):P&&"[object Float64Array]"===Object.prototype.toString.call(P)&&function O(Y){L.length=0;for(var S=0;S<Y.length;S+=2)L.push(new o(Y[S],Y[S+1]))}(P)}function l(P){var X=this,L=[];this.push=function(Y){var S=!1;return(L.forEach(function(v){Y.isEqual(v)&&(S=!0)}),!S)&&(L.push(Y),!0)},this.toArray=function(){return L},this.count=function(){return L.length},this.toFloat64Array=function(){for(var Y=new Float64Array(4*L.length),S=0;S<L.length;S++)Y[0+4*S]=L[S].getStartPoint().getX(),Y[1+4*S]=L[S].getStartPoint().getY(),Y[2+4*S]=L[S].getEndPoint().getX(),Y[3+4*S]=L[S].getEndPoint().getY();return Y};P&&Array.isArray(P)?P.forEach(X.push):P&&"[object Float64Array]"===Object.prototype.toString.call(P)&&function O(Y){L.length=0;for(var S=0;S<Y.length;S+=4)L.push(new s(new o(Y[S],Y[S+1]),new o(Y[S+2],Y[S+3])))}(P)}function u(P,X,L){var O=this;this.getId=function(){return P},this.getX=function(){return O.getCentroid().getX()},this.getY=function(){return O.getCentroid().getY()},this.getWidth=function(){var Y=X.getBoundingClientRect();return Y.right-Y.left},this.getHeight=function(){var Y=X.getBoundingClientRect();return Y.bottom-Y.top},this.getCentroid=function(){var Y=X.getBoundingClientRect(),S=L.getPageOffset();return new o(Y.left+S.getX()+0.5*O.getWidth(),Y.top+S.getY()+0.5*O.getHeight())},this.getRoutingPoints=function(Y){var S=O.getCentroid(),v=0.5*O.getWidth(),w=0.5*O.getHeight();return[new o(S.getX()+v+Y,S.getY()),new o(S.getX()-v-Y,S.getY()),new o(S.getX(),S.getY()+w+Y),new o(S.getX(),S.getY()-w-Y)]},this.getBoundingRectange=function(){var Y=O.getCentroid(),S=0.5*O.getWidth(),v=0.5*O.getHeight();return new a(Y.getX()-S,Y.getY()-v,Y.getX()+S,Y.getY()+v)}}function f(P,X,L,O,Y){var v=this;"undefined"==typeof O&&(O="#000"),"undefined"==typeof Y&&(Y="2px");var w=window.document.createElementNS("http://www.w3.org/2000/svg","path");w.setAttribute("d","M0 0 L0 0"),w.style.stroke=O,w.style.strokeWidth=Y;this.appendPathToContainerDomElement=function(){L.appendChild(w)},this.refresh=function(B){w.setAttribute("d",B)},this.getId=function(){var B=[P.getId(),X.getId()].sort();return B.join(":")},this.getAnchorStart=function(){return P},this.getAnchorEnd=function(){return X},this.removePathElement=function(){w.remove()},this.getDescriptor=function(){return{id:v.getId(),anchor_start_centroid:P.getCentroid().toString(),anchor_end_centroid:X.getCentroid().toString()}}}function E(P,X,L){this.getSize=function(){return P},this.getStyle=function(){return L},this.getSvgImageTile=function(){return L===m.LINE?"<svg xmlns=\"http://www.w3.org/2000/svg\" width=\""+P+"\" height=\""+P+"\"><rect width=\""+P+"\" height=\"1\" x=\"0\" y=\""+(P-1)+"\" style=\"fill:"+X+"\" /><rect width=\"1\" height=\""+P+"\" x=\""+(P-1)+"\" y=\"0\" style=\"fill:"+X+"\" /></svg>":"<svg xmlns=\"http://www.w3.org/2000/svg\" width=\""+P+"\" height=\""+P+"\"><rect width=\"1\" height=\"1\" x=\""+(P-1)+"\" y=\""+(P-1)+"\" style=\"fill:"+X+"\" /></svg>"}}function _(P){var X=this,L=[];this.getId=function(){return P},this.getObjectIndex=function(O){return X.getObjectIndexById(O.getId())},this.getObjectIndexById=function(O){for(var Y=0;Y<L.length;Y++)if(L[Y].getId()===O)return Y;return null},this.addObject=function(O){return null===X.getObjectIndex(O)&&(L.push(O),!0)},this.getObjects=function(){return L},this.getObjectIds=function(){var O=[];return L.forEach(function(Y){O.push(Y.getId())}),O},this.removeObjectById=function(O){var Y=X.getObjectIndexById(O);return null!==Y&&(L.splice(Y,1),!0)},this.removeAllObjects=function(){L.length=0}}o.prototype.getX=function(){return this.__x},o.prototype.getY=function(){return this.__y},o.prototype.isEqual=function(P){return this.__x===P.getX()&&this.__y===P.getY()},o.prototype.getCartesianPoint=function(P,X){return new o(this.__x-0.5*P,-this.__y+0.5*X)},o.prototype.toString=function(){return this.__x+" "+this.__y};var A=Object.freeze({PARALLEL:"parallel",COINCIDENT:"coincident",LINE:"line",LINESEG:"lineseg"});s.prototype.getStartPoint=function(){return this.__startPoint},s.prototype.getEndPoint=function(){return this.__endPoint},s.prototype.isEqual=function(P){return this.getStartPoint().isEqual(P.getStartPoint())&&this.getEndPoint().isEqual(P.getEndPoint())},s.prototype.getLength=function(){return Math.sqrt(Math.pow(this.__endPoint.getX()-this.__startPoint.getX(),2)+Math.pow(this.__endPoint.getY()-this.__startPoint.getY(),2))},s.prototype.computeIntersectionType=function(P){var X=this.__startPoint.getX(),L=this.__startPoint.getY(),O=this.__endPoint.getX(),Y=this.__endPoint.getY(),S=P.getStartPoint().getX(),v=P.getStartPoint().getY(),w=P.getEndPoint().getX(),B=P.getEndPoint().getY(),D=(B-v)*(O-X)-(w-S)*(Y-L),R=(w-S)*(L-v)-(B-v)*(X-S),G=(O-X)*(L-v)-(Y-L)*(X-S);if(0==D)return 0==D&&0==R&&0==G?A.COINCIDENT:A.PARALLEL;var N=R/D,F=G/D;return 1<N||0>N||1<F||0>F?A.LINE:A.LINESEG},s.prototype.computeIntersection=function(P){var X=this.__startPoint.getX(),L=this.__startPoint.getY(),O=this.__endPoint.getX(),Y=this.__endPoint.getY(),S=P.getStartPoint().getX(),v=P.getStartPoint().getY(),w=P.getEndPoint().getX(),B=P.getEndPoint().getY(),D=(B-v)*(O-X)-(w-S)*(Y-L),R=(w-S)*(L-v)-(B-v)*(X-S),G=(O-X)*(L-v)-(Y-L)*(X-S);if(0==D)return 0==D&&0==R&&0==G?new g(A.COINCIDENT,null):new g(A.PARALLEL,null);var N=R/D,F=G/D,k=this.__startPoint.getX()+N*(this.__endPoint.getX()-this.__startPoint.getX()),W=this.__startPoint.getY()+N*(this.__endPoint.getY()-this.__startPoint.getY());return 1<N||0>N||1<F||0>F?new g(A.LINE,new o(k,W)):new g(A.LINESEG,new o(k,W))};var m={LINE:"line",DOT:"dot"};return t.Dimensions=function(P,X){this.getWidth=function(){return P},this.getHeight=function(){return X}},t.Rectangle=a,t.Point=o,t.LINE_INTERSECTION_TYPE=A,t.LineIntersection=g,t.Line=s,t.CanvasObject=function(P,X,L,O,Y,S,v,w,B){var F=this,W=[],D=1e3,R=null;this.x=parseInt(X),this.y=parseInt(L),this.width=parseInt(O),this.height=parseInt(Y),this.isDeleted=!1,this.addNonInteractableConnectorAnchor=function(M){var q=new u(P+("-"+D),M,S);return W.push(q),D++,q},this.addInteractableConnectorAnchor=function(M){var q=new u(P+("-"+D),M,S);return M.addEventListener("click",function(){S.addConnectionAnchorToSelectionStack(q)}),W.push(q),D++,q},this.getConnectorAnchorRoutingPoints=function(M){var q=F.getBoundingRectange(),J=[];return W.forEach(function(V){var K=V.getRoutingPoints(M);K.forEach(function(Z){q.checkIsPointWithin(Z)||J.push(Z)})}),J},this.getConnectorAnchors=function(){return W},this.hasConnectorAnchor=function(M){for(var q=F.getConnectorAnchors(),J=0;J<q.length;J++)if(q[J]===M)return!0;return!1},this.getTranslateHandleOffset=function(){return R?new o(-(R.offsetLeft+0.5*R.offsetWidth),-(R.offsetTop+0.5*R.offsetHeight)):null},this.getId=function(){return P},this.getX=function(){return F.x},this.setX=function(M){F.x=M},this.getY=function(){return F.y},this.setY=function(M){F.y=M},this.translate=function(M,q){F.x=M,F.y=q,v.style.left=parseInt(F.x)+"px",v.style.top=parseInt(F.y)+"px"},this.getWidth=function(){return F.width},this.getHeight=function(){return F.height},this.resize=function(M,q){F.width=M,F.height=q,v.style.width=parseInt(F.width)+"px",v.style.height=parseInt(F.height)+"px"},this.getIsDeleted=function(){return F.isDeleted},this.getDomElement=function(){return v},this.handleSiblingObjectChange=function(){},this.getBoundingRectange=function(){var M=parseInt(F.x),q=parseInt(F.y),J=M+parseInt(F.width),V=q+parseInt(F.height);return new a(M,q,J,V)},this.getBoundingPoints=function(){var M=new o(F.getX(),F.getY()),q=new o(F.getX()+F.getWidth(),F.getY()),J=new o(F.getX(),F.getY()+F.getWidth()),V=new o(F.getX()+F.getWidth(),F.getY()+F.getWidth());return[M,q,J,V]};var G=function moveStart(){},N=function resizeStart(){};this.setMoveStartCallback=function(M){G=M},this.setResizeStartCallback=function(M){N=M};(function z(){w.forEach(function(M){M.addEventListener("touchstart",function(q){R=M,G(F,q.touches[0].pageX,q.touches[0].pageY,!0)}),M.addEventListener("mousedown",function(q){R=M,G(F,q.pageX,q.pageY,!1)})})})(),function H(){B.forEach(function(M){M.addEventListener("mousedown",function(q){q.which!==1||N(F,q.pageX,q.pageY)})})}()},t.Canvas=function(P,X,L){var q=this,J={DBLCLICK:"dblclick",CLICK:"click",OBJECT_ADDED:"object-added",OBJECT_RESIZED:"object-resized",OBJECT_TRANSLATED:"object-translated"},V=X.document.createElementNS("http://www.w3.org/2000/svg","svg");V.style.width="100%",V.style.height="100%";var K=P.appendChild(V),O=null,Y="transform 0.55s ease-in-out, transform-origin 0.55s ease-in-out",S=0,v=0,w=0,B=0,D=1,R=1,G=[],Z=[],U=[],F=null,k=null,W=0,z=0,H={lastTouchX:null,lastTouchY:null,lastTouchTime:null},Q=[],$=new Map;this.getCurrentPointVisibilityMap=function(){return null},this.setGrid=function(ce){O=ce,P.style.background="url('data:image/svg+xml;base64,"+X.btoa(O.getSvgImageTile())+"') repeat"},this.getGrid=function(){return O},this.getGridSize=function(){return O.getSize()};var ee=function(){var ce=new h;return Z.forEach(function(le){var ue=le.getBoundingRectange().getPointsScaledToGrid(q.getGridSize());ue.forEach(function(fe){ce.push(fe)})}),Z.forEach(function(le){var ue=le.getConnectorAnchorRoutingPoints(q.getGridSize());ue.forEach(function(fe){ce.push(fe)})}),ce},te=function(){var ce=new h;return Z.forEach(function(le){var ue=le.getConnectorAnchorRoutingPoints(q.getGridSize());ue.forEach(function(fe){ce.push(fe)})}),ce},ne=function(){var ce=[];return Z.forEach(function(le){var ue=le.getBoundingRectange().getLines();ue.forEach(function(pe){ce.push(pe)});var fe=le.getConnectorAnchors();fe.forEach(function(pe){var Ee=pe.getBoundingRectange().getLines();Ee.forEach(function(Ce){ce.push(Ce)})})}),new l(ce)},oe=function(){var ce=[];U.forEach(function(pe){ce.push(pe.getDescriptor())});var le=te().toFloat64Array(),ue=ee().toFloat64Array(),fe=ne().toFloat64Array();L.postMessage({gridSize:q.getGridSize(),connectorDescriptors:ce,routingPoints:ue.buffer,boundaryLines:fe.buffer,anchorPoints:le.buffer},[ue.buffer,fe.buffer,le.buffer])};L.onmessage=function(ce){var le=ce.data.connectorDescriptors,ue=function(fe){for(var pe=0;pe<le.length;pe++)if(le[pe].id===fe)return le[pe];return null};U.forEach(function(fe){var pe=ue(fe.getId());pe&&fe.refresh(pe.svgPath)})};var M=function makeNewConnector(ce,le,ue){return new f(ce,le,ue)};this.setConnectorFactory=function(ce){M=ce},this.getTransitionCss=function(){return Y},this.setTransitionCss=function(ce){Y=ce,P.style.transition=Y},this.getTransformOriginX=function(){return S},this.getTransformOriginY=function(){return v},this.getScaleFactor=function(){return D},this.getTranslateX=function(){return w},this.getTranslateY=function(){return B},this.setTransformOrigin=function(ce,le){S=ce,v=le,P.style.transformOrigin=S+"px "+v+"px"},this.scale=function(ce,le){if(le=le||!1,le){var ue=q.getGridSize()*ce,fe=Math.round(ue);ce=fe/q.getGridSize()}return D=ce,R=1/D,G.push("scale3d("+D+","+D+","+D+")"),q},this.translate=function(ce,le){return w=ce,B=le,G.push("translate3d("+w+"px,"+B+"px,0)"),q},this.applyTransform=function(){P.style.transform=G.join(" "),G.length=0},this.resetTransform=function(){D=1,R=1,w=0,B=0,P.style.transform="none"},this.getPageOffset=function(){return new o(window.pageXOffset,window.pageYOffset)},this.snapToGrid=function(ce){var le=Math.round(ce/q.getGridSize())*q.getGridSize();return Math.max(0,le-1)},this.getOffsetLeft=function(){return P.offsetLeft},this.getOffsetTop=function(){return P.offsetTop},this.getWidth=function(){return P.offsetWidth},this.getHeight=function(){return P.offsetHeight},this.getObjectsAroundPoint=function(ce,le){var ue=[],fe=new a(ce,le,ce+1,le+1);return Z.forEach(function(pe){!pe.getIsDeleted()&&fe.checkIntersect(pe.getBoundingRectange())&&ue.push(pe)}),ue},this.calcBoundingBox=function(){var ce=null,le=null,ue=null,fe=null;return Z.forEach(function(pe){var Te=parseInt(pe.getX()),Ie=parseInt(pe.getY()),be=Te+parseInt(pe.getWidth()),Ae=Ie+parseInt(pe.getHeight());(null==le||Te<le)&&(le=Te),(null==ce||Ie<ce)&&(ce=Ie),(null==ue||Ae>ue)&&(ue=Ae),(null==fe||be>fe)&&(fe=be)}),new a(le,ce,fe,ue)},this.getAllObjects=function(){return Z},this.publishSiblingObjectChange=function(ce,le){Z.forEach(function(ue){ue.handleSiblingObjectChange(ce,le)})},this.getObjectById=function(ce){var le=null;return Z.forEach(function(ue){null==le&&ue.getId()===ce&&(le=ue)}),le},this.addObject=function(ce){ce.setResizeStartCallback(ie),ce.setMoveStartCallback(re),Z.push(ce),oe(),he(J.OBJECT_ADDED,{object:ce})},this.getConnector=function(ce){for(var le=0;le<U.length;le++)if(U[le].getId()===ce)return U[le];return null},this.getConnectorsBetweenObjects=function(ce,le){var ue=[];return U.forEach(function(fe){var pe=fe.getAnchorStart(),Ee=fe.getAnchorEnd();ce.hasConnectorAnchor(pe)&&le.hasConnectorAnchor(Ee)&&ue.push(fe),ce.hasConnectorAnchor(Ee)&&le.hasConnectorAnchor(pe)&&ue.push(fe)}),ue},this.removeAllConnectors=function(){U.forEach(function(ce){ce.removePathElement()}),U.splice(0,U.length)},this.removeConnector=function(ce){for(var le=0;le<U.length;le++)if(U[le]===ce)return U.splice(le,1),!0;return!1},this.makeNewConnectorFromAnchors=function(ce,le){var ue=M(ce,le,K),fe=q.getConnector(ue.getId());return null===fe?(U.push(ue),ue.appendPathToContainerDomElement(),oe(),ue):fe},this.findBestConnectorAnchorsToConnectObjects=function(ce,le){for(var Ee=ce.getConnectorAnchors(),Ce=le.getConnectorAnchors(),ue=0,fe=0,pe=Number.MAX_VALUE,Te=0;Te<Ee.length;Te++)for(var Ie=0;Ie<Ce.length;Ie++){var be=Ee[Te].getCentroid(),Ae=Ce[Ie].getCentroid(),me=Math.sqrt(Math.pow(Ae.getX()-be.getX(),2)+Math.pow(Ae.getY()-be.getY(),2));me<pe&&(ue=Te,fe=Ie,pe=me)}return{objectAAnchorIndex:ue,objectAAnchor:Ee[ue],objectBAnchorIndex:fe,objectBAnchor:Ce[fe]}},this.addConnectionAnchorToSelectionStack=function(ce){Q.push(ce),2===Q.length&&(q.makeNewConnectorFromAnchors(Q[0],Q[1]),Q.length=0)};var ge=function(ce,le){var ue=q.getObjectsAroundPoint(ce,le),fe={targetPoint:new o(ce,le),objectsAroundPoint:ue};he(J.DBLCLICK,fe)};this.initInteractionHandlers=function(ce,le){P.addEventListener("dblclick",function(ue){ge(ue.pageX,ue.pageY)}),P.addEventListener("click",function(ue){var fe=!1;ue.target!==P&&(fe=!0);var pe={targetPoint:new o(ue.pageX,ue.pageY),canvasObjectClicked:fe};he(J.CLICK,pe)}),P.addEventListener("touchend",function(ue){if(0>=ue.changedTouches.length)return!1;var fe=!1,pe=ue.changedTouches[0].pageX,Ee=ue.changedTouches[0].pageY,Ce=new Date().getTime();if(null!==H.lastTouchTime){var Te=H.lastTouchTime,be=H.lastTouchX,Ae=H.lastTouchY,me=Math.sqrt(Math.pow(pe-be,2)+Math.pow(Ee-Ae,2));Ce-Te<=ce&&me<=le&&(fe=!0,ge(pe,Ee),H.lastTouchTime=null,H.lastTouchX=null,H.lastTouchY=null)}fe||(H.lastTouchTime=Ce,H.lastTouchX=pe,H.lastTouchY=Ee)})};var ie=function(ce){k=ce.getId()},re=function(ce,le,ue){F=ce.getId(),W=le,z=ue},se=function(ce,le){var ue=q.getObjectById(F),fe=ue.getTranslateHandleOffset(),pe=q.snapToGrid(ce+fe.getX()),Ee=q.snapToGrid(le+fe.getY());ue.translate(pe,Ee),he(J.OBJECT_TRANSLATED,{object:ue}),oe()},de=function(ce,le){var ue=q.getObjectById(F),fe=ue.getTranslateHandleOffset(),pe=q.snapToGrid(ce+fe.getX()),Ee=q.snapToGrid(le+fe.getY()),Ce=W,Te=z;Ce==pe&&Te==Ee||(ue.translate(pe,Ee),he(J.OBJECT_TRANSLATED,{object:ue}))},ae=function(ce,le){var ue=q.getObjectById(k),fe=q.snapToGrid(ce),pe=q.snapToGrid(le),Ee=ue.getY(),Ce=ue.getX();ue.resize(fe-Ce+1,pe-Ee+1),oe(),he(J.OBJECT_RESIZED,{object:ue})};this.initTransformationHandlers=function(){P.addEventListener("touchmove",function(ce){null!==F&&(se(ce.touches[0].pageX*R,ce.touches[0].pageY*R),ce.preventDefault())}),P.addEventListener("mousemove",function(ce){null!==F&&se(ce.pageX*R,ce.pageY*R),null!==k&&ae(ce.pageX*R,ce.pageY*R)}),P.addEventListener("touchend",function(){if(null!==F){q.getObjectById(F);F=null,k=null}}),P.addEventListener("mouseup",function(ce){1===ce.which&&(null!==F&&de(ce.pageX*R,ce.pageY*R),F=null,k=null)}),P.addEventListener("mousedown",function(ce){(null!==F||null!==k)&&(ce.preventDefault(),ce.stopPropagation())})};var he=function(ce,le){for(var pe,ue=$.get(ce)||[],fe=0;fe<ue.length;fe++)pe=ue[fe],pe(le)};this.off=function(ce,le){for(var ue=$.get(ce)||[],fe=0;fe<ue.length;fe++)if(ue[fe]===le){ue.splice(fe,1);break}$.set(ce,ue)},this.on=function(ce,le){var ue=$.get(ce)||[];ue.push(le),$.set(ce,ue)},q.setGrid(new E(12,"#424242",m.DOT)),q.resetTransform(),q.setTransformOrigin(0,0),q.setTransitionCss(Y)},t.Cluster=_,t.BoxClusterDetector=function(P){var X=this,L=function(S,v){for(var w=0;w<v.length;w++)if(v[w].getId()===S.getId())return w;return-1},O=function(S,v){for(var B,w=0;w<S.length;w++)B=L(S[w],v),-1!==B&&v.splice(B,1);return v},Y=function(S){var v=0,w=null;return S.forEach(function(B,D){B>v&&(v=B,w=D)}),w};this.areObjectsClose=function(S,v){var w=new a(S.x-P,S.y-P,S.x+S.width+P,S.y+S.height+P),B=new a(v.x-P,v.y-P,v.x+v.width+P,v.y+v.height+P);return w.checkIntersect(B)},this.getAllObjectsCloseTo=function(S,v){for(var w=[],B=0;B<v.length;B++)S.getId()!==v[B].getId()&&X.areObjectsClose(S,v[B])&&w.push(v[B]);return w},this.getClusterObjectsFromSeed=function(S,v,w){var B=X.getAllObjectsCloseTo(S,v);return 0===B.length?[]:void(O(B.concat([S]),v),B.forEach(function(D){w.push(D),X.getClusterObjectsFromSeed(D,v,w)}))},this.findIntersectingClustersForObjects=function(S,v){var w=new Map;return v.forEach(function(B){for(var D=B.getObjects(),R=0;R<D.length;R++)for(var G=0;G<S.length;G++)if(D[R].getId()===S[G].getId())if(w.has(B)){var N=w.get(B);w.set(B,N+1)}else w.set(B,1)}),w},this.removeObjectFromClusters=function(S,v){v.forEach(function(w){w.removeObjectById(S.getId())})},this.computeClusters=function(S,v,w){for(var B=v.map(function(k){return k}),D=S.map(function(k){return k});0<D.length;){var R=D.pop(),G=[R];if(X.getClusterObjectsFromSeed(R,D,G),1<G.length){var N=X.findIntersectingClustersForObjects(G,B);0===N.size?function(){var k=new _(w());G.forEach(function(W){k.addObject(W)}),B.push(k)}():function(){var k=Y(N);k.removeAllObjects(),G.forEach(function(W){X.removeObjectFromClusters(W,B),k.addObject(W)})}(),O(G,D)}else X.removeObjectFromClusters(R,B)}var F=B.filter(function(k){return!!(2<=k.getObjects().length)});return F}},t.Connector=f,t.ConnectorAnchor=u,t.PointVisibilityMap=function(P,X){var L=this,O=X.toArray(),Y=new Map,S=function(D){for(var G,R=0;R<O.length;R++)if(G=O[R].computeIntersectionType(D),G===A.LINESEG)return!0;return!1},w=function(D){var R=Number.MAX_SAFE_INTEGER,G=null,_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var W,k=D.entries()[Symbol.iterator]();!(_iteratorNormalCompletion=(W=k.next()).done);_iteratorNormalCompletion=!0){var _step$value=_slicedToArray(W.value,2),N=_step$value[0],F=_step$value[1];F<R&&(G=N,R=F)}}catch(z){_didIteratorError=!0,_iteratorError=z}finally{try{!_iteratorNormalCompletion&&k.return&&k.return()}finally{if(_didIteratorError)throw _iteratorError}}return null===G?null:{cost:R,point:G}},B=function(D,R,G,N){var k=new Map,F=Y.get(G);F=F.filter(function(z){for(var H=0;H<R.length;H++)if(z.isEqual(R[H]))return!1;return!0}),F.forEach(function(z){var H=new s(G,z).getLength()+D,M=new s(z,N).getLength();k.set(z,H+M)});var W=w(k);return null===W?null:W};this.findPointClosestTo=function(D){var R=null,G=Number.MAX_SAFE_INTEGER;return Y.forEach(function(N,F){var k=new s(D,F);k.getLength()<G&&(R=F,G=k.getLength())}),R},this.findVisiblePointClosestTo=function(D){var R=null,G=Number.MAX_SAFE_INTEGER;return Y.forEach(function(N,F){var k=new s(D,F);!S(k)&&k.getLength()<G&&(R=F,G=k.getLength())}),R},this.computeRoute=function(D,R){if(null===D||null===R)return new h;var F=L.findVisiblePointClosestTo(D);if(null===F)return new h;for(var W,G=0,k=[F],N=F;;){if(W=B(G,k,N,R),null===W){var z=new s(k[k.length-1],R);if(S(z))return new h;break}if(G+=new s(N,W.point).getLength(),k.push(W.point),N=W.point,1>new s(N,R).getLength())break}return new h(k)},function v(){for(var D=P.toArray(),R=0;R<D.length;R++)Y.set(D[R],[]);for(var G=0;G<D.length;G++)for(var F,N=G+1;N<D.length;N++)if(F=new s(D[G],D[N]),!S(F)){var k=Y.get(D[G]);k.push(D[N]),Y.set(D[G],k);var W=Y.get(D[N]);W.push(D[G]),Y.set(D[N],W)}}()},t.GRID_STYLE=m,t.Grid=E,t}({});