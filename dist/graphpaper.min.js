"use strict";var _slicedToArray=function(){function a(d,f){var g=[],h=!0,k=!1,l=void 0;try{for(var n,m=d[Symbol.iterator]();!(h=(n=m.next()).done)&&(g.push(n.value),!(f&&g.length===f));h=!0);}catch(o){k=!0,l=o}finally{try{!h&&m["return"]&&m["return"]()}finally{if(k)throw l}}return g}return function(d,f){if(Array.isArray(d))return d;if(Symbol.iterator in Object(d))return a(d,f);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),GraphPaper=function(a){"use strict";function f(z,A){this.getX=function(){return z},this.getY=function(){return A},this.isEqual=function(B){return z===B.getX()&&A===B.getY()},this.getCartesianPoint=function(B,C){return new f(z-0.5*B,-A+0.5*C)},this.toString=function(){return z+" "+A}}function g(z,A){this.getType=function(){return z},this.getIntersectionPoint=function(){return A}}function h(z,A){var B=this;this.getStartPoint=function(){return z},this.getEndPoint=function(){return A},this.isEqual=function(C){return B.getStartPoint().isEqual(C.getStartPoint())&&B.getEndPoint().isEqual(C.getEndPoint())},this.getLength=function(){return Math.sqrt(Math.pow(A.getX()-z.getX(),2)+Math.pow(A.getY()-z.getY(),2))},this.computeIntersectionType=function(C){var D=z.getX(),E=z.getY(),F=A.getX(),G=A.getY(),H=C.getStartPoint().getX(),I=C.getStartPoint().getY(),J=C.getEndPoint().getX(),K=C.getEndPoint().getY(),L=(K-I)*(F-D)-(J-H)*(G-E),M=(J-H)*(E-I)-(K-I)*(D-H),N=(F-D)*(E-I)-(G-E)*(D-H);if(0==L)return 0==L&&0==M&&0==N?v.COINCIDENT:v.PARALLEL;var O=M/L,P=N/L;return 1<O||0>O||1<P||0>P?v.LINE:v.LINESEG},this.computeIntersection=function(C){var D=z.getX(),E=z.getY(),F=A.getX(),G=A.getY(),H=C.getStartPoint().getX(),I=C.getStartPoint().getY(),J=C.getEndPoint().getX(),K=C.getEndPoint().getY(),L=(K-I)*(F-D)-(J-H)*(G-E),M=(J-H)*(E-I)-(K-I)*(D-H),N=(F-D)*(E-I)-(G-E)*(D-H);if(0==L)return 0==L&&0==M&&0==N?new g(v.COINCIDENT,null):new g(v.PARALLEL,null);var O=M/L,P=N/L,Q=z.getX()+O*(A.getX()-z.getX()),R=z.getY()+O*(A.getY()-z.getY());return 1<O||0>O||1<P||0>P?new g(v.LINE,new f(Q,R)):new g(v.LINESEG,new f(Q,R))}}function k(z,A,B,C){this.getLeft=function(){return z},this.getTop=function(){return A},this.getRight=function(){return B},this.getBottom=function(){return C},this.getPoints=function(){return[new f(z,A),new f(B,A),new f(B,C),new f(z,C)]},this.getLines=function(){return[new h(new f(z,A),new f(B,A)),new h(new f(B,A),new f(B,C)),new h(new f(B,C),new f(z,C)),new h(new f(z,C),new f(z,A))]},this.getPointsScaledToGrid=function(D){var E=new f(z+0.5*(B-z),A+0.5*(C-A)),F=(B-E.getX()+D)/(B-E.getX()),G=(C-E.getY()+D)/(C-E.getY()),H=[new f((z-E.getX())*F+E.getX(),(A-E.getY())*G+E.getY()),new f((B-E.getX())*F+E.getX(),(A-E.getY())*G+E.getY()),new f((B-E.getX())*F+E.getX(),(C-E.getY())*G+E.getY()),new f((z-E.getX())*F+E.getX(),(C-E.getY())*G+E.getY())];return H},this.checkIntersect=function(D){return!(C<D.getTop())&&!(A>D.getBottom())&&!(B<D.getLeft())&&!(z>D.getRight())},this.checkIsPointWithin=function(D){return D.getX()>=z&&D.getX()<=B&&D.getY()>=A&&D.getY()<=C},this.checkIsWithin=function(D){return C<=D.getBottom()&&A>=D.getTop()&&B<=D.getRight()&&z>=D.getLeft()}}function l(z){var A=this,B=[];this.push=function(D){var E=!1;return(B.forEach(function(F){D.isEqual(F)&&(E=!0)}),!E)&&(B.push(D),!0)},this.findPointClosestTo=function(D){var E=null,F=Number.MAX_SAFE_INTEGER;return B.forEach(function(G){var H=new h(D,G);H.getLength()<F&&(E=G,F=H.getLength())}),E},this.findDistanceToPointClosestTo=function(D){var E=Number.MAX_SAFE_INTEGER;return B.forEach(function(F){var G=new h(D,F);G.getLength()<E&&(E=G.getLength())}),E},this.findPointsCloseTo=function(D,E){var F=new l;return B.forEach(function(G){var H=new h(D,G);H.getLength()<=E&&F.push(G)}),F},this.toArray=function(){return B},this.toFloat64Array=function(){for(var D=new Float64Array(2*B.length),E=0;E<B.length;E++)D[0+2*E]=B[E].getX(),D[1+2*E]=B[E].getY();return D};this.count=function(){return B.length},z&&Array.isArray(z)?z.forEach(A.push):z&&"[object Float64Array]"===Object.prototype.toString.call(z)&&function C(D){B.length=0;for(var E=0;E<D.length;E+=2)B.push(new f(D[E],D[E+1]))}(z)}function m(z){var A=this,B=[];this.push=function(D){var E=!1;return(B.forEach(function(F){D.isEqual(F)&&(E=!0)}),!E)&&(B.push(D),!0)},this.toArray=function(){return B},this.count=function(){return B.length},this.toFloat64Array=function(){for(var D=new Float64Array(4*B.length),E=0;E<B.length;E++)D[0+4*E]=B[E].getStartPoint().getX(),D[1+4*E]=B[E].getStartPoint().getY(),D[2+4*E]=B[E].getEndPoint().getX(),D[3+4*E]=B[E].getEndPoint().getY();return D};z&&Array.isArray(z)?z.forEach(A.push):z&&"[object Float64Array]"===Object.prototype.toString.call(z)&&function C(D){B.length=0;for(var E=0;E<D.length;E+=4)B.push(new h(new f(D[E],D[E+1]),new f(D[E+2],D[E+3])))}(z)}function n(z,A,B){var C=this;this.getParentObject=function(){return A},this.getObjectId=function(){return A.getId()},this.getX=function(){return C.getCentroid().getX()},this.getY=function(){return C.getCentroid().getY()},this.getWidth=function(){return z.clientWidth},this.getHeight=function(){return z.clientHeight},this.getCentroid=function(){var D=z.getBoundingClientRect(),E=B.getPageOffset();return new f(D.left+E.getX()+0.5*z.clientWidth,D.top+E.getY()+0.5*z.clientHeight)},this.getRoutingPoints=function(D){var E=C.getCentroid(),F=0.5*z.clientWidth,G=0.5*z.clientHeight;return[new f(E.getX()+F+D,E.getY()),new f(E.getX()-F-D,E.getY()),new f(E.getX(),E.getY()+G+D),new f(E.getX(),E.getY()-G-D)]},this.getBoundingRectange=function(){var D=C.getCentroid(),E=0.5*z.clientWidth,F=0.5*z.clientHeight;return new k(D.getX()-E,D.getY()-F,D.getX()+E,D.getY()+F)},this.getDomElement=function(){return z}}function o(z,A,B,C,D){var F=this;"undefined"==typeof C&&(C="#000"),"undefined"==typeof D&&(D="2px");var G=document.createElementNS("http://www.w3.org/2000/svg","path");G.setAttribute("d","M0 0 L0 0"),G.style.stroke=C,G.style.strokeWidth=D;this.appendPathToContainerDomElement=function(){B.appendChild(G)},this.refresh=function(H){G.setAttribute("d",H)},this.getId=function(){var H=[z.getObjectId(),A.getObjectId()].sort();return H.join(":")},this.getDescriptor=function(){return{id:F.getId(),anchor_start_centroid:z.getCentroid().toString(),anchor_end_centroid:A.getCentroid().toString()}}}function q(z,A,B){this.getSize=function(){return z},this.getStyle=function(){return B},this.getSvgImageTile=function(){return B===w.LINE?"<svg xmlns=\"http://www.w3.org/2000/svg\" width=\""+z+"\" height=\""+z+"\"><rect width=\""+z+"\" height=\"1\" x=\"0\" y=\""+(z-1)+"\" style=\"fill:"+A+"\" /><rect width=\"1\" height=\""+z+"\" x=\""+(z-1)+"\" y=\"0\" style=\"fill:"+A+"\" /></svg>":"<svg xmlns=\"http://www.w3.org/2000/svg\" width=\""+z+"\" height=\""+z+"\"><rect width=\"1\" height=\"1\" x=\""+(z-1)+"\" y=\""+(z-1)+"\" style=\"fill:"+A+"\" /></svg>"}}function t(z){var A=this,B=[];this.getId=function(){return z},this.getObjectIndex=function(C){return A.getObjectIndexById(C.getId())},this.getObjectIndexById=function(C){for(var D=0;D<B.length;D++)if(B[D].getId()===C)return D;return null},this.addObject=function(C){return null===A.getObjectIndex(C)&&(B.push(C),!0)},this.getObjects=function(){return B},this.getObjectIds=function(){var C=[];return B.forEach(function(D){C.push(D.getId())}),C},this.removeObjectById=function(C){var D=A.getObjectIndexById(C);return null!==D&&(B.splice(D,1),!0)},this.removeAllObjects=function(){B.length=0}}var v=Object.freeze({PARALLEL:"parallel",COINCIDENT:"coincident",LINE:"line",LINESEG:"lineseg"}),w={LINE:"line",DOT:"dot"};return a.Dimensions=function(z,A){this.getWidth=function(){return z},this.getHeight=function(){return A}},a.Rectangle=k,a.Point=f,a.LINE_INTERSECTION_TYPE=v,a.LineIntersection=g,a.Line=h,a.CanvasObject=function(z,A,B,C,D,E,F,G,H){var K=this,L=[];this.x=parseInt(A),this.y=parseInt(B),this.width=parseInt(C),this.height=parseInt(D),this.isDeleted=!1,this.addConnectorAnchor=function(M){var N=new n(M,K,E);M.addEventListener("click",function(){E.addConnectionAnchorToSelectionStack(N)}),L.push(N)},this.getConnectorAnchorRoutingPoints=function(M){var N=K.getBoundingRectange(),O=[];return L.forEach(function(P){var Q=P.getRoutingPoints(M);Q.forEach(function(R){N.checkIsPointWithin(R)||O.push(R)})}),O},this.getConnectorAnchors=function(){return L},this.getTranslateHandleOffsetX=function(){return-(G.offsetLeft+0.5*G.offsetWidth)},this.getTranslateHandleOffsetY=function(){return-(G.offsetTop+0.5*G.offsetHeight)},this.getId=function(){return z},this.getX=function(){return K.x},this.setX=function(M){K.x=M},this.getY=function(){return K.y},this.setY=function(M){K.y=M},this.translate=function(M,N){K.x=M,K.y=N,F.style.left=parseInt(K.x)+"px",F.style.top=parseInt(K.y)+"px"},this.getWidth=function(){return K.width},this.getHeight=function(){return K.height},this.resize=function(M,N){K.width=M,K.height=N,F.style.width=parseInt(K.width)+"px",F.style.height=parseInt(K.height)+"px"},this.getIsDeleted=function(){return K.isDeleted},this.getDomElement=function(){return F},this.handleSiblingObjectChange=function(){},this.getBoundingRectange=function(){var M=parseInt(K.x),N=parseInt(K.y),O=M+parseInt(K.width),P=N+parseInt(K.height);return new k(M,N,O,P)},this.getBoundingPoints=function(){var M=new f(K.getX(),K.getY()),N=new f(K.getX()+K.getWidth(),K.getY()),O=new f(K.getX(),K.getY()+K.getWidth()),P=new f(K.getX()+K.getWidth(),K.getY()+K.getWidth());return[M,N,O,P]};var I=function moveStart(){},J=function resizeStart(){};this.setMoveStartCallback=function(M){I=M},this.setResizeStartCallback=function(M){J=M},G.addEventListener("touchstart",function(M){I(K,M.touches[0].pageX,M.touches[0].pageY,!0)}),G.addEventListener("mousedown",function(M){I(K,M.pageX,M.pageY,!1)}),H.addEventListener("mousedown",function(M){1!==M.which||J(K,M.pageX,M.pageY)})},a.Canvas=function(z,A,B,C){var T=this,U=B.document.createElementNS("http://www.w3.org/2000/svg","svg");U.style.width="100%",U.style.height="100%";var V=z.appendChild(U),D=null,E="transform 0.55s ease-in-out, transform-origin 0.55s ease-in-out",F=0,G=0,H=0,I=0,J=1,K=1,W=[],X=[],M=null,N=null,O=0,P=0,Q={lastTouchX:null,lastTouchY:null,lastTouchTime:null},Y=[];this.getCurrentPointVisibilityMap=function(){return null},this.setGrid=function(ga){D=ga,z.style.background="url('data:image/svg+xml;base64,"+B.btoa(D.getSvgImageTile())+"') repeat"},this.getGrid=function(){return D},this.getGridSize=function(){return D.getSize()};var Z=function(){var ga=new l;return W.forEach(function(ha){var ia=ha.getBoundingRectange().getPointsScaledToGrid(T.getGridSize());ia.forEach(function(ja){ga.push(ja)})}),W.forEach(function(ha){var ia=ha.getConnectorAnchorRoutingPoints(T.getGridSize());ia.forEach(function(ja){ga.push(ja)})}),ga},$=function(){var ga=new l;return W.forEach(function(ha){var ia=ha.getConnectorAnchorRoutingPoints(T.getGridSize());ia.forEach(function(ja){ga.push(ja)})}),ga},_=function(){var ga=[];return W.forEach(function(ha){var ia=ha.getBoundingRectange().getLines();ia.forEach(function(ka){ga.push(ka)});var ja=ha.getConnectorAnchors();ja.forEach(function(ka){var la=ka.getBoundingRectange().getLines();la.forEach(function(ma){ga.push(ma)})})}),new m(ga)},aa=function(){var ga=[];X.forEach(function(ka){ga.push(ka.getDescriptor())});var ha=$().toFloat64Array(),ia=Z().toFloat64Array(),ja=_().toFloat64Array();C.postMessage({gridSize:T.getGridSize(),connectorDescriptors:ga,routingPoints:ia.buffer,boundaryLines:ja.buffer,anchorPoints:ha.buffer},[ia.buffer,ja.buffer,ha.buffer])};C.onmessage=function(ga){var ha=ga.data.connectorDescriptors,ia=function(ja){for(var ka=0;ka<ha.length;ka++)if(ha[ka].id===ja)return ha[ka];return null};X.forEach(function(ja){var ka=ia(ja.getId());ka&&ja.refresh(ka.svgPath)})};var R=function makeNewConnector(ga,ha,ia){return new o(ga,ha,ia)};this.setConnectorFactory=function(ga){R=ga},this.getTransitionCss=function(){return E},this.setTransitionCss=function(ga){E=ga,z.style.transition=E},this.getTransformOriginX=function(){return F},this.getTransformOriginY=function(){return G},this.getScaleFactor=function(){return J},this.getTranslateX=function(){return H},this.getTranslateY=function(){return I},this.setTransformOrigin=function(ga,ha){F=ga,G=ha,z.style.transformOrigin=F+"px "+G+"px"},this.setScaleFactor=function(ga,ha){if(ha=ha||!1,ha){var ia=T.getGridSize()*ga,ja=Math.round(ia);ga=ja/T.getGridSize()}return z.style.transform="scale3d("+ga+","+ga+","+ga+")",J=ga,K=1/J,ga},this.transform=function(ga,ha,ia,ja){if(ha=ha||!1,H=ia||H,I=ja||I,ha){var ka=T.getGridSize()*ga,la=Math.round(ka);ga=la/T.getGridSize()}J=ga,K=1/J,z.style.transform="scale3d("+J+","+J+","+J+") translate3d("+H+"px,"+I+"px,0)"},this.resetTransform=function(){J=1,K=1,H=0,I=0,z.style.transform="none"},this.getPageOffset=function(){return new f(window.pageXOffset,window.pageYOffset)},this.snapToGrid=function(ga){var ha=Math.round(ga/T.getGridSize())*T.getGridSize();return Math.max(0,ha-1)},this.getOffsetLeft=function(){return z.offsetLeft},this.getOffsetTop=function(){return z.offsetTop},this.getWidth=function(){return z.offsetWidth},this.getHeight=function(){return z.offsetHeight},this.getObjectsAroundPoint=function(ga,ha){var ia=[],ja=new k(ga,ha,ga+1,ha+1);return W.forEach(function(ka){!ka.getIsDeleted()&&ja.checkIntersect(ka.getBoundingRectange())&&ia.push(ka)}),ia},this.calcBoundingBox=function(){var ga=null,ha=null,ia=null,ja=null;return W.forEach(function(ka){var na=parseInt(ka.getX()),oa=parseInt(ka.getY()),pa=na+parseInt(ka.getWidth()),qa=oa+parseInt(ka.getHeight());(null==ha||na<ha)&&(ha=na),(null==ga||oa<ga)&&(ga=oa),(null==ia||qa>ia)&&(ia=qa),(null==ja||pa>ja)&&(ja=pa)}),new k(ha,ga,ja,ia)},this.getAllObjects=function(){return W},this.publishSiblingObjectChange=function(ga,ha){W.forEach(function(ia){ia.handleSiblingObjectChange(ga,ha)})},this.getObjectById=function(ga){var ha=null;return W.forEach(function(ia){null==ha&&ia.getId()===ga&&(ha=ia)}),ha},this.addObject=function(ga){ga.setResizeStartCallback(ba),ga.setMoveStartCallback(ca),W.push(ga),aa()},this.getConnector=function(ga){for(var ha=0;ha<X.length;ha++)if(X[ha].getId()===ga)return X[ha];return null},this.addConnectionAnchorToSelectionStack=function(ga){if(Y.push(ga),2===Y.length){var ha=R(Y[0],Y[1],V),ia=T.getConnector(ha.getId());Y.length=0,null===ia&&(X.push(ha),ha.appendPathToContainerDomElement(),aa())}};var S=function(ga,ha){var ia=T.getObjectsAroundPoint(ga,ha);0===ia.length&&A("dbl-click",new f(ga,ha))};this.initInteractionHandlers=function(ga,ha){z.addEventListener("dblclick",function(ia){S(ia.pageX,ia.pageY)}),z.addEventListener("click",function(ia){ia.target===z?A("click",{canvasObjectClicked:!1}):A("click",{canvasObjectClicked:!0})}),z.addEventListener("touchend",function(ia){if(0>=ia.changedTouches.length)return!1;var ja=!1,ka=ia.changedTouches[0].pageX,la=ia.changedTouches[0].pageY,ma=new Date().getTime();if(null!==Q.lastTouchTime){var na=Q.lastTouchTime,pa=Q.lastTouchX,qa=Q.lastTouchY,ra=Math.sqrt(Math.pow(ka-pa,2)+Math.pow(la-qa,2));ma-na<=ga&&ra<=ha&&(ja=!0,S(ka,la),Q.lastTouchTime=null,Q.lastTouchX=null,Q.lastTouchY=null)}ja||(Q.lastTouchTime=ma,Q.lastTouchX=ka,Q.lastTouchY=la)})};var ba=function(ga){N=ga.getId()},ca=function(ga,ha,ia){M=ga.getId(),O=ha,P=ia},da=function(ga,ha){var ia=T.getObjectById(M),ja=T.snapToGrid(ga+ia.getTranslateHandleOffsetX()),ka=T.snapToGrid(ha+ia.getTranslateHandleOffsetY());ia.translate(ja,ka),aa()},ea=function(ga,ha){var ia=T.getObjectById(M),ja=T.snapToGrid(ga+ia.getTranslateHandleOffsetX()),ka=T.snapToGrid(ha+ia.getTranslateHandleOffsetY()),la=O,ma=P;la==ja&&ma==ka||(ia.translate(ja,ka),A("object-translated",ia))},fa=function(ga,ha){var ia=T.getObjectById(N),ja=T.snapToGrid(ga),ka=T.snapToGrid(ha),la=ia.getY(),ma=ia.getX();ia.resize(ja-ma+1,ka-la+1),aa(),A("object-resized",ia)};this.initTransformationHandlers=function(){z.addEventListener("touchmove",function(ga){null!==M&&(da(ga.touches[0].pageX*K,ga.touches[0].pageY*K),ga.preventDefault())}),z.addEventListener("mousemove",function(ga){null!==M&&da(ga.pageX*K,ga.pageY*K),null!==N&&fa(ga.pageX*K,ga.pageY*K)}),z.addEventListener("touchend",function(){if(null!==M){T.getObjectById(M);M=null,N=null}}),z.addEventListener("mouseup",function(ga){1===ga.which&&(null!==M&&ea(ga.pageX*K,ga.pageY*K),M=null,N=null)}),z.addEventListener("mousedown",function(ga){(null!==M||null!==N)&&(ga.preventDefault(),ga.stopPropagation())})},T.setGrid(new q(12,"#424242",w.DOT)),T.resetTransform(),T.setTransformOrigin(0,0),T.setTransitionCss(E)},a.Cluster=t,a.BoxClusterDetector=function(z){var A=this,B=function(E,F){for(var G=0;G<F.length;G++)if(F[G].getId()===E.getId())return G;return-1},C=function(E,F){for(var H,G=0;G<E.length;G++)H=B(E[G],F),-1!==H&&F.splice(H,1);return F},D=function(E){var F=0,G=null;return E.forEach(function(H,I){H>F&&(F=H,G=I)}),G};this.areObjectsClose=function(E,F){var G=new k(E.x-z,E.y-z,E.x+E.width+z,E.y+E.height+z),H=new k(F.x-z,F.y-z,F.x+F.width+z,F.y+F.height+z);return G.checkIntersect(H)},this.getAllObjectsCloseTo=function(E,F){for(var G=[],H=0;H<F.length;H++)E.getId()!==F[H].getId()&&A.areObjectsClose(E,F[H])&&G.push(F[H]);return G},this.getClusterObjectsFromSeed=function(E,F,G){var H=A.getAllObjectsCloseTo(E,F);return 0===H.length?[]:void(C(H.concat([E]),F),H.forEach(function(I){G.push(I),A.getClusterObjectsFromSeed(I,F,G)}))},this.findIntersectingClustersForObjects=function(E,F){var G=new Map;return F.forEach(function(H){for(var I=H.getObjects(),J=0;J<I.length;J++)for(var K=0;K<E.length;K++)if(I[J].getId()===E[K].getId())if(G.has(H)){var L=G.get(H);G.set(H,L+1)}else G.set(H,1)}),G},this.removeObjectFromClusters=function(E,F){F.forEach(function(G){G.removeObjectById(E.getId())})},this.computeClusters=function(E,F,G){for(var H=F.map(function(N){return N}),I=E.map(function(N){return N});0<I.length;){var J=I.pop(),K=[J];if(A.getClusterObjectsFromSeed(J,I,K),1<K.length){var L=A.findIntersectingClustersForObjects(K,H);0===L.size?function(){var N=new t(G());K.forEach(function(O){N.addObject(O)}),H.push(N)}():function(){var N=D(L);N.removeAllObjects(),K.forEach(function(O){A.removeObjectFromClusters(O,H),N.addObject(O)})}(),C(K,I)}else A.removeObjectFromClusters(J,H)}var M=H.filter(function(N){return!!(2<=N.getObjects().length)});return M}},a.Connector=o,a.ConnectorAnchor=n,a.PointVisibilityMap=function(z,A){var B=this,C=new Map,D=function(H){for(var K,I=A.toArray(),J=0;J<I.length;J++)if(K=I[J].computeIntersectionType(H),K===v.LINESEG)return!0;return!1},F=function(H){var I=Number.MAX_SAFE_INTEGER,J=null,_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var N,M=H.entries()[Symbol.iterator]();!(_iteratorNormalCompletion=(N=M.next()).done);_iteratorNormalCompletion=!0){var _step$value=_slicedToArray(N.value,2),K=_step$value[0],L=_step$value[1];L<I&&(J=K,I=L)}}catch(O){_didIteratorError=!0,_iteratorError=O}finally{try{!_iteratorNormalCompletion&&M.return&&M.return()}finally{if(_didIteratorError)throw _iteratorError}}return null===J?null:{cost:I,point:J}},G=function(H,I,J,K){var M=new Map,L=C.get(J);L=L.filter(function(O){for(var P=0;P<I.length;P++)if(O.isEqual(I[P]))return!1;return!0}),L.forEach(function(O){var P=new h(J,O).getLength()+H,Q=new h(O,K).getLength();M.set(O,P+Q)});var N=F(M);return null===N?null:N};this.findPointClosestTo=function(H){var I=null,J=Number.MAX_SAFE_INTEGER;return C.forEach(function(K,L){var M=new h(H,L);M.getLength()<J&&(I=L,J=M.getLength())}),I},this.findVisiblePointClosestTo=function(H){var I=null,J=Number.MAX_SAFE_INTEGER;return C.forEach(function(K,L){var M=new h(H,L);!D(M)&&M.getLength()<J&&(I=L,J=M.getLength())}),I},this.computeRoute=function(H,I){var L=B.findVisiblePointClosestTo(H);if(null===L)return new l;for(var N,J=0,M=[L],K=L;(N=G(J,M,K,I),null!==N)&&(J+=new h(K,N.point).getLength(),M.push(N.point),K=N.point,!(1>new h(K,I).getLength())););return new l(M)},function E(){for(var H=z.toArray(),I=0;I<H.length;I++)C.set(H[I],[]);for(var J=0;J<H.length;J++)for(var L,K=J+1;K<H.length;K++)if(L=new h(H[J],H[K]),!D(L)){var M=C.get(H[J]);M.push(H[K]),C.set(H[J],M);var N=C.get(H[K]);N.push(H[J]),C.set(H[K],N)}}()},a.GRID_STYLE=w,a.Grid=q,a}({});