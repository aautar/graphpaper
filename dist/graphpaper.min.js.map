{"version":3,"file":"graphpaper.min.js","sources":["../src/MatrixMath.js","../src/Point.js","../src/LineIntersection.js","../src/Line.js","../src/SvgPathBuilder.js","../src/Dimensions.js","../src/Rectangle.js","../src/GroupTransformationContainerEvent.js","../src/EntityEvent.js","../src/PointSet.js","../src/AccessibleRoutingPointsFinder.js","../src/SheetEvent.js","../src/ConnectorAnchor.js","../src/ConnectorAnchorFinder/ClosestPairFinder.js","../src/DebugMetricsPanel/DebugMetricsPanel.js","../src/DoubleTapDetector.js","../src/LineSet.js","../src/ConnectorEvent.js","../src/ConnectorRoutingAlgorithm.js","../src/Connector.js","../src/PointVisibilityMapRouteOptimizer.js","../src/PointVisibilityMap.js","../src/Grid.js","../src/Workers/ConnectorRoutingWorker.string.js","../src/Sheet.js","../src/Entity.js","../src/GroupTransformationContainer.js","../src/Cluster.js","../src/BoxClusterDetector.js"],"sourcesContent":["const MatrixMath = {\r\n\r\n    mat4Multiply: function(_a, _b) {\r\n\r\n        const result = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\r\n        for(let i=0; i<4; i++) {\r\n            for(let j=0; j<4; j++) {\r\n\r\n                var sum = 0;\r\n                for(let k=0; k<4; k++) {\r\n                    sum += _a[k + 4*i] * _b[j + 4*k];\r\n                }\r\n\r\n                result[j + 4*i] = sum;\r\n            }\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    vecMat4Multiply: function(_v, _m) {\r\n        const result = [0, 0, 0, 0];\r\n        for(let vi=0; vi<4; vi++) {\r\n            result[vi] = \r\n                (_v[0] * _m[(vi*4) + 0]) + \r\n                (_v[1] * _m[(vi*4) + 1]) + \r\n                (_v[2] * _m[(vi*4) + 2]) + \r\n                (_v[3] * _m[(vi*4) + 3]);\r\n        }\r\n\r\n        return result;\r\n    }\r\n};\r\n\r\nexport { MatrixMath };\r\n","/**\r\n * \r\n * @param {Number} _x\r\n * @param {Number} _y\r\n */\r\nfunction Point(_x, _y) {\r\n    this.__x = _x;\r\n    this.__y = _y;\r\n};\r\n\r\n/**\r\n * @returns {Number}\r\n */     \r\nPoint.prototype.getX = function() {\r\n    return this.__x;\r\n};\r\n\r\n/**\r\n * @returns {Number}\r\n */     \r\nPoint.prototype.getY = function() {\r\n    return this.__y;\r\n};\r\n\r\n/**\r\n * @param {Point} _otherPoint\r\n * @returns {Boolean}\r\n */\r\nPoint.prototype.isEqual = function(_otherPoint) {\r\n    if(this.__x === _otherPoint.getX() && this.__y === _otherPoint.getY()) {\r\n        return true;\r\n    }\r\n\r\n    return false;\r\n};\r\n\r\n/**\r\n * @returns {Point}\r\n */\r\nPoint.prototype.getCartesianPoint = function(_sheetWidth, _sheetHeight) {\r\n    return new Point(\r\n        this.__x - (_sheetWidth * 0.5),\r\n        -this.__y + (_sheetHeight * 0.5)\r\n    );\r\n};\r\n\r\n/**\r\n * @returns {String}\r\n */\r\nPoint.prototype.toString = function() {\r\n    return this.__x + \" \" + this.__y;\r\n};\r\n\r\n/**\r\n * @returns {Number[]}\r\n */\r\nPoint.prototype.toArray = function() {\r\n    return [this.__x, this.__y];\r\n};\r\n\r\n/**\r\n * @param {Number[]} _arr\r\n * @returns {Point}\r\n */\r\nPoint.fromArray = function(_arr) {\r\n    return new Point(_arr[0], _arr[1]);\r\n};\r\n\r\nexport { Point };\r\n","import  {Point} from './Point';\r\n\r\nconst LINE_INTERSECTION_TYPE = Object.freeze({\r\n\tPARALLEL: \"parallel\",\t\t// no intersection, lines are parallel\r\n    COINCIDENT: \"coincident\",\t// no intersection, lines are coincident\r\n\tLINE: \"line\",\t\t\t\t// the lines intersect, but the intersection point is beyond the bounds of the line segments\r\n\tLINESEG: \"lineseg\",\t\t\t// the lines intersect, and the intersection point is within the bounds of the line segments\r\n});\r\n\r\n/**\r\n * \r\n * @param {LINE_INTERSECTION_TYPE} _type \r\n * @param {Point} _intersectionPoint \r\n */\r\nfunction LineIntersection(_type, _intersectionPoint) {\r\n\r\n    /**\r\n     * @returns {LINE_INTERSECTION_TYPE}\r\n     */\r\n    this.getType = function() {\r\n        return _type;\r\n    };\r\n\r\n    /**\r\n     * @returns {Point|null}\r\n     */\r\n    this.getIntersectionPoint = function() {\r\n        return _intersectionPoint;\r\n    };\r\n};\r\n\r\nexport {LINE_INTERSECTION_TYPE, LineIntersection};\r\n","import  {Point} from './Point';\r\nimport  {LINE_INTERSECTION_TYPE, LineIntersection} from './LineIntersection';\r\n\r\n/**\r\n * \r\n * @param {Point} _startPoint\r\n * @param {Point} _endPoint\r\n */\r\nfunction Line(_startPoint, _endPoint) {   \r\n\r\n    if(typeof _startPoint === 'undefined' || _startPoint === null) {\r\n        throw \"Line missing _startPoint\";\r\n    }\r\n\r\n    if(typeof _endPoint === 'undefined' || _endPoint === null) {\r\n        throw \"Line missing _endPoint\";\r\n    }\r\n\r\n    this.__startPoint = _startPoint;\r\n    this.__endPoint = _endPoint;\r\n};\r\n\r\n\r\n/**\r\n * @returns {Point}\r\n */       \r\nLine.prototype.getStartPoint = function() {\r\n    return this.__startPoint;\r\n};\r\n\r\n/**\r\n * @returns {Point}\r\n */       \r\nLine.prototype.getEndPoint = function() {\r\n    return this.__endPoint;\r\n};\r\n\r\n/**\r\n * @param {Line} _otherLine\r\n * @returns {Boolean}\r\n */\r\nLine.prototype.isEqual = function(_otherLine) {\r\n    if(this.getStartPoint().isEqual(_otherLine.getStartPoint()) && this.getEndPoint().isEqual(_otherLine.getEndPoint())) {\r\n        return true;\r\n    }\r\n\r\n    return false;\r\n};\r\n\r\n/**\r\n * @returns {Number}\r\n */\r\nLine.prototype.getLength = function() {\r\n    return Math.sqrt(\r\n        Math.pow(this.__endPoint.getX() - this.__startPoint.getX(), 2) + Math.pow(this.__endPoint.getY() - this.__startPoint.getY(), 2)\r\n    );\r\n};\r\n\r\n/**\r\n * Calculate unit length direction vector\r\n * \r\n * @returns {Point}\r\n */\r\nLine.prototype.getDirection = function() {\r\n    const dx = this.__endPoint.getX() - this.__startPoint.getX();\r\n    const dy = this.__endPoint.getY() - this.__startPoint.getY();\r\n\r\n    const len = Math.sqrt(dx*dx + dy*dy);\r\n\r\n    return new Point(       \r\n        dx / len,\r\n        dy / len\r\n    );    \r\n};\r\n\r\n/**\r\n * Create a Line shorted at the start and end by the specified amounts\r\n * \r\n * @returns {Line}\r\n */\r\nLine.prototype.createShortenedLine = function(startReduceByPx, endReduceByPx) {\r\n    const dx = this.__endPoint.getX() - this.__startPoint.getX();\r\n    const dy = this.__endPoint.getY() - this.__startPoint.getY();    \r\n    const dir = this.getDirection();\r\n\r\n    return new Line(\r\n        new Point(\r\n            this.__startPoint.getX() + (startReduceByPx * dir.getX()), \r\n            this.__startPoint.getY() + (startReduceByPx * dir.getY())\r\n        ),\r\n        new Point(\r\n            (this.__startPoint.getX() + dx) - (endReduceByPx * dir.getX()), \r\n            (this.__startPoint.getY() + dy) - (endReduceByPx * dir.getY())\r\n        )\r\n    );\r\n};\r\n\r\n/**\r\n * @param {Line} _otherLine\r\n * @returns {LINE_INTERSECTION_TYPE}\r\n */\r\nLine.prototype.computeIntersectionType = function(_otherLine) {\r\n    const thisLineStartPointX = this.__startPoint.getX();\r\n    const thisLineStartPointY = this.__startPoint.getY();\r\n    const thisLineEndPointX = this.__endPoint.getX();\r\n    const thisLineEndPointY = this.__endPoint.getY();        \r\n    const otherLineStartPointX = _otherLine.getStartPoint().getX();\r\n    const otherLineStartPointY = _otherLine.getStartPoint().getY();\r\n    const otherLineEndPointX = _otherLine.getEndPoint().getX();\r\n    const otherLineEndPointY = _otherLine.getEndPoint().getY();\r\n\r\n    const paramDenom = (otherLineEndPointY-otherLineStartPointY)*(thisLineEndPointX-thisLineStartPointX) - (otherLineEndPointX-otherLineStartPointX)*(thisLineEndPointY-thisLineStartPointY);\r\n    const paramANumer = (otherLineEndPointX-otherLineStartPointX)*(thisLineStartPointY-otherLineStartPointY) - (otherLineEndPointY - otherLineStartPointY)*(thisLineStartPointX-otherLineStartPointX);\r\n    const paramBNumer = (thisLineEndPointX-thisLineStartPointX)*(thisLineStartPointY-otherLineStartPointY) - (thisLineEndPointY-thisLineStartPointY)*(thisLineStartPointX-otherLineStartPointX);\r\n\r\n    if(paramDenom == 0) {\r\n        if(paramDenom == 0 && paramANumer == 0 && paramBNumer==0)\r\n            return LINE_INTERSECTION_TYPE.COINCIDENT;\r\n        else\r\n            return LINE_INTERSECTION_TYPE.PARALLEL;\r\n    }\r\n\r\n    const paramA = paramANumer / paramDenom;\r\n    const paramB = paramBNumer / paramDenom;\r\n    \r\n    if(paramA > 1.0 || paramA < 0.0 || paramB > 1.0 || paramB < 0.0) {\r\n        return LINE_INTERSECTION_TYPE.LINE;\r\n    } else {\r\n        return LINE_INTERSECTION_TYPE.LINESEG;\r\n    }\r\n};\r\n    \r\n/**\r\n * @param {Line} _otherLine\r\n * @returns {LINE_INTERSECTION_RESULT}\r\n */\r\nLine.prototype.computeIntersection = function(_otherLine) {\r\n\r\n    const thisLineStartPointX = this.__startPoint.getX();\r\n    const thisLineStartPointY = this.__startPoint.getY();\r\n    const thisLineEndPointX = this.__endPoint.getX();\r\n    const thisLineEndPointY = this.__endPoint.getY();        \r\n    const otherLineStartPointX = _otherLine.getStartPoint().getX();\r\n    const otherLineStartPointY = _otherLine.getStartPoint().getY();\r\n    const otherLineEndPointX = _otherLine.getEndPoint().getX();\r\n    const otherLineEndPointY = _otherLine.getEndPoint().getY();\r\n\r\n    const paramDenom = (otherLineEndPointY-otherLineStartPointY)*(thisLineEndPointX-thisLineStartPointX) - (otherLineEndPointX-otherLineStartPointX)*(thisLineEndPointY-thisLineStartPointY);\r\n    const paramANumer = (otherLineEndPointX-otherLineStartPointX)*(thisLineStartPointY-otherLineStartPointY) - (otherLineEndPointY - otherLineStartPointY)*(thisLineStartPointX-otherLineStartPointX);\r\n    const paramBNumer = (thisLineEndPointX-thisLineStartPointX)*(thisLineStartPointY-otherLineStartPointY) - (thisLineEndPointY-thisLineStartPointY)*(thisLineStartPointX-otherLineStartPointX);\r\n\r\n    if(paramDenom == 0) {\r\n        if(paramDenom == 0 && paramANumer == 0 && paramBNumer==0)\r\n            return new LineIntersection(LINE_INTERSECTION_TYPE.COINCIDENT, null);\r\n        else\r\n            return new LineIntersection(LINE_INTERSECTION_TYPE.PARALLEL, null);\r\n    }\r\n\r\n    const paramA = paramANumer / paramDenom;\r\n    const paramB = paramBNumer / paramDenom;\r\n\r\n    const xIntersect = this.__startPoint.getX() + paramA*(this.__endPoint.getX()-this.__startPoint.getX());\r\n    const yIntersect = this.__startPoint.getY() + paramA*(this.__endPoint.getY()-this.__startPoint.getY());\r\n    \r\n    if(paramA > 1.0 || paramA < 0.0 || paramB > 1.0 || paramB < 0.0) {\r\n        return new LineIntersection(LINE_INTERSECTION_TYPE.LINE, new Point(xIntersect, yIntersect));\r\n    } else {\r\n        return new LineIntersection(LINE_INTERSECTION_TYPE.LINESEG, new Point(xIntersect, yIntersect));\r\n    }\r\n};\r\n\r\nexport { Line };\r\n","import { Line } from \"./Line\";\r\n\r\nconst SvgPathBuilder = {\r\n\r\n    /**\r\n     * \r\n     * @param {Point} _pt \r\n     * @returns {String}\r\n     */\r\n    pointToLineTo: function(_pt, _ptIndex) {\r\n        if(_ptIndex === 0) {\r\n            return \"M\" + _pt.getX() + \" \" + _pt.getY();\r\n        }\r\n\r\n        return \"L\" + _pt.getX() + \" \" + _pt.getY();\r\n    },\r\n\r\n    /**\r\n     * \r\n     * @param {Point[]} _points \r\n     * @param {Number} _curvaturePx \r\n     * @returns {Point[]}\r\n     */\r\n    pointTripletToTesselatedCurvePoints(_points, _curvaturePx) {\r\n        if(_points.length !== 3) {\r\n            throw new Error(\"_points must be array of exactly 3 points\");\r\n        }\r\n\r\n        const controlPoint = _points[1];\r\n\r\n        const lineA = new Line(_points[0], _points[1]);\r\n        const lineB = new Line(_points[1], _points[2]);\r\n\r\n        const lineAShortened = lineA.createShortenedLine(0, _curvaturePx * 0.5);\r\n        const lineBShortened = lineB.createShortenedLine(_curvaturePx * 0.5, 0);\r\n\r\n        return [\r\n            lineAShortened.getStartPoint(),\r\n            lineAShortened.getEndPoint(),\r\n            lineBShortened.getStartPoint(),\r\n            lineBShortened.getEndPoint(),\r\n        ];\r\n    },\r\n\r\n    /**\r\n     * \r\n     * @param {Point[]} _points\r\n     * @param {Number} _curvaturePx\r\n     * @returns {String}\r\n     */\r\n    pointsToPath: function(_points, _curvaturePx) {\r\n        _curvaturePx = _curvaturePx || 0.0;\r\n\r\n        const svgPathParts = [];\r\n        let ptIdx = 0; // minify bug if this is put within the if(_curvaturePx... block\r\n\r\n        if(_curvaturePx > 0.0) {\r\n            while(_points.length >= 3) {\r\n                const ptA = _points.shift();\r\n                const ptB = _points.shift();\r\n                const ptC = _points.shift();\r\n\r\n                const newPts = SvgPathBuilder.pointTripletToTesselatedCurvePoints(\r\n                    [\r\n                        ptA,\r\n                        ptB,\r\n                        ptC,\r\n                    ],\r\n                    _curvaturePx\r\n                );                \r\n\r\n                _points.unshift(newPts[3]);\r\n                _points.unshift(newPts[2]);\r\n\r\n                for(let j=0; j<newPts.length-2; j++) {\r\n                    svgPathParts.push(SvgPathBuilder.pointToLineTo(newPts[j], ptIdx++));\r\n                }\r\n            }\r\n\r\n            while(_points.length > 0) {\r\n                const pt = _points.shift();\r\n                svgPathParts.push(SvgPathBuilder.pointToLineTo(pt, ptIdx++));\r\n            }\r\n\r\n        } else {\r\n            for(let i=0; i<_points.length; i++) {\r\n                const p = _points[i];\r\n                svgPathParts.push(SvgPathBuilder.pointToLineTo(p, i));\r\n            }\r\n        }\r\n\r\n        return svgPathParts.join(\" \");        \r\n    },\r\n\r\n};\r\n\r\nexport { SvgPathBuilder };\r\n","/**\r\n * \r\n * @param {Number} _width\r\n * @param {Number} _height\r\n */\r\nfunction Dimensions(_width, _height) {\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */       \r\n    this.getWidth = function() {\r\n        return _width;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */       \r\n    this.getHeight = function() {\r\n        return _height;\r\n    };\r\n};\r\n\r\nexport { Dimensions };\r\n","import {Point} from './Point';\r\nimport {Line} from './Line';\r\nimport  {LINE_INTERSECTION_TYPE, LineIntersection} from './LineIntersection';\r\n\r\n/**\r\n * \r\n * @param {Number} _left\r\n * @param {Number} _top\r\n * @param {Number} _right\r\n * @param {Number} _bottom\r\n */\r\nfunction Rectangle(_left, _top, _right, _bottom)  {\r\n    \r\n    const self=this;\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getLeft = function() {\r\n        return _left;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getTop = function() {\r\n        return _top;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getRight = function() {\r\n        return _right;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getBottom = function() {\r\n        return _bottom;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */    \r\n    this.getWidth = function() {\r\n        return _right - _left;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */    \r\n    this.getHeight = function() {\r\n        return _bottom - _top;\r\n    };\r\n\r\n    /**\r\n     * @returns {Point[]}\r\n     */\r\n    this.getPoints = function() {\r\n        return [\r\n            new Point(_left, _top),\r\n            new Point(_right, _top),\r\n            new Point(_right, _bottom),\r\n            new Point(_left, _bottom)\r\n        ];\r\n    };\r\n\r\n    /**\r\n     * @returns {Line[]}\r\n     */\r\n    this.getLines = function() {\r\n        return [\r\n            new Line(new Point(_left, _top), new Point(_right, _top)),\r\n            new Line(new Point(_right, _top), new Point(_right, _bottom)),\r\n            new Line(new Point(_right, _bottom), new Point(_left, _bottom)),\r\n            new Line(new Point(_left, _bottom), new Point(_left, _top))\r\n        ];\r\n    };\r\n\r\n    /**\r\n     * @param {Number} _resizeByPx\r\n     * @returns {Rectangle}\r\n     */\r\n    this.getUniformlyResizedCopy = function(_resizeByPx) {\r\n        return new Rectangle(\r\n            _left - _resizeByPx, \r\n            _top - _resizeByPx, \r\n            _right + _resizeByPx, \r\n            _bottom + _resizeByPx\r\n        );\r\n    };\r\n\r\n    /**\r\n     * Scale the bounding box by _gridSize, and return the points comprising the box\r\n     * \r\n     * @param {Number} _gridSize\r\n     * @returns {Point[]}\r\n     */\r\n    this.getPointsScaledToGrid = function(_gridSize) {\r\n\r\n        const centroid = new Point(\r\n            _left + ((_right-_left)*0.5),\r\n            _top + ((_bottom-_top)*0.5)\r\n        );\r\n\r\n        const scaleDx = ((_right - centroid.getX()) + _gridSize) / (_right - centroid.getX());\r\n        const scaleDy = ((_bottom - centroid.getY()) + _gridSize) / (_bottom - centroid.getY());        \r\n       \r\n        const scaledPoints = [\r\n            new Point(\r\n                ((_left - centroid.getX())*scaleDx) + centroid.getX(), \r\n                ((_top - centroid.getY())*scaleDy) + centroid.getY()\r\n            ),\r\n\r\n            new Point(\r\n                ((_right - centroid.getX())*scaleDx) + centroid.getX(), \r\n                ((_top - centroid.getY())*scaleDy) + centroid.getY()\r\n            ),\r\n\r\n            new Point(\r\n                ((_right - centroid.getX())*scaleDx) + centroid.getX(), \r\n                ((_bottom - centroid.getY())*scaleDy) + centroid.getY()\r\n            ),\r\n\r\n            new Point(\r\n                ((_left - centroid.getX())*scaleDx) + centroid.getX(), \r\n                ((_bottom - centroid.getY())*scaleDy) + centroid.getY()\r\n            )\r\n        ];\r\n\r\n        return scaledPoints;\r\n    };    \r\n\r\n    /**\r\n     * \r\n     * @param {Rectangle} _otherRectangle\r\n     * @returns {Boolean}\r\n     */\r\n    this.checkIntersect = function(_otherRectangle) {\r\n        if(_bottom < _otherRectangle.getTop()) {\r\n            return false;\r\n        }\r\n\r\n        if(_top > _otherRectangle.getBottom()) {\r\n            return false;\r\n        }\r\n\r\n        if(_right < _otherRectangle.getLeft()) {\r\n            return false;\r\n        }\r\n\r\n        if(_left > _otherRectangle.getRight()) {\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    };\r\n\r\n\r\n    /**\r\n     * \r\n     * @param {Point} _point \r\n     */\r\n    this.checkIsPointWithin = function(_point) {\r\n        if(_point.getX() >= _left && _point.getX() <= _right && _point.getY() >= _top && _point.getY() <= _bottom) {\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Rectangle} _otherRectangle\r\n     * @returns {Boolean}\r\n     */\r\n    this.checkIsWithin = function(_otherRectangle) {\r\n        if( _bottom <= _otherRectangle.getBottom() &&\r\n            _top >= _otherRectangle.getTop() &&\r\n            _right <= _otherRectangle.getRight() &&\r\n            _left >= _otherRectangle.getLeft()\r\n        ) {\r\n\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    };\r\n};\r\n\r\nexport { Rectangle }\r\n","const GroupTransformationContainerEvent = Object.freeze({\r\n    TRANSLATE_START: 'group-transformation-container-translate-start'\r\n});\r\n\r\nexport { GroupTransformationContainerEvent };\r\n","const EntityEvent = Object.freeze({\r\n    TRANSLATE_START: 'obj-translate-start',\r\n    TRANSLATE: 'obj-translate',\r\n    RESIZE_START: 'obj-resize-start',\r\n    RESIZE: 'obj-resize'\r\n});\r\n\r\n\r\nexport { EntityEvent };\r\n","import  {Point} from './Point';\r\nimport  {Line} from './Line';\r\n\r\n/**\r\n * Unique collection of Point objects\r\n * \r\n * @param {Point[]|Float64Array|undefined} _pointsInput\r\n */\r\nfunction PointSet(_pointsInput) {\r\n\r\n    const self = this;\r\n\r\n    /**\r\n     * @type {Point[]}\r\n     */\r\n    const points = [];\r\n\r\n    /**\r\n     * @param {Point} _newPoint\r\n     */\r\n    this.push = function(_newPoint) {\r\n        for(let i=0; i<points.length; i++) {\r\n            if(_newPoint.isEqual(points[i])) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        points.push(_newPoint);\r\n        return true;\r\n    };\r\n\r\n    /**\r\n     * @param {PointSet} _ps\r\n     */\r\n    this.pushPointSet = function(_ps) {\r\n        const possibleNewPoints = _ps.toArray();\r\n        for(let i=0; i<possibleNewPoints.length; i++) {\r\n            self.push(possibleNewPoints[i]);\r\n        }\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Point} _point \r\n     * @returns {Point}\r\n     */\r\n    this.findPointClosestTo = function(_point) {\r\n        var resultPoint = null;\r\n        var currentMinLength = Number.MAX_SAFE_INTEGER;\r\n\r\n        points.forEach(function(_pt) {\r\n            const lineToPt = new Line(_point, _pt);\r\n            if(lineToPt.getLength() < currentMinLength) {\r\n                resultPoint = _pt;\r\n                currentMinLength = lineToPt.getLength();\r\n            }\r\n        });\r\n        \r\n        return resultPoint;        \r\n    };\r\n\r\n    this.findDistanceToPointClosestTo = function(_point) {\r\n        var currentMinLength = Number.MAX_SAFE_INTEGER;\r\n\r\n        points.forEach(function(_pt) {\r\n            const lineToPt = new Line(_point, _pt);\r\n            if(lineToPt.getLength() < currentMinLength) {\r\n                currentMinLength = lineToPt.getLength();\r\n            }\r\n        });\r\n        \r\n        return currentMinLength;        \r\n    };    \r\n\r\n    /**\r\n     * \r\n     * @param {Point} _point \r\n     * @returns {PointSet}\r\n     */\r\n    this.findPointsCloseTo = function(_point, _radius) {\r\n        const resultSet = new PointSet();\r\n\r\n        points.forEach(function(_pt) {\r\n            const lineToPt = new Line(_point, _pt);\r\n            if(lineToPt.getLength() <= _radius) {\r\n                resultSet.push(_pt);\r\n            }\r\n        });\r\n        \r\n        return resultSet;        \r\n    };    \r\n\r\n    /**\r\n     * @returns {Point[]}\r\n     */\r\n    this.toArray = function() {\r\n        return points;\r\n    };\r\n\r\n    /**\r\n     * @returns {Float64Array}\r\n     */\r\n    this.toFloat64Array = function() {\r\n\r\n        const result = new Float64Array(points.length * 2);\r\n        for(let i=0; i<points.length; i++) {\r\n            result[0 + (i*2)] = points[i].getX();\r\n            result[1 + (i*2)] = points[i].getY();\r\n        }\r\n\r\n        return result;\r\n    };\r\n    \r\n    /**\r\n     * @param {Float64Array} _float64Array\r\n     */\r\n    const fromFloat64Array = function(_float64Array) {\r\n        points.length = 0;\r\n        for(let i=0; i<_float64Array.length; i+=2) {\r\n            points.push(\r\n                new Point(_float64Array[i], _float64Array[i+1])\r\n            );\r\n        }\r\n    };    \r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.count = function() {\r\n        return points.length;\r\n    };\r\n\r\n    if(_pointsInput && Array.isArray(_pointsInput)) {\r\n        _pointsInput.forEach(self.push);\r\n    } else if(_pointsInput && Object.prototype.toString.call(_pointsInput) === '[object Float64Array]') {\r\n        fromFloat64Array(_pointsInput);\r\n    } else { }    \r\n\r\n};\r\n\r\nexport { PointSet };\r\n","import { Entity } from \"./Entity\";\r\nimport { PointSet } from \"./PointSet\";\r\n\r\nconst AccessibleRoutingPointsFinder = {\r\n\r\n    /**\r\n     * Find routing points that are not occluded by objects\r\n     * \r\n     * @param {Entity[]} _subjectObjects\r\n     * @param {Entity[]} _occludableByObjects\r\n     * @param {Number} _gridSize\r\n     * @returns {Object}\r\n     */\r\n    find: function(_subjectEntities, _occludableByEntities, _gridSize) {\r\n        const connectorAnchorToNumValidRoutingPoints = new Map();\r\n        const allRoutingPoints = [];\r\n        const filteredRoutingPoints = new PointSet();\r\n\r\n        _subjectEntities.forEach((_entity) => {\r\n            const anchors = _entity.getConnectorAnchors();\r\n\r\n            anchors.forEach((_a) => {\r\n                let isAnchorOccluded = false;\r\n\r\n                // check if anchor is occluded\r\n                // @todo Commented out for now, need a decision on how to handle anchors where centroid is on the occluder bounding rect\r\n                /*for(let i=0; i<_occludableByObjects.length; i++) {\r\n                    const possibleOccluderBoundingRect = _occludableByObjects[i].getBoundingRectange();\r\n                    if(possibleOccluderBoundingRect.checkIsPointWithin(_a.getCentroid())) {\r\n                        connectorAnchorToNumValidRoutingPoints.set(_a.getId(), 0);\r\n                        isAnchorOccluded = true;\r\n                        break;\r\n                    }\r\n                }*/\r\n\r\n                if(!isAnchorOccluded) {\r\n                    const routingPoints = _a.getRoutingPoints(_gridSize);\r\n                    routingPoints.forEach((_rp) => {\r\n                        allRoutingPoints.push(\r\n                            {\r\n                                \"routingPoint\": _rp,\r\n                                \"parentAnchor\": _a,\r\n                                \"parentEntity\": _entity\r\n                            }\r\n                        );\r\n                    });\r\n\r\n                    connectorAnchorToNumValidRoutingPoints.set(_a.getId(), routingPoints.length);\r\n                }\r\n            });\r\n        });\r\n\r\n        allRoutingPoints.forEach((_rp) => {\r\n            let isPointWithinObj = false;\r\n\r\n            // check if routing point is occluded\r\n            for(let i=0; i<_occludableByEntities.length; i++) {\r\n                const occluder = _occludableByEntities[i];\r\n                const boundingRect = occluder.getBoundingRectange();\r\n                if(boundingRect.checkIsPointWithin(_rp.routingPoint)) {\r\n                    isPointWithinObj = true;\r\n                    const currentNumRoutingPoints = connectorAnchorToNumValidRoutingPoints.get(_rp.parentAnchor.getId()) || 0;\r\n                    connectorAnchorToNumValidRoutingPoints.set(_rp.parentAnchor.getId(), currentNumRoutingPoints - 1);\r\n                }\r\n            }\r\n\r\n            if(!isPointWithinObj) {\r\n                filteredRoutingPoints.push(_rp.routingPoint);\r\n            }\r\n            \r\n        });\r\n\r\n        return {\r\n            \"connectorAnchorToNumValidRoutingPoints\": connectorAnchorToNumValidRoutingPoints,\r\n            \"accessibleRoutingPoints\": filteredRoutingPoints,\r\n        };\r\n    }\r\n\r\n};\r\n\r\nexport { AccessibleRoutingPointsFinder };\r\n","const SheetEvent = Object.freeze({\r\n    DBLCLICK: \"dblclick\",\r\n    CLICK: \"click\",\r\n    CONNECTOR_UPDATED: \"connector-updated\",\r\n    ENTITY_ADDED: \"entity-added\",\r\n    ENTITY_REMOVED: \"entity-removed\",\r\n    ENTITY_RESIZED: \"entity-resized\",\r\n    ENTITY_TRANSLATED: \"entity-translated\",\r\n    MULTIPLE_ENTITY_SELECTION_STARTED: \"multiple-object-selection-started\",\r\n    MULTIPLE_ENTITIES_SELECTED: \"multiple-objects-selected\",\r\n});\r\n\r\n\r\nexport { SheetEvent };\r\n","import  {Point} from './Point';\r\nimport  {Rectangle} from './Rectangle';\r\n\r\n/**\r\n * @param {String} _id\r\n * @param {Element} _domElement\r\n * @param {Sheet} _sheet\r\n */\r\nfunction ConnectorAnchor(_id, _domElement, _sheet) {\r\n    \r\n    const self = this;\r\n\r\n    const getDimensions = function() {\r\n        const r = _sheet.transformDomRectToPageSpaceRect(_domElement.getBoundingClientRect());\r\n        return new Point(r.getWidth(), r.getHeight());\r\n    };\r\n\r\n    /**\r\n     * @returns {String}\r\n     */\r\n    this.getId = function() {\r\n        return _id;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */     \r\n    this.getX = function() {\r\n        return self.getCentroid().getX();\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */     \r\n    this.getY = function() {\r\n        return self.getCentroid().getY();\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getWidth = function() {\r\n        const r = _sheet.transformDomRectToPageSpaceRect(_domElement.getBoundingClientRect());\r\n        return r.getWidth();\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getHeight = function() {\r\n        const r = _sheet.transformDomRectToPageSpaceRect(_domElement.getBoundingClientRect());\r\n        return r.getHeight();\r\n    };\r\n\r\n    /**\r\n     * @returns {Point}\r\n     */\r\n    this.getCentroid = function() {\r\n        const sheetOffset = _sheet.getSheetOffset();\r\n        const pageSpaceRect = _sheet.transformDomRectToPageSpaceRect(_domElement.getBoundingClientRect());\r\n        const halfWidth = pageSpaceRect.getWidth() * 0.5;\r\n        const halfHeight = pageSpaceRect.getHeight() * 0.5;        \r\n        \r\n        return new Point(\r\n            (pageSpaceRect.getLeft() + halfWidth) - sheetOffset.getX(), \r\n            (pageSpaceRect.getTop() + halfHeight) - sheetOffset.getY()\r\n        );\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Number} _gridSize \r\n     * @returns {Point[]}\r\n     */\r\n    this.getRoutingPoints = function(_gridSize) {\r\n        const dimensions = getDimensions();\r\n        const centroid = self.getCentroid();\r\n        const halfWidth = dimensions.getX() * 0.5;\r\n        const halfHeight = dimensions.getY() * 0.5;\r\n\r\n        return [\r\n            new Point(centroid.getX() + halfWidth + _gridSize, centroid.getY()),\r\n            new Point(centroid.getX() - halfWidth - _gridSize, centroid.getY()),\r\n            new Point(centroid.getX(), centroid.getY() + halfHeight + _gridSize),\r\n            new Point(centroid.getX(), centroid.getY() - halfHeight - _gridSize),\r\n        ];\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @returns {Rectangle}\r\n     */\r\n    this.getBoundingRectange = function() {\r\n        const dimensions = getDimensions();\r\n        const centroid = self.getCentroid();\r\n        const halfWidth = dimensions.getX() * 0.5;\r\n        const halfHeight = dimensions.getY() * 0.5;\r\n\r\n        return new Rectangle(\r\n            centroid.getX() - halfWidth, \r\n            centroid.getY() - halfHeight, \r\n            centroid.getX() + halfWidth, \r\n            centroid.getY() + halfHeight\r\n        );\r\n    };\r\n};\r\n\r\nexport { ConnectorAnchor };\r\n","import { Entity } from \"../Entity\";\r\nimport { ConnectorAnchor } from \"../ConnectorAnchor\";\r\n\r\nconst ClosestPairFinder = {   \r\n    /**\r\n     * \r\n     * @param {Entity} _objA \r\n     * @param {Entity} _objB\r\n     * @param {Map<ConnectorAnchor, Number>} _connectorAnchorToNumValidRoutingPoints\r\n     * @returns {Object}\r\n     */\r\n    findClosestPairBetweenObjects: function(_objA, _objB, _connectorAnchorToNumValidRoutingPoints) {\r\n        const objAConnectorAnchors = _objA.getConnectorAnchors();\r\n        const objBConnectorAnchors = _objB.getConnectorAnchors();\r\n\r\n        var startAnchorIdxWithMinDist = 0;\r\n        var endAnchorIdxWithMinDist = 0;\r\n        var minDist = Number.MAX_VALUE;\r\n        \r\n        // Find best anchor element to connect _objA and _objB            \r\n        // Find anchors that produce shortest straight line distance\r\n        for(let x=0; x<objAConnectorAnchors.length; x++) {\r\n            const aCentroid = objAConnectorAnchors[x].getCentroid();\r\n            const objANumValidRoutingPoints = _connectorAnchorToNumValidRoutingPoints.get(objAConnectorAnchors[x].getId()) || 0;\r\n            if(objANumValidRoutingPoints === 0) {\r\n                continue;\r\n            }\r\n\r\n            for(let y=0; y<objBConnectorAnchors.length; y++) {\r\n                const bCentroid = objBConnectorAnchors[y].getCentroid();\r\n                const d = Math.sqrt(Math.pow(bCentroid.getX()-aCentroid.getX(),2) + Math.pow(bCentroid.getY()-aCentroid.getY(),2));\r\n                const objBNumValidRoutingPoints = _connectorAnchorToNumValidRoutingPoints.get(objBConnectorAnchors[y].getId()) || 0;\r\n                \r\n                if(d < minDist && objBNumValidRoutingPoints > 0) {\r\n                    startAnchorIdxWithMinDist = x;\r\n                    endAnchorIdxWithMinDist = y;\r\n                    minDist = d;\r\n                }\r\n            }\r\n        }\r\n\r\n        return {\r\n            \"objectAAnchorIndex\": startAnchorIdxWithMinDist,\r\n            \"objectAAnchor\": objAConnectorAnchors[startAnchorIdxWithMinDist],\r\n            \"objectBAnchorIndex\": endAnchorIdxWithMinDist,\r\n            \"objectBAnchor\": objBConnectorAnchors[endAnchorIdxWithMinDist],\r\n        };\r\n    }\r\n};\r\n\r\nexport { ClosestPairFinder };\r\n","const DebugMetricsPanel = function(_window) {\r\n    var debugPanelElem = null;\r\n    var isVisible = false;\r\n\r\n    this.init = function() {\r\n        debugPanelElem = _window.document.createElement(\"div\");\r\n        debugPanelElem.classList.add(\"graphpaper-debug-panel\");\r\n        debugPanelElem.style.display = \"none\";\r\n        debugPanelElem.style.position = \"fixed\";\r\n        debugPanelElem.style.right = \"0px\";\r\n        debugPanelElem.style.top = \"0px\";\r\n        debugPanelElem.style.width = \"450px\";\r\n        debugPanelElem.style.height = \"200px\";\r\n        debugPanelElem.style.color = \"#fff\";\r\n        debugPanelElem.style.padding = \"15px\";\r\n        debugPanelElem.style.backgroundColor = \"rgba(0,0,0,0.75)\";\r\n        _window.document.body.appendChild(debugPanelElem);\r\n    };\r\n\r\n    this.show = function() {\r\n        isVisible = true;\r\n        debugPanelElem.style.display = \"block\";\r\n    };\r\n\r\n    this.hide = function() {\r\n        isVisible = false;\r\n        debugPanelElem.style.display = \"none\";\r\n    };\r\n\r\n    this.refresh = function(_metrics) {\r\n        if(isVisible === false) {\r\n            return;\r\n        }\r\n\r\n        debugPanelElem.innerHTML = `\r\n            <p>refreshAllConnectorsInternal.executionTime = ${_metrics.refreshAllConnectorsInternal.executionTime}</p>\r\n            <p>-- refreshAllConnectorsInternal.accessibleRoutingPointsFinder = ${_metrics.refreshAllConnectorsInternal.accessibleRoutingPointsFinder}</p>\r\n            <p>connectorRoutingWorker.executionTime = ${_metrics.connectorRoutingWorker.executionTime}</p>            \r\n            <p>-- connectorRoutingWorker.msgDecodeTime = ${_metrics.connectorRoutingWorker.msgDecodeTime}</p>\r\n            <p>-- connectorRoutingWorker.pointVisibilityMapCreationTime = ${_metrics.connectorRoutingWorker.pointVisibilityMapCreationTime}</p>\r\n            <p>-- connectorRoutingWorker.allPathsComputationTime = ${_metrics.connectorRoutingWorker.allPathsComputationTime}</p>\r\n            <p>-- connectorRoutingWorker.numRoutingPoints = ${_metrics.connectorRoutingWorker.numRoutingPoints}</p>\r\n            <p>-- connectorRoutingWorker.numBoundaryLines = ${_metrics.connectorRoutingWorker.numBoundaryLines}</p>\r\n            <p>connectorsRefreshTime = ${_metrics.connectorsRefreshTime}</p>\r\n        `;\r\n    };\r\n\r\n};\r\n\r\nexport { DebugMetricsPanel };\r\n","import { MatrixMath } from './MatrixMath';\r\n\r\n/**\r\n * \r\n * @param {Number} _dblTapSpeed \r\n * @param {Number} _dblTapRadius \r\n */\r\nfunction DoubleTapDetector(_dblTapSpeed, _dblTapRadius)\r\n{\r\n    const dblTapDetectVars = {\r\n        lastTouchX: null,\r\n        lastTouchY: null,\r\n        lastTouchTime: null\r\n    };\r\n    \r\n    let dblTapSpeed = _dblTapSpeed || 300.0;\r\n    let dblTapRadius = _dblTapRadius || 24.0;\r\n\r\n    /**\r\n     * \r\n     * @param {TouchEvent} _touchEndEvent \r\n     * @param {Point} _sheetPageOffset \r\n     * @param {Array} currentInvTransformationMatrix\r\n     * @returns {Object}\r\n     */\r\n    this.processTap = function(_touchEndEvent, _sheetPageOffset, _currentInvTransformationMatrix) {\r\n        if(_touchEndEvent.changedTouches.length === 0) {\r\n            // we have nothing to work with\r\n            return {\r\n                \"doubleTapDetected\": false,\r\n                \"touchX\": null,\r\n                \"touchY\": null\r\n            };\r\n        }\r\n\r\n        // Position of the touch\r\n\r\n        // THIS NEEDS TO BE UPDATED TO ACCOUNT FOR OFFSET OF SHEET RELATIVE TO PAGE\r\n\r\n        const invTransformedPos = MatrixMath.vecMat4Multiply(\r\n            [_touchEndEvent.changedTouches[0].pageX - _sheetPageOffset.getX(), _touchEndEvent.changedTouches[0].pageY - _sheetPageOffset.getY(), 0, 1],\r\n            _currentInvTransformationMatrix\r\n        );            \r\n\r\n        let dblTapDetected = false;  // flag specifying if we detected a double-tap\r\n        const x = invTransformedPos[0];\r\n        const y = invTransformedPos[1];\r\n        const now = new Date().getTime();\r\n\r\n        // Check if we have stored data for a previous touch (indicating we should test for a double-tap)\r\n        if(dblTapDetectVars.lastTouchTime !== null) {\r\n            const lastTouchTime = dblTapDetectVars.lastTouchTime;\r\n\r\n            // Compute time since the previous touch\r\n            const timeSinceLastTouch = now - lastTouchTime;\r\n\r\n            // Get the position of the last touch on the element\r\n            const lastX = dblTapDetectVars.lastTouchX;\r\n            const lastY = dblTapDetectVars.lastTouchY;\r\n\r\n            // Compute the distance from the last touch on the element\r\n            const distFromLastTouch = Math.sqrt( Math.pow(x-lastX,2) + Math.pow(y-lastY,2) );\r\n\r\n            if(timeSinceLastTouch <= dblTapSpeed && distFromLastTouch <= dblTapRadius) {\r\n                // Remove last touch info from element\r\n                dblTapDetectVars.lastTouchTime = null;\r\n                dblTapDetectVars.lastTouchX = null;\r\n                dblTapDetectVars.lastTouchY = null;\r\n\r\n                // Flag that we detected a double tap\r\n                dblTapDetected = true;                \r\n            }\r\n        }\r\n\r\n        if(!dblTapDetected) {\r\n            dblTapDetectVars.lastTouchTime = now;\r\n            dblTapDetectVars.lastTouchX = x;\r\n            dblTapDetectVars.lastTouchY = y;\r\n        }\r\n\r\n        return {\r\n            \"doubleTapDetected\": dblTapDetected,\r\n            \"touchX\": x,\r\n            \"touchY\": y\r\n        }\r\n    };\r\n};\r\n\r\nexport { DoubleTapDetector };\r\n","import  {Point} from './Point';\r\nimport  {Line} from './Line';\r\n\r\n/**\r\n * Unique collection of Line objects\r\n * \r\n * @param {Line[]|Float64Array|undefined} _linesInput\r\n */\r\nfunction LineSet(_linesInput) {\r\n\r\n    const self = this;\r\n    \r\n    /**\r\n     * @type {Line[]}\r\n     */\r\n    const lines = [];    \r\n\r\n    /**\r\n     * @param {Line} _newLine\r\n     * @returns {Boolean}\r\n     */\r\n    this.push = function(_newLine) {\r\n        for(let i=0; i<lines.length; i++) {\r\n            if(_newLine.isEqual(lines[i])) {\r\n                // line already in set\r\n                return false;\r\n            }\r\n        }\r\n\r\n        lines.push(_newLine);\r\n        return true;\r\n    };\r\n  \r\n    /**\r\n     * @returns {Line[]}\r\n     */\r\n    this.toArray = function() {\r\n        return lines;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.count = function() {\r\n        return lines.length;\r\n    };\r\n\r\n    /**\r\n     * @returns {Float64Array}\r\n     */\r\n    this.toFloat64Array = function() {\r\n        const result = new Float64Array(lines.length * 4);\r\n        for(let i=0; i<lines.length; i++) {\r\n            result[0 + (i*4)] = lines[i].getStartPoint().getX();\r\n            result[1 + (i*4)] = lines[i].getStartPoint().getY();\r\n            result[2 + (i*4)] = lines[i].getEndPoint().getX();\r\n            result[3 + (i*4)] = lines[i].getEndPoint().getY();\r\n        }\r\n\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * @param {Float64Array} _float64Array\r\n     */\r\n    const fromFloat64Array = function(_float64Array) {\r\n        lines.length = 0;\r\n        for(let i=0; i<_float64Array.length; i+=4) {\r\n            lines.push(\r\n                new Line(\r\n                    new Point(_float64Array[i], _float64Array[i+1]),\r\n                    new Point(_float64Array[i+2], _float64Array[i+3])\r\n                )\r\n            );\r\n        }\r\n    };\r\n\r\n    if(_linesInput && Array.isArray(_linesInput)) {\r\n        _linesInput.forEach(self.push);\r\n    } else if(_linesInput && Object.prototype.toString.call(_linesInput) === '[object Float64Array]') {\r\n        fromFloat64Array(_linesInput);\r\n    } else { }    \r\n};\r\n\r\nexport { LineSet };\r\n","const ConnectorEvent = Object.freeze({\r\n    CLICK: 'connector-click',\r\n    MOUSE_ENTER: 'connector-mouse-enter',\r\n    MOUSE_LEAVE: 'connector-mouse-leave'\r\n});\r\n\r\nexport { ConnectorEvent };\r\n","const ConnectorRoutingAlgorithm = Object.freeze({\r\n    STRAIGHT_LINE: 0,\r\n    STRAIGHT_LINE_BETWEEN_ANCHORS: 1,\r\n    STRAIGHT_LINE_BETWEEN_ANCHORS_AVOID_SELF_INTERSECTION: 2, // unsupported\r\n    ASTAR: 3,\r\n    ASTAR_WITH_ROUTE_OPTIMIZATION: 4\r\n});\r\n\r\nexport { ConnectorRoutingAlgorithm };\r\n","import {ConnectorAnchor} from './ConnectorAnchor';\r\nimport {ConnectorEvent} from './ConnectorEvent';\r\nimport {ConnectorRoutingAlgorithm} from './ConnectorRoutingAlgorithm';\r\nimport {Line} from './Line';\r\nimport {Point} from './Point';\r\n\r\n/**\r\n * \r\n * @param {ConnectorAnchor} _anchorStart \r\n * @param {ConnectorAnchor} _anchorEnd\r\n * @param {Element} _containerDomElement\r\n * @param {String} _strokeColor\r\n * @param {String} _strokeWidth\r\n * @param {Number} _curvaturePx\r\n * @param {ConnectorRoutingAlgorithm} _routingAlgorithm\r\n */\r\nfunction Connector(_anchorStart, _anchorEnd, _containerDomElement, _strokeColor, _strokeWidth, _curvaturePx, _routingAlgorithm) {\r\n    const self = this;\r\n\r\n    const eventNameToHandlerFunc = new Map();\r\n    let markerStartSize = 0;\r\n    let markerEndSize = 0;\r\n\r\n    if(typeof _strokeColor === 'undefined') {\r\n        _strokeColor = '#000';\r\n    }\r\n\r\n    if(typeof _strokeWidth === 'undefined') {\r\n        _strokeWidth = '2px';\r\n    }\r\n\r\n    if(typeof _curvaturePx === 'undefined') {\r\n        _curvaturePx = 0;\r\n    }\r\n\r\n    if(typeof _routingAlgorithm === 'undefined') {\r\n        _routingAlgorithm = ConnectorRoutingAlgorithm.ASTAR_WITH_ROUTE_OPTIMIZATION;\r\n    }\r\n\r\n    /**\r\n     * @type {Point[]|null}\r\n     */\r\n    let pathPoints = null;\r\n\r\n    /**\r\n     * @type {Element}\r\n     */\r\n    const pathElem = window.document.createElementNS(\"http://www.w3.org/2000/svg\", 'path');\r\n    pathElem.setAttribute(\"d\", 'M0 0 L0 0');\r\n    pathElem.style.stroke = _strokeColor; \r\n    pathElem.style.strokeWidth = _strokeWidth;         \r\n\r\n    pathElem.addEventListener(\"click\", function(e) {\r\n        self.dispatchEvent(ConnectorEvent.CLICK, {\"connector\":self, \"clickedAtX\": e.pageX, \"clickedAtY\": e.pageY});\r\n    });\r\n\r\n    pathElem.addEventListener(\"mouseenter\", function(e) {\r\n        self.dispatchEvent(ConnectorEvent.MOUSE_ENTER, {\"connector\":self, \"pointerAtX\": e.pageX, \"pointerAtY\": e.pageY});\r\n    });\r\n\r\n    pathElem.addEventListener(\"mouseleave\", function(e) {\r\n        self.dispatchEvent(ConnectorEvent.MOUSE_LEAVE, {\"connector\":self });\r\n    });        \r\n\r\n    /**\r\n     * @type {Element}\r\n     */\r\n    var svgDomElem = null;\r\n\r\n    this.appendPathToContainerDomElement = function() {\r\n        svgDomElem = _containerDomElement.appendChild(pathElem);\r\n    };\r\n\r\n    /**\r\n     * @param {String} _url\r\n     * @param {Number} _size\r\n     */    \r\n    this.setMarkerStart = function(_url, _size) {\r\n        pathElem.setAttribute(`marker-start`, `url(${_url})`);\r\n        markerStartSize = _size;\r\n    };\r\n\r\n    this.unsetMarkerStart = function() {\r\n        pathElem.removeAttribute(`marker-start`);\r\n        markerStartSize = 0;\r\n    };\r\n\r\n    /**\r\n     * @param {String} _url\r\n     * @param {Number} _size\r\n     */\r\n    this.setMarkerEnd = function(_url, _size) {\r\n        pathElem.setAttribute(`marker-end`, `url(${_url})`);\r\n        markerEndSize = _size;\r\n    };\r\n\r\n    this.unsetMarkerEnd = function() {\r\n        pathElem.removeAttribute(`marker-end`);\r\n        markerEndSize = 0;\r\n    };    \r\n\r\n    /**\r\n     * @returns {Point[]|null}\r\n     */\r\n    this.getPathPoints = function() {\r\n        return pathPoints;\r\n    };\r\n\r\n    /**\r\n     * @returns {Line[]}\r\n     */\r\n    this.getPathLines = function() {\r\n        if(pathPoints === null || pathPoints.length < 2) {\r\n            return [];\r\n        }\r\n\r\n        const lines = [];\r\n        for(let i=0; i<pathPoints.length-1; i++) {\r\n            lines.push(new Line(pathPoints[i], pathPoints[i+1]));\r\n        }\r\n\r\n        return lines;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getLength = function() {\r\n        let totalLength = 0;\r\n\r\n        const pathLines = self.getPathLines();\r\n        for(let i=0; i<pathLines.length; i++) {\r\n            totalLength += pathLines[i].getLength();\r\n        }\r\n        \r\n        return totalLength;\r\n    };\r\n\r\n    /**\r\n     * @returns {Point}\r\n     */\r\n    this.getMidpoint = function() {\r\n        const totalLength = self.getLength();\r\n        const pathLines = self.getPathLines();\r\n\r\n        let lengthSoFar = 0;\r\n        let curPathLineWithMidpoint = null;\r\n\r\n        for(let i=0; i<pathLines.length; i++) {\r\n            curPathLineWithMidpoint = pathLines[i];\r\n            const pathLineLength = pathLines[i].getLength();\r\n            lengthSoFar += pathLineLength;\r\n\r\n            if(lengthSoFar >= totalLength/2.0) {\r\n                break;\r\n            }\r\n        }\r\n\r\n        const lengthBeforeCur = (lengthSoFar - curPathLineWithMidpoint.getLength());\r\n        const midOnCurPath = (totalLength / 2.0) - lengthBeforeCur; // i.e. distance to midpoint\r\n\r\n        const p = midOnCurPath / curPathLineWithMidpoint.getLength();\r\n\r\n        return new Point(\r\n            curPathLineWithMidpoint.getStartPoint().getX() + (p * (curPathLineWithMidpoint.getEndPoint().getX() - curPathLineWithMidpoint.getStartPoint().getX())),\r\n            curPathLineWithMidpoint.getStartPoint().getY() + (p * (curPathLineWithMidpoint.getEndPoint().getY() - curPathLineWithMidpoint.getStartPoint().getY()))\r\n        );\r\n    };\r\n\r\n    /**\r\n     * @returns {Point}\r\n     */\r\n    this.getMidpointDirection = function() {\r\n        const totalLength = self.getLength();\r\n        const pathLines = self.getPathLines();\r\n\r\n        let lengthSoFar = 0;\r\n        let curPathLineWithMidpoint = null;\r\n\r\n        for(let i=0; i<pathLines.length; i++) {\r\n            curPathLineWithMidpoint = pathLines[i];\r\n            const pathLineLength = pathLines[i].getLength();\r\n            lengthSoFar += pathLineLength;\r\n\r\n            if(lengthSoFar >= totalLength/2.0) {\r\n                break;\r\n            }\r\n        }\r\n\r\n        if(curPathLineWithMidpoint === null) {\r\n            return pathLines[0].getDirection();\r\n        }\r\n\r\n        return curPathLineWithMidpoint.getDirection();\r\n    };\r\n\r\n\r\n    /**\r\n     * @param {String} _svgPath\r\n     * @param {Point[]} _pathPoints\r\n     */\r\n    this.refresh = function(_svgPath, _pathPoints) {\r\n        pathPoints = _pathPoints;\r\n        pathElem.setAttribute(\"d\", _svgPath);\r\n    };\r\n\r\n    /**\r\n     * @returns {String}\r\n     */\r\n    this.getId = function() {\r\n        const anchorIds = [_anchorStart.getId(), _anchorEnd.getId()].sort();\r\n        return anchorIds.join(':');\r\n    };\r\n\r\n    /**\r\n     * @returns {ConnectorAnchor}\r\n     */\r\n    this.getAnchorStart = function() {\r\n        return _anchorStart;\r\n    };\r\n\r\n    /**\r\n     * @returns {ConnectorAnchor}\r\n     */    \r\n    this.getAnchorEnd = function() {\r\n        return _anchorEnd;\r\n    };\r\n\r\n    this.removePathElement = function() {\r\n        pathElem.remove();\r\n    };\r\n\r\n    /**\r\n     * @param {String} _cl\r\n     * @returns {undefined}\r\n     */\r\n    this.addClassToDomElement = function(_cl) {\r\n        pathElem.classList.add(_cl);\r\n    };\r\n\r\n    /**\r\n     * @param {String} _cl\r\n     * @returns {undefined}\r\n     */    \r\n    this.removeClassFromDomElement = function(_cl) {\r\n        pathElem.classList.remove(_cl);\r\n    };\r\n\r\n    /**\r\n     * @returns {Object}\r\n     */\r\n    this.getDescriptor = function() {\r\n        return {\r\n            \"id\": self.getId(),\r\n            \"anchor_start_centroid_arr\": _anchorStart.getCentroid().toArray(),\r\n            \"anchor_end_centroid_arr\": _anchorEnd.getCentroid().toArray(),\r\n            \"marker_start_size\": markerStartSize,\r\n            \"marker_end_size\": markerEndSize,\r\n            \"curvature_px\": _curvaturePx,\r\n            \"routing_algorithm\": _routingAlgorithm\r\n        };\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {String} _eventName \r\n     * @param {*} _handlerFunc \r\n     */\r\n    this.on = function(_eventName, _handlerFunc) {\r\n        const allHandlers = eventNameToHandlerFunc.get(_eventName) || [];\r\n        allHandlers.push(_handlerFunc);\r\n        eventNameToHandlerFunc.set(_eventName, allHandlers);        \r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {String} _eventName \r\n     * @param {*} _callback \r\n     */\r\n    this.off = function(_eventName, _callback) {\r\n        const allCallbacks = eventNameToHandlerFunc.get(_eventName) || [];\r\n\r\n        for(let i=0; i<allCallbacks.length; i++) {\r\n            if(allCallbacks[i] === _callback) {\r\n                allCallbacks.splice(i, 1);\r\n                break;\r\n            }\r\n        }\r\n\r\n        eventNameToHandlerFunc.set(_eventName, allCallbacks);\r\n    };\r\n\r\n    /**\r\n     * @param {String} _eventId\r\n     * @param {Object} _eventData\r\n     */\r\n    this.dispatchEvent = function(_eventId, _eventData) {\r\n        const observers = eventNameToHandlerFunc.get(_eventId) || [];\r\n        observers.forEach(function(handler) {\r\n            handler(_eventData);\r\n        });\r\n    };\r\n};\r\n\r\nexport { Connector };\r\n","import {Point} from './Point';\r\n\r\nconst PointVisibilityMapRouteOptimizer = {\r\n\r\n    /**\r\n     * \r\n     * @param {Point[]} _pointsInRoute\r\n     * @param {Function} _arePointsVisibleToEachOther\r\n     */\r\n    optimize: function(_pointsInRoute, _arePointsVisibleToEachOther) {\r\n        let start = 0;\r\n        let end = _pointsInRoute.length - 1;\r\n\r\n        while(true) {\r\n            if((end-start) <= 1) {\r\n                start++;\r\n                end = _pointsInRoute.length - 1;\r\n\r\n                if(start >= _pointsInRoute.length-2) {\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if(_arePointsVisibleToEachOther(_pointsInRoute[start], _pointsInRoute[end])) {\r\n                _pointsInRoute.splice(start + 1, (end-start) - 1);\r\n                end = _pointsInRoute.length - 1;\r\n            } else {\r\n                end--;\r\n            }\r\n        }\r\n    }\r\n\r\n};\r\n\r\nexport { PointVisibilityMapRouteOptimizer }\r\n","import {Point} from './Point';\r\nimport {Line} from './Line';\r\nimport {PointSet} from './PointSet';\r\nimport {PointVisibilityMapRouteOptimizer} from './PointVisibilityMapRouteOptimizer';\r\nimport {LineSet} from './LineSet';\r\nimport  {LINE_INTERSECTION_TYPE, LineIntersection} from './LineIntersection';\r\n\r\n/**\r\n * \r\n * @param {PointSet} _freePoints\r\n * @param {LineSet} _boundaryLines\r\n * @param {Array|undefined} _precomputedPointToVisibleSet\r\n */\r\nfunction PointVisibilityMap(_freePoints, _boundaryLines, _precomputedPointToVisibleSet) {\r\n    const self = this;\r\n\r\n    const boundaryLinesArr = _boundaryLines.toArray();\r\n    const freePointsArr = _freePoints.toArray();\r\n    let pointToVisibleSet = null;\r\n\r\n    /**\r\n     * @param {Line} _theLine\r\n     * @returns {Boolean}\r\n     */\r\n    const doesLineIntersectAnyBoundaryLines = function(_theLine) {\r\n        for(let b=0; b<boundaryLinesArr.length; b++) {\r\n            const intersectionType = boundaryLinesArr[b].computeIntersectionType(_theLine);\r\n            if(intersectionType === LINE_INTERSECTION_TYPE.LINESEG) {\r\n                return true;\r\n            }\r\n        };\r\n\r\n        return false;\r\n    };\r\n\r\n    const initPointsVisibility = function() {\r\n        for(let i=0; i<freePointsArr.length; i++) {\r\n            pointToVisibleSet[i] = null;   \r\n        }\r\n\r\n        // We can do the following to compute the entire PV map on init\r\n        /*\r\n        for(let i=0; i<freePointsArr.length; i++) {            \r\n            for(let j=i+1; j<freePointsArr.length; j++) {\r\n\r\n                // line representing line-of-sight between the 2 points\r\n                const ijLine = new Line(freePointsArr[i], freePointsArr[j]);\r\n\r\n                if(!doesLineIntersectAnyBoundaryLines(ijLine)) {\r\n                    // record indices into freePointsArr\r\n                    pointToVisibleSet[i].push(j);\r\n                    pointToVisibleSet[j].push(i);\r\n                }\r\n            }\r\n        }\r\n        */\r\n    };\r\n\r\n    const computePointsVisibilityForIndex = function(_idx) {\r\n        pointToVisibleSet[_idx] = [];\r\n        for(let j=0; j<freePointsArr.length; j++) {\r\n            if(_idx === j) {\r\n                continue;\r\n            }\r\n\r\n            // line representing line-of-sight between the 2 points\r\n            const ijLine = new Line(freePointsArr[_idx], freePointsArr[j]);\r\n\r\n            if(!doesLineIntersectAnyBoundaryLines(ijLine)) {\r\n                // record indices into freePointsArr\r\n                pointToVisibleSet[_idx].push(j);\r\n            }\r\n        }\r\n\r\n        return pointToVisibleSet[_idx];\r\n    };\r\n\r\n    const arePointsVisibleToEachOther = function(_ptA, _ptB) {\r\n        for(let i=0; i<freePointsArr.length; i++) {\r\n            if(freePointsArr[i].isEqual(_ptA)) {\r\n                let visiblePointIndices = pointToVisibleSet[i];\r\n                if(visiblePointIndices === null) {\r\n                    visiblePointIndices = computePointsVisibilityForIndex(i);\r\n                }\r\n\r\n                for(let j=0; j<visiblePointIndices.length; j++) {\r\n                    if(freePointsArr[visiblePointIndices[j]].isEqual(_ptB)) {\r\n                        return true;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return false;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Number} _currentPointIndex\r\n     * @returns {Point[]}\r\n     */\r\n    const getVisiblePointsRelativeTo = function(_pointIndex) {\r\n        if(pointToVisibleSet[_pointIndex] === null) {\r\n            computePointsVisibilityForIndex(_pointIndex);\r\n        }\r\n        \r\n        return pointToVisibleSet[_pointIndex];\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Point} _needle \r\n     * @param {Point[]} _haystack \r\n     */\r\n    const isPointInArray = function(_needle, _haystack) {\r\n        for(let i=0; i<_haystack.length; i++) {\r\n            if(_needle.isEqual(_haystack[i])) {\r\n                return true;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Number} _currentRouteLength \r\n     * @param {Point[]} _pointsInRoute \r\n     * @param {Number} _currentPointIndex \r\n     * @param {Point} _endPoint \r\n     * @returns {Object|null}\r\n     */\r\n    const routeToEndpoint = function(_currentRouteLength, _pointsInRoute, _currentPointIndex, _endPoint) {\r\n        const currentPoint = freePointsArr[_currentPointIndex];\r\n        const visiblePointIndices = getVisiblePointsRelativeTo(_currentPointIndex);\r\n        var curMinCost = Number.MAX_SAFE_INTEGER;\r\n        var visiblePointWithMinCost = null;\r\n        var visiblePointWithMinCostIndex = null;\r\n\r\n        for(let i=0; i<visiblePointIndices.length; i++) {\r\n            const visiblePt = freePointsArr[visiblePointIndices[i]];\r\n\r\n            // ignore point if it's already in the route\r\n            if(isPointInArray(visiblePt, _pointsInRoute)) {\r\n                continue;\r\n            }\r\n\r\n            // g(n) = length/cost of _startPoint to _vp + _currentRouteLength\r\n            const gn = (new Line(currentPoint, visiblePt)).getLength() + _currentRouteLength;\r\n\r\n            // h(n) = length/cost of _vp to _endPoint\r\n            const hn = (new Line(visiblePt, _endPoint)).getLength();\r\n\r\n            // see if this is the new min\r\n            if((gn + hn) < curMinCost) {\r\n                curMinCost = gn + hn;\r\n                visiblePointWithMinCost = visiblePt;\r\n                visiblePointWithMinCostIndex = visiblePointIndices[i];\r\n            }\r\n        }\r\n\r\n        if(curMinCost === Number.MAX_SAFE_INTEGER) {\r\n            return null;\r\n        }\r\n\r\n        return {\r\n            \"cost\": curMinCost,\r\n            \"point\": visiblePointWithMinCost,\r\n            \"pointIndex\": visiblePointWithMinCostIndex\r\n        };\r\n    };\r\n\r\n    /**\r\n     * @returns {Array}\r\n     */\r\n    this.getPointToVisibleSetData = function() {\r\n        return pointToVisibleSet;\r\n    };\r\n\r\n    /**\r\n     * @param {Point} _point\r\n     * @returns {Point|null}\r\n     */\r\n    this.findPointClosestTo = function(_point) {\r\n        var resultPoint = null;\r\n        var currentMaxLength = Number.MAX_SAFE_INTEGER;\r\n\r\n        freePointsArr.forEach(function(_ptKey) {\r\n            const lineOfSight = new Line(_point, _ptKey);\r\n            if(lineOfSight.getLength() < currentMaxLength) {\r\n                resultPoint = _ptKey;\r\n                currentMaxLength = lineOfSight.getLength();\r\n            }\r\n        });\r\n        \r\n        return resultPoint;\r\n    };\r\n\r\n    /**\r\n     * @param {Point} _point\r\n     * @returns {Point|null}\r\n     */\r\n    this.findVisiblePointClosestTo = function(_point) {\r\n        var resultPoint = null;\r\n        var currentMaxLength = Number.MAX_SAFE_INTEGER;\r\n\r\n        freePointsArr.forEach(function(_freePt) {\r\n\r\n            const lineOfSight = new Line(_point, _freePt);\r\n            const lineOfSightLength = lineOfSight.getLength();\r\n\r\n            if(lineOfSightLength < currentMaxLength && !doesLineIntersectAnyBoundaryLines(lineOfSight)) {\r\n                resultPoint = _freePt;\r\n                currentMaxLength = lineOfSightLength;\r\n            };\r\n\r\n        });\r\n        \r\n        return resultPoint;\r\n    };\r\n\r\n    /**\r\n     * @param {Point} _point\r\n     * @returns {Point|null}\r\n     */\r\n    this.findVisiblePointIndexClosestTo = function(_point) {\r\n        var resultPointIndex = null;\r\n        var currentMaxLength = Number.MAX_SAFE_INTEGER;\r\n\r\n        for(let i=0; i<freePointsArr.length; i++) {\r\n            const freePt = freePointsArr[i];\r\n\r\n            const lineOfSight = new Line(_point, freePt);\r\n            const lineOfSightLength = lineOfSight.getLength();\r\n\r\n            if(lineOfSightLength < currentMaxLength && !doesLineIntersectAnyBoundaryLines(lineOfSight)) {\r\n                resultPointIndex = i;\r\n                currentMaxLength = lineOfSightLength;\r\n            };\r\n\r\n        }\r\n        \r\n        return resultPointIndex;\r\n    };    \r\n\r\n    /**\r\n     * @param {Point} _startPoint\r\n     * @param {Point} _endPoint\r\n     * @param {Boolean} _optimizeRoute\r\n     * \r\n     * @return {PointSet}\r\n     */\r\n    this.computeRoute = function(_startPoint, _endPoint, _optimizeRoute) {\r\n        // if no valid startpoint or endpoint, we can't route\r\n        if(_startPoint === null || _endPoint === null) {\r\n            return new PointSet();\r\n        }\r\n\r\n        // find closest visible point \r\n        const firstRoutingPointIndex = self.findVisiblePointIndexClosestTo(_startPoint);\r\n        if(firstRoutingPointIndex === null) {\r\n            return new PointSet();\r\n        }\r\n\r\n        var currentRouteLen = 0;\r\n        const firstRoutingPoint = freePointsArr[firstRoutingPointIndex];\r\n        const pointsInRoute = [firstRoutingPoint];\r\n        var currentPointIndex = firstRoutingPointIndex;\r\n        while(true) {\r\n            const routeSegment = routeToEndpoint(currentRouteLen, pointsInRoute, currentPointIndex, _endPoint);\r\n            if(routeSegment === null) {\r\n                // Is there unobstructed line to endpoint? \r\n                // If not, failed to find route\r\n                const lastSegmentToEndpoint = new Line(pointsInRoute[pointsInRoute.length-1], _endPoint);\r\n                if(doesLineIntersectAnyBoundaryLines(lastSegmentToEndpoint)) {\r\n                    return new PointSet();\r\n                }\r\n\r\n                break;\r\n            }\r\n\r\n            // update cur path length\r\n            currentRouteLen += (new Line(freePointsArr[currentPointIndex], routeSegment.point)).getLength();\r\n\r\n            // add new point to path\r\n            pointsInRoute.push(routeSegment.point);\r\n\r\n            // update current point index\r\n            currentPointIndex = routeSegment.pointIndex;\r\n\r\n            // check if we're done\r\n            if((new Line(freePointsArr[currentPointIndex], _endPoint).getLength()) < 1.0) {\r\n                break;\r\n            }\r\n        }\r\n\r\n        if(_optimizeRoute) {\r\n            PointVisibilityMapRouteOptimizer.optimize(pointsInRoute, arePointsVisibleToEachOther);\r\n        }\r\n\r\n        return new PointSet(pointsInRoute);\r\n    };\r\n\r\n    if(_precomputedPointToVisibleSet) {\r\n        pointToVisibleSet = _precomputedPointToVisibleSet;\r\n    } else {\r\n        pointToVisibleSet = new Array(_freePoints.count()); // index represents entry in freePointsArr\r\n        initPointsVisibility();        \r\n    }\r\n};\r\n   \r\nexport { PointVisibilityMap };\r\n","const GRID_STYLE = {\r\n    LINE: 'line',\r\n    DOT: 'dot'\r\n};\r\n\r\n/**\r\n * \r\n * @param {Number} _size\r\n * @param {String} _color\r\n * @param {String} _style\r\n */\r\nfunction Grid(_size, _color, _style) {\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getSize = function() {\r\n        return _size;\r\n    };\r\n\r\n    /**\r\n     * @returns {String}\r\n     */\r\n    this.getStyle = function() {\r\n        return _style;\r\n    };\r\n\r\n    /**\r\n     * @returns {String}\r\n     */\r\n    this.getSvgImageTile = function() {\r\n        if(_style === GRID_STYLE.LINE) {\r\n            return '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"' + _size + '\" height=\"' + _size + '\"><rect width=\"' + _size + '\" height=\"1\" x=\"0\" y=\"' + (_size-1.0) + '\" style=\"fill:' + _color + '\" /><rect width=\"1\" height=\"' + _size + '\" x=\"' + (_size-1.0) + '\" y=\"0\" style=\"fill:' + _color + '\" /></svg>';\r\n        } else {\r\n            return '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"' + _size + '\" height=\"' + _size + '\"><rect width=\"1\" height=\"1\" x=\"' + (_size-1.0) + '\" y=\"' + (_size-1.0) + '\" style=\"fill:' + _color + '\" /></svg>';\r\n        }\r\n    };\r\n\r\n};\r\n    \r\nexport { GRID_STYLE, Grid };\r\n","const ConnectorRoutingWorkerJsString = `(function () {\n  'use strict';\n\n  function _toConsumableArray(arr) {\n    return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();\n  }\n\n  function _arrayWithoutHoles(arr) {\n    if (Array.isArray(arr)) {\n      for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) arr2[i] = arr[i];\n\n      return arr2;\n    }\n  }\n\n  function _iterableToArray(iter) {\n    if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter);\n  }\n\n  function _nonIterableSpread() {\n    throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n  }\n\n  function Point(a,b){this.__x=a,this.__y=b;}Point.prototype.getX=function(){return this.__x},Point.prototype.getY=function(){return this.__y},Point.prototype.isEqual=function(a){return !(this.__x!==a.getX()||this.__y!==a.getY())},Point.prototype.getCartesianPoint=function(a,b){return new Point(this.__x-.5*a,-this.__y+.5*b)},Point.prototype.toString=function(){return this.__x+\" \"+this.__y},Point.prototype.toArray=function(){return [this.__x,this.__y]},Point.fromArray=function(a){return new Point(a[0],a[1])};\n\n  var LINE_INTERSECTION_TYPE=Object.freeze({PARALLEL:\"parallel\",COINCIDENT:\"coincident\",LINE:\"line\",LINESEG:\"lineseg\"});function LineIntersection(a,b){this.getType=function(){return a},this.getIntersectionPoint=function(){return b};}\n\n  function Line(a,b){if(\"undefined\"==typeof a||null===a)throw \"Line missing _startPoint\";if(\"undefined\"==typeof b||null===b)throw \"Line missing _endPoint\";this.__startPoint=a,this.__endPoint=b;}Line.prototype.getStartPoint=function(){return this.__startPoint},Line.prototype.getEndPoint=function(){return this.__endPoint},Line.prototype.isEqual=function(a){return !!(this.getStartPoint().isEqual(a.getStartPoint())&&this.getEndPoint().isEqual(a.getEndPoint()))},Line.prototype.getLength=function(){return Math.sqrt(Math.pow(this.__endPoint.getX()-this.__startPoint.getX(),2)+Math.pow(this.__endPoint.getY()-this.__startPoint.getY(),2))},Line.prototype.getDirection=function(){var a=this.__endPoint.getX()-this.__startPoint.getX(),b=this.__endPoint.getY()-this.__startPoint.getY(),c=Math.sqrt(a*a+b*b);return new Point(a/c,b/c)},Line.prototype.createShortenedLine=function(a,b){var c=this.__endPoint.getX()-this.__startPoint.getX(),d=this.__endPoint.getY()-this.__startPoint.getY(),e=this.getDirection();return new Line(new Point(this.__startPoint.getX()+a*e.getX(),this.__startPoint.getY()+a*e.getY()),new Point(this.__startPoint.getX()+c-b*e.getX(),this.__startPoint.getY()+d-b*e.getY()))},Line.prototype.computeIntersectionType=function(a){var b=this.__startPoint.getX(),c=this.__startPoint.getY(),d=this.__endPoint.getX(),e=this.__endPoint.getY(),f=a.getStartPoint().getX(),g=a.getStartPoint().getY(),h=a.getEndPoint().getX(),i=a.getEndPoint().getY(),j=(i-g)*(d-b)-(h-f)*(e-c),k=(h-f)*(c-g)-(i-g)*(b-f),l=(d-b)*(c-g)-(e-c)*(b-f);if(0==j)return 0==j&&0==k&&0==l?LINE_INTERSECTION_TYPE.COINCIDENT:LINE_INTERSECTION_TYPE.PARALLEL;var m=k/j,n=l/j;return 1<m||0>m||1<n||0>n?LINE_INTERSECTION_TYPE.LINE:LINE_INTERSECTION_TYPE.LINESEG},Line.prototype.computeIntersection=function(a){var b=this.__startPoint.getX(),c=this.__startPoint.getY(),d=this.__endPoint.getX(),e=this.__endPoint.getY(),f=a.getStartPoint().getX(),g=a.getStartPoint().getY(),h=a.getEndPoint().getX(),i=a.getEndPoint().getY(),j=(i-g)*(d-b)-(h-f)*(e-c),k=(h-f)*(c-g)-(i-g)*(b-f),l=(d-b)*(c-g)-(e-c)*(b-f);if(0==j)return 0==j&&0==k&&0==l?new LineIntersection(LINE_INTERSECTION_TYPE.COINCIDENT,null):new LineIntersection(LINE_INTERSECTION_TYPE.PARALLEL,null);var m=k/j,n=l/j,o=this.__startPoint.getX()+m*(this.__endPoint.getX()-this.__startPoint.getX()),p=this.__startPoint.getY()+m*(this.__endPoint.getY()-this.__startPoint.getY());return 1<m||0>m||1<n||0>n?new LineIntersection(LINE_INTERSECTION_TYPE.LINE,new Point(o,p)):new LineIntersection(LINE_INTERSECTION_TYPE.LINESEG,new Point(o,p))};\n\n  function PointSet(a){var b=this,c=[];this.push=function(a){for(var b=0;b<c.length;b++)if(a.isEqual(c[b]))return !1;return c.push(a),!0},this.pushPointSet=function(a){for(var c=a.toArray(),d=0;d<c.length;d++)b.push(c[d]);},this.findPointClosestTo=function(a){var b=null,d=Number.MAX_SAFE_INTEGER;return c.forEach(function(c){var e=new Line(a,c);e.getLength()<d&&(b=c,d=e.getLength());}),b},this.findDistanceToPointClosestTo=function(a){var b=Number.MAX_SAFE_INTEGER;return c.forEach(function(c){var d=new Line(a,c);d.getLength()<b&&(b=d.getLength());}),b},this.findPointsCloseTo=function(a,b){var d=new PointSet;return c.forEach(function(c){var e=new Line(a,c);e.getLength()<=b&&d.push(c);}),d},this.toArray=function(){return c},this.toFloat64Array=function(){for(var a=new Float64Array(2*c.length),b=0;b<c.length;b++)a[0+2*b]=c[b].getX(),a[1+2*b]=c[b].getY();return a};var d=function fromFloat64Array(a){c.length=0;for(var b=0;b<a.length;b+=2)c.push(new Point(a[b],a[b+1]));};this.count=function(){return c.length},a&&Array.isArray(a)?a.forEach(b.push):a&&\"[object Float64Array]\"===Object.prototype.toString.call(a)&&d(a);}\n\n  function LineSet(a){var b=this,c=[];this.push=function(a){for(var b=0;b<c.length;b++)if(a.isEqual(c[b]))return !1;return c.push(a),!0},this.toArray=function(){return c},this.count=function(){return c.length},this.toFloat64Array=function(){for(var a=new Float64Array(4*c.length),b=0;b<c.length;b++)a[0+4*b]=c[b].getStartPoint().getX(),a[1+4*b]=c[b].getStartPoint().getY(),a[2+4*b]=c[b].getEndPoint().getX(),a[3+4*b]=c[b].getEndPoint().getY();return a};var d=function fromFloat64Array(a){c.length=0;for(var b=0;b<a.length;b+=4)c.push(new Line(new Point(a[b],a[b+1]),new Point(a[b+2],a[b+3])));};a&&Array.isArray(a)?a.forEach(b.push):a&&\"[object Float64Array]\"===Object.prototype.toString.call(a)&&d(a);}\n\n  var PointVisibilityMapRouteOptimizer={optimize:function optimize(a,b){for(var c=0,d=a.length-1;!(1>=d-c&&(c++,d=a.length-1,c>=a.length-2));)b(a[c],a[d])?(a.splice(c+1,d-c-1),d=a.length-1):d--;}};\n\n  function PointVisibilityMap(a,b,c){var d=this,e=b.toArray(),f=a.toArray(),g=null,h=function doesLineIntersectAnyBoundaryLines(a){for(var c,d=0;d<e.length;d++)if(c=e[d].computeIntersectionType(a),c===LINE_INTERSECTION_TYPE.LINESEG)return !0;return !1},i=function initPointsVisibility(){for(var a=0;a<f.length;a++)g[a]=null;},j=function computePointsVisibilityForIndex(a){g[a]=[];for(var c=0;c<f.length;c++)if(a!==c){var b=new Line(f[a],f[c]);h(b)||g[a].push(c);}return g[a]},k=function arePointsVisibleToEachOther(a,b){for(var c=0;c<f.length;c++)if(f[c].isEqual(a)){var d=g[c];null===d&&(d=j(c));for(var e=0;e<d.length;e++)if(f[d[e]].isEqual(b))return !0}return !1},l=function getVisiblePointsRelativeTo(a){return null===g[a]&&j(a),g[a]},m=function isPointInArray(a,b){for(var c=0;c<b.length;c++)if(a.isEqual(b[c]))return !0;return !1},n=function routeToEndpoint(a,b,c,d){for(var e,g=f[c],h=l(c),j=Number.MAX_SAFE_INTEGER,k=null,n=null,o=0;o<h.length;o++)if(e=f[h[o]],!m(e,b)){var p=new Line(g,e).getLength()+a,q=new Line(e,d).getLength();p+q<j&&(j=p+q,k=e,n=h[o]);}return j===Number.MAX_SAFE_INTEGER?null:{cost:j,point:k,pointIndex:n}};this.getPointToVisibleSetData=function(){return g},this.findPointClosestTo=function(a){var b=null,c=Number.MAX_SAFE_INTEGER;return f.forEach(function(d){var e=new Line(a,d);e.getLength()<c&&(b=d,c=e.getLength());}),b},this.findVisiblePointClosestTo=function(a){var b=null,c=Number.MAX_SAFE_INTEGER;return f.forEach(function(d){var e=new Line(a,d),f=e.getLength();f<c&&!h(e)&&(b=d,c=f);}),b},this.findVisiblePointIndexClosestTo=function(a){for(var b=null,c=Number.MAX_SAFE_INTEGER,d=0;d<f.length;d++){var e=f[d],g=new Line(a,e),j=g.getLength();j<c&&!h(g)&&(b=d,c=j);}return b},this.computeRoute=function(a,b,c){if(null===a||null===b)return new PointSet;var e=d.findVisiblePointIndexClosestTo(a);if(null===e)return new PointSet;for(var g,i=0,j=f[e],l=[j],m=e;!0;){if(g=n(i,l,m,b),null===g){var o=new Line(l[l.length-1],b);if(h(o))return new PointSet;break}if(i+=new Line(f[m],g.point).getLength(),l.push(g.point),m=g.pointIndex,1>new Line(f[m],b).getLength())break}return c&&PointVisibilityMapRouteOptimizer.optimize(l,k),new PointSet(l)},c?g=c:(g=Array(a.count()),i());}\n\n  var SvgPathBuilder={pointToLineTo:function pointToLineTo(a,b){return 0===b?\"M\"+a.getX()+\" \"+a.getY():\"L\"+a.getX()+\" \"+a.getY()},pointTripletToTesselatedCurvePoints:function pointTripletToTesselatedCurvePoints(a,b){if(3!==a.length)throw new Error(\"_points must be array of exactly 3 points\");var c=a[1],d=new Line(a[0],a[1]),e=new Line(a[1],a[2]),f=d.createShortenedLine(0,.5*b),g=e.createShortenedLine(.5*b,0);return [f.getStartPoint(),f.getEndPoint(),g.getStartPoint(),g.getEndPoint()]},pointsToPath:function pointsToPath(a,b){b=b||0;var c=[],d=0;if(0<b){for(;3<=a.length;){var e=a.shift(),f=a.shift(),g=a.shift(),h=SvgPathBuilder.pointTripletToTesselatedCurvePoints([e,f,g],b);a.unshift(h[3]),a.unshift(h[2]);for(var k=0;k<h.length-2;k++)c.push(SvgPathBuilder.pointToLineTo(h[k],d++));}for(;0<a.length;){var j=a.shift();c.push(SvgPathBuilder.pointToLineTo(j,d++));}}else for(var l,m=0;m<a.length;m++)l=a[m],c.push(SvgPathBuilder.pointToLineTo(l,m));return c.join(\" \")}};\n\n  var ConnectorRoutingAlgorithm=Object.freeze({STRAIGHT_LINE:0,STRAIGHT_LINE_BETWEEN_ANCHORS:1,STRAIGHT_LINE_BETWEEN_ANCHORS_AVOID_SELF_INTERSECTION:2,ASTAR:3,ASTAR_WITH_ROUTE_OPTIMIZATION:4});\n\n  var computeConnectorPath=function computeConnectorPath(a,b,c){var d=Point.fromArray(a.anchor_start_centroid_arr),e=Point.fromArray(a.anchor_end_centroid_arr),f=a.marker_start_size,g=a.marker_end_size,h=a.curvature_px,i=a.routing_algorithm,j=b.findDistanceToPointClosestTo(d),k=b.findPointsCloseTo(d,j).findPointClosestTo(e),l=b.findPointsCloseTo(e,j).findPointClosestTo(d),m=new PointSet;if(i==ConnectorRoutingAlgorithm.STRAIGHT_LINE_BETWEEN_ANCHORS)m=new PointSet([k,l]);else if(i===ConnectorRoutingAlgorithm.ASTAR||i===ConnectorRoutingAlgorithm.ASTAR_WITH_ROUTE_OPTIMIZATION){var r=!(i!==ConnectorRoutingAlgorithm.ASTAR_WITH_ROUTE_OPTIMIZATION);m=c.computeRoute(k,l,r);}else throw \"Invalid routing algorithm\";var n=m.toArray(),o=d,p=e;if(0<f&&1<=n.length){var s=new Line(n[0],d).createShortenedLine(0,f);o=s.getEndPoint();}if(0<g&&1<=n.length){var t=new Line(n[n.length-1],e).createShortenedLine(0,g);p=t.getEndPoint();}var q=[o].concat(_toConsumableArray(n),[p]);return {svgPath:SvgPathBuilder.pointsToPath(q,h),pointsInPath:q}},convertArrayBufferToFloat64Array=function convertArrayBufferToFloat64Array(a){return new Float64Array(a)},requestQueue=[],processRequestQueue=function processRequestQueue(){if(0!==requestQueue.length){var a=requestQueue.pop();requestQueue.length=0;var b={overallTime:null},c=new Date,d=a.gridSize,e=a.connectorDescriptors,f=a.entityDescriptors,g=new Date,h=new PointSet(convertArrayBufferToFloat64Array(a.routingPoints)),i=new LineSet(convertArrayBufferToFloat64Array(a.boundaryLines)),j=new PointSet(convertArrayBufferToFloat64Array(a.routingPointsAroundAnchor));b.msgDecodeTime=new Date-g;var k=new Date,l=new PointVisibilityMap(h,i);b.pointVisibilityMapCreationTime=new Date-k;var m=new Date;e.forEach(function(a){var b=computeConnectorPath(a,j,l),c=new PointSet(b.pointsInPath);a.svgPath=b.svgPath,a.pointsInPath=c.toFloat64Array().buffer;}),b.allPathsComputationTime=new Date-m,b.numRoutingPoints=h.count(),b.numBoundaryLines=i.count(),b.overallTime=new Date-c,postMessage({routingPoints:a.routingPoints,boundaryLines:a.boundaryLines,connectorDescriptors:e,pointVisibilityMapData:l.getPointToVisibleSetData(),metrics:b});}};setInterval(processRequestQueue,6),onmessage=function onmessage(a){requestQueue.push(a.data);};\n\n}());\n`; export { ConnectorRoutingWorkerJsString }","import {MatrixMath} from './MatrixMath';\r\nimport {AccessibleRoutingPointsFinder} from './AccessibleRoutingPointsFinder';\r\nimport {SheetEvent} from './SheetEvent';\r\nimport {Entity} from './Entity';\r\nimport {EntityEvent} from './EntityEvent';\r\nimport {ClosestPairFinder as ConnectorAnchorClosestPairFinder} from './ConnectorAnchorFinder/ClosestPairFinder';\r\nimport {DebugMetricsPanel} from './DebugMetricsPanel/DebugMetricsPanel';\r\nimport {DoubleTapDetector} from './DoubleTapDetector';\r\nimport {Rectangle} from './Rectangle';\r\nimport {Point} from './Point';\r\nimport {Line} from './Line';\r\nimport {PointSet} from './PointSet';\r\nimport {LineSet} from './LineSet';\r\nimport {GroupTransformationContainer} from './GroupTransformationContainer';\r\nimport {Connector} from './Connector';\r\nimport {PointVisibilityMap} from './PointVisibilityMap';\r\nimport {GRID_STYLE, Grid} from './Grid';\r\nimport {GroupTransformationContainerEvent } from './GroupTransformationContainerEvent';\r\nimport {ConnectorRoutingWorkerJsString} from './Workers/ConnectorRoutingWorker.string';\r\n\r\n/**\r\n * @callback HandleSheetInteractionCallback\r\n * @param {String} interactionType\r\n * @param {Object} interactionData\r\n */ \r\n\r\n /**\r\n * @param {Element} _sheetDomElement \r\n * @param {Window} _window\r\n */\r\nfunction Sheet(_sheetDomElement, _window) {\r\n    const self = this;\r\n\r\n    // Create container for SVG connectors\r\n    const svgElem = _window.document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\r\n    svgElem.style.width = \"100%\";\r\n    svgElem.style.height = \"100%\";\r\n    const connectorsContainerDomElement = _sheetDomElement.appendChild(svgElem);\r\n\r\n    // Selection box element\r\n    var selectionBoxElem = null;\r\n\r\n    // GroupTransformationContainers\r\n    const groupTransformationContainers = [];\r\n    var currentGroupTransformationContainerBeingDragged = null;\r\n  \r\n    /**\r\n     * @type {Grid}\r\n     */\r\n    var grid = null;\r\n\r\n    var transitionCss = \"transform 0.55s ease-in-out, transform-origin 0.55s ease-in-out\";\r\n\r\n    var transformOriginX = 0;\r\n    var transformOriginY = 0;\r\n\r\n    var touchMoveLastX = 0.0;\r\n    var touchMoveLastY = 0.0;\r\n\r\n    var translateX = 0;\r\n    var translateY = 0;\r\n    var scaleFactor = 1.0;\r\n    var invScaleFactor = 1.0;    \r\n\r\n    const invTransformationMatrixStack = [];\r\n    var currentInvTransformationMatrix = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\r\n    var currentTransformationMatrix = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\r\n\r\n    var currentPointVisibilityMap = null;\r\n\r\n    var connectorRefreshBufferTime = 6.94;\r\n    var useTranslate3d = false; // better performance w/o it\r\n    const sheetEntities = [];\r\n\r\n    /**\r\n     * @type {Connector[]}\r\n     */\r\n    const objectConnectors = [];\r\n\r\n    var objectIdBeingDragged = null;\r\n    var objectIdBeingResized = null;\r\n    var objectResizeCursor = \"default\";\r\n    \r\n    var objectDragX = 0.0;\r\n    var objectDragY = 0.0;\r\n    var objectDragStartX = 0.0;\r\n    var objectDragStartY = 0.0;\r\n\r\n    var doubleTapDetector = null;\r\n    const debugMetricsPanel = new DebugMetricsPanel(_window);\r\n\r\n    const metrics = {\r\n        connectorRoutingWorker: {\r\n            executionTime: null,\r\n            numRoutingPoints: null,\r\n            numBoundaryLines: null,\r\n            msgDecodeTime: null,\r\n            pointVisibilityMapCreationTime: null,\r\n            allPathsComputationTime: null\r\n        },\r\n        refreshAllConnectorsInternal: {\r\n            accessibleRoutingPointsFinder: null,\r\n            executionTime: null\r\n        },\r\n        connectorsRefreshTime: null\r\n    };\r\n\r\n    var touchHoldDelayTimeMs = 750.0;\r\n    var touchHoldStartInterval = null;\r\n\r\n    var multiObjectSelectionStartX = 0.0;\r\n    var multiObjectSelectionStartY = 0.0;\r\n    var multiObjectSelectionEndX = 0.0;\r\n    var multiObjectSelectionEndY = 0.0;\r\n    var multiObjectSelectionStarted = false;\r\n\r\n    const connectorAnchorsSelected = [];\r\n\r\n    // DOM attribute cache to prevent reflow\r\n    let isDomMetricsLockActive = false;\r\n    let sheetOffsetLeft = null;\r\n    let sheetOffsetTop = null;\r\n    let sheetPageScrollXOffset = null;\r\n    let sheetPageScrollYOffset = null;\r\n\r\n    /**\r\n     * Event name -> Callback map\r\n     */\r\n    const eventHandlers = new Map();\r\n    var connectorRefreshStartTime = null;\r\n    var connectorRefreshTimeout = null;\r\n\r\n\r\n    // Setup ConnectorRoutingWorker\r\n    const workerUrl = URL.createObjectURL(new Blob([ ConnectorRoutingWorkerJsString ]));\r\n    \r\n    const connectorRoutingWorker = new Worker(workerUrl);\r\n\r\n    const convertArrayBufferToFloat64Array = function(_ab) {\r\n        return new Float64Array(_ab);\r\n    };\r\n\r\n    connectorRoutingWorker.onmessage = function(_msg) {\r\n        const connectorsRefreshTimeT1 = new Date();\r\n\r\n        currentPointVisibilityMap = new PointVisibilityMap(\r\n            new PointSet(convertArrayBufferToFloat64Array(_msg.data.routingPoints)),\r\n            new LineSet(convertArrayBufferToFloat64Array(_msg.data.boundaryLines)),\r\n            _msg.data.pointVisibilityMapData\r\n        );\r\n\r\n        const connectorDescriptors = _msg.data.connectorDescriptors;\r\n        const getConnectorDescriptorById = function(_id) {\r\n            for(let i=0; i<connectorDescriptors.length; i++) {\r\n                if(connectorDescriptors[i].id === _id) {\r\n                    return connectorDescriptors[i];\r\n                }\r\n            }\r\n\r\n            return null;\r\n        };\r\n\r\n        objectConnectors.forEach(function(_c) {\r\n            const descriptor = getConnectorDescriptorById(_c.getId());\r\n            if(descriptor) {\r\n                const ps = new PointSet(new Float64Array(descriptor.pointsInPath));\r\n                _c.refresh(descriptor.svgPath, ps.toArray());\r\n                emitEvent(SheetEvent.CONNECTOR_UPDATED, { 'connector': _c });\r\n            }\r\n        });        \r\n        \r\n\r\n        metrics.connectorsRefreshTime = (new Date()) - connectorsRefreshTimeT1;\r\n\r\n        metrics.connectorRoutingWorker.executionTime = _msg.data.metrics.overallTime;\r\n        metrics.connectorRoutingWorker.numBoundaryLines = _msg.data.metrics.numBoundaryLines;\r\n        metrics.connectorRoutingWorker.numRoutingPoints = _msg.data.metrics.numRoutingPoints;\r\n        metrics.connectorRoutingWorker.msgDecodeTime = _msg.data.metrics.msgDecodeTime;\r\n        metrics.connectorRoutingWorker.pointVisibilityMapCreationTime = _msg.data.metrics.pointVisibilityMapCreationTime;\r\n        metrics.connectorRoutingWorker.allPathsComputationTime = _msg.data.metrics.allPathsComputationTime;\r\n\r\n        debugMetricsPanel.refresh(metrics);\r\n    };    \r\n\r\n    /**\r\n     * @param {Grid} _grid\r\n     */\r\n    this.setGrid = function(_grid) {\r\n        grid = _grid;\r\n        _sheetDomElement.style.backgroundImage = \"url('data:image/svg+xml;base64,\" + _window.btoa(grid.getSvgImageTile()) + \"')\";\r\n        _sheetDomElement.style.backgroundRepeat = \"repeat\";\r\n        _sheetDomElement.style.backgroundColor = \"#fff\";\r\n    };\r\n\r\n    /**\r\n     * @returns {Grid}\r\n     */\r\n    this.getGrid = function() {\r\n        return grid;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getGridSize = function() {\r\n        return grid.getSize();\r\n    };\r\n\r\n    const lockDomMetrics = function() {\r\n        sheetOffsetLeft = _sheetDomElement.offsetLeft;\r\n        sheetOffsetTop = _sheetDomElement.offsetTop;\r\n        sheetPageScrollXOffset = _window.pageXOffset;\r\n        sheetPageScrollYOffset = _window.pageYOffset;\r\n\r\n        isDomMetricsLockActive = true;\r\n    };\r\n\r\n    const unlockDomMetrics = function() {\r\n        isDomMetricsLockActive = false;\r\n    };\r\n\r\n    this.hasDomMetricsLock = function() {\r\n        return isDomMetricsLockActive;\r\n    };\r\n\r\n    /**\r\n     * @returns {PointSet}\r\n     */\r\n    const getEntityExtentRoutingPoints = function() {\r\n        const pointSet = new PointSet();\r\n        sheetEntities.forEach(function(_obj) {\r\n            const scaledPoints = _obj.getBoundingRectange().getPointsScaledToGrid(self.getGridSize());\r\n            scaledPoints.forEach((_sp) => {\r\n                pointSet.push(_sp);\r\n            });\r\n        });\r\n\r\n        return pointSet;\r\n    };\r\n\r\n    /**\r\n     * @returns {PointSet}\r\n     */    \r\n    const getConnectorRoutingPointsAroundAnchor = function() {\r\n        const executionTimeT1 = new Date();\r\n        const routingPointsResult = AccessibleRoutingPointsFinder.find(sheetEntities, sheetEntities, self.getGridSize());\r\n        metrics.refreshAllConnectorsInternal.accessibleRoutingPointsFinder = (new Date()) - executionTimeT1;\r\n\r\n        return routingPointsResult.accessibleRoutingPoints;\r\n    };\r\n\r\n    /**\r\n     * @returns {Line[]}\r\n     */    \r\n    const getConnectorBoundaryLines = function() {\r\n        const boundaryLines = new LineSet();\r\n\r\n        sheetEntities.forEach(function(_obj) {\r\n            const lines = _obj.getBoundingRectange().getLines();\r\n            lines.forEach((_l) => {\r\n                boundaryLines.push(_l);\r\n            });\r\n\r\n            const anchors = _obj.getConnectorAnchors();\r\n            anchors.forEach(function(_anchor) {\r\n                const lines = _anchor.getBoundingRectange().getLines();\r\n                lines.forEach((_l) => {\r\n                    boundaryLines.push(_l);\r\n                });                \r\n            });\r\n        });\r\n\r\n        return boundaryLines;\r\n    };    \r\n\r\n    const refreshAllConnectorsInternal = function() {\r\n        lockDomMetrics();\r\n\r\n        const executionTimeT1 = new Date();\r\n        const connectorDescriptors = [];\r\n        objectConnectors.forEach(function(_c) {\r\n            connectorDescriptors.push(_c.getDescriptor());\r\n        });\r\n\r\n        const entityDescriptors = [];\r\n        sheetEntities.forEach(function(_e) {\r\n            entityDescriptors.push(_e.getDescriptor(self.getGridSize()));\r\n        });\r\n\r\n        const routingPointsAroundAnchor = getConnectorRoutingPointsAroundAnchor();\r\n        const entityExtentRoutingPoints = getEntityExtentRoutingPoints();\r\n\r\n        const allRoutingPoints = new PointSet();        \r\n        allRoutingPoints.pushPointSet(routingPointsAroundAnchor);\r\n        allRoutingPoints.pushPointSet(entityExtentRoutingPoints);\r\n\r\n        const routingPointsAroundAnchorFloat64Array = routingPointsAroundAnchor.toFloat64Array();\r\n        const routingPointsFloat64Array = allRoutingPoints.toFloat64Array();\r\n        const boundaryLinesFloat64Array = (getConnectorBoundaryLines()).toFloat64Array();\r\n        connectorRoutingWorker.postMessage(\r\n            {\r\n                \"gridSize\": self.getGridSize(),\r\n                \"connectorDescriptors\": connectorDescriptors,\r\n                \"entityDescriptors\": entityDescriptors,\r\n                \"routingPoints\": routingPointsFloat64Array.buffer,\r\n                \"boundaryLines\": boundaryLinesFloat64Array.buffer,\r\n                \"routingPointsAroundAnchor\": routingPointsAroundAnchorFloat64Array.buffer\r\n            },\r\n            [\r\n                routingPointsFloat64Array.buffer,\r\n                boundaryLinesFloat64Array.buffer,\r\n                routingPointsAroundAnchorFloat64Array.buffer\r\n            ]\r\n        );\r\n\r\n        metrics.refreshAllConnectorsInternal.executionTime = (new Date()) - executionTimeT1;\r\n\r\n        unlockDomMetrics();\r\n    };\r\n\r\n    /**\r\n     * @param {Number} _bufferTimeMs\r\n     */\r\n    this.setConnectorRefreshBufferTime = function(_bufferTimeMs) {\r\n        connectorRefreshBufferTime = _bufferTimeMs;\r\n    };\r\n\r\n    this.refreshAllConnectors = function() {\r\n        // We'll try to coalesce refresh calls within refreshBatchBufferTimeMs \r\n        // Default is 6.944ms, for continuous calls, this corresponds to 144Hz, but actual\r\n        // performance is less given web worker overhead, path computation cost, and browser minimum limit on setTimeout\r\n\r\n        if(connectorRefreshStartTime !== null) {\r\n            const tdelta = (new Date()) - connectorRefreshStartTime;\r\n            if(tdelta < connectorRefreshBufferTime) {\r\n                return; // already scheduled\r\n            }\r\n        }\r\n\r\n        connectorRefreshStartTime = new Date();        \r\n        connectorRefreshTimeout = setTimeout(function() {\r\n            connectorRefreshTimeout = null;\r\n            connectorRefreshStartTime = null;\r\n            refreshAllConnectorsInternal();\r\n        }, connectorRefreshBufferTime);\r\n    };\r\n\r\n    var makeNewConnector = function(_anchorStart, _anchorEnd, _containerDomElement) {\r\n        return new Connector(_anchorStart, _anchorEnd, _containerDomElement);\r\n    };\r\n\r\n    /**\r\n     * @callback ConnectorFactory\r\n     * @param {ConnectorAnchor} _anchorStart\r\n     * @param {ConnectorAnchor} _anchorEnd\r\n     * @param {Element} _containerDomElement\r\n     */\r\n\r\n    /**\r\n     * @param {ConnectorFactory} _connectorFactory\r\n     */\r\n    this.setConnectorFactory = function(_newConnectorFactory) {\r\n        makeNewConnector = _newConnectorFactory;\r\n    };    \r\n\r\n\r\n    /**\r\n     * @returns {String}\r\n     */\r\n    this.getTransitionCss = function() {\r\n        return transitionCss;\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {String} _css \r\n     */\r\n    this.setTransitionCss = function(_css) {\r\n        transitionCss = _css;\r\n        _sheetDomElement.style.transition = transitionCss;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */    \r\n    this.getTransformOriginX = function() {\r\n        return transformOriginX;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */    \r\n    this.getTransformOriginY = function() {\r\n        return transformOriginY;\r\n    };    \r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getScaleFactor = function() {\r\n        return scaleFactor;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getTranslateX = function() {\r\n        return translateX;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */    \r\n    this.getTranslateY = function() {\r\n        return translateY;\r\n    };    \r\n\r\n    /**\r\n     * \r\n     * @param {Number} _x \r\n     * @param {Number} _y \r\n     */\r\n    this.setTransformOrigin = function(_x, _y) {\r\n        transformOriginX = _x;\r\n        transformOriginY = _y;\r\n        _sheetDomElement.style.transformOrigin = `${transformOriginX}px ${transformOriginY}px`;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Number} _scaleFactor \r\n     * @param {Boolean} _adjustFactorToPreserveIntegerGrid \r\n     */\r\n    this.scale = function(_scaleFactor, _adjustFactorToPreserveIntegerGrid) {\r\n        _adjustFactorToPreserveIntegerGrid = _adjustFactorToPreserveIntegerGrid || false;\r\n\r\n        if(_adjustFactorToPreserveIntegerGrid) {\r\n            const newGridSize = self.getGridSize() * _scaleFactor;\r\n            const roundedGridSize = Math.round(newGridSize);\r\n            _scaleFactor = roundedGridSize / self.getGridSize();\r\n        }\r\n\r\n        scaleFactor = _scaleFactor;\r\n        invScaleFactor = 1.0 / scaleFactor;        \r\n\r\n        const scaleMat = \r\n            [\r\n                scaleFactor, 0, 0, 0, \r\n                0, scaleFactor, 0, 0, \r\n                0, 0, scaleFactor, 1, \r\n                0, 0, 0, 1\r\n            ];\r\n\r\n        currentTransformationMatrix = MatrixMath.mat4Multiply(\r\n            currentTransformationMatrix, \r\n            scaleMat\r\n        );\r\n\r\n        invTransformationMatrixStack.push(\r\n            [\r\n                invScaleFactor, 0, 0, 0, \r\n                0, invScaleFactor, 0, 0, \r\n                0, 0, invScaleFactor, 1, \r\n                0, 0, 0, 1\r\n            ]\r\n        );\r\n\r\n        return self;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Number} _x \r\n     * @param {Number} _y \r\n     */\r\n    this.translate = function(_x, _y) {\r\n        translateX = _x;\r\n        translateY = _y;\r\n\r\n        const translateMatrix =             \r\n            [\r\n                1, 0, 0, 0, \r\n                0, 1, 0, 0, \r\n                0, 0, 1, 0, \r\n                translateX, translateY, 0, 1\r\n            ];\r\n\r\n        currentTransformationMatrix = MatrixMath.mat4Multiply(\r\n            currentTransformationMatrix, \r\n            translateMatrix\r\n        ); \r\n\r\n        invTransformationMatrixStack.push(\r\n            [\r\n                1, 0, 0, -translateX, \r\n                0, 1, 0, -translateY, \r\n                0, 0, 1, 0, \r\n                0, 0, 0, 1\r\n            ]\r\n        );\r\n\r\n        return self;\r\n    };\r\n\r\n    this.applyTransform = function() {\r\n        _sheetDomElement.style.transform = self.getTransformMatrixCss();\r\n        currentInvTransformationMatrix = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\r\n        for(let i=0; i<invTransformationMatrixStack.length; i++) {\r\n            currentInvTransformationMatrix = MatrixMath.mat4Multiply(currentInvTransformationMatrix, invTransformationMatrixStack[i]);\r\n        }\r\n    };\r\n\r\n    /**\r\n     * @returns {Array}\r\n     */\r\n    this.getTransformMatrix = function() {\r\n        return currentTransformationMatrix;\r\n    };\r\n\r\n    /**\r\n     * @returns {String}\r\n     */    \r\n    this.getTransformMatrixCss = function() {\r\n        const matElems = currentTransformationMatrix.join(\",\");\r\n        return `matrix3d(${matElems})`;\r\n    };\r\n\r\n    /**\r\n     * @param {DOMRect} _domRect\r\n     * @returns {Rectangle}\r\n     */\r\n    this.transformDomRectToPageSpaceRect = function(_domRect) {\r\n        const pageOffset = self.getPageOffset();\r\n        const sheetOffset = self.getSheetOffset();\r\n\r\n        const left = _domRect.left - sheetOffset.getX() + pageOffset.getX();\r\n        const top = _domRect.top - sheetOffset.getY() + pageOffset.getY();\r\n        const right = _domRect.right - sheetOffset.getX() + pageOffset.getX();\r\n        const bottom = _domRect.bottom - sheetOffset.getY() + pageOffset.getY();\r\n\r\n        // inv transform\r\n        const invTransformedPosLeftTop = MatrixMath.vecMat4Multiply(\r\n            [left, top, 0, 1],\r\n            currentInvTransformationMatrix\r\n        );\r\n\r\n        const invTransformedPosRightBottom = MatrixMath.vecMat4Multiply(\r\n            [right, bottom, 0, 1],\r\n            currentInvTransformationMatrix\r\n        );\r\n\r\n        // we have Sheet space coordinates, transform to Page space and return\r\n        return new Rectangle(\r\n            invTransformedPosLeftTop[0] + sheetOffset.getX(), \r\n            invTransformedPosLeftTop[1] + sheetOffset.getY(), \r\n            invTransformedPosRightBottom[0] + sheetOffset.getX(), \r\n            invTransformedPosRightBottom[1] + sheetOffset.getY()\r\n        );\r\n    };\r\n\r\n    this.resetTransform = function() {\r\n        scaleFactor = 1.0;\r\n        invScaleFactor = 1.0;\r\n        translateX = 0.0;\r\n        translateY = 0.0;\r\n        currentTransformationMatrix = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\r\n        currentInvTransformationMatrix = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\r\n        invTransformationMatrixStack.length = 0;\r\n        _sheetDomElement.style.transform = \"none\";\r\n    };\r\n\r\n    /**\r\n     * @returns {Point}\r\n     */\r\n    this.getPageOffset = function() {\r\n        if(self.hasDomMetricsLock()) {\r\n            return new Point(sheetPageScrollXOffset, sheetPageScrollYOffset);\r\n        }\r\n\r\n        return new Point(_window.pageXOffset, _window.pageYOffset);\r\n    };\r\n\r\n    /**\r\n     * @param {Number} _p \r\n     * @returns {Number}\r\n     */\r\n    this.snapToGrid = function(_p) {\r\n        var ret = Math.round(_p/self.getGridSize()) * self.getGridSize();\r\n        return Math.max(0, ret - 1);\r\n    };\r\n\r\n    /**\r\n     * @returns {Point}\r\n     */\r\n    this.getSheetOffset = function() {\r\n        if(self.hasDomMetricsLock()) {\r\n            return new Point(sheetOffsetLeft, sheetOffsetTop);\r\n        }\r\n        \r\n        return new Point(_sheetDomElement.offsetLeft, _sheetDomElement.offsetTop);\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getOffsetLeft = function() {\r\n        return _sheetDomElement.offsetLeft;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getOffsetTop = function() {\r\n        return _sheetDomElement.offsetTop;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getWidth = function() {\r\n        return _sheetDomElement.offsetWidth;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getHeight = function() {\r\n        return _sheetDomElement.offsetHeight;\r\n    };\r\n\r\n    /**\r\n     * @param {Entity[]} _objs \r\n     * @returns {Rectangle}\r\n     */\r\n    this.calcBoundingRectForEntities = function(_entities) {\r\n        var minTop = null;\r\n        var minLeft = null;\r\n        var maxBottom = null;\r\n        var maxRight = null;\r\n\r\n        _entities.forEach(function(_obj, index, array) {\r\n            const objRect = _obj.getBoundingRectange();\r\n            const left = objRect.getLeft();\r\n            const top = objRect.getTop();  \r\n            const right = objRect.getRight();\r\n            const bottom = objRect.getBottom();\r\n\r\n            if(minLeft === null || left < minLeft) {\r\n                minLeft = left;\r\n            }\r\n\r\n            if(minTop === null || top < minTop) {\r\n                minTop = top;\r\n            }\r\n\r\n            if(maxBottom === null || bottom > maxBottom) {\r\n                maxBottom = bottom;\r\n            }        \r\n\r\n            if(maxRight === null || right > maxRight) {\r\n                maxRight = right;\r\n            }\r\n        });\r\n\r\n        if(minTop === null || minLeft === null || maxBottom === null || maxRight === null) {\r\n            minTop = 0;\r\n            minLeft = 0;\r\n            maxBottom = 0;\r\n            maxRight = 0;            \r\n        }\r\n\r\n        return new Rectangle(minLeft, minTop, maxRight, maxBottom);\r\n    };\r\n\r\n    /**\r\n     * @returns {Rectangle}\r\n     */\r\n    this.calcBoundingBox = function() {\r\n        if(sheetEntities.length === 0) {    \r\n            return new Rectangle(0, 0, self.getWidth(), self.getHeight());     \r\n        }\r\n\r\n        return self.calcBoundingRectForEntities(sheetEntities);\r\n    };\r\n\r\n    /**\r\n     * @param {Number} _x\r\n     * @param {Number} _y\r\n     * @param {Number} _radius\r\n     * @returns {Entity[]}\r\n     */\r\n    this.getEntitiesAroundPoint = function(_x, _y, _radius) {\r\n        _radius = _radius || 1.0;\r\n\r\n        const result = [];\r\n\r\n        const ptRect = new Rectangle(\r\n            _x - _radius, \r\n            _y - _radius, \r\n            _x + _radius, \r\n            _y + _radius\r\n        );\r\n\r\n        sheetEntities.forEach(function(_obj) {\r\n            if(ptRect.checkIntersect(_obj.getBoundingRectange())) {\r\n                result.push(_obj);\r\n            }\r\n        });\r\n\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * @param {Rectangle} _rect\r\n     * @returns {Entity[]}\r\n     */\r\n    this.getEntitiesWithinRect = function(_rect) {\r\n        const result = [];\r\n\r\n        sheetEntities.forEach(function(_obj) {\r\n            if(_obj.getBoundingRectange().checkIsWithin(_rect)) {\r\n                result.push(_obj);\r\n            }\r\n        });\r\n\r\n        return result;\r\n    };    \r\n      \r\n    /**\r\n     * @returns {Entity[]}\r\n     */\r\n    this.getAllEntities = function() {    \r\n        return sheetEntities;\r\n    };\r\n\r\n    /**\r\n     * @deprecated\r\n     * Helper method to publish an object change to all objects\r\n     * \r\n     * @param {String} _eventName\r\n     * @param {*} _eventData\r\n     */\r\n    this.publishSiblingObjectChange = function(_eventName, _eventData) {\r\n        sheetEntities.forEach(function(_obj) {\r\n            _obj.handleSiblingObjectChange(_eventName, _eventData);\r\n        });\r\n    };\r\n\r\n    /**\r\n     * @param {String} _id\r\n     * @returns {Entity|null}\r\n     */   \r\n    this.getEntityById = function(_id) {\r\n        var foundEntity = null;\r\n        sheetEntities.forEach(function(obj, index, array) {\r\n            if(foundEntity === null && obj.getId() === _id) {\r\n                foundEntity = obj;\r\n            }            \r\n        });\r\n        \r\n        return foundEntity;\r\n    };\r\n\r\n    /**\r\n     * @param {Entity} _obj\r\n     */\r\n    this.addEntity = function(_obj) {\r\n        _obj.on(EntityEvent.RESIZE_START, handleResizeStart);\r\n\r\n        _obj.on(EntityEvent.RESIZE, function(e) {\r\n            emitEvent(SheetEvent.ENTITY_RESIZED, { 'object': e.obj });\r\n            self.refreshAllConnectors();    \r\n        });\r\n\r\n        _obj.on(EntityEvent.TRANSLATE_START, handleMoveStart);\r\n\r\n        _obj.on(EntityEvent.TRANSLATE, function(e) {\r\n            emitEvent(SheetEvent.ENTITY_TRANSLATED, { 'object': e.obj });\r\n            self.refreshAllConnectors();    \r\n        });\r\n\r\n        sheetEntities.push(_obj);\r\n        self.refreshAllConnectors();       \r\n\r\n        emitEvent(SheetEvent.ENTITY_ADDED, { \"object\":_obj });\r\n    };    \r\n\r\n    /**\r\n     * Remove object from the sheet\r\n     * Note: as caller is responsible for putting object into the DOM, caller is responsible for removing it from the DOM\r\n     * \r\n     * @param {String} _entityId\r\n     * @returns {Boolean} \r\n     */\r\n    this.removeEntity = function(_entityId) {\r\n        for(let i=0; i<sheetEntities.length; i++) {\r\n            if(sheetEntities[i].getId() === _entityId) {\r\n                sheetEntities.splice(i, 1);\r\n                self.refreshAllConnectors();\r\n                emitEvent(SheetEvent.ENTITY_REMOVED, { \"object\":sheetEntities[i] });\r\n                return true;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    };\r\n\r\n    /**\r\n     * @param {String} _id\r\n     * @returns {Connector|null}\r\n     */    \r\n    this.getConnector = function(_id) {\r\n        for(let c=0; c<objectConnectors.length; c++) {\r\n            if(objectConnectors[c].getId() === _id) {\r\n                return objectConnectors[c];\r\n            }\r\n        }\r\n\r\n        return null;\r\n    };\r\n\r\n    /**\r\n     * @returns {Connector[]}\r\n     */\r\n    this.getAllConnectors = function() {\r\n        return objectConnectors;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Entity} _objA \r\n     * @param {Entity} _objB \r\n     * @returns {Connector[]}\r\n     */\r\n    this.getConnectorsBetweenEntities = function(_entityA, _entityB) {\r\n        const foundConnectors = [];\r\n\r\n        objectConnectors.forEach((_conn) => {\r\n            const aS = _conn.getAnchorStart();\r\n            const aE = _conn.getAnchorEnd();\r\n\r\n            if(_entityA.hasConnectorAnchor(aS) && _entityB.hasConnectorAnchor(aE)) {\r\n                foundConnectors.push(_conn);\r\n            }\r\n\r\n            if(_entityA.hasConnectorAnchor(aE) && _entityB.hasConnectorAnchor(aS)) {\r\n                foundConnectors.push(_conn);\r\n            }            \r\n        });\r\n\r\n        return foundConnectors;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Entity[]} _entitySet\r\n     * @returns {Connector[]}\r\n     */\r\n    this.getConnectorsInEntitySet = function(_entitySet) {\r\n        const foundConnectors = [];\r\n\r\n        for(let i=0; i<_entitySet.length; i++) {\r\n            for(let j=i+1; j<_entitySet.length; j++) {\r\n                const connectorsBetween = self.getConnectorsBetweenEntities(_entitySet[i], _entitySet[j]);\r\n                foundConnectors.push(...connectorsBetween);\r\n            }\r\n        }\r\n\r\n        return foundConnectors;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {String} _connectorId\r\n     * @returns {Entity[]} \r\n     */\r\n    this.getEntitiesConnectedViaConnector = function(_connectorId) {\r\n        const foundEntities = [];\r\n        const allEntities = self.getAllEntities();\r\n\r\n        objectConnectors.forEach((_conn) => {\r\n            if(_conn.getId() !== _connectorId) {\r\n                return;\r\n            }\r\n\r\n            const aS = _conn.getAnchorStart();\r\n            const aE = _conn.getAnchorEnd();\r\n\r\n            allEntities.forEach((_o) => {\r\n                if(_o.hasConnectorAnchor(aS) || _o.hasConnectorAnchor(aE)) {\r\n                    foundEntities.push(_o);\r\n                }\r\n            });\r\n        });\r\n\r\n        return foundEntities;        \r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Entity} _obj\r\n     * @returns {Connector[]} \r\n     */\r\n    this.getConnectorsConnectedToEntity = function(_entity) {\r\n        const foundConnectors = [];\r\n\r\n        objectConnectors.forEach((_conn) => {\r\n            const aS = _conn.getAnchorStart();\r\n            const aE = _conn.getAnchorEnd();\r\n\r\n            if(_entity.hasConnectorAnchor(aS) || _entity.hasConnectorAnchor(aE)) {\r\n                foundConnectors.push(_conn);\r\n            }\r\n\r\n        });\r\n\r\n        return foundConnectors;        \r\n    };\r\n\r\n    /**\r\n     * @param {String} _connectorAnchorId\r\n     * @returns {Entity|null} \r\n     */\r\n    this.getEntityWithConnectorAnchor = function(_connectorAnchorId) {\r\n        const allEntities = self.getAllEntities();\r\n        for(let i=0; i<allEntities.length; i++) {                \r\n            const anchors = allEntities[i].getConnectorAnchors();\r\n            for(let j=0; j<anchors.length; j++) {\r\n                if(anchors[j].getId() === _connectorAnchorId) {\r\n                    return allEntities[i];\r\n                }\r\n            }\r\n        }\r\n\r\n        return null;\r\n    };    \r\n\r\n    this.removeAllConnectors = function() {\r\n        objectConnectors.forEach(function(_conn) {\r\n            _conn.removePathElement();\r\n        });\r\n\r\n        objectConnectors.splice(0, objectConnectors.length);\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Connector} _connector\r\n     * @returns {Boolean}\r\n     */\r\n    this.removeConnector = function(_connector) {\r\n        for(let i=0; i<objectConnectors.length; i++) {\r\n            if(objectConnectors[i] === _connector) {\r\n                _connector.removePathElement();\r\n                objectConnectors.splice(i, 1);\r\n                return true;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {ConnectorAnchor} _anchorA \r\n     * @param {ConnectorAnchor} _anchorB \r\n     * @returns {Connector}\r\n     */\r\n    this.makeNewConnectorFromAnchors = function(_anchorA, _anchorB) {\r\n        const newConnector = makeNewConnector(_anchorA, _anchorB, connectorsContainerDomElement);\r\n        const foundConnector = self.getConnector(newConnector.getId());\r\n\r\n        if(foundConnector === null) {\r\n            objectConnectors.push(newConnector);\r\n            newConnector.appendPathToContainerDomElement();\r\n            self.refreshAllConnectors();\r\n            return newConnector;\r\n        }\r\n\r\n        return foundConnector;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Entity} _objA \r\n     * @param {Entity} _objB\r\n     */\r\n    this.findBestConnectorAnchorsToConnectEntities = function(_entityA, _entityB, _onFound) {\r\n        const searchFunc = (_searchData) => {\r\n            const accessibleRoutingPointsResult = AccessibleRoutingPointsFinder.find([_entityA, _entityB], sheetEntities, self.getGridSize());\r\n            const result = ConnectorAnchorClosestPairFinder.findClosestPairBetweenObjects(\r\n                _searchData.objectA, \r\n                _searchData.objectB, \r\n                accessibleRoutingPointsResult.connectorAnchorToNumValidRoutingPoints\r\n            );\r\n    \r\n            _searchData.cb(result);\r\n        };\r\n\r\n        setTimeout(function() {\r\n            searchFunc(\r\n                {\r\n                    \"objectA\": _entityA, // deprecated\r\n                    \"objectB\": _entityB, // deprecated\r\n                    \"entityA\": _entityA,\r\n                    \"entityB\": _entityB,                    \r\n                    \"cb\": _onFound\r\n                }\r\n            );\r\n        }, connectorRefreshBufferTime);\r\n    };\r\n\r\n    /**\r\n     * @param {ConnectorAnchor} _anchor\r\n     */\r\n    this.addConnectionAnchorToSelectionStack = function(_anchor) {\r\n        connectorAnchorsSelected.push(_anchor);\r\n\r\n        if(connectorAnchorsSelected.length === 2) {\r\n            self.makeNewConnectorFromAnchors(connectorAnchorsSelected[0], connectorAnchorsSelected[1]);\r\n            connectorAnchorsSelected.length = 0;\r\n        }\r\n    };\r\n\r\n    /**\r\n     * @param {Number} _posX \r\n     * @param {Number} _posY \r\n     */\r\n    const dblClickTapHandler = function(_posX, _posY) {\r\n        const entitiesAroundPoint = self.getEntitiesAroundPoint(_posX, _posY);\r\n\r\n        const eventData = {\r\n            'targetPoint': new Point(_posX, _posY),\r\n            'objectsAroundPoint': entitiesAroundPoint, // deprecated\r\n            'entitiesAroundPoint': entitiesAroundPoint\r\n        };\r\n\r\n        emitEvent(SheetEvent.DBLCLICK, eventData);\r\n    };\r\n\r\n    this.initDebugMetricsPanel = function() {\r\n        debugMetricsPanel.init();\r\n        debugMetricsPanel.show();\r\n    };\r\n\r\n    /**\r\n     * @param {Number} _dblTapSpeed\r\n     * @param {Number} _dblTapRadius\r\n     */\r\n    this.initInteractionHandlers = function(_dblTapSpeed, _dblTapRadius) {\r\n\r\n        doubleTapDetector = new DoubleTapDetector(_dblTapSpeed, _dblTapRadius);\r\n\r\n        // dblclick on empty area of the sheet\r\n        _sheetDomElement.addEventListener('dblclick', function (e) {\r\n\r\n            const invTransformedPos = MatrixMath.vecMat4Multiply(\r\n                [e.pageX - self.getOffsetLeft(), e.pageY - self.getOffsetTop(), 0, 1],\r\n                currentInvTransformationMatrix\r\n            );\r\n\r\n            dblClickTapHandler(invTransformedPos[0], invTransformedPos[1]);\r\n        });\r\n\r\n        // click anywhere on sheet\r\n        _sheetDomElement.addEventListener('click', function (e) {\r\n            let sheetEntityClicked = false;\r\n            if(e.target !== _sheetDomElement) {\r\n                sheetEntityClicked = true;\r\n            }\r\n\r\n            const invTransformedPos = MatrixMath.vecMat4Multiply(\r\n                [e.pageX - self.getOffsetLeft(), e.pageY - self.getOffsetTop(), 0, 1],\r\n                currentInvTransformationMatrix\r\n            );\r\n\r\n            const eventData = {\r\n                'targetPoint': new Point(invTransformedPos[0], invTransformedPos[1]),\r\n                'entityClicked': sheetEntityClicked,\r\n                'canvasObjectClicked': sheetEntityClicked // deprecated\r\n            };\r\n    \r\n            emitEvent(SheetEvent.CLICK, eventData);\r\n        });\r\n\r\n        // touchend on sheet, logic to see if there was a double-tap\r\n        _sheetDomElement.addEventListener('touchend', function(e) {\r\n            const detectResult = doubleTapDetector.processTap(\r\n                e,\r\n                new Point(self.getOffsetLeft(), self.getOffsetTop()),\r\n                currentInvTransformationMatrix,\r\n            );\r\n\r\n            if(detectResult.doubleTapDetected) {\r\n                dblClickTapHandler(detectResult.touchX, detectResult.touchY);\r\n            }\r\n        });\r\n    };\r\n\r\n    /**\r\n     * @param {GroupTransformationContainer} _groupTransformationContainer\r\n     */\r\n    this.attachGroupTransformationContainer = function(_groupTransformationContainer) {\r\n        _sheetDomElement.appendChild(_groupTransformationContainer.getContainerDomElement());\r\n        groupTransformationContainers.push(_groupTransformationContainer);\r\n\r\n        _groupTransformationContainer.on(GroupTransformationContainerEvent.TRANSLATE_START, function(e) {\r\n            currentGroupTransformationContainerBeingDragged = e.container;\r\n        });\r\n    };\r\n\r\n    /**\r\n     * @param {GroupTransformationContainer} _groupTransformationContainer\r\n     * @returns {Boolean}\r\n     */\r\n    this.detachGroupTransformationContainer = function(_groupTransformationContainer) {\r\n        for(let i=0; i<groupTransformationContainers.length; i++) {\r\n            if(groupTransformationContainers[i] === _groupTransformationContainer) {\r\n                _sheetDomElement.removeChild(_groupTransformationContainer.getContainerDomElement());\r\n                groupTransformationContainers.splice(i, 1);\r\n                return true;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Number} _dx \r\n     * @param {Number} _dy \r\n     */\r\n    const handleGroupTransformationContainerMove = function(_dx, _dy) {\r\n        const gtc = currentGroupTransformationContainerBeingDragged;        \r\n        gtc.translateByOffset(_dx, _dy);\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Object} _e\r\n     */\r\n    const handleMoveStart = function(_e) {     \r\n        objectIdBeingDragged = _e.obj.getId();\r\n        objectDragX = _e.x;\r\n        objectDragY = _e.y;\r\n        objectDragStartX = _e.x;\r\n        objectDragStartY = _e.y;        \r\n    };    \r\n\r\n    /**\r\n     * \r\n     * @param {Number} _x \r\n     * @param {Number} _y \r\n     */\r\n    const handleMove = function(_x, _y) {\r\n        const entity = self.getEntityById(objectIdBeingDragged);\r\n        const translateOffset = entity.getTranslateHandleOffset();\r\n        const mx = self.snapToGrid(_x + translateOffset.getX());\r\n        const my = self.snapToGrid(_y + translateOffset.getY());\r\n        \r\n        objectDragX = mx;\r\n        objectDragY = my;\t\t\r\n\r\n        entity.translate(mx, my);\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Number} _x \r\n     * @param {Number} _y \r\n     */\r\n    const handleMoveEnd = function(_x, _y) {\r\n        const entity = self.getEntityById(objectIdBeingDragged);\r\n        const translateOffset = entity.getTranslateHandleOffset();\r\n        const mx = self.snapToGrid(_x + translateOffset.getX());\r\n        const my = self.snapToGrid(_y + translateOffset.getY());\r\n        entity.translate(mx, my);       \r\n    };         \r\n\r\n    /**\r\n     * \r\n     * @param {Object} _e \r\n     */\r\n    const handleResizeStart = function(_e) {       \r\n        objectIdBeingResized = _e.obj.getId();\r\n        objectResizeCursor = _e.resizeCursor;\r\n\r\n        _sheetDomElement.style.cursor = objectResizeCursor;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Number} _x \r\n     * @param {Number} _y \r\n     */    \r\n    const handleResize = function(_x, _y) {\r\n        const entity = self.getEntityById(objectIdBeingResized);\r\n\r\n        const mx = self.snapToGrid(_x);\r\n        const my = self.snapToGrid(_y);\r\n\r\n        const top = entity.getY();\r\n        const left = entity.getX();\r\n        const newWidth = ((mx - left)+1);\r\n        const newHeight = ((my - top)+1);\r\n\r\n        entity.resize(newWidth, newHeight);\r\n    };\r\n\r\n    const handleResizeEnd = function() {\r\n        objectIdBeingResized = null;\r\n        _sheetDomElement.style.cursor = \"\";\r\n    };    \r\n\r\n    /**\r\n     * \r\n     * @param {Number} _x \r\n     * @param {Number} _y \r\n     * @param {Element} _targetElem \r\n     * @returns {Boolean}\r\n     */\r\n    const handleMultiEntitySelectionStart = function(_x, _y, _targetElem) {\r\n        if(multiObjectSelectionStarted) {\r\n            return false; // already doing selection\r\n        }\r\n\r\n        if(_targetElem !== svgElem) { // hacky, but b/c of the SVG overlay, events propagate from the overlay\r\n            return false;\r\n        }\r\n\r\n        if(objectIdBeingDragged !== null) {\r\n            return false;\r\n        }\r\n\r\n        if(objectIdBeingResized !== null) {\r\n            return false;\r\n        }        \r\n\r\n        const invTransformedPos = MatrixMath.vecMat4Multiply(\r\n            [_x, _y, 0, 1],\r\n            currentInvTransformationMatrix\r\n        );\r\n\r\n        multiObjectSelectionStartX = invTransformedPos[0];\r\n        multiObjectSelectionStartY = invTransformedPos[1];\r\n        multiObjectSelectionEndX = invTransformedPos[0];\r\n        multiObjectSelectionEndY = invTransformedPos[1];\r\n        multiObjectSelectionStarted = true;\r\n\r\n        selectionBoxElem.style.left = `${multiObjectSelectionStartX}px`;\r\n        selectionBoxElem.style.top = `${multiObjectSelectionStartY}px`;\r\n        selectionBoxElem.style.width = `0px`;\r\n        selectionBoxElem.style.height = `0px`;\r\n        selectionBoxElem.style.display = \"block\";\r\n\r\n        emitEvent(\r\n            SheetEvent.MULTIPLE_ENTITY_SELECTION_STARTED,\r\n            { \r\n                'x': invTransformedPos[0],\r\n                'y': invTransformedPos[1]\r\n            }\r\n        );\r\n\r\n        return true;\r\n    };\r\n\r\n    const handleMultiEntitySelectionEnd = function() {\r\n        multiObjectSelectionStarted = false;\r\n\r\n        const selectionRect = new Rectangle(\r\n            Math.min(multiObjectSelectionStartX, multiObjectSelectionEndX), \r\n            Math.min(multiObjectSelectionStartY, multiObjectSelectionEndY),\r\n            Math.max(multiObjectSelectionStartX, multiObjectSelectionEndX), \r\n            Math.max(multiObjectSelectionStartY, multiObjectSelectionEndY)\r\n        );\r\n\r\n        const selectedEntities = self.getEntitiesWithinRect(selectionRect);\r\n        const boundingRect = self.calcBoundingRectForEntities(selectedEntities);\r\n\r\n        selectionBoxElem.style.left = `${boundingRect.getLeft()}px`;\r\n        selectionBoxElem.style.top = `${boundingRect.getTop()}px`;\r\n        selectionBoxElem.style.width = `${boundingRect.getWidth()}px`;\r\n        selectionBoxElem.style.height = `${boundingRect.getHeight()}px`;\r\n        selectionBoxElem.style.display = \"none\";\r\n\r\n        emitEvent(\r\n            SheetEvent.MULTIPLE_ENTITIES_SELECTED, \r\n            { \r\n                'selectedObjects': selectedEntities, // deprecated\r\n                'selectedEntities': selectedEntities,\r\n                'boundingRect': boundingRect\r\n            }\r\n        );\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Number} _endX \r\n     * @param {Number} _endY \r\n     */\r\n    const updateSelectionBoxEndPoint = function(_endX, _endY) {\r\n\r\n        const invTransformedPos = MatrixMath.vecMat4Multiply(\r\n            [_endX, _endY, 0, 1],\r\n            currentInvTransformationMatrix\r\n        );\r\n\r\n        multiObjectSelectionEndX = invTransformedPos[0];\r\n        multiObjectSelectionEndY = invTransformedPos[1];\r\n        const width = multiObjectSelectionEndX - multiObjectSelectionStartX;\r\n        const height = multiObjectSelectionEndY - multiObjectSelectionStartY;\r\n\r\n        if(width >= 0) {\r\n            selectionBoxElem.style.width = `${width}px`;\r\n        } else {\r\n            selectionBoxElem.style.left = `${invTransformedPos[0]}px`;\r\n            selectionBoxElem.style.width = `${Math.abs(width)}px`;\r\n        }\r\n\r\n        if(height >= 0) {\r\n            selectionBoxElem.style.height = `${height}px`;\r\n        } else {\r\n            selectionBoxElem.style.top = `${invTransformedPos[1]}px`;\r\n            selectionBoxElem.style.height = `${Math.abs(height)}px`;\r\n        }\r\n    };\r\n\r\n    /**\r\n     * @param {String[]} _selectionRectStyleCssClasses\r\n     */\r\n    this.initMultiEntitySelectionHandler = function(_selectionRectStyleCssClasses) {\r\n        // Create selection box DOM element\r\n        const selBox = _window.document.createElement(\"div\");\r\n        selBox.classList.add(\"ia-selection-box\");\r\n        selBox.style.display = \"none\";\r\n        selBox.style.position = \"absolute\";\r\n        selBox.style.left = \"0px\";\r\n        selBox.style.top = \"0px\";\r\n\r\n        if(typeof _selectionRectStyleCssClasses === 'undefined' || _selectionRectStyleCssClasses.length === 0) {\r\n            selBox.style.border = \"1px solid rgb(158, 158, 158)\";\r\n            selBox.style.background = \"rgba(153, 153, 153, 0.5)\";            \r\n        } else {\r\n            // CSS classes will control styling for things GraphPaper doesn't care about\r\n            // (GraphPaper style concerns are handled via inline styles which will always take precedance)\r\n            _selectionRectStyleCssClasses.forEach(function(_class) {\r\n                selBox.classList.add(_class);\r\n            });\r\n        }\r\n\r\n        selectionBoxElem = _sheetDomElement.appendChild(selBox);\r\n\r\n        const handleTouchSelectionStart = function(e) {\r\n            const hasSelectionStarted = handleMultiEntitySelectionStart(e.touches[0].pageX - self.getOffsetLeft(), e.touches[0].pageY - self.getOffsetTop(), e.target);\r\n        };\r\n\r\n        _sheetDomElement.addEventListener('mousedown', function(e) {\r\n            if (e.which !== 1) {\r\n                return;\r\n            }\r\n\r\n            const hasSelectionStarted = handleMultiEntitySelectionStart(e.pageX - self.getOffsetLeft(), e.pageY - self.getOffsetTop(), e.target);\r\n            if(hasSelectionStarted) {\r\n                e.preventDefault(); // prevents text selection from triggering\r\n            }\r\n        });\r\n\r\n        _sheetDomElement.addEventListener('touchstart', function(e) {\r\n            touchHoldStartInterval = setInterval(function() {\r\n                handleTouchSelectionStart(e);\r\n            }, touchHoldDelayTimeMs);\r\n        });\r\n\r\n        _sheetDomElement.addEventListener('touchend', function(e) {\r\n            clearInterval(touchHoldStartInterval);\r\n        });\r\n\r\n        _sheetDomElement.addEventListener('touchmove', function(e) {\r\n            clearInterval(touchHoldStartInterval);\r\n        });        \r\n    };\r\n\r\n    this.initTransformationHandlers = function() {\r\n        _sheetDomElement.addEventListener('touchstart', function(e) {\r\n            touchMoveLastX = e.touches[0].pageX - self.getOffsetLeft();\r\n            touchMoveLastY = e.touches[0].pageY - self.getOffsetTop();\r\n        });\r\n\r\n        _sheetDomElement.addEventListener('touchmove', function (e) {\r\n            if (objectIdBeingDragged !== null) {\r\n                const invTransformedPos = MatrixMath.vecMat4Multiply(\r\n                    [e.touches[0].pageX - self.getOffsetLeft(), e.touches[0].pageY - self.getOffsetTop(), 0, 1],\r\n                    currentInvTransformationMatrix\r\n                );                    \r\n\r\n                handleMove(invTransformedPos[0], invTransformedPos[1]);\r\n                // if we're transforming an object, make sure we don't scroll the sheet\r\n                e.preventDefault();\r\n            }\r\n\r\n            if(objectIdBeingResized !== null) {\r\n                const invTransformedPos = MatrixMath.vecMat4Multiply(\r\n                    [e.touches[0].pageX - self.getOffsetLeft(), e.touches[0].pageY - self.getOffsetTop(), 0, 1],\r\n                    currentInvTransformationMatrix\r\n                );     \r\n\r\n                handleResize(invTransformedPos[0], invTransformedPos[1]);\r\n                e.preventDefault();\r\n            }\r\n\r\n            if(currentGroupTransformationContainerBeingDragged !== null) {\r\n                const dx = (e.touches[0].pageX - self.getOffsetLeft()) - touchMoveLastX;\r\n                const dy = (e.touches[0].pageY - self.getOffsetTop()) - touchMoveLastY;\r\n\r\n                const invTransformedPos = MatrixMath.vecMat4Multiply(\r\n                    [dx, dy, 0, 1],\r\n                    currentInvTransformationMatrix\r\n                );                    \r\n\r\n                handleGroupTransformationContainerMove(invTransformedPos[0], invTransformedPos[1]);        \r\n                e.preventDefault();        \r\n            }\r\n\r\n            if(multiObjectSelectionStarted) {\r\n                updateSelectionBoxEndPoint(e.touches[0].pageX - self.getOffsetLeft(), e.touches[0].pageY - self.getOffsetTop());\r\n                e.preventDefault();\r\n            }\r\n\r\n            touchMoveLastX = e.touches[0].pageX - self.getOffsetLeft();\r\n            touchMoveLastY = e.touches[0].pageY - self.getOffsetTop();\r\n        });\r\n\r\n        _sheetDomElement.addEventListener('mousemove', function (e) {\r\n            if (objectIdBeingDragged !== null) {\t\t\r\n                const invTransformedPos = MatrixMath.vecMat4Multiply(\r\n                    [e.pageX - self.getOffsetLeft(), e.pageY - self.getOffsetTop(), 0, 1],\r\n                    currentInvTransformationMatrix\r\n                );                    \r\n\r\n                handleMove(invTransformedPos[0], invTransformedPos[1]);\r\n            }\r\n\r\n            if(objectIdBeingResized !== null) {\r\n                const invTransformedPos = MatrixMath.vecMat4Multiply(\r\n                    [e.pageX - self.getOffsetLeft(), e.pageY - self.getOffsetTop(), 0, 1],\r\n                    currentInvTransformationMatrix\r\n                );     \r\n\r\n                handleResize(invTransformedPos[0], invTransformedPos[1]);\r\n            }\r\n\r\n            if(currentGroupTransformationContainerBeingDragged !== null) {\r\n                const invTransformedPos = MatrixMath.vecMat4Multiply(\r\n                    [e.movementX, e.movementY, 0, 1],\r\n                    currentInvTransformationMatrix\r\n                );                    \r\n\r\n                handleGroupTransformationContainerMove(invTransformedPos[0], invTransformedPos[1]);                \r\n            }\r\n\r\n            if(multiObjectSelectionStarted) {\r\n                updateSelectionBoxEndPoint(e.pageX - self.getOffsetLeft(), e.pageY - self.getOffsetTop());\r\n            }\r\n        });\r\n\r\n        _sheetDomElement.addEventListener('touchend', function (e) {\r\n\r\n            // e.touches is empty..\r\n            // Need to use e.changedTouches for final x,y ???\r\n\r\n            if(objectIdBeingDragged !== null) {\r\n                objectIdBeingDragged = null;\r\n            }           \r\n            \r\n            if(objectIdBeingResized !== null) {\r\n                handleResizeEnd();\r\n            }\r\n\r\n            if(currentGroupTransformationContainerBeingDragged !== null) {\r\n                currentGroupTransformationContainerBeingDragged.endTranslate();\r\n                currentGroupTransformationContainerBeingDragged = null;\r\n            }            \r\n\r\n            if(multiObjectSelectionStarted) {\r\n                handleMultiEntitySelectionEnd();\r\n            }\r\n        });\r\n\r\n        _sheetDomElement.addEventListener('mouseup', function (e) {\r\n            if (e.which === 1) {\r\n                if(objectIdBeingDragged !== null) {\r\n\r\n                    const invTransformedPos = MatrixMath.vecMat4Multiply(\r\n                        [e.pageX - self.getOffsetLeft(), e.pageY - self.getOffsetTop(), 0, 1],\r\n                        currentInvTransformationMatrix\r\n                    );\r\n\r\n                    handleMoveEnd(invTransformedPos[0], invTransformedPos[1]);\r\n                }\r\n\r\n                if(objectIdBeingResized !== null) {\r\n                    handleResizeEnd();\r\n                }\r\n\r\n                if(currentGroupTransformationContainerBeingDragged !== null) {\r\n                    currentGroupTransformationContainerBeingDragged.endTranslate();\r\n                    currentGroupTransformationContainerBeingDragged = null;\r\n                }\r\n\r\n                if(multiObjectSelectionStarted) {\r\n                    handleMultiEntitySelectionEnd();\r\n                }\r\n\r\n                objectIdBeingDragged = null;\r\n                objectIdBeingResized = null;\r\n            }\r\n        });\r\n\r\n        _sheetDomElement.addEventListener('mousedown', function (e) {\r\n            // if we're dragging something, stop propagation\r\n            if(currentGroupTransformationContainerBeingDragged !== null || objectIdBeingDragged !== null || objectIdBeingResized !== null) {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n            }\r\n        });\r\n    };\r\n\r\n    const emitEvent = function(_eventName, _eventData) {\r\n        const allCallbacks = eventHandlers.get(_eventName) || [];\r\n\r\n        for(let i=0; i<allCallbacks.length; i++) {\r\n            const cbFunc = allCallbacks[i];\r\n            cbFunc(_eventData);\r\n        }\r\n    };\r\n\r\n    this.off = function(_eventName, _callback) {\r\n        const allCallbacks = eventHandlers.get(_eventName) || [];\r\n\r\n        for(let i=0; i<allCallbacks.length; i++) {\r\n            if(allCallbacks[i] === _callback) {\r\n                allCallbacks.splice(i, 1);\r\n                break;\r\n            }\r\n        }\r\n\r\n        eventHandlers.set(_eventName, allCallbacks);\r\n    };\r\n\r\n    this.on = function(_eventName, _callback) {\r\n        const allCallbacks = eventHandlers.get(_eventName) || [];\r\n        allCallbacks.push(_callback);\r\n        eventHandlers.set(_eventName, allCallbacks);\r\n    };\r\n\r\n    self.setGrid(new Grid(12.0, '#424242', GRID_STYLE.DOT));\r\n    self.resetTransform();\r\n    self.setTransformOrigin(0, 0);\r\n    self.setTransitionCss(transitionCss);\r\n};\r\n\r\nexport { Sheet };\r\n","import {EntityEvent} from './EntityEvent';\r\nimport {Point} from './Point';\r\nimport {Rectangle} from './Rectangle';\r\nimport {Sheet} from './Sheet';\r\nimport {ConnectorAnchor} from './ConnectorAnchor';\r\nimport { PointSet } from './PointSet';\r\n\r\n/**\r\n * \r\n * @param {String} _id\r\n * @param {Number} _x\r\n * @param {Number} _y\r\n * @param {Number} _width\r\n * @param {Number} _height\r\n * @param {Sheet} _sheet\r\n * @param {Element} _domElement\r\n * @param {Element[]} _translateHandleDomElements\r\n * @param {Element[]} _resizeHandleDomElements\r\n */\r\nfunction Entity(_id, _x, _y, _width, _height, _sheet, _domElement, _translateHandleDomElements, _resizeHandleDomElements) {\r\n    const self = this;\r\n\r\n    const MOUSE_MIDDLE_BUTTON = 1;\r\n\r\n    /**\r\n     * @type {ConnectorAnchor[]}\r\n     */\r\n    const connectorAnchors = [];\r\n\r\n    /**\r\n     * @type {Number}\r\n     */\r\n    var nextConnectorAnchorIdSuffix = 1000;\r\n\r\n    /**\r\n     * @type {Element}\r\n     */\r\n    var currentTranslateHandleElementActivated = null;\r\n\r\n    /**\r\n     * @type {Element}\r\n     */\r\n    var currentResizeHandleElementActivated = null;\r\n\r\n    const eventNameToHandlerFunc = new Map();\r\n\r\n    let x = null;\r\n    let y = null;\r\n    let width = null;\r\n    let height = null;\r\n\r\n    /**\r\n     * @param {Element} _connectorAnchorDomElement\r\n     * @returns {ConnectorAnchor}\r\n     */    \r\n    this.addNonInteractableConnectorAnchor = function(_connectorAnchorDomElement) {\r\n        const newAnchor = new ConnectorAnchor(_id + `-${nextConnectorAnchorIdSuffix}`, _connectorAnchorDomElement, _sheet);\r\n        connectorAnchors.push(newAnchor);\r\n        nextConnectorAnchorIdSuffix++;\r\n        return newAnchor;\r\n    };\r\n\r\n    /**\r\n     * @param {Element} _connectorAnchorDomElement\r\n     * @returns {ConnectorAnchor}\r\n     */    \r\n    this.addInteractableConnectorAnchor = function(_connectorAnchorDomElement) {     \r\n        const anchor = new ConnectorAnchor(_id + `-${nextConnectorAnchorIdSuffix}`, _connectorAnchorDomElement, _sheet);\r\n\r\n        _connectorAnchorDomElement.addEventListener('click', function(e) {\r\n            _sheet.addConnectionAnchorToSelectionStack(anchor);\r\n        });\r\n\r\n        connectorAnchors.push(anchor);\r\n        nextConnectorAnchorIdSuffix++;\r\n        return anchor;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Number} _gridSize \r\n     * @returns {Point[]}\r\n     */\r\n    this.getConnectorAnchorRoutingPoints = function(_gridSize) {\r\n        const allRoutingPoints = [];\r\n        connectorAnchors.forEach(function(_anchor) {\r\n            const anchorPoints = _anchor.getRoutingPoints(_gridSize);\r\n            anchorPoints.forEach(function(_pt) {\r\n                allRoutingPoints.push(_pt);\r\n            });\r\n        });\r\n\r\n        return allRoutingPoints;\r\n    };\r\n\r\n    /**\r\n     * @returns {ConnectorAnchor[]}\r\n     */\r\n    this.getConnectorAnchors = function() {\r\n        return connectorAnchors;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {ConnectorAnchor} _anchor \r\n     * @returns {Boolean}\r\n     */\r\n    this.hasConnectorAnchor = function(_anchor) {\r\n        const anchors = self.getConnectorAnchors();\r\n        for(let i=0; i<anchors.length; i++) {\r\n            if(anchors[i] === _anchor) {\r\n                return true;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    };\r\n\r\n    /**\r\n     * @returns {Point|null}\r\n     */    \r\n    this.getTranslateHandleOffset = function() {\r\n        if(currentTranslateHandleElementActivated) {\r\n            return new Point(\r\n                -(currentTranslateHandleElementActivated.offsetLeft + currentTranslateHandleElementActivated.offsetWidth * 0.5),\r\n                -(currentTranslateHandleElementActivated.offsetTop  + currentTranslateHandleElementActivated.offsetHeight * 0.5)\r\n            );\r\n        }\r\n\r\n        return null;\r\n    };\r\n\r\n    /**\r\n     * @returns {String}\r\n     */\r\n    this.getId = function() {\r\n        return _id;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getX = function() {\r\n        return x;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getY = function() {\r\n        return y;\r\n    };\r\n\r\n    /**\r\n     * @returns {Point}\r\n     */\r\n    this.getPositionOnPage = function() {\r\n        const window = _domElement.ownerDocument.defaultView;\r\n        const boundingRect = _domElement.getBoundingClientRect();\r\n        return new Point(boundingRect.left + window.scrollX, boundingRect.top + window.scrollY);\r\n    };\r\n\r\n    /**\r\n     * @param {Number} _x\r\n     * @param {Number} _y\r\n     */\r\n    this.translate = function(_x, _y) {\r\n\r\n        if(_x === x && _y === y) {\r\n            return;\r\n        }\r\n\r\n        x = _x;\r\n        y = _y;\r\n\r\n        _domElement.style.left = x + 'px';\r\n        _domElement.style.top = y + 'px';\r\n\r\n        const observers = eventNameToHandlerFunc.get(EntityEvent.TRANSLATE) || [];\r\n        observers.forEach(function(handler) {\r\n            handler({\"obj\":self, \"x\": _x, \"y\": _y});\r\n        });\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getWidth = function() {\r\n        return width;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getHeight = function() {\r\n        return height;\r\n    };\r\n\r\n    /**\r\n     * @param {Number} _width\r\n     * @param {Number} _height\r\n     * @param {Function} _domElementStyleUpdateOverrideFunc\r\n     */\r\n    this.resize = function(_width, _height, _domElementStyleUpdateOverrideFunc) {            \r\n        width = _width;\r\n        height = _height;\r\n\r\n        if(_domElementStyleUpdateOverrideFunc) {\r\n            _domElementStyleUpdateOverrideFunc(_domElement);\r\n        } else {\r\n            _domElement.style.width = width + 'px';\r\n            _domElement.style.height = height + 'px';\r\n        }\r\n\r\n        const observers = eventNameToHandlerFunc.get(EntityEvent.RESIZE) || [];\r\n        observers.forEach(function(handler) {\r\n            handler({\"obj\":self, \"width\": _width, \"height\": _height});\r\n        });\r\n    };\r\n\r\n    /**\r\n     * @returns {Element}\r\n     */\r\n    this.getDomElement = function() {\r\n        return _domElement;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {String} _eventName\r\n     * @param {*} _eventData\r\n     */\r\n    this.handleSiblingObjectChange = function(_eventName, _eventData) { \r\n\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @returns {Rectangle}\r\n     */\r\n    this.getBoundingRectange = function() {\r\n        const left = x;\r\n        const top = y;\r\n        const right = left + width;\r\n        const bottom = top + height;\r\n\r\n        return new Rectangle(left, top, right, bottom);\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @returns {Rectangle}\r\n     */\r\n    this.getBoundingRectangeInPageSpace = function() {\r\n        const pagePos = self.getPositionOnPage();\r\n        const left = pagePos.getX();\r\n        const top = pagePos.getY();\r\n        const right = left + width;\r\n        const bottom = top + height;\r\n        return new Rectangle(left, top, right, bottom);\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Rectangle} _rectInPageSpace\r\n     * @returns {Rectangle}\r\n     */\r\n    this.computePageToEntitySpaceTransformedRectangle = function(_rectInPageSpace) {\r\n        const noteBoundingRect = self.getBoundingRectangeInPageSpace();\r\n        const rectRelativeToNote = new GraphPaper.Rectangle(\r\n            _rectInPageSpace.getLeft() - noteBoundingRect.getLeft(),\r\n            _rectInPageSpace.getTop() - noteBoundingRect.getTop(),\r\n            _rectInPageSpace.getRight() - noteBoundingRect.getRight(),\r\n            _rectInPageSpace.getBottom() - noteBoundingRect.getBottom()\r\n        );\r\n\r\n        return rectRelativeToNote;\r\n    };\r\n\r\n    /**\r\n     * @returns {Point[]}\r\n     */\r\n    this.getBoundingPoints = function() {\r\n        const topLeft = new Point(self.getX(), self.getY());\r\n        const topRight = new Point(self.getX() + self.getWidth(), self.getY());\r\n        const bottomLeft = new Point(self.getX(), self.getY() + self.getWidth());\r\n        const bottomRight = new Point(self.getX() + self.getWidth(), self.getY() + self.getWidth());\r\n\r\n        return [\r\n            topLeft,\r\n            topRight,\r\n            bottomLeft,\r\n            bottomRight\r\n        ];\r\n    };\r\n\r\n    /**\r\n     * @param {Number} _gridSize\r\n     * @returns {Object}\r\n     */\r\n    this.getDescriptor = function(_gridSize) {\r\n        const anchors = [];\r\n        for(let i=0; i<connectorAnchors.length; i++) {\r\n            let routingPoints = new PointSet(self.getConnectorAnchorRoutingPoints(_gridSize));\r\n            anchors.push(\r\n                {\r\n                    \"id\": connectorAnchors[i].getId(),\r\n                    \"routingPointsFloat64Arr\": routingPoints.toFloat64Array()\r\n                }\r\n            );\r\n        }\r\n\r\n        return {\r\n            \"id\": self.getId(),\r\n            \"x\": self.getX(),\r\n            \"y\": self.getY(),\r\n            \"width\": self.getWidth(),\r\n            \"height\": self.getHeight(),\r\n            \"connectorAnchors\": anchors\r\n        }\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {String} _eventName \r\n     * @param {*} _handlerFunc \r\n     */\r\n    this.on = function(_eventName, _handlerFunc) {\r\n        const allHandlers = eventNameToHandlerFunc.get(_eventName) || [];\r\n        allHandlers.push(_handlerFunc);\r\n        eventNameToHandlerFunc.set(_eventName, allHandlers);    \r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {String} _eventName \r\n     * @param {*} _callback \r\n     */\r\n    this.off = function(_eventName, _callback) {\r\n        const allCallbacks = eventNameToHandlerFunc.get(_eventName) || [];\r\n\r\n        for(let i=0; i<allCallbacks.length; i++) {\r\n            if(allCallbacks[i] === _callback) {\r\n                allCallbacks.splice(i, 1);\r\n                break;\r\n            }\r\n        }\r\n\r\n        eventNameToHandlerFunc.set(_eventName, allCallbacks);\r\n    };\r\n\r\n    this.suspendTranslateInteractions = function() {\r\n        unbindTranslateHandleElements();\r\n    };\r\n\r\n    this.resumeTranslateInteractions = function() {\r\n        bindTranslateHandleElements();\r\n    };\r\n\r\n    const translateTouchStartHandler = function(e) {\r\n        currentTranslateHandleElementActivated = e.target;\r\n\r\n        const observers = eventNameToHandlerFunc.get(EntityEvent.TRANSLATE_START) || [];\r\n        observers.forEach(function(handler) {\r\n            handler({\r\n                \"obj\": self,\r\n                \"x\": e.touches[0].pageX, \r\n                \"y\": e.touches[0].pageY,\r\n                \"isTouch\": true\r\n            });\r\n        });        \r\n\r\n    };\r\n\r\n    const translateMouseDownHandler = function(e) {\r\n        currentTranslateHandleElementActivated = e.target;\r\n        \r\n        const observers = eventNameToHandlerFunc.get(EntityEvent.TRANSLATE_START) || [];\r\n        observers.forEach(function(handler) {\r\n            handler({\r\n                \"obj\": self,\r\n                \"x\": e.pageX, \r\n                \"y\": e.pageY,\r\n                \"isTouch\": false\r\n            });\r\n        });        \r\n        \r\n    };\r\n\r\n    const unbindTranslateHandleElements = function() {\r\n        _translateHandleDomElements.forEach((_el) => {\r\n            _el.removeEventListener('touchstart', translateTouchStartHandler);        \r\n            _el.removeEventListener('mousedown', translateMouseDownHandler);\r\n        });\r\n    };\r\n\r\n    const bindTranslateHandleElements = function() {\r\n        _translateHandleDomElements.forEach((_el) => {\r\n            _el.addEventListener('touchstart', translateTouchStartHandler);        \r\n            _el.addEventListener('mousedown', translateMouseDownHandler);\r\n        });\r\n    };\r\n\r\n    const resizeMouseDownHandler = function(_e, _triggeredByElement, _resizeCursor) {\r\n        if (_e.which !== MOUSE_MIDDLE_BUTTON) {\r\n            return;\r\n        }\r\n\r\n        currentResizeHandleElementActivated = _triggeredByElement;\r\n        \r\n        const observers = eventNameToHandlerFunc.get(EntityEvent.RESIZE_START) || [];\r\n        observers.forEach(function(handler) {\r\n            handler({\r\n                \"obj\": self,\r\n                \"x\": _e.pageX, \r\n                \"y\": _e.pageY,\r\n                \"resizeCursor\": _resizeCursor,\r\n                \"isTouch\": false\r\n            });\r\n        });    \r\n    };\r\n\r\n    const resizeTouchStartHandler = function(_e, _triggeredByElement, _resizeCursor) {\r\n        currentResizeHandleElementActivated =_triggeredByElement;\r\n        \r\n        const observers = eventNameToHandlerFunc.get(EntityEvent.RESIZE_START) || [];\r\n        observers.forEach(function(handler) {\r\n            handler({\r\n                \"obj\": self,\r\n                \"x\": _e.touches[0].pageX,  \r\n                \"y\": _e.touches[0].pageY,\r\n                \"resizeCursor\": _resizeCursor,\r\n                \"isTouch\": true\r\n            });\r\n        });\r\n    };\r\n\r\n    const bindResizeHandleElements = function() {\r\n        _resizeHandleDomElements.forEach((_el) => {\r\n            const cursor = window.getComputedStyle(_el)['cursor'];\r\n\r\n            _el.addEventListener('touchstart', (e) => {\r\n                resizeTouchStartHandler(e, _el, cursor);\r\n            });\r\n\r\n            _el.addEventListener('mousedown', (e) => {\r\n                resizeMouseDownHandler(e, _el, cursor);\r\n            });  \r\n        });\r\n    };\r\n\r\n\r\n    bindTranslateHandleElements();\r\n    bindResizeHandleElements();\r\n    self.translate(_x, _y);\r\n    self.resize(_width, _height);\r\n};\r\n\r\nexport { Entity };\r\n","import {Entity} from './Entity';\r\nimport {GroupTransformationContainerEvent} from './GroupTransformationContainerEvent';\r\n\r\n/**\r\n * @param {Sheet} _sheet\r\n * @param {Entity[]} _entities\r\n * @param {String[]} _containerStyleCssClasses\r\n * @param {Number} _sizeAdjustmentPx\r\n */\r\nfunction GroupTransformationContainer(_sheet, _entities, _containerStyleCssClasses, _sizeAdjustmentPx)  {\r\n    const self = this;\r\n    const eventNameToHandlerFunc = new Map();\r\n\r\n    const calculateBoundingRect = function() {\r\n        var r = _sheet.calcBoundingRectForEntities(_entities);\r\n        if(_sizeAdjustmentPx) {\r\n            r = r.getUniformlyResizedCopy(_sizeAdjustmentPx);\r\n        }\r\n\r\n        return r;\r\n    };\r\n\r\n    var boundingRect = calculateBoundingRect();\r\n\r\n    var accTranslateX = 0.0;\r\n    var accTranslateY = 0.0;    \r\n\r\n    var currentLeft = boundingRect.getLeft();\r\n    var currentTop = boundingRect.getTop();\r\n\r\n    const entityPositionRelativeToBoundingRect = [];\r\n\r\n    _entities.forEach(function(_obj) {\r\n        const rp = {\r\n            \"x\": _obj.getX() - currentLeft,\r\n            \"y\": _obj.getY() - currentTop\r\n        };\r\n\r\n        entityPositionRelativeToBoundingRect.push(rp);\r\n    });\r\n\r\n    const selBox = window.document.createElement(\"div\");\r\n    selBox.classList.add('ia-group-transformation-container');\r\n    selBox.style.display = \"none\";\r\n    selBox.style.position = \"absolute\";\r\n    selBox.style.left = `${currentLeft}px`;\r\n    selBox.style.top = `${currentTop}px`;\r\n    selBox.style.width = `${boundingRect.getWidth()}px`;\r\n    selBox.style.height = `${boundingRect.getHeight()}px`;    \r\n\r\n    // only display the container if we have 1+ entity in the group\r\n    if(_entities.length > 0) {\r\n        selBox.style.display = \"block\";\r\n    }\r\n\r\n    if(typeof _containerStyleCssClasses === 'undefined' || _containerStyleCssClasses.length === 0) {\r\n        // default styling if no classes are provided\r\n        selBox.style.border = \"1px solid rgb(158, 158, 158)\";\r\n        selBox.style.backgroundColor = \"rgba(153, 153, 153, 0.5)\";       \r\n    } else {\r\n        // CSS classes will control styling for things GraphPaper doesn't care about\r\n        // (GraphPaper style concerns are handled via inline styles which will always take precedance)\r\n        _containerStyleCssClasses.forEach(function(_class) {\r\n            selBox.classList.add(_class);\r\n        });\r\n    }\r\n\r\n\r\n    this.getContainerDomElement = function() {\r\n        return selBox;\r\n    };\r\n    \r\n    /**\r\n     * @returns {Entity[]}\r\n     */\r\n    this.getEntities = function() {\r\n        return _entities;\r\n    };\r\n\r\n    /**\r\n     * @param {Number} _dx\r\n     * @param {Number} _dy\r\n     */\r\n    this.translateByOffset = function(_dx, _dy) {\r\n        accTranslateX += _dx;\r\n        accTranslateY += _dy;\r\n\r\n        currentLeft = _sheet.snapToGrid(boundingRect.getLeft() + accTranslateX);\r\n        currentTop = _sheet.snapToGrid(boundingRect.getTop() + accTranslateY);\r\n        selBox.style.left = `${currentLeft}px`;\r\n        selBox.style.top = `${currentTop}px`;        \r\n\r\n        for(let i=0; i<_entities.length; i++) {\r\n            const obj = _entities[i];\r\n            const rp = entityPositionRelativeToBoundingRect[i];\r\n\r\n            obj.translate(\r\n                _sheet.snapToGrid(currentLeft + rp.x), \r\n                _sheet.snapToGrid(currentTop + rp.y)\r\n            );\r\n        }\r\n    };\r\n\r\n    this.endTranslate = function() {\r\n        accTranslateX = 0.0;\r\n        accTranslateY = 0.0;\r\n        boundingRect = calculateBoundingRect();\r\n    };\r\n\r\n    this.initTranslateInteractionHandler = function() {\r\n        selBox.addEventListener('touchstart', translateTouchStartHandler);        \r\n        selBox.addEventListener('mousedown', translateMouseDownHandler);\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {String} _eventName \r\n     * @param {*} _handlerFunc \r\n     */\r\n    this.on = function(_eventName, _handlerFunc) {\r\n        const allHandlers = eventNameToHandlerFunc.get(_eventName) || [];\r\n        allHandlers.push(_handlerFunc);\r\n        eventNameToHandlerFunc.set(_eventName, allHandlers);        \r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {String} _eventName \r\n     * @param {*} _callback \r\n     */\r\n    this.off = function(_eventName, _callback) {\r\n        const allCallbacks = eventNameToHandlerFunc.get(_eventName) || [];\r\n\r\n        for(let i=0; i<allCallbacks.length; i++) {\r\n            if(allCallbacks[i] === _callback) {\r\n                allCallbacks.splice(i, 1);\r\n                break;\r\n            }\r\n        }\r\n\r\n        eventNameToHandlerFunc.set(_eventName, allCallbacks);\r\n    };\r\n\r\n    const translateTouchStartHandler = function(e) {\r\n        const observers = eventNameToHandlerFunc.get(GroupTransformationContainerEvent.TRANSLATE_START) || [];\r\n        observers.forEach(function(handler) {\r\n            handler({\r\n                \"container\": self,\r\n                \"x\": e.touches[0].pageX, \r\n                \"y\": e.touches[0].pageY,\r\n                \"isTouch\": true\r\n            });\r\n        });        \r\n\r\n    };\r\n\r\n    const translateMouseDownHandler = function(e) {       \r\n        const observers = eventNameToHandlerFunc.get(GroupTransformationContainerEvent.TRANSLATE_START) || [];\r\n        observers.forEach(function(handler) {\r\n            handler({\r\n                \"container\": self,\r\n                \"x\": e.pageX, \r\n                \"y\": e.pageY,\r\n                \"isTouch\": false\r\n            });\r\n        });        \r\n        \r\n    };    \r\n};\r\n\r\nexport {GroupTransformationContainer}\r\n","/**\r\n * \r\n * @param {String} _id \r\n */\r\nfunction Cluster(_id) {\r\n\r\n    const self = this;\r\n\r\n    /**\r\n     * @type {Entity[]}\r\n     */\r\n    const entities = [];\r\n\r\n    /**\r\n     * @returns {String}\r\n     */\r\n    this.getId = function() {\r\n        return _id;\r\n    };\r\n\r\n    /**\r\n     * @param {Entity} _obj\r\n     * @returns {Number|null}\r\n     */\r\n    this.getEntityIndex = function(_entity) {\r\n        return self.getEntityIndexById(_entity.getId());\r\n    };\r\n\r\n    /**\r\n     * @param {String} _objId\r\n     * @returns {Number|null}\r\n     */\r\n    this.getEntityIndexById = function(_entityId) {\r\n        for(let i=0; i<entities.length; i++) {\r\n            if(entities[i].getId() === _entityId) {\r\n                return i;\r\n            }\r\n        }\r\n\r\n        return null;\r\n    };\r\n\r\n    /**\r\n     * @param {Entity} _o\r\n     * @returns {Boolean}\r\n     */\r\n    this.addEntity = function(_entity) {\r\n        if(self.getEntityIndex(_entity) !== null) {\r\n            return false;\r\n        }\r\n\r\n        entities.push(_entity);\r\n        return true;\r\n    };\r\n\r\n    /**\r\n     * @returns {Entity[]}\r\n     */\r\n    this.getEntities = function() {\r\n        return entities;\r\n    };\r\n\r\n    /**\r\n     * @returns {String[]}\r\n     */\r\n    this.getEntityIds = function() {\r\n        const ids = [];\r\n        entities.forEach(function(_o) {\r\n            ids.push(_o.getId());\r\n        });\r\n\r\n        return ids;\r\n    };    \r\n\r\n    /**\r\n     * @param {String} _id\r\n     * @returns {Boolean}\r\n     */\r\n    this.removeEntityById = function(_id) {\r\n        const idx = self.getEntityIndexById(_id);\r\n        if(idx === null) {\r\n            return false;\r\n        }\r\n\r\n        entities.splice(idx, 1);\r\n        return true;\r\n    };\r\n\r\n    this.removeAllEntities = function() {\r\n        entities.length = 0;\r\n    };\r\n};\r\n\r\nexport { Cluster };\r\n","import {Rectangle} from './Rectangle';\r\nimport {Entity} from './Entity';\r\nimport {Cluster} from './Cluster';\r\n\r\nfunction BoxClusterDetector(_boxExtentOffset) {\r\n    const self = this;\r\n\r\n    /**\r\n     * \r\n     * @param {Entity} _entity \r\n     * @param {Entity[]} _sheetEntitiesArray \r\n     * @returns {Number}\r\n     */\r\n    const getEntityIndexFromArray = function(_entity, _sheetEntitiesArray) {\r\n        for(let i=0; i<_sheetEntitiesArray.length; i++) {\r\n            if(_sheetEntitiesArray[i].getId() === _entity.getId()) {\r\n                return i;\r\n            }\r\n        }\r\n\r\n        return -1;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Entity[]} _entities \r\n     * @param {Entity[]} _sheetEntitiesArray \r\n     * @returns {Entity[]}\r\n     */\r\n    const removeEntitiesFromArray = function(_entities, _sheetEntitiesArray) {\r\n        for(let i=0; i<_entities.length; i++) {\r\n            const idx = getEntityIndexFromArray(_entities[i], _sheetEntitiesArray);\r\n            if(idx !== -1) {\r\n                _sheetEntitiesArray.splice(idx, 1);\r\n            }\r\n        }\r\n\r\n        return _sheetEntitiesArray;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Map<Cluster, Number>} _clusterToEntityCountMap \r\n     * @returns {Cluster}\r\n     */\r\n    const getClusterWithMostEntitiesFromClusterMap = function(_clusterToEntityCountMap) {\r\n        var curMaxObjs = 0;\r\n        var curClusterWithMax = null;\r\n\r\n        _clusterToEntityCountMap.forEach(function(_numObjs, _cluster, _map) {\r\n            if(_numObjs > curMaxObjs) {\r\n                curMaxObjs = _numObjs;\r\n                curClusterWithMax = _cluster;\r\n            }\r\n        });\r\n\r\n        return curClusterWithMax;\r\n    };\r\n\r\n    /**\r\n     * @param {Map<Cluster, Number>} _clusterToEntityCountMap \r\n     * @returns {Cluster[]}\r\n     */\r\n    const getClusterArrayFromClusterMap = function(_clusterToEntityCountMap) {\r\n        const resultSet = [];\r\n        _clusterToEntityCountMap.keys().forEach(function(_cluster) {\r\n            resultSet.push(_cluster);\r\n        });\r\n\r\n        return resultSet;\r\n    };\r\n\r\n    /**\r\n     * @param {Entity} _objA\r\n     * @param {Entity} _objB\r\n     * @returns {Boolean}\r\n     */\r\n    this.areEntitiesClose = function(_entityA, _entityB) {\r\n        const nA = new Rectangle(\r\n            _entityA.getX() - _boxExtentOffset, \r\n            _entityA.getY() - _boxExtentOffset, \r\n            _entityA.getX() + _entityA.getWidth() + _boxExtentOffset, \r\n            _entityA.getY() + _entityA.getHeight() + _boxExtentOffset\r\n        );\r\n\r\n        const nB = new Rectangle(\r\n            _entityB.getX() - _boxExtentOffset, \r\n            _entityB.getY() - _boxExtentOffset, \r\n            _entityB.getX() + _entityB.getWidth() + _boxExtentOffset, \r\n            _entityB.getY() + _entityB.getHeight() + _boxExtentOffset\r\n        );\r\n        \r\n        return nA.checkIntersect(nB);\r\n    };\r\n   \r\n    /**\r\n     * @param {Entity} _obj\r\n     * @param {Entity[]} _entitiesUnderConsideration\r\n     * @returns {Entity[]}\r\n     */\r\n    this.getAllEntitiesCloseTo = function(_entity, _entitiesUnderConsideration) {\r\n        const resultSet = [];\r\n        for(let i=0; i<_entitiesUnderConsideration.length; i++) {\r\n            if(_entity.getId() === _entitiesUnderConsideration[i].getId()) {\r\n                continue;\r\n            }\r\n\r\n            if(self.areEntitiesClose(_entity, _entitiesUnderConsideration[i])) {\r\n                resultSet.push(_entitiesUnderConsideration[i]);\r\n            }\r\n        }\r\n\r\n        return resultSet;\r\n    };\r\n\r\n    /**\r\n     * @param {Entity} _seedObj\r\n     * @param {Entity[]} _entitiesUnderConsideration\r\n     * @param {Entity[]} _resultSet\r\n     */\r\n    this.getClusterEntitiesFromSeed = function(_seedEntity, _entitiesUnderConsideration, _resultSet) {\r\n        const closeByEntities = self.getAllEntitiesCloseTo(_seedEntity, _entitiesUnderConsideration);\r\n        if(closeByEntities.length === 0) {\r\n            return [];\r\n        } else {\r\n            removeEntitiesFromArray(closeByEntities.concat([_seedEntity]), _entitiesUnderConsideration);\r\n\r\n            closeByEntities.forEach(function(_o) {\r\n                _resultSet.push(_o);\r\n                self.getClusterEntitiesFromSeed(_o, _entitiesUnderConsideration, _resultSet);\r\n            });\r\n        }\r\n    };\r\n\r\n    /**\r\n     * @param {Entity[]} _entities\r\n     * @param {Cluster[]} _clusters\r\n     * @returns {Map<Cluster,Number>}\r\n     */\r\n    this.findIntersectingClustersForEntities = function(_entities, _clusters) {\r\n        // Map of Cluster that is intersecting to number of entities in _objs that is intersecting the given Cluster\r\n        const intersectingClusterToNumEntitiesIntersecting = new Map();\r\n\r\n        _clusters.forEach(function(_cluster) {\r\n            const clusterEntities = _cluster.getEntities();\r\n\r\n            for(let i=0; i<clusterEntities.length; i++) {\r\n                for(let j=0; j<_entities.length; j++) {\r\n\r\n                    if(clusterEntities[i].getId() !== _entities[j].getId()) {\r\n                        continue;\r\n                    }\r\n\r\n                    if(intersectingClusterToNumEntitiesIntersecting.has(_cluster)) {\r\n                        const count = intersectingClusterToNumEntitiesIntersecting.get(_cluster);\r\n                        intersectingClusterToNumEntitiesIntersecting.set(_cluster, count+1);\r\n                    } else {\r\n                        intersectingClusterToNumEntitiesIntersecting.set(_cluster, 1);\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        return intersectingClusterToNumEntitiesIntersecting;\r\n    };\r\n\r\n    /**\r\n     * @param {Entity} _entity\r\n     * @param {Cluster[]} _clusters\r\n     */\r\n    this.removeEntityFromClusters = function(_entity, _clusters) {\r\n        _clusters.forEach(function(_c) {\r\n            _c.removeEntityById(_entity.getId());\r\n        });\r\n    };\r\n\r\n    /**\r\n     * @param {Entity[]} _entities\r\n     * @param {Cluster[]} _knownClusters\r\n     * @param {Function} _getNewIdFunc\r\n     */\r\n    this.computeClusters = function(_entities, _knownClusters, _getNewIdFunc) {\r\n        const clusters = _knownClusters.map(function(_c) {\r\n            return _c;\r\n        });\r\n\r\n        const entitiesUnderConsideration = _entities.map(function(_o) {\r\n            return _o;\r\n        });\r\n\r\n        while(entitiesUnderConsideration.length > 0) {\r\n            const entity = entitiesUnderConsideration.pop();\r\n\r\n            const entitiesForCluster = [entity];\r\n            self.getClusterEntitiesFromSeed(entity, entitiesUnderConsideration, entitiesForCluster);\r\n\r\n            if(entitiesForCluster.length > 1) {\r\n\r\n                const intersectingClusterToNumEntitiesIntersecting = self.findIntersectingClustersForEntities(entitiesForCluster, clusters);\r\n\r\n                if(intersectingClusterToNumEntitiesIntersecting.size === 0) {\r\n                    const newCluster = new Cluster(_getNewIdFunc());\r\n                    entitiesForCluster.forEach(function(_clusterEntity) {\r\n                        newCluster.addEntity(_clusterEntity);\r\n                    });    \r\n\r\n                    clusters.push(newCluster);\r\n                } else {\r\n                    const clusterToModify = getClusterWithMostEntitiesFromClusterMap(intersectingClusterToNumEntitiesIntersecting);\r\n\r\n                    // Clear out entities in cluster\r\n                    clusterToModify.removeAllEntities();\r\n\r\n                    // Remove entity from any cluster it's currently in, add it to clusterToModify\r\n                    entitiesForCluster.forEach(function(_clusterEntity) {\r\n                        self.removeEntityFromClusters(_clusterEntity, clusters);                    \r\n                        clusterToModify.addEntity(_clusterEntity);\r\n                    });\r\n\r\n                }\r\n\r\n                removeEntitiesFromArray(entitiesForCluster, entitiesUnderConsideration);\r\n                \r\n            } else {\r\n                self.removeEntityFromClusters(entity, clusters);\r\n            }\r\n        }\r\n\r\n        // Filter out clusters w/o any entities\r\n        const nonEmptyClusters = clusters.filter(function(_c) {\r\n            if(_c.getEntities().length >= 2) {\r\n                return true;\r\n            }\r\n\r\n            return false;\r\n        });\r\n\r\n        return nonEmptyClusters;\r\n    };\r\n};\r\n\r\nexport { BoxClusterDetector };\r\n"],"names":["MatrixMath","mat4Multiply","_a","_b","result","i","sum","j","k","vecMat4Multiply","_v","_m","vi","Point","_x","_y","__x","__y","prototype","getX","getY","isEqual","_otherPoint","getCartesianPoint","_sheetWidth","_sheetHeight","toString","toArray","fromArray","_arr","LINE_INTERSECTION_TYPE","Object","freeze","PARALLEL","COINCIDENT","LINE","LINESEG","LineIntersection","_type","_intersectionPoint","getType","getIntersectionPoint","Line","_startPoint","_endPoint","__startPoint","__endPoint","getStartPoint","getEndPoint","_otherLine","getLength","Math","sqrt","pow","getDirection","dx","dy","len","createShortenedLine","startReduceByPx","endReduceByPx","dir","computeIntersectionType","thisLineStartPointX","thisLineStartPointY","thisLineEndPointX","thisLineEndPointY","otherLineStartPointX","otherLineStartPointY","otherLineEndPointX","otherLineEndPointY","paramDenom","paramANumer","paramBNumer","paramA","paramB","computeIntersection","xIntersect","yIntersect","SvgPathBuilder","pointToLineTo","_pt","_ptIndex","pointTripletToTesselatedCurvePoints","_points","_curvaturePx","length","Error","controlPoint","lineA","lineB","lineAShortened","lineBShortened","pointsToPath","svgPathParts","ptIdx","ptA","shift","ptB","ptC","newPts","unshift","push","pt","p","join","Dimensions","_width","_height","getWidth","getHeight","Rectangle","_left","_top","_right","_bottom","getLeft","getTop","getRight","getBottom","getPoints","getLines","getUniformlyResizedCopy","_resizeByPx","getPointsScaledToGrid","_gridSize","centroid","scaleDx","scaleDy","scaledPoints","checkIntersect","_otherRectangle","checkIsPointWithin","_point","checkIsWithin","GroupTransformationContainerEvent","TRANSLATE_START","EntityEvent","TRANSLATE","RESIZE_START","RESIZE","PointSet","_pointsInput","self","points","_newPoint","pushPointSet","_ps","possibleNewPoints","findPointClosestTo","resultPoint","currentMinLength","Number","MAX_SAFE_INTEGER","forEach","lineToPt","findDistanceToPointClosestTo","findPointsCloseTo","_radius","resultSet","toFloat64Array","Float64Array","fromFloat64Array","_float64Array","count","Array","isArray","call","AccessibleRoutingPointsFinder","find","_subjectEntities","_occludableByEntities","connectorAnchorToNumValidRoutingPoints","Map","allRoutingPoints","filteredRoutingPoints","_entity","anchors","getConnectorAnchors","routingPoints","getRoutingPoints","_rp","set","getId","isPointWithinObj","occluder","boundingRect","getBoundingRectange","routingPoint","currentNumRoutingPoints","get","parentAnchor","SheetEvent","DBLCLICK","CLICK","CONNECTOR_UPDATED","ENTITY_ADDED","ENTITY_REMOVED","ENTITY_RESIZED","ENTITY_TRANSLATED","MULTIPLE_ENTITY_SELECTION_STARTED","MULTIPLE_ENTITIES_SELECTED","ConnectorAnchor","_id","_domElement","_sheet","getDimensions","r","transformDomRectToPageSpaceRect","getBoundingClientRect","getCentroid","sheetOffset","getSheetOffset","pageSpaceRect","halfWidth","halfHeight","dimensions","ClosestPairFinder","findClosestPairBetweenObjects","_objA","_objB","_connectorAnchorToNumValidRoutingPoints","objAConnectorAnchors","objBConnectorAnchors","startAnchorIdxWithMinDist","endAnchorIdxWithMinDist","minDist","MAX_VALUE","x","aCentroid","objANumValidRoutingPoints","y","bCentroid","d","objBNumValidRoutingPoints","DebugMetricsPanel","_window","debugPanelElem","isVisible","init","document","createElement","classList","add","style","display","position","right","top","width","height","color","padding","backgroundColor","body","appendChild","show","hide","refresh","_metrics","innerHTML","refreshAllConnectorsInternal","executionTime","accessibleRoutingPointsFinder","connectorRoutingWorker","msgDecodeTime","pointVisibilityMapCreationTime","allPathsComputationTime","numRoutingPoints","numBoundaryLines","connectorsRefreshTime","DoubleTapDetector","_dblTapSpeed","_dblTapRadius","dblTapDetectVars","lastTouchX","lastTouchY","lastTouchTime","dblTapSpeed","dblTapRadius","processTap","_touchEndEvent","_sheetPageOffset","_currentInvTransformationMatrix","changedTouches","invTransformedPos","pageX","pageY","dblTapDetected","now","Date","getTime","timeSinceLastTouch","lastX","lastY","distFromLastTouch","LineSet","_linesInput","lines","_newLine","ConnectorEvent","MOUSE_ENTER","MOUSE_LEAVE","ConnectorRoutingAlgorithm","STRAIGHT_LINE","STRAIGHT_LINE_BETWEEN_ANCHORS","STRAIGHT_LINE_BETWEEN_ANCHORS_AVOID_SELF_INTERSECTION","ASTAR","ASTAR_WITH_ROUTE_OPTIMIZATION","Connector","_anchorStart","_anchorEnd","_containerDomElement","_strokeColor","_strokeWidth","_routingAlgorithm","eventNameToHandlerFunc","markerStartSize","markerEndSize","pathPoints","pathElem","window","createElementNS","setAttribute","stroke","strokeWidth","addEventListener","e","dispatchEvent","svgDomElem","appendPathToContainerDomElement","setMarkerStart","_url","_size","unsetMarkerStart","removeAttribute","setMarkerEnd","unsetMarkerEnd","getPathPoints","getPathLines","totalLength","pathLines","getMidpoint","lengthSoFar","curPathLineWithMidpoint","pathLineLength","lengthBeforeCur","midOnCurPath","getMidpointDirection","_svgPath","_pathPoints","anchorIds","sort","getAnchorStart","getAnchorEnd","removePathElement","remove","addClassToDomElement","_cl","removeClassFromDomElement","getDescriptor","on","_eventName","_handlerFunc","allHandlers","off","_callback","allCallbacks","splice","_eventId","_eventData","observers","handler","PointVisibilityMapRouteOptimizer","optimize","_pointsInRoute","_arePointsVisibleToEachOther","start","end","PointVisibilityMap","_freePoints","_boundaryLines","_precomputedPointToVisibleSet","boundaryLinesArr","freePointsArr","pointToVisibleSet","doesLineIntersectAnyBoundaryLines","_theLine","intersectionType","b","initPointsVisibility","computePointsVisibilityForIndex","_idx","ijLine","arePointsVisibleToEachOther","_ptA","_ptB","visiblePointIndices","getVisiblePointsRelativeTo","_pointIndex","isPointInArray","_needle","_haystack","routeToEndpoint","_currentRouteLength","_currentPointIndex","visiblePt","currentPoint","curMinCost","visiblePointWithMinCost","visiblePointWithMinCostIndex","gn","hn","getPointToVisibleSetData","currentMaxLength","_ptKey","lineOfSight","findVisiblePointClosestTo","_freePt","lineOfSightLength","findVisiblePointIndexClosestTo","resultPointIndex","freePt","computeRoute","_optimizeRoute","firstRoutingPointIndex","routeSegment","currentRouteLen","firstRoutingPoint","pointsInRoute","currentPointIndex","lastSegmentToEndpoint","point","pointIndex","GRID_STYLE","DOT","Grid","_color","_style","getSize","getStyle","getSvgImageTile","ConnectorRoutingWorkerJsString","Sheet","_sheetDomElement","svgElem","connectorsContainerDomElement","selectionBoxElem","groupTransformationContainers","currentGroupTransformationContainerBeingDragged","grid","transitionCss","transformOriginX","transformOriginY","touchMoveLastX","touchMoveLastY","translateX","translateY","scaleFactor","invScaleFactor","invTransformationMatrixStack","currentInvTransformationMatrix","currentTransformationMatrix","currentPointVisibilityMap","connectorRefreshBufferTime","sheetEntities","objectConnectors","objectIdBeingDragged","objectIdBeingResized","objectResizeCursor","objectDragX","objectDragY","objectDragStartX","objectDragStartY","doubleTapDetector","debugMetricsPanel","metrics","touchHoldDelayTimeMs","touchHoldStartInterval","multiObjectSelectionStartX","multiObjectSelectionStartY","multiObjectSelectionEndX","multiObjectSelectionEndY","multiObjectSelectionStarted","connectorAnchorsSelected","isDomMetricsLockActive","sheetOffsetLeft","sheetOffsetTop","sheetPageScrollXOffset","sheetPageScrollYOffset","eventHandlers","connectorRefreshStartTime","connectorRefreshTimeout","workerUrl","URL","createObjectURL","Blob","Worker","convertArrayBufferToFloat64Array","_ab","onmessage","_msg","connectorsRefreshTimeT1","data","boundaryLines","pointVisibilityMapData","connectorDescriptors","getConnectorDescriptorById","id","_c","descriptor","ps","pointsInPath","svgPath","emitEvent","overallTime","setGrid","_grid","backgroundImage","btoa","backgroundRepeat","getGrid","getGridSize","lockDomMetrics","offsetLeft","offsetTop","pageXOffset","pageYOffset","unlockDomMetrics","hasDomMetricsLock","getEntityExtentRoutingPoints","pointSet","_obj","_sp","getConnectorRoutingPointsAroundAnchor","executionTimeT1","routingPointsResult","accessibleRoutingPoints","getConnectorBoundaryLines","_l","_anchor","entityDescriptors","_e","routingPointsAroundAnchor","entityExtentRoutingPoints","routingPointsAroundAnchorFloat64Array","routingPointsFloat64Array","boundaryLinesFloat64Array","postMessage","buffer","setConnectorRefreshBufferTime","_bufferTimeMs","refreshAllConnectors","tdelta","setTimeout","makeNewConnector","setConnectorFactory","_newConnectorFactory","getTransitionCss","setTransitionCss","_css","transition","getTransformOriginX","getTransformOriginY","getScaleFactor","getTranslateX","getTranslateY","setTransformOrigin","transformOrigin","scale","_scaleFactor","_adjustFactorToPreserveIntegerGrid","newGridSize","roundedGridSize","round","scaleMat","translate","translateMatrix","applyTransform","transform","getTransformMatrixCss","getTransformMatrix","matElems","_domRect","pageOffset","getPageOffset","left","bottom","invTransformedPosLeftTop","invTransformedPosRightBottom","resetTransform","snapToGrid","_p","ret","max","getOffsetLeft","getOffsetTop","offsetWidth","offsetHeight","calcBoundingRectForEntities","_entities","minTop","minLeft","maxBottom","maxRight","index","array","objRect","calcBoundingBox","getEntitiesAroundPoint","ptRect","getEntitiesWithinRect","_rect","getAllEntities","publishSiblingObjectChange","handleSiblingObjectChange","getEntityById","foundEntity","obj","addEntity","handleResizeStart","handleMoveStart","removeEntity","_entityId","getConnector","c","getAllConnectors","getConnectorsBetweenEntities","_entityA","_entityB","foundConnectors","_conn","aS","aE","hasConnectorAnchor","getConnectorsInEntitySet","_entitySet","connectorsBetween","getEntitiesConnectedViaConnector","_connectorId","foundEntities","allEntities","_o","getConnectorsConnectedToEntity","getEntityWithConnectorAnchor","_connectorAnchorId","removeAllConnectors","removeConnector","_connector","makeNewConnectorFromAnchors","_anchorA","_anchorB","newConnector","foundConnector","findBestConnectorAnchorsToConnectEntities","_onFound","searchFunc","_searchData","accessibleRoutingPointsResult","ConnectorAnchorClosestPairFinder","objectA","objectB","cb","addConnectionAnchorToSelectionStack","dblClickTapHandler","_posX","_posY","entitiesAroundPoint","eventData","initDebugMetricsPanel","initInteractionHandlers","sheetEntityClicked","target","detectResult","doubleTapDetected","touchX","touchY","attachGroupTransformationContainer","_groupTransformationContainer","getContainerDomElement","container","detachGroupTransformationContainer","removeChild","handleGroupTransformationContainerMove","_dx","_dy","gtc","translateByOffset","handleMove","entity","translateOffset","getTranslateHandleOffset","mx","my","handleMoveEnd","resizeCursor","cursor","handleResize","newWidth","newHeight","resize","handleResizeEnd","handleMultiEntitySelectionStart","_targetElem","handleMultiEntitySelectionEnd","selectionRect","min","selectedEntities","updateSelectionBoxEndPoint","_endX","_endY","abs","initMultiEntitySelectionHandler","_selectionRectStyleCssClasses","selBox","border","background","_class","handleTouchSelectionStart","hasSelectionStarted","touches","which","preventDefault","setInterval","clearInterval","initTransformationHandlers","movementX","movementY","endTranslate","stopPropagation","cbFunc","Entity","_translateHandleDomElements","_resizeHandleDomElements","MOUSE_MIDDLE_BUTTON","connectorAnchors","nextConnectorAnchorIdSuffix","currentTranslateHandleElementActivated","addNonInteractableConnectorAnchor","_connectorAnchorDomElement","newAnchor","addInteractableConnectorAnchor","anchor","getConnectorAnchorRoutingPoints","anchorPoints","getPositionOnPage","ownerDocument","defaultView","scrollX","scrollY","_domElementStyleUpdateOverrideFunc","getDomElement","getBoundingRectangeInPageSpace","pagePos","computePageToEntitySpaceTransformedRectangle","_rectInPageSpace","noteBoundingRect","rectRelativeToNote","GraphPaper","getBoundingPoints","topLeft","topRight","bottomLeft","bottomRight","suspendTranslateInteractions","unbindTranslateHandleElements","resumeTranslateInteractions","bindTranslateHandleElements","translateTouchStartHandler","translateMouseDownHandler","_el","removeEventListener","resizeMouseDownHandler","_triggeredByElement","_resizeCursor","resizeTouchStartHandler","bindResizeHandleElements","getComputedStyle","GroupTransformationContainer","_containerStyleCssClasses","_sizeAdjustmentPx","calculateBoundingRect","accTranslateX","accTranslateY","currentLeft","currentTop","entityPositionRelativeToBoundingRect","rp","getEntities","initTranslateInteractionHandler","Cluster","entities","getEntityIndex","getEntityIndexById","getEntityIds","ids","removeEntityById","idx","removeAllEntities","BoxClusterDetector","_boxExtentOffset","getEntityIndexFromArray","_sheetEntitiesArray","removeEntitiesFromArray","getClusterWithMostEntitiesFromClusterMap","_clusterToEntityCountMap","curMaxObjs","curClusterWithMax","_numObjs","_cluster","_map","areEntitiesClose","nA","nB","getAllEntitiesCloseTo","_entitiesUnderConsideration","getClusterEntitiesFromSeed","_seedEntity","_resultSet","closeByEntities","concat","findIntersectingClustersForEntities","_clusters","intersectingClusterToNumEntitiesIntersecting","clusterEntities","has","removeEntityFromClusters","computeClusters","_knownClusters","_getNewIdFunc","clusters","map","entitiesUnderConsideration","pop","entitiesForCluster","size","newCluster","_clusterEntity","clusterToModify","nonEmptyClusters","filter"],"mappings":"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"}