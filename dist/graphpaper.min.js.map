{"version":3,"file":"graphpaper.min.js","sources":["../src/MatrixMath.js","../src/Point.js","../src/LineIntersection.js","../src/Line.js","../src/SvgPathBuilder.js","../src/Dimensions.js","../src/Rectangle.js","../src/GroupTransformationContainerEvent.js","../src/EntityEvent.js","../src/PointSet.js","../src/AccessibleRoutingPointsFinder.js","../src/ConnectorAnchor.js","../src/ConnectorAnchorFinder/ClosestPairFinder.js","../src/ConnectorAnchorFinder/BestToConnectEntitiesFinder.js","../src/SheetEvent.js","../src/DebugMetricsPanel/DebugMetricsPanel.js","../src/DoubleTapDetector.js","../src/ConnectorEvent.js","../src/ConnectorRoutingAlgorithm.js","../src/Connector.js","../src/Grid.js","../src/Workers/ClusterDetectionWorker.string.js","../src/Workers/ConnectorRoutingWorker.string.js","../src/DescriptorCollection.js","../src/Cluster.js","../src/Originator.js","../src/Sheet.js","../src/Entity.js","../src/GroupTransformationContainer.js","../src/BoxClusterDetector.js","../src/PointVisibilityMapRouteOptimizer.js","../src/LineSet.js","../src/Vec2.js","../src/PointVisibilityMap.js"],"sourcesContent":["const MatrixMath = {\r\n\r\n    mat4Multiply: function(_a, _b) {\r\n\r\n        const result = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\r\n        for(let i=0; i<4; i++) {\r\n            for(let j=0; j<4; j++) {\r\n\r\n                var sum = 0;\r\n                for(let k=0; k<4; k++) {\r\n                    sum += _a[k + 4*i] * _b[j + 4*k];\r\n                }\r\n\r\n                result[j + 4*i] = sum;\r\n            }\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    vecMat4Multiply: function(_v, _m) {\r\n        const result = [0, 0, 0, 0];\r\n        for(let vi=0; vi<4; vi++) {\r\n            result[vi] = \r\n                (_v[0] * _m[(vi*4) + 0]) + \r\n                (_v[1] * _m[(vi*4) + 1]) + \r\n                (_v[2] * _m[(vi*4) + 2]) + \r\n                (_v[3] * _m[(vi*4) + 3]);\r\n        }\r\n\r\n        return result;\r\n    }\r\n};\r\n\r\nexport { MatrixMath };\r\n","/**\r\n * \r\n * @param {Number} _x\r\n * @param {Number} _y\r\n */\r\nfunction Point(_x, _y) {\r\n    this.__x = _x;\r\n    this.__y = _y;\r\n};\r\n\r\n/**\r\n * @returns {Number}\r\n */     \r\nPoint.prototype.getX = function() {\r\n    return this.__x;\r\n};\r\n\r\n/**\r\n * @returns {Number}\r\n */     \r\nPoint.prototype.getY = function() {\r\n    return this.__y;\r\n};\r\n\r\n/**\r\n * @param {Point} _otherPoint\r\n * @returns {Boolean}\r\n */\r\nPoint.prototype.isEqual = function(_otherPoint) {\r\n    if(this.__x === _otherPoint.getX() && this.__y === _otherPoint.getY()) {\r\n        return true;\r\n    }\r\n\r\n    return false;\r\n};\r\n\r\n/**\r\n * @returns {Point}\r\n */\r\nPoint.prototype.getCartesianPoint = function(_sheetWidth, _sheetHeight) {\r\n    return new Point(\r\n        this.__x - (_sheetWidth * 0.5),\r\n        -this.__y + (_sheetHeight * 0.5)\r\n    );\r\n};\r\n\r\n/**\r\n * @returns {String}\r\n */\r\nPoint.prototype.toString = function() {\r\n    return this.__x + \" \" + this.__y;\r\n};\r\n\r\n/**\r\n * @returns {Number[]}\r\n */\r\nPoint.prototype.toArray = function() {\r\n    return [this.__x, this.__y];\r\n};\r\n\r\n/**\r\n * @param {Number[]} _arr\r\n * @returns {Point}\r\n */\r\nPoint.fromArray = function(_arr) {\r\n    return new Point(_arr[0], _arr[1]);\r\n};\r\n\r\nexport { Point };\r\n","import  {Point} from './Point';\r\n\r\nconst LINE_INTERSECTION_TYPE = Object.freeze({\r\n\tPARALLEL: \"parallel\",\t\t// no intersection, lines are parallel\r\n    COINCIDENT: \"coincident\",\t// no intersection, lines are coincident\r\n\tLINE: \"line\",\t\t\t\t// the lines intersect, but the intersection point is beyond the bounds of the line segments\r\n\tLINESEG: \"lineseg\",\t\t\t// the lines intersect, and the intersection point is within the bounds of the line segments\r\n});\r\n\r\n/**\r\n * \r\n * @param {LINE_INTERSECTION_TYPE} _type \r\n * @param {Point} _intersectionPoint \r\n */\r\nfunction LineIntersection(_type, _intersectionPoint) {\r\n    this.__type = _type;\r\n    this.__intersectionPoint = _intersectionPoint;\r\n};\r\n\r\n\r\n/**\r\n * @returns {LINE_INTERSECTION_TYPE}\r\n */\r\nLineIntersection.prototype.getType = function() {\r\n    return this.__type;\r\n};\r\n\r\n/**\r\n * @returns {Point|null}\r\n */\r\nLineIntersection.prototype.getIntersectionPoint = function() {\r\n    return this.__intersectionPoint;\r\n};\r\n\r\nexport {LINE_INTERSECTION_TYPE, LineIntersection};\r\n","import  {Point} from './Point';\r\nimport  {LINE_INTERSECTION_TYPE, LineIntersection} from './LineIntersection';\r\n\r\n/**\r\n * \r\n * @param {Point} _startPoint\r\n * @param {Point} _endPoint\r\n */\r\nfunction Line(_startPoint, _endPoint) {   \r\n\r\n    if(typeof _startPoint === 'undefined' || _startPoint === null) {\r\n        throw \"Line missing _startPoint\";\r\n    }\r\n\r\n    if(typeof _endPoint === 'undefined' || _endPoint === null) {\r\n        throw \"Line missing _endPoint\";\r\n    }\r\n\r\n    this.__startPoint = _startPoint;\r\n    this.__endPoint = _endPoint;\r\n};\r\n\r\n\r\n/**\r\n * @returns {Point}\r\n */       \r\nLine.prototype.getStartPoint = function() {\r\n    return this.__startPoint;\r\n};\r\n\r\n/**\r\n * @returns {Point}\r\n */       \r\nLine.prototype.getEndPoint = function() {\r\n    return this.__endPoint;\r\n};\r\n\r\n/**\r\n * @param {Line} _otherLine\r\n * @returns {Boolean}\r\n */\r\nLine.prototype.isEqual = function(_otherLine) {\r\n    if(this.getStartPoint().isEqual(_otherLine.getStartPoint()) && this.getEndPoint().isEqual(_otherLine.getEndPoint())) {\r\n        return true;\r\n    }\r\n\r\n    return false;\r\n};\r\n\r\n/**\r\n * @returns {Number}\r\n */\r\nLine.prototype.getLength = function() {\r\n    return Math.sqrt(\r\n        Math.pow(this.__endPoint.getX() - this.__startPoint.getX(), 2) + Math.pow(this.__endPoint.getY() - this.__startPoint.getY(), 2)\r\n    );\r\n};\r\n\r\n/**\r\n * @returns {Number}\r\n */\r\nLine.prototype.getMinX = function() {\r\n    return Math.min(this.getStartPoint().getX(), this.getEndPoint().getX());\r\n};\r\n\r\n/**\r\n * @returns {Number}\r\n */\r\nLine.prototype.getMaxX = function() {\r\n    return Math.max(this.getStartPoint().getX(), this.getEndPoint().getX());\r\n};\r\n\r\n/**\r\n * @returns {Number}\r\n */\r\nLine.prototype.getMinY = function() {\r\n    return Math.min(this.getStartPoint().getY(), this.getEndPoint().getY());\r\n};\r\n\r\n/**\r\n * @returns {Number}\r\n */\r\nLine.prototype.getMaxY = function() {\r\n    return Math.max(this.getStartPoint().getY(), this.getEndPoint().getY());\r\n};\r\n\r\n/**\r\n * Calculate unit length direction vector\r\n * \r\n * @returns {Point}\r\n */\r\nLine.prototype.getDirection = function() {\r\n    const dx = this.__endPoint.getX() - this.__startPoint.getX();\r\n    const dy = this.__endPoint.getY() - this.__startPoint.getY();\r\n\r\n    const len = Math.sqrt(dx*dx + dy*dy);\r\n\r\n    return new Point(       \r\n        dx / len,\r\n        dy / len\r\n    );    \r\n};\r\n\r\n/**\r\n * Create a Line shorted at the start and end by the specified amounts\r\n * \r\n * @returns {Line}\r\n */\r\nLine.prototype.createShortenedLine = function(startReduceByPx, endReduceByPx) {\r\n    const dx = this.__endPoint.getX() - this.__startPoint.getX();\r\n    const dy = this.__endPoint.getY() - this.__startPoint.getY();    \r\n    const dir = this.getDirection();\r\n\r\n    return new Line(\r\n        new Point(\r\n            this.__startPoint.getX() + (startReduceByPx * dir.getX()), \r\n            this.__startPoint.getY() + (startReduceByPx * dir.getY())\r\n        ),\r\n        new Point(\r\n            (this.__startPoint.getX() + dx) - (endReduceByPx * dir.getX()), \r\n            (this.__startPoint.getY() + dy) - (endReduceByPx * dir.getY())\r\n        )\r\n    );\r\n};\r\n\r\n/**\r\n * @param {Line} _otherLine\r\n * @returns {LINE_INTERSECTION_TYPE}\r\n */\r\nLine.prototype.computeIntersectionType = function(_otherLine) {\r\n    const thisLineStartPointX = this.__startPoint.getX();\r\n    const thisLineStartPointY = this.__startPoint.getY();\r\n    const thisLineEndPointX = this.__endPoint.getX();\r\n    const thisLineEndPointY = this.__endPoint.getY();        \r\n    const otherLineStartPointX = _otherLine.getStartPoint().getX();\r\n    const otherLineStartPointY = _otherLine.getStartPoint().getY();\r\n    const otherLineEndPointX = _otherLine.getEndPoint().getX();\r\n    const otherLineEndPointY = _otherLine.getEndPoint().getY();\r\n\r\n    const paramDenom = (otherLineEndPointY-otherLineStartPointY)*(thisLineEndPointX-thisLineStartPointX) - (otherLineEndPointX-otherLineStartPointX)*(thisLineEndPointY-thisLineStartPointY);\r\n    const paramANumer = (otherLineEndPointX-otherLineStartPointX)*(thisLineStartPointY-otherLineStartPointY) - (otherLineEndPointY - otherLineStartPointY)*(thisLineStartPointX-otherLineStartPointX);\r\n    const paramBNumer = (thisLineEndPointX-thisLineStartPointX)*(thisLineStartPointY-otherLineStartPointY) - (thisLineEndPointY-thisLineStartPointY)*(thisLineStartPointX-otherLineStartPointX);\r\n\r\n    if(paramDenom == 0) {\r\n        if(paramDenom == 0 && paramANumer == 0 && paramBNumer==0)\r\n            return LINE_INTERSECTION_TYPE.COINCIDENT;\r\n        else\r\n            return LINE_INTERSECTION_TYPE.PARALLEL;\r\n    }\r\n\r\n    const paramA = paramANumer / paramDenom;\r\n    const paramB = paramBNumer / paramDenom;\r\n    \r\n    if(paramA > 1.0 || paramA < 0.0 || paramB > 1.0 || paramB < 0.0) {\r\n        return LINE_INTERSECTION_TYPE.LINE;\r\n    } else {\r\n        return LINE_INTERSECTION_TYPE.LINESEG;\r\n    }\r\n};\r\n    \r\n/**\r\n * @param {Line} _otherLine\r\n * @returns {LINE_INTERSECTION_RESULT}\r\n */\r\nLine.prototype.computeIntersection = function(_otherLine) {\r\n\r\n    const thisLineStartPointX = this.__startPoint.getX();\r\n    const thisLineStartPointY = this.__startPoint.getY();\r\n    const thisLineEndPointX = this.__endPoint.getX();\r\n    const thisLineEndPointY = this.__endPoint.getY();        \r\n    const otherLineStartPointX = _otherLine.getStartPoint().getX();\r\n    const otherLineStartPointY = _otherLine.getStartPoint().getY();\r\n    const otherLineEndPointX = _otherLine.getEndPoint().getX();\r\n    const otherLineEndPointY = _otherLine.getEndPoint().getY();\r\n\r\n    const paramDenom = (otherLineEndPointY-otherLineStartPointY)*(thisLineEndPointX-thisLineStartPointX) - (otherLineEndPointX-otherLineStartPointX)*(thisLineEndPointY-thisLineStartPointY);\r\n    const paramANumer = (otherLineEndPointX-otherLineStartPointX)*(thisLineStartPointY-otherLineStartPointY) - (otherLineEndPointY - otherLineStartPointY)*(thisLineStartPointX-otherLineStartPointX);\r\n    const paramBNumer = (thisLineEndPointX-thisLineStartPointX)*(thisLineStartPointY-otherLineStartPointY) - (thisLineEndPointY-thisLineStartPointY)*(thisLineStartPointX-otherLineStartPointX);\r\n\r\n    if(paramDenom == 0) {\r\n        if(paramDenom == 0 && paramANumer == 0 && paramBNumer==0)\r\n            return new LineIntersection(LINE_INTERSECTION_TYPE.COINCIDENT, null);\r\n        else\r\n            return new LineIntersection(LINE_INTERSECTION_TYPE.PARALLEL, null);\r\n    }\r\n\r\n    const paramA = paramANumer / paramDenom;\r\n    const paramB = paramBNumer / paramDenom;\r\n\r\n    const xIntersect = this.__startPoint.getX() + paramA*(this.__endPoint.getX()-this.__startPoint.getX());\r\n    const yIntersect = this.__startPoint.getY() + paramA*(this.__endPoint.getY()-this.__startPoint.getY());\r\n    \r\n    if(paramA > 1.0 || paramA < 0.0 || paramB > 1.0 || paramB < 0.0) {\r\n        return new LineIntersection(LINE_INTERSECTION_TYPE.LINE, new Point(xIntersect, yIntersect));\r\n    } else {\r\n        return new LineIntersection(LINE_INTERSECTION_TYPE.LINESEG, new Point(xIntersect, yIntersect));\r\n    }\r\n};\r\n\r\nexport { Line };\r\n","import { Line } from \"./Line\";\r\n\r\nconst SvgPathBuilder = {\r\n\r\n    /**\r\n     * \r\n     * @param {Point} _pt \r\n     * @returns {String}\r\n     */\r\n    pointToLineTo: function(_pt, _ptIndex) {\r\n        if(_ptIndex === 0) {\r\n            return \"M\" + _pt.getX() + \" \" + _pt.getY();\r\n        }\r\n\r\n        return \"L\" + _pt.getX() + \" \" + _pt.getY();\r\n    },\r\n\r\n    /**\r\n     * \r\n     * @param {Point[]} _points \r\n     * @param {Number} _curvaturePx \r\n     * @returns {Point[]}\r\n     */\r\n    pointTripletToTesselatedCurvePoints(_points, _curvaturePx) {\r\n        if(_points.length !== 3) {\r\n            throw new Error(\"_points must be array of exactly 3 points\");\r\n        }\r\n\r\n        const controlPoint = _points[1];\r\n\r\n        const lineA = new Line(_points[0], _points[1]);\r\n        const lineB = new Line(_points[1], _points[2]);\r\n\r\n        const lineAShortened = lineA.createShortenedLine(0, _curvaturePx * 0.5);\r\n        const lineBShortened = lineB.createShortenedLine(_curvaturePx * 0.5, 0);\r\n\r\n        return [\r\n            lineAShortened.getStartPoint(),\r\n            lineAShortened.getEndPoint(),\r\n            lineBShortened.getStartPoint(),\r\n            lineBShortened.getEndPoint(),\r\n        ];\r\n    },\r\n\r\n    /**\r\n     * \r\n     * @param {Point[]} _points\r\n     * @param {Number} _curvaturePx\r\n     * @returns {String}\r\n     */\r\n    pointsToPath: function(_points, _curvaturePx) {\r\n        _curvaturePx = _curvaturePx || 0.0;\r\n\r\n        const svgPathParts = [];\r\n        let ptIdx = 0; // minify bug if this is put within the if(_curvaturePx... block\r\n\r\n        if(_curvaturePx > 0.0) {\r\n            while(_points.length >= 3) {\r\n                const ptA = _points.shift();\r\n                const ptB = _points.shift();\r\n                const ptC = _points.shift();\r\n\r\n                const newPts = SvgPathBuilder.pointTripletToTesselatedCurvePoints(\r\n                    [\r\n                        ptA,\r\n                        ptB,\r\n                        ptC,\r\n                    ],\r\n                    _curvaturePx\r\n                );                \r\n\r\n                _points.unshift(newPts[3]);\r\n                _points.unshift(newPts[2]);\r\n\r\n                for(let j=0; j<newPts.length-2; j++) {\r\n                    svgPathParts.push(SvgPathBuilder.pointToLineTo(newPts[j], ptIdx++));\r\n                }\r\n            }\r\n\r\n            while(_points.length > 0) {\r\n                const pt = _points.shift();\r\n                svgPathParts.push(SvgPathBuilder.pointToLineTo(pt, ptIdx++));\r\n            }\r\n\r\n        } else {\r\n            for(let i=0; i<_points.length; i++) {\r\n                const p = _points[i];\r\n                svgPathParts.push(SvgPathBuilder.pointToLineTo(p, i));\r\n            }\r\n        }\r\n\r\n        return svgPathParts.join(\" \");        \r\n    },\r\n\r\n};\r\n\r\nexport { SvgPathBuilder };\r\n","/**\r\n * \r\n * @param {Number} _width\r\n * @param {Number} _height\r\n */\r\nfunction Dimensions(_width, _height) {\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */       \r\n    this.getWidth = function() {\r\n        return _width;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */       \r\n    this.getHeight = function() {\r\n        return _height;\r\n    };\r\n};\r\n\r\nexport { Dimensions };\r\n","import {Point} from './Point';\r\nimport {Line} from './Line';\r\nimport  {LINE_INTERSECTION_TYPE, LineIntersection} from './LineIntersection';\r\n\r\n/**\r\n * \r\n * @param {Number} _left\r\n * @param {Number} _top\r\n * @param {Number} _right\r\n * @param {Number} _bottom\r\n */\r\nfunction Rectangle(_left, _top, _right, _bottom)  {\r\n    this.__left = _left;\r\n    this.__top = _top;\r\n    this.__right = _right;\r\n    this.__bottom = _bottom;    \r\n};\r\n\r\n\r\n/**\r\n * @returns {Number}\r\n */\r\nRectangle.prototype.getLeft = function() {\r\n    return this.__left;\r\n};\r\n\r\n/**\r\n * @returns {Number}\r\n */\r\nRectangle.prototype.getTop = function() {\r\n    return this.__top;\r\n};\r\n\r\n/**\r\n * @returns {Number}\r\n */\r\nRectangle.prototype.getRight = function() {\r\n    return this.__right;\r\n};\r\n\r\n/**\r\n * @returns {Number}\r\n */\r\nRectangle.prototype.getBottom = function() {\r\n    return this.__bottom;\r\n};\r\n\r\n/**\r\n * @returns {Number}\r\n */    \r\nRectangle.prototype.getWidth = function() {\r\n    return this.__right - this.__left;\r\n};\r\n\r\n/**\r\n * @returns {Number}\r\n */    \r\nRectangle.prototype.getHeight = function() {\r\n    return this.__bottom - this.__top;\r\n};\r\n\r\n/**\r\n * @returns {Point[]}\r\n */\r\nRectangle.prototype.getPoints = function() {\r\n    return [\r\n        new Point(this.__left, this.__top),\r\n        new Point(this.__right, this.__top),\r\n        new Point(this.__right, this.__bottom),\r\n        new Point(this.__left, this.__bottom)\r\n    ];\r\n};\r\n\r\n/**\r\n * @returns {Line[]}\r\n */\r\nRectangle.prototype.getLines = function() {\r\n    return [\r\n        new Line(new Point(this.__left, this.__top), new Point(this.__right, this.__top)),\r\n        new Line(new Point(this.__right, this.__top), new Point(this.__right, this.__bottom)),\r\n        new Line(new Point(this.__right, this.__bottom), new Point(this.__left, this.__bottom)),\r\n        new Line(new Point(this.__left, this.__bottom), new Point(this.__left, this.__top))\r\n    ];\r\n};\r\n\r\n/**\r\n * @param {Number} _resizeByPx\r\n * @returns {Rectangle}\r\n */\r\nRectangle.prototype.getUniformlyResizedCopy = function(_resizeByPx) {\r\n    return new Rectangle(\r\n        this.__left - _resizeByPx, \r\n        this.__top - _resizeByPx, \r\n        this.__right + _resizeByPx, \r\n        this.__bottom + _resizeByPx\r\n    );\r\n};\r\n\r\n/**\r\n * Scale the bounding box by _gridSize, and return the points comprising the box\r\n * \r\n * @param {Number} _gridSize\r\n * @returns {Point[]}\r\n */\r\nRectangle.prototype.getPointsScaledToGrid = function(_gridSize) {\r\n\r\n    const centroid = new Point(\r\n        this.__left + ((this.__right-this.__left)*0.5),\r\n        this.__top + ((this.__bottom-this.__top)*0.5)\r\n    );\r\n\r\n    const scaleDx = ((this.__right - centroid.getX()) + _gridSize) / (this.__right - centroid.getX());\r\n    const scaleDy = ((this.__bottom - centroid.getY()) + _gridSize) / (this.__bottom - centroid.getY());        \r\n\r\n    const scaledPoints = [\r\n        new Point(\r\n            ((this.__left - centroid.getX())*scaleDx) + centroid.getX(), \r\n            ((this.__top - centroid.getY())*scaleDy) + centroid.getY()\r\n        ),\r\n\r\n        new Point(\r\n            ((this.__right - centroid.getX())*scaleDx) + centroid.getX(), \r\n            ((this.__top - centroid.getY())*scaleDy) + centroid.getY()\r\n        ),\r\n\r\n        new Point(\r\n            ((this.__right - centroid.getX())*scaleDx) + centroid.getX(), \r\n            ((this.__bottom - centroid.getY())*scaleDy) + centroid.getY()\r\n        ),\r\n\r\n        new Point(\r\n            ((this.__left - centroid.getX())*scaleDx) + centroid.getX(), \r\n            ((this.__bottom - centroid.getY())*scaleDy) + centroid.getY()\r\n        )\r\n    ];\r\n\r\n    return scaledPoints;\r\n};    \r\n\r\n/**\r\n * \r\n * @param {Rectangle} _otherRectangle\r\n * @returns {Boolean}\r\n */\r\nRectangle.prototype.checkIntersect = function(_otherRectangle) {\r\n    if(this.__bottom < _otherRectangle.getTop()) {\r\n        return false;\r\n    }\r\n\r\n    if(this.__top > _otherRectangle.getBottom()) {\r\n        return false;\r\n    }\r\n\r\n    if(this.__right < _otherRectangle.getLeft()) {\r\n        return false;\r\n    }\r\n\r\n    if(this.__left > _otherRectangle.getRight()) {\r\n        return false;\r\n    }\r\n\r\n    return true;\r\n};\r\n\r\n\r\n/**\r\n * \r\n * @param {Point} _point \r\n */\r\nRectangle.prototype.checkIsPointWithin = function(_point) {\r\n    if(_point.getX() >= this.__left && _point.getX() <= this.__right && _point.getY() >= this.__top && _point.getY() <= this.__bottom) {\r\n        return true;\r\n    }\r\n\r\n    return false;\r\n};\r\n\r\n/**\r\n * \r\n * @param {Rectangle} _otherRectangle\r\n * @returns {Boolean}\r\n */\r\nRectangle.prototype.checkIsWithin = function(_otherRectangle) {\r\n    if( this.__bottom <= _otherRectangle.getBottom() &&\r\n        this.__top >= _otherRectangle.getTop() &&\r\n        this.__right <= _otherRectangle.getRight() &&\r\n        this.__left >= _otherRectangle.getLeft()\r\n    ) {\r\n\r\n        return true;\r\n    }\r\n\r\n    return false;\r\n};\r\n\r\n\r\nexport { Rectangle }\r\n","const GroupTransformationContainerEvent = Object.freeze({\r\n    TRANSLATE_START: 'group-transformation-container-translate-start',\r\n    TRANSLATE: 'group-transformation-container-translate',\r\n});\r\n\r\nexport { GroupTransformationContainerEvent };\r\n","const EntityEvent = Object.freeze({\r\n    TRANSLATE_START: 'obj-translate-start',\r\n    TRANSLATE: 'obj-translate',\r\n    RESIZE_START: 'obj-resize-start',\r\n    RESIZE: 'obj-resize'\r\n});\r\n\r\n\r\nexport { EntityEvent };\r\n","import  {Point} from './Point';\r\nimport  {Line} from './Line';\r\n\r\n/**\r\n * Unique collection of Point objects\r\n * \r\n * @param {Point[]|Float64Array|undefined} _pointsInput\r\n */\r\nfunction PointSet(_pointsInput) {\r\n\r\n    const self = this;\r\n\r\n    /**\r\n     * @type {Point[]}\r\n     */\r\n    const points = [];\r\n\r\n    /**\r\n     * @param {Point} _newPoint\r\n     */\r\n    this.push = function(_newPoint) {\r\n        for(let i=0; i<points.length; i++) {\r\n            if(_newPoint.isEqual(points[i])) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        points.push(_newPoint);\r\n        return true;\r\n    };\r\n\r\n    /**\r\n     * @param {PointSet} _ps\r\n     */\r\n    this.pushPointSet = function(_ps) {\r\n        const possibleNewPoints = _ps.toArray();\r\n        for(let i=0; i<possibleNewPoints.length; i++) {\r\n            self.push(possibleNewPoints[i]);\r\n        }\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Point} _point \r\n     * @returns {Point}\r\n     */\r\n    this.findPointClosestTo = function(_point) {\r\n        var resultPoint = null;\r\n        var currentMinLength = Number.MAX_SAFE_INTEGER;\r\n\r\n        points.forEach(function(_pt) {\r\n            const lineToPt = new Line(_point, _pt);\r\n            if(lineToPt.getLength() < currentMinLength) {\r\n                resultPoint = _pt;\r\n                currentMinLength = lineToPt.getLength();\r\n            }\r\n        });\r\n        \r\n        return resultPoint;        \r\n    };\r\n\r\n    this.findDistanceToPointClosestTo = function(_point) {\r\n        var currentMinLength = Number.MAX_SAFE_INTEGER;\r\n\r\n        points.forEach(function(_pt) {\r\n            const lineToPt = new Line(_point, _pt);\r\n            if(lineToPt.getLength() < currentMinLength) {\r\n                currentMinLength = lineToPt.getLength();\r\n            }\r\n        });\r\n        \r\n        return currentMinLength;        \r\n    };    \r\n\r\n    /**\r\n     * \r\n     * @param {Point} _point \r\n     * @returns {PointSet}\r\n     */\r\n    this.findPointsCloseTo = function(_point, _radius) {\r\n        const resultSet = new PointSet();\r\n\r\n        points.forEach(function(_pt) {\r\n            const lineToPt = new Line(_point, _pt);\r\n            if(lineToPt.getLength() <= _radius) {\r\n                resultSet.push(_pt);\r\n            }\r\n        });\r\n        \r\n        return resultSet;        \r\n    };    \r\n\r\n    /**\r\n     * @returns {Point[]}\r\n     */\r\n    this.toArray = function() {\r\n        return points;\r\n    };\r\n\r\n    /**\r\n     * @returns {Float64Array}\r\n     */\r\n    this.toFloat64Array = function() {\r\n\r\n        const result = new Float64Array(points.length * 2);\r\n        for(let i=0; i<points.length; i++) {\r\n            result[0 + (i*2)] = points[i].getX();\r\n            result[1 + (i*2)] = points[i].getY();\r\n        }\r\n\r\n        return result;\r\n    };\r\n    \r\n    /**\r\n     * @param {Float64Array} _float64Array\r\n     */\r\n    const fromFloat64Array = function(_float64Array) {\r\n        points.length = 0;\r\n        for(let i=0; i<_float64Array.length; i+=2) {\r\n            points.push(\r\n                new Point(_float64Array[i], _float64Array[i+1])\r\n            );\r\n        }\r\n    };    \r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.count = function() {\r\n        return points.length;\r\n    };\r\n\r\n    if(_pointsInput && Array.isArray(_pointsInput)) {\r\n        _pointsInput.forEach(self.push);\r\n    } else if(_pointsInput && Object.prototype.toString.call(_pointsInput) === '[object Float64Array]') {\r\n        fromFloat64Array(_pointsInput);\r\n    } else { }    \r\n\r\n};\r\n\r\nexport { PointSet };\r\n","import { PointSet } from \"./PointSet\";\r\nimport { Rectangle } from \"./Rectangle\";\r\n\r\nconst AccessibleRoutingPointsFinder = {\r\n\r\n    /**\r\n     * Find routing points that are not occluded by objects\r\n     * \r\n     * @param {Object[]} _subjectEntityDescriptors\r\n     * @param {Object[]} _occluderEntityDescriptors\r\n     * @param {Number} _gridSize\r\n     * @returns {Object}\r\n     */\r\n    find: function(_subjectEntityDescriptors, _occluderEntityDescriptors, _gridSize) {\r\n        const connectorAnchorToNumValidRoutingPoints = new Map();\r\n        const allRoutingPoints = [];\r\n        const filteredRoutingPoints = new PointSet();\r\n\r\n        _subjectEntityDescriptors.forEach((_entityDescriptor) => {\r\n            const anchors = _entityDescriptor.connectorAnchors;\r\n\r\n            anchors.forEach((_a) => {\r\n                let isAnchorOccluded = false;\r\n\r\n                // check if anchor is occluded\r\n                // @todo Commented out for now, need a decision on how to handle anchors where centroid is on the occluder bounding rect\r\n                /*for(let i=0; i<_occludableByObjects.length; i++) {\r\n                    const possibleOccluderBoundingRect = _occludableByObjects[i].getBoundingRectange();\r\n                    if(possibleOccluderBoundingRect.checkIsPointWithin(_a.getCentroid())) {\r\n                        connectorAnchorToNumValidRoutingPoints.set(_a.getId(), 0);\r\n                        isAnchorOccluded = true;\r\n                        break;\r\n                    }\r\n                }*/\r\n\r\n                if(!isAnchorOccluded) {\r\n                    const routingPoints = (new PointSet(_a.routingPointsFloat64Arr)).toArray();\r\n                    routingPoints.forEach((_rp) => {\r\n                        allRoutingPoints.push(\r\n                            {\r\n                                \"routingPoint\": _rp,\r\n                                \"parentAnchorId\": _a.id\r\n                            }\r\n                        );\r\n                    });\r\n\r\n                    connectorAnchorToNumValidRoutingPoints.set(_a.id, routingPoints.length);\r\n                }\r\n            });\r\n        });\r\n\r\n        allRoutingPoints.forEach((_rp) => {\r\n            let isPointWithinObj = false;\r\n\r\n            // check if routing point is occluded\r\n            for(let i=0; i<_occluderEntityDescriptors.length; i++) {\r\n                const occluder = _occluderEntityDescriptors[i];\r\n                const boundingRect = new Rectangle(occluder.x, occluder.y, occluder.x + occluder.width, occluder.y + occluder.height);\r\n                if(boundingRect.checkIsPointWithin(_rp.routingPoint)) {\r\n                    isPointWithinObj = true;\r\n                    const currentNumRoutingPoints = connectorAnchorToNumValidRoutingPoints.get(_rp.parentAnchorId) || 0;\r\n                    connectorAnchorToNumValidRoutingPoints.set(_rp.parentAnchorId, Math.max(0, currentNumRoutingPoints - 1));\r\n                }\r\n            }\r\n\r\n            if(!isPointWithinObj) {\r\n                filteredRoutingPoints.push(_rp.routingPoint);\r\n            }\r\n            \r\n        });\r\n\r\n        return {\r\n            \"connectorAnchorToNumValidRoutingPoints\": connectorAnchorToNumValidRoutingPoints,\r\n            \"accessibleRoutingPoints\": filteredRoutingPoints,\r\n        };\r\n    }\r\n};\r\n\r\nexport { AccessibleRoutingPointsFinder };\r\n","import  {Point} from './Point';\r\nimport  {Rectangle} from './Rectangle';\r\n\r\n/**\r\n * @param {String} _id\r\n * @param {Element} _domElement\r\n * @param {Sheet} _sheet\r\n * @param {Number} _routingPointOffsetX\r\n * @param {Number} _routingPointOffsetY\r\n */\r\nfunction ConnectorAnchor(_id, _domElement, _sheet, _routingPointOffsetX, _routingPointOffsetY) {\r\n    const self = this;\r\n    let routingPointDirections = [\"top\", \"left\", \"bottom\", \"right\"];\r\n\r\n    _routingPointOffsetX = _routingPointOffsetX || _sheet.getGridSize();\r\n    _routingPointOffsetY = _routingPointOffsetY || _sheet.getGridSize();\r\n\r\n    const getDimensions = function() {\r\n        const r = _sheet.transformDomRectToPageSpaceRect(_domElement.getBoundingClientRect());\r\n        return new Point(r.getWidth(), r.getHeight());\r\n    };\r\n\r\n    const routingPointDirectionToPoint = function(_direction, _centroid, _halfWidth, _halfHeight) {\r\n        if(_direction === 'top') {\r\n            return new Point(_centroid.getX(), _centroid.getY() - _halfHeight - _routingPointOffsetY);\r\n        }\r\n\r\n        if(_direction === 'bottom') {\r\n            return new Point(_centroid.getX(), _centroid.getY() + _halfHeight + _routingPointOffsetY);\r\n        }\r\n\r\n        if(_direction === 'left') {\r\n            return new Point(_centroid.getX() - _halfWidth - _routingPointOffsetX, _centroid.getY());\r\n        }\r\n\r\n        if(_direction === 'right') {\r\n            return new Point(_centroid.getX() + _halfWidth + _routingPointOffsetX, _centroid.getY());\r\n        }\r\n\r\n        return null;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {String[]} _directions \r\n     */\r\n    this.setPossibleRoutingPointDirections = function(_directions) {\r\n        routingPointDirections = _directions;\r\n    };\r\n\r\n    /**\r\n     * @returns {String}\r\n     */\r\n    this.getId = function() {\r\n        return _id;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */     \r\n    this.getX = function() {\r\n        // Might want to return left edge coordinate instead\r\n        return self.getCentroid().getX();\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */     \r\n    this.getY = function() {\r\n        // Might want to return top edge coordinate instead\r\n        return self.getCentroid().getY();\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getWidth = function() {\r\n        const r = _sheet.transformDomRectToPageSpaceRect(_domElement.getBoundingClientRect());\r\n        return r.getWidth();\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getHeight = function() {\r\n        const r = _sheet.transformDomRectToPageSpaceRect(_domElement.getBoundingClientRect());\r\n        return r.getHeight();\r\n    };\r\n\r\n    /**\r\n     * @returns {Point}\r\n     */\r\n    this.getCentroid = function() {\r\n        const sheetOffset = _sheet.getSheetOffset();\r\n        const pageSpaceRect = _sheet.transformDomRectToPageSpaceRect(_domElement.getBoundingClientRect());\r\n        const halfWidth = pageSpaceRect.getWidth() * 0.5;\r\n        const halfHeight = pageSpaceRect.getHeight() * 0.5;        \r\n        \r\n        return new Point(\r\n            (pageSpaceRect.getLeft() + halfWidth) - sheetOffset.getX(), \r\n            (pageSpaceRect.getTop() + halfHeight) - sheetOffset.getY()\r\n        );\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @returns {Point[]}\r\n     */\r\n    this.getRoutingPoints = function() {\r\n        const dimensions = getDimensions();\r\n        const centroid = self.getCentroid();\r\n        const halfWidth = dimensions.getX() * 0.5;\r\n        const halfHeight = dimensions.getY() * 0.5;\r\n\r\n        const result = [];\r\n        routingPointDirections.forEach((_dir) => {\r\n            result.push(routingPointDirectionToPoint(_dir, centroid, halfWidth, halfHeight));\r\n        });\r\n\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @returns {Rectangle}\r\n     */\r\n    this.getBoundingRectange = function() {\r\n        const dimensions = getDimensions();\r\n        const centroid = self.getCentroid();\r\n        const halfWidth = dimensions.getX() * 0.5;\r\n        const halfHeight = dimensions.getY() * 0.5;\r\n\r\n        return new Rectangle(\r\n            centroid.getX() - halfWidth, \r\n            centroid.getY() - halfHeight, \r\n            centroid.getX() + halfWidth, \r\n            centroid.getY() + halfHeight\r\n        );\r\n    };\r\n};\r\n\r\nexport { ConnectorAnchor };\r\n","import { Entity } from \"../Entity\";\r\nimport { ConnectorAnchor } from \"../ConnectorAnchor\";\r\n\r\nconst ClosestPairFinder = {   \r\n    /**\r\n     * \r\n     * @param {Entity} _objA \r\n     * @param {Entity} _objB\r\n     * @param {Map<ConnectorAnchor, Number>} _connectorAnchorToNumValidRoutingPoints\r\n     * @returns {Object}\r\n     */\r\n    findClosestPairBetweenObjects: function(_objA, _objB, _connectorAnchorToNumValidRoutingPoints) {\r\n        const objAConnectorAnchors = _objA.getConnectorAnchors();\r\n        const objBConnectorAnchors = _objB.getConnectorAnchors();\r\n\r\n        var startAnchorIdxWithMinDist = 0;\r\n        var endAnchorIdxWithMinDist = 0;\r\n        var minDist = Number.MAX_VALUE;\r\n        \r\n        // Find best anchor element to connect _objA and _objB            \r\n        // Find anchors that produce shortest straight line distance\r\n        for(let x=0; x<objAConnectorAnchors.length; x++) {\r\n            const aCentroid = objAConnectorAnchors[x].getCentroid();\r\n            const objANumValidRoutingPoints = _connectorAnchorToNumValidRoutingPoints.get(objAConnectorAnchors[x].getId()) || 0;\r\n            if(objANumValidRoutingPoints === 0) {\r\n                continue;\r\n            }\r\n\r\n            for(let y=0; y<objBConnectorAnchors.length; y++) {\r\n                const bCentroid = objBConnectorAnchors[y].getCentroid();\r\n                const d = Math.sqrt(Math.pow(bCentroid.getX()-aCentroid.getX(),2) + Math.pow(bCentroid.getY()-aCentroid.getY(),2));\r\n                const objBNumValidRoutingPoints = _connectorAnchorToNumValidRoutingPoints.get(objBConnectorAnchors[y].getId()) || 0;\r\n                \r\n                if(d < minDist && objBNumValidRoutingPoints > 0) {\r\n                    startAnchorIdxWithMinDist = x;\r\n                    endAnchorIdxWithMinDist = y;\r\n                    minDist = d;\r\n                }\r\n            }\r\n        }\r\n\r\n        // If we have an anchor without no routing points, we end up with this situation\r\n        if(minDist === Number.MAX_VALUE) {\r\n            // Find and return the 2 anchors closest to each other\r\n            for(let x=0; x<objAConnectorAnchors.length; x++) {\r\n                const aCentroid = objAConnectorAnchors[x].getCentroid();\r\n                for(let y=0; y<objBConnectorAnchors.length; y++) {\r\n                    const bCentroid = objBConnectorAnchors[y].getCentroid();\r\n                    const d = Math.sqrt(Math.pow(bCentroid.getX()-aCentroid.getX(),2) + Math.pow(bCentroid.getY()-aCentroid.getY(),2));\r\n\r\n                    if(d < minDist) {\r\n                        startAnchorIdxWithMinDist = x;\r\n                        endAnchorIdxWithMinDist = y;                        \r\n                        minDist = d;\r\n                    }\r\n                }\r\n            }                \r\n        }\r\n\r\n        return {\r\n            \"objectAAnchorIndex\": startAnchorIdxWithMinDist,\r\n            \"objectAAnchor\": objAConnectorAnchors[startAnchorIdxWithMinDist],\r\n            \"objectBAnchorIndex\": endAnchorIdxWithMinDist,\r\n            \"objectBAnchor\": objBConnectorAnchors[endAnchorIdxWithMinDist],\r\n        };\r\n    }\r\n};\r\n\r\nexport { ClosestPairFinder };\r\n","import { AccessibleRoutingPointsFinder } from \"../AccessibleRoutingPointsFinder\";\r\nimport { ClosestPairFinder as ConnectorAnchorClosestPairFinder } from \"../ConnectorAnchorFinder/ClosestPairFinder\";\r\n\r\nconst BestToConnectEntitiesFinder = function() {\r\n    this.findBestTimeout = null;\r\n    this.searchInputs = [];\r\n    this.currentSheetEntities = [];\r\n    this.currentGridSize = 11.0;\r\n    this.findBufferTime = 6.94;\r\n    this.metrics = {\r\n        batchSize: null,\r\n        searchFuncExecutionTime: null\r\n    };\r\n};\r\n\r\n/**\r\n * \r\n * @returns {Number}\r\n */\r\nBestToConnectEntitiesFinder.prototype.getSearchFuncExecutionTime = function() {\r\n    return this.metrics.searchFuncExecutionTime;\r\n};\r\n\r\n/**\r\n * \r\n * @returns {Number}\r\n */\r\n BestToConnectEntitiesFinder.prototype.getSearchFuncBatchSize = function() {\r\n    return this.metrics.batchSize;\r\n};\r\n\r\n/**\r\n * \r\n * @param {Entity} _a \r\n * @param {Entity} _b \r\n * @param {Function} _cb \r\n * @returns \r\n */\r\nBestToConnectEntitiesFinder.prototype.alreadyInSearchInputs = function(_a, _b, _cb) {\r\n    for(let i=0; i<this.searchInputs.length; i++) {\r\n        if(\r\n            this.searchInputs[i].entityA === _a && \r\n            this.searchInputs[i].entityB === _b &&\r\n            this.searchInputs[i].cb.toString() === _cb.toString()\r\n        ) {\r\n            return true;\r\n        }\r\n    }\r\n\r\n    return false;\r\n};\r\n\r\nBestToConnectEntitiesFinder.prototype.clearSearchInputs = function() {\r\n    this.searchInputs.length = 0;\r\n};\r\n\r\nBestToConnectEntitiesFinder.prototype.search = function() {\r\n    const exTimeT1 = new Date();\r\n\r\n    const inputBatchSize = this.searchInputs.length;\r\n    const gridSize = this.currentGridSize;\r\n\r\n    const entityDescriptors = [];\r\n    this.currentSheetEntities.forEach(function(_e) {\r\n        entityDescriptors[_e.getId()] = _e.getDescriptor(gridSize);\r\n    });\r\n\r\n    // maybe update AccessibleRoutingPointsFinder.find to handle an object?\r\n    const entityDescriptorsArr = Object.values(entityDescriptors);\r\n\r\n    for(let i=0; i<this.searchInputs.length; i++) {\r\n        const accessibleRoutingPointsResult = AccessibleRoutingPointsFinder.find(\r\n            [\r\n                entityDescriptors[this.searchInputs[i].entityA.getId()], \r\n                entityDescriptors[this.searchInputs[i].entityB.getId()]\r\n            ],\r\n            entityDescriptorsArr, \r\n            gridSize\r\n        );\r\n\r\n        const result = ConnectorAnchorClosestPairFinder.findClosestPairBetweenObjects(\r\n            this.searchInputs[i].entityA, \r\n            this.searchInputs[i].entityB, \r\n            accessibleRoutingPointsResult.connectorAnchorToNumValidRoutingPoints\r\n        );\r\n\r\n        this.searchInputs[i].cb(result);\r\n    }\r\n\r\n    this.metrics.batchSize = inputBatchSize;\r\n    this.metrics.searchFuncExecutionTime = (new Date()) - exTimeT1;\r\n};\r\n\r\n/**\r\n * \r\n * @param {Entity} _entityA \r\n * @param {Entity} _entityB \r\n * @param {Function} _onFound \r\n */\r\nBestToConnectEntitiesFinder.prototype.findBest = function(_entityA, _entityB, _onFound, _sheetEntities, _gridSize) {\r\n    this.currentSheetEntities = _sheetEntities;\r\n    this.currentGridSize = _gridSize;\r\n\r\n    if(!this.alreadyInSearchInputs(_entityA, _entityB, _onFound)) {\r\n        this.searchInputs.push(\r\n            {\r\n                \"entityA\": _entityA,\r\n                \"entityB\": _entityB,\r\n                \"cb\": _onFound\r\n            }\r\n        );\r\n    }\r\n\r\n    if(this.findBestTimeout) {\r\n        clearTimeout(this.findBestTimeout);\r\n        this.findBestTimeout = null;\r\n    }\r\n\r\n    const searchFunc = () => {\r\n        this.search(this.searchInputs);\r\n        this.findBestTimeout = null;\r\n        this.searchInputs = [];            \r\n    };\r\n\r\n    this.findBestTimeout = setTimeout(searchFunc, this.findBufferTime);\r\n};\r\n\r\nexport { BestToConnectEntitiesFinder };\r\n","const SheetEvent = Object.freeze({\r\n    DBLCLICK: \"dblclick\",\r\n    CLICK: \"click\",\r\n    CLUSTER_CREATED: \"cluster-created\",\r\n    CLUSTER_DELETED: \"cluster-deleted\",\r\n    CLUSTER_UPDATED: \"cluster-updated\",\r\n    CONNECTOR_UPDATED: \"connector-updated\",\r\n    ENTITY_ADDED: \"entity-added\",\r\n    ENTITY_REMOVED: \"entity-removed\",\r\n    ENTITY_RESIZED: \"entity-resized\",\r\n    ENTITY_TRANSLATED: \"entity-translated\",\r\n    ENTITY_OVERLAP_DETECTED: \"entity-overlap-detected\",\r\n    MULTIPLE_ENTITY_SELECTION_STARTED: \"multiple-object-selection-started\",\r\n    MULTIPLE_ENTITIES_SELECTED: \"multiple-objects-selected\",\r\n});\r\n\r\n\r\nexport { SheetEvent };\r\n","const DebugMetricsPanel = function(_window) {\r\n    var debugPanelElem = null;\r\n    var isVisible = false;\r\n\r\n    const objectHtmlDumpDepthFirst = function(_obj, _output, _parentName) {\r\n        if(typeof _parentName === 'undefined') {\r\n            _parentName = \"\";\r\n        }\r\n\r\n        if(_obj instanceof Object) {\r\n            Object.keys(_obj).forEach((_k) => {\r\n                if(_obj[_k] instanceof Object) {\r\n                    objectHtmlDumpDepthFirst(_obj[_k], _output, _k);\r\n                } else {\r\n                    let prefix = \"\";\r\n                    if(_parentName.length > 0) {\r\n                        prefix = _parentName + \".\";\r\n                    }\r\n\r\n                    const metricName = `${prefix}${_k}`;\r\n                    _output.push(`<p class=\"metric\">${metricName} = ${_obj[_k]}</p>`);\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    this.init = function() {\r\n        debugPanelElem = _window.document.createElement(\"div\");\r\n        debugPanelElem.classList.add(\"graphpaper-debug-panel\");\r\n        debugPanelElem.style.display = \"none\";\r\n        debugPanelElem.style.position = \"fixed\";\r\n        debugPanelElem.style.right = \"0px\";\r\n        debugPanelElem.style.top = \"0px\";\r\n        debugPanelElem.style.width = \"500px\";\r\n        debugPanelElem.style.height = \"200px\";\r\n        debugPanelElem.style.color = \"#fff\";\r\n        debugPanelElem.style.padding = \"15px\";\r\n        debugPanelElem.style.backgroundColor = \"rgba(0,0,0,0.75)\";\r\n        debugPanelElem.style.zIndex = 9999;\r\n        _window.document.body.appendChild(debugPanelElem);\r\n    };\r\n\r\n    this.show = function() {\r\n        isVisible = true;\r\n        debugPanelElem.style.display = \"block\";\r\n    };\r\n\r\n    this.hide = function() {\r\n        isVisible = false;\r\n        debugPanelElem.style.display = \"none\";\r\n    };\r\n\r\n    this.refresh = function(_metrics) {\r\n        if(isVisible === false) {\r\n            return;\r\n        }\r\n\r\n        const htmlStringsArr = [];\r\n        objectHtmlDumpDepthFirst(_metrics, htmlStringsArr);\r\n        debugPanelElem.innerHTML = htmlStringsArr.join('');\r\n    };\r\n\r\n};\r\n\r\nexport { DebugMetricsPanel };\r\n","import { MatrixMath } from './MatrixMath';\r\n\r\n/**\r\n * \r\n * @param {Number} _dblTapSpeed \r\n * @param {Number} _dblTapRadius \r\n */\r\nfunction DoubleTapDetector(_dblTapSpeed, _dblTapRadius)\r\n{\r\n    const dblTapDetectVars = {\r\n        lastTouchX: null,\r\n        lastTouchY: null,\r\n        lastTouchTime: null\r\n    };\r\n    \r\n    let dblTapSpeed = _dblTapSpeed || 300.0;\r\n    let dblTapRadius = _dblTapRadius || 24.0;\r\n\r\n    /**\r\n     * \r\n     * @param {TouchEvent} _touchEndEvent \r\n     * @param {Point} _sheetPageOffset \r\n     * @param {Array} currentInvTransformationMatrix\r\n     * @returns {Object}\r\n     */\r\n    this.processTap = function(_touchEndEvent, _sheetPageOffset, _currentInvTransformationMatrix) {\r\n        if(_touchEndEvent.changedTouches.length === 0) {\r\n            // we have nothing to work with\r\n            return {\r\n                \"doubleTapDetected\": false,\r\n                \"touchX\": null,\r\n                \"touchY\": null\r\n            };\r\n        }\r\n\r\n        // Position of the touch\r\n\r\n        // THIS NEEDS TO BE UPDATED TO ACCOUNT FOR OFFSET OF SHEET RELATIVE TO PAGE\r\n\r\n        const invTransformedPos = MatrixMath.vecMat4Multiply(\r\n            [_touchEndEvent.changedTouches[0].pageX - _sheetPageOffset.getX(), _touchEndEvent.changedTouches[0].pageY - _sheetPageOffset.getY(), 0, 1],\r\n            _currentInvTransformationMatrix\r\n        );            \r\n\r\n        let dblTapDetected = false;  // flag specifying if we detected a double-tap\r\n        const x = invTransformedPos[0];\r\n        const y = invTransformedPos[1];\r\n        const now = new Date().getTime();\r\n\r\n        // Check if we have stored data for a previous touch (indicating we should test for a double-tap)\r\n        if(dblTapDetectVars.lastTouchTime !== null) {\r\n            const lastTouchTime = dblTapDetectVars.lastTouchTime;\r\n\r\n            // Compute time since the previous touch\r\n            const timeSinceLastTouch = now - lastTouchTime;\r\n\r\n            // Get the position of the last touch on the element\r\n            const lastX = dblTapDetectVars.lastTouchX;\r\n            const lastY = dblTapDetectVars.lastTouchY;\r\n\r\n            // Compute the distance from the last touch on the element\r\n            const distFromLastTouch = Math.sqrt( Math.pow(x-lastX,2) + Math.pow(y-lastY,2) );\r\n\r\n            if(timeSinceLastTouch <= dblTapSpeed && distFromLastTouch <= dblTapRadius) {\r\n                // Remove last touch info from element\r\n                dblTapDetectVars.lastTouchTime = null;\r\n                dblTapDetectVars.lastTouchX = null;\r\n                dblTapDetectVars.lastTouchY = null;\r\n\r\n                // Flag that we detected a double tap\r\n                dblTapDetected = true;                \r\n            }\r\n        }\r\n\r\n        if(!dblTapDetected) {\r\n            dblTapDetectVars.lastTouchTime = now;\r\n            dblTapDetectVars.lastTouchX = x;\r\n            dblTapDetectVars.lastTouchY = y;\r\n        }\r\n\r\n        return {\r\n            \"doubleTapDetected\": dblTapDetected,\r\n            \"touchX\": x,\r\n            \"touchY\": y\r\n        }\r\n    };\r\n};\r\n\r\nexport { DoubleTapDetector };\r\n","const ConnectorEvent = Object.freeze({\r\n    CLICK: 'connector-click',\r\n    MOUSE_ENTER: 'connector-mouse-enter',\r\n    MOUSE_LEAVE: 'connector-mouse-leave'\r\n});\r\n\r\nexport { ConnectorEvent };\r\n","const ConnectorRoutingAlgorithm = Object.freeze({\r\n    STRAIGHT_LINE: 0,\r\n    STRAIGHT_LINE_BETWEEN_ANCHORS: 1,\r\n    STRAIGHT_LINE_BETWEEN_ANCHORS_AVOID_SELF_INTERSECTION: 2, // unsupported\r\n    ASTAR: 3,\r\n    ASTAR_WITH_ROUTE_OPTIMIZATION: 4,\r\n    ASTAR_THETA_WITH_ROUTE_OPTIMIZATION: 5,\r\n});\r\n\r\nexport { ConnectorRoutingAlgorithm };\r\n","import {ConnectorAnchor} from './ConnectorAnchor';\r\nimport {ConnectorEvent} from './ConnectorEvent';\r\nimport {ConnectorRoutingAlgorithm} from './ConnectorRoutingAlgorithm';\r\nimport {Line} from './Line';\r\nimport {Point} from './Point';\r\n\r\n/**\r\n * \r\n * @param {ConnectorAnchor} _anchorStart \r\n * @param {ConnectorAnchor} _anchorEnd\r\n * @param {Element} _containerDomElement\r\n * @param {Number} _curvaturePx\r\n * @param {ConnectorRoutingAlgorithm} _routingAlgorithm\r\n */\r\nfunction Connector(_anchorStart, _anchorEnd, _containerDomElement, _curvaturePx, _routingAlgorithm) {\r\n    const self = this;\r\n\r\n    const eventNameToHandlerFunc = new Map();\r\n    let markerStartSize = 0;\r\n    let markerEndSize = 0;\r\n    const defaultStrokeColor = '#000';\r\n    const defaultStrokeWidth = '2px';\r\n\r\n    if(typeof _curvaturePx === 'undefined') {\r\n        _curvaturePx = 0;\r\n    }\r\n\r\n    if(typeof _routingAlgorithm === 'undefined') {\r\n        _routingAlgorithm = ConnectorRoutingAlgorithm.ASTAR_THETA_WITH_ROUTE_OPTIMIZATION;\r\n    }\r\n\r\n    /**\r\n     * @type {Point[]|null}\r\n     */\r\n    let pathPoints = null;\r\n\r\n    /**\r\n     * @type {Element}\r\n     */\r\n    const pathElem = window.document.createElementNS(\"http://www.w3.org/2000/svg\", 'path');\r\n    pathElem.setAttribute(\"d\", 'M0 0 L0 0');\r\n    pathElem.style.stroke = defaultStrokeColor;\r\n    pathElem.style.strokeWidth = defaultStrokeWidth;\r\n\r\n    /**\r\n     * @type {Element}\r\n     * \r\n     * Transparent copy of pathElem, with a larger stroke, that is used for interaction (e.g. click, mousenter, etc.) events.\r\n     * This is to address the fact that it can be difficult to interact with pathElem when the stroke is small.\r\n     * \r\n     */\r\n    const interactionElem = window.document.createElementNS(\"http://www.w3.org/2000/svg\", 'path');\r\n    interactionElem.setAttribute(\"d\", 'M0 0 L0 0');\r\n    interactionElem.style.stroke = 'transparent';\r\n    interactionElem.style.strokeWidth = defaultStrokeWidth;\r\n\r\n    interactionElem.addEventListener(\"click\", function(e) {\r\n        self.dispatchEvent(ConnectorEvent.CLICK, {\"connector\":self, \"clickedAtX\": e.pageX, \"clickedAtY\": e.pageY});\r\n    });\r\n\r\n    interactionElem.addEventListener(\"mouseenter\", function(e) {\r\n        self.dispatchEvent(ConnectorEvent.MOUSE_ENTER, {\"connector\":self, \"pointerAtX\": e.pageX, \"pointerAtY\": e.pageY});\r\n    });\r\n\r\n    interactionElem.addEventListener(\"mouseleave\", function(e) {\r\n        self.dispatchEvent(ConnectorEvent.MOUSE_LEAVE, {\"connector\":self });\r\n    });        \r\n\r\n    this.appendPathToContainerDomElement = function() {\r\n        _containerDomElement.appendChild(pathElem);\r\n        _containerDomElement.appendChild(interactionElem);\r\n    };\r\n\r\n    /**\r\n     * @param {String} _url\r\n     * @param {Number} _size\r\n     */    \r\n    this.setMarkerStart = function(_url, _size) {\r\n        pathElem.setAttribute(`marker-start`, `url(${_url})`);\r\n        markerStartSize = _size;\r\n    };\r\n\r\n    this.unsetMarkerStart = function() {\r\n        pathElem.removeAttribute(`marker-start`);\r\n        markerStartSize = 0;\r\n    };\r\n\r\n    /**\r\n     * @param {String} _url\r\n     * @param {Number} _size\r\n     */\r\n    this.setMarkerEnd = function(_url, _size) {\r\n        pathElem.setAttribute(`marker-end`, `url(${_url})`);\r\n        markerEndSize = _size;\r\n    };\r\n\r\n    this.unsetMarkerEnd = function() {\r\n        pathElem.removeAttribute(`marker-end`);\r\n        markerEndSize = 0;\r\n    };    \r\n\r\n    /**\r\n     * @returns {Point[]|null}\r\n     */\r\n    this.getPathPoints = function() {\r\n        return pathPoints;\r\n    };\r\n\r\n    /**\r\n     * @returns {Line[]}\r\n     */\r\n    this.getPathLines = function() {\r\n        if(pathPoints === null || pathPoints.length < 2) {\r\n            return [];\r\n        }\r\n\r\n        const lines = [];\r\n        for(let i=0; i<pathPoints.length-1; i++) {\r\n            lines.push(new Line(pathPoints[i], pathPoints[i+1]));\r\n        }\r\n\r\n        return lines;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getLength = function() {\r\n        let totalLength = 0;\r\n\r\n        const pathLines = self.getPathLines();\r\n        for(let i=0; i<pathLines.length; i++) {\r\n            totalLength += pathLines[i].getLength();\r\n        }\r\n        \r\n        return totalLength;\r\n    };\r\n\r\n    /**\r\n     * @returns {Point}\r\n     */\r\n    this.getMidpoint = function() {\r\n        const totalLength = self.getLength();\r\n        const pathLines = self.getPathLines();\r\n\r\n        let lengthSoFar = 0;\r\n        let curPathLineWithMidpoint = null;\r\n\r\n        for(let i=0; i<pathLines.length; i++) {\r\n            curPathLineWithMidpoint = pathLines[i];\r\n            const pathLineLength = pathLines[i].getLength();\r\n            lengthSoFar += pathLineLength;\r\n\r\n            if(lengthSoFar >= totalLength/2.0) {\r\n                break;\r\n            }\r\n        }\r\n\r\n        const lengthBeforeCur = (lengthSoFar - curPathLineWithMidpoint.getLength());\r\n        const midOnCurPath = (totalLength / 2.0) - lengthBeforeCur; // i.e. distance to midpoint\r\n\r\n        const p = midOnCurPath / curPathLineWithMidpoint.getLength();\r\n\r\n        return new Point(\r\n            curPathLineWithMidpoint.getStartPoint().getX() + (p * (curPathLineWithMidpoint.getEndPoint().getX() - curPathLineWithMidpoint.getStartPoint().getX())),\r\n            curPathLineWithMidpoint.getStartPoint().getY() + (p * (curPathLineWithMidpoint.getEndPoint().getY() - curPathLineWithMidpoint.getStartPoint().getY()))\r\n        );\r\n    };\r\n\r\n    /**\r\n     * @returns {Point}\r\n     */\r\n    this.getMidpointDirection = function() {\r\n        const totalLength = self.getLength();\r\n        const pathLines = self.getPathLines();\r\n\r\n        let lengthSoFar = 0;\r\n        let curPathLineWithMidpoint = null;\r\n\r\n        for(let i=0; i<pathLines.length; i++) {\r\n            curPathLineWithMidpoint = pathLines[i];\r\n            const pathLineLength = pathLines[i].getLength();\r\n            lengthSoFar += pathLineLength;\r\n\r\n            if(lengthSoFar >= totalLength/2.0) {\r\n                break;\r\n            }\r\n        }\r\n\r\n        if(curPathLineWithMidpoint === null) {\r\n            return pathLines[0].getDirection();\r\n        }\r\n\r\n        return curPathLineWithMidpoint.getDirection();\r\n    };\r\n\r\n\r\n    /**\r\n     * @param {String} _svgPath\r\n     */\r\n    this.refresh = function(_svgPath) {\r\n        pathElem.setAttribute(\"d\", _svgPath);\r\n        interactionElem.setAttribute(\"d\", _svgPath);\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Point[]} _pathPoints\r\n     */\r\n    this.updatePathPoints = function(_pathPoints) {\r\n        pathPoints = _pathPoints;\r\n    };\r\n\r\n    /**\r\n     * @returns {String}\r\n     */\r\n    this.getId = function() {\r\n        const anchorIds = [_anchorStart.getId(), _anchorEnd.getId()].sort();\r\n        return anchorIds.join(':');\r\n    };\r\n\r\n    /**\r\n     * @returns {ConnectorAnchor}\r\n     */\r\n    this.getAnchorStart = function() {\r\n        return _anchorStart;\r\n    };\r\n\r\n    /**\r\n     * @returns {ConnectorAnchor}\r\n     */    \r\n    this.getAnchorEnd = function() {\r\n        return _anchorEnd;\r\n    };\r\n\r\n    this.removePathElement = function() {\r\n        pathElem.remove();\r\n        interactionElem.remove();\r\n    };\r\n\r\n    this.removeDefaultStyles = function() {\r\n        self.setInlineStyleOnPathElement('stroke', '');\r\n        self.setInlineStyleOnPathElement('strokeWidth', '');\r\n        self.setInlineStyleOnInteractionElement('stroke', '');\r\n        self.setInlineStyleOnInteractionElement('strokeWidth', '');        \r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {String} _key \r\n     * @param {String} _value \r\n     */\r\n    this.setInlineStyleOnPathElement = function(_key, _value) {\r\n        pathElem.style[_key] = _value;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {String[]} _cssClassesToAdd\r\n     */\r\n    this.addStyleClassesToPathElement = function(_cssClassesToAdd) {\r\n        _cssClassesToAdd.forEach((_cls) => {\r\n            pathElem.classList.add(_cls);\r\n        });\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {String[]} _cssClassesToRemove \r\n     */\r\n     this.removeStyleClassesFromPathElement = function(_cssClassesToRemove) {\r\n        _cssClassesToRemove.forEach((_cls) => {\r\n            pathElem.classList.remove(_cls);\r\n        });\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {String} _key \r\n     * @param {String} _value \r\n     */    \r\n    this.setInlineStyleOnInteractionElement = function(_key, _value) {\r\n        interactionElem.style[_key] = _value;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {String[]} _cssClassesToAdd \r\n     */    \r\n    this.addStyleClassesToInteractionElement = function(_cssClassesToAdd) {\r\n        _cssClassesToAdd.forEach((_cls) => {\r\n            interactionElem.classList.add(_cls);\r\n        });\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {String[]} _cssClassesToRemove \r\n     */    \r\n    this.removeStyleClassesFromInteractionElement = function(_cssClassesToRemove) {\r\n        _cssClassesToRemove.forEach((_cls) => {\r\n            interactionElem.classList.remove(_cls);\r\n        });\r\n    };\r\n\r\n    /**\r\n     * @returns {Object}\r\n     */\r\n    this.getDescriptor = function() {\r\n        return {\r\n            \"id\": self.getId(),\r\n            \"anchor_start_centroid_arr\": _anchorStart.getCentroid().toArray(),\r\n            \"anchor_end_centroid_arr\": _anchorEnd.getCentroid().toArray(),\r\n            \"marker_start_size\": markerStartSize,\r\n            \"marker_end_size\": markerEndSize,\r\n            \"curvature_px\": _curvaturePx,\r\n            \"routing_algorithm\": _routingAlgorithm\r\n        };\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {String} _eventName \r\n     * @param {*} _handlerFunc \r\n     */\r\n    this.on = function(_eventName, _handlerFunc) {\r\n        const allHandlers = eventNameToHandlerFunc.get(_eventName) || [];\r\n        allHandlers.push(_handlerFunc);\r\n        eventNameToHandlerFunc.set(_eventName, allHandlers);        \r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {String} _eventName \r\n     * @param {*} _callback \r\n     */\r\n    this.off = function(_eventName, _callback) {\r\n        const allCallbacks = eventNameToHandlerFunc.get(_eventName) || [];\r\n\r\n        for(let i=0; i<allCallbacks.length; i++) {\r\n            if(allCallbacks[i] === _callback) {\r\n                allCallbacks.splice(i, 1);\r\n                break;\r\n            }\r\n        }\r\n\r\n        eventNameToHandlerFunc.set(_eventName, allCallbacks);\r\n    };\r\n\r\n    /**\r\n     * @param {String} _eventId\r\n     * @param {Object} _eventData\r\n     */\r\n    this.dispatchEvent = function(_eventId, _eventData) {\r\n        const observers = eventNameToHandlerFunc.get(_eventId) || [];\r\n        observers.forEach(function(handler) {\r\n            handler(_eventData);\r\n        });\r\n    };\r\n};\r\n\r\nexport { Connector };\r\n","const GRID_STYLE = {\r\n    LINE: 'line',\r\n    DOT: 'dot'\r\n};\r\n\r\n/**\r\n * \r\n * @param {Number} _size\r\n * @param {String} _color\r\n * @param {String} _style\r\n */\r\nfunction Grid(_size, _color, _style) {\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getSize = function() {\r\n        return _size;\r\n    };\r\n\r\n    /**\r\n     * @returns {String}\r\n     */\r\n    this.getStyle = function() {\r\n        return _style;\r\n    };\r\n\r\n    /**\r\n     * @returns {String}\r\n     */\r\n    this.getSvgImageTile = function() {\r\n        if(_style === GRID_STYLE.LINE) {\r\n            return `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${_size}\" height=\"${_size}\"><rect width=\"${_size}\" height=\"1\" x=\"0\" y=\"${(_size-1.0)}\" style=\"fill:${_color}\" /><rect width=\"1\" height=\"${_size}\" x=\"${(_size-1.0)}\" y=\"0\" style=\"fill:${_color}\" /></svg>`;\r\n        } else {\r\n            return `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${_size}\" height=\"${_size}\"><rect width=\"1\" height=\"1\" x=\"${(_size-1.0)}\" y=\"${(_size-1.0)}\" style=\"fill:${_color}\" /></svg>`;\r\n        }\r\n    };\r\n\r\n};\r\n    \r\nexport { GRID_STYLE, Grid };\r\n","const ClusterDetectionWorkerJsString = String.raw`(function () {\n    'use strict';\n\n    function Point(a,b){this.__x=a,this.__y=b;}Point.prototype.getX=function(){return this.__x},Point.prototype.getY=function(){return this.__y},Point.prototype.isEqual=function(a){return !(this.__x!==a.getX()||this.__y!==a.getY())},Point.prototype.getCartesianPoint=function(a,b){return new Point(this.__x-.5*a,-this.__y+.5*b)},Point.prototype.toString=function(){return this.__x+\" \"+this.__y},Point.prototype.toArray=function(){return [this.__x,this.__y]},Point.fromArray=function(a){return new Point(a[0],a[1])};\n\n    var LINE_INTERSECTION_TYPE=Object.freeze({PARALLEL:\"parallel\",COINCIDENT:\"coincident\",LINE:\"line\",LINESEG:\"lineseg\"});function LineIntersection(a,b){this.__type=a,this.__intersectionPoint=b;}LineIntersection.prototype.getType=function(){return this.__type},LineIntersection.prototype.getIntersectionPoint=function(){return this.__intersectionPoint};\n\n    function Line(a,b){if(\"undefined\"==typeof a||null===a)throw \"Line missing _startPoint\";if(\"undefined\"==typeof b||null===b)throw \"Line missing _endPoint\";this.__startPoint=a,this.__endPoint=b;}Line.prototype.getStartPoint=function(){return this.__startPoint},Line.prototype.getEndPoint=function(){return this.__endPoint},Line.prototype.isEqual=function(a){return !!(this.getStartPoint().isEqual(a.getStartPoint())&&this.getEndPoint().isEqual(a.getEndPoint()))},Line.prototype.getLength=function(){return Math.sqrt(Math.pow(this.__endPoint.getX()-this.__startPoint.getX(),2)+Math.pow(this.__endPoint.getY()-this.__startPoint.getY(),2))},Line.prototype.getMinX=function(){return Math.min(this.getStartPoint().getX(),this.getEndPoint().getX())},Line.prototype.getMaxX=function(){return Math.max(this.getStartPoint().getX(),this.getEndPoint().getX())},Line.prototype.getMinY=function(){return Math.min(this.getStartPoint().getY(),this.getEndPoint().getY())},Line.prototype.getMaxY=function(){return Math.max(this.getStartPoint().getY(),this.getEndPoint().getY())},Line.prototype.getDirection=function(){var a=this.__endPoint.getX()-this.__startPoint.getX(),b=this.__endPoint.getY()-this.__startPoint.getY(),c=Math.sqrt(a*a+b*b);return new Point(a/c,b/c)},Line.prototype.createShortenedLine=function(a,b){var c=this.__endPoint.getX()-this.__startPoint.getX(),d=this.__endPoint.getY()-this.__startPoint.getY(),e=this.getDirection();return new Line(new Point(this.__startPoint.getX()+a*e.getX(),this.__startPoint.getY()+a*e.getY()),new Point(this.__startPoint.getX()+c-b*e.getX(),this.__startPoint.getY()+d-b*e.getY()))},Line.prototype.computeIntersectionType=function(a){var b=this.__startPoint.getX(),c=this.__startPoint.getY(),d=this.__endPoint.getX(),e=this.__endPoint.getY(),f=a.getStartPoint().getX(),g=a.getStartPoint().getY(),h=a.getEndPoint().getX(),i=a.getEndPoint().getY(),j=(i-g)*(d-b)-(h-f)*(e-c),k=(h-f)*(c-g)-(i-g)*(b-f),l=(d-b)*(c-g)-(e-c)*(b-f);if(0==j)return 0==j&&0==k&&0==l?LINE_INTERSECTION_TYPE.COINCIDENT:LINE_INTERSECTION_TYPE.PARALLEL;var m=k/j,n=l/j;return 1<m||0>m||1<n||0>n?LINE_INTERSECTION_TYPE.LINE:LINE_INTERSECTION_TYPE.LINESEG},Line.prototype.computeIntersection=function(a){var b=this.__startPoint.getX(),c=this.__startPoint.getY(),d=this.__endPoint.getX(),e=this.__endPoint.getY(),f=a.getStartPoint().getX(),g=a.getStartPoint().getY(),h=a.getEndPoint().getX(),i=a.getEndPoint().getY(),j=(i-g)*(d-b)-(h-f)*(e-c),k=(h-f)*(c-g)-(i-g)*(b-f),l=(d-b)*(c-g)-(e-c)*(b-f);if(0==j)return 0==j&&0==k&&0==l?new LineIntersection(LINE_INTERSECTION_TYPE.COINCIDENT,null):new LineIntersection(LINE_INTERSECTION_TYPE.PARALLEL,null);var m=k/j,n=l/j,o=this.__startPoint.getX()+m*(this.__endPoint.getX()-this.__startPoint.getX()),p=this.__startPoint.getY()+m*(this.__endPoint.getY()-this.__startPoint.getY());return 1<m||0>m||1<n||0>n?new LineIntersection(LINE_INTERSECTION_TYPE.LINE,new Point(o,p)):new LineIntersection(LINE_INTERSECTION_TYPE.LINESEG,new Point(o,p))};\n\n    function Rectangle(a,b,c,d){this.__left=a,this.__top=b,this.__right=c,this.__bottom=d;}Rectangle.prototype.getLeft=function(){return this.__left},Rectangle.prototype.getTop=function(){return this.__top},Rectangle.prototype.getRight=function(){return this.__right},Rectangle.prototype.getBottom=function(){return this.__bottom},Rectangle.prototype.getWidth=function(){return this.__right-this.__left},Rectangle.prototype.getHeight=function(){return this.__bottom-this.__top},Rectangle.prototype.getPoints=function(){return [new Point(this.__left,this.__top),new Point(this.__right,this.__top),new Point(this.__right,this.__bottom),new Point(this.__left,this.__bottom)]},Rectangle.prototype.getLines=function(){return [new Line(new Point(this.__left,this.__top),new Point(this.__right,this.__top)),new Line(new Point(this.__right,this.__top),new Point(this.__right,this.__bottom)),new Line(new Point(this.__right,this.__bottom),new Point(this.__left,this.__bottom)),new Line(new Point(this.__left,this.__bottom),new Point(this.__left,this.__top))]},Rectangle.prototype.getUniformlyResizedCopy=function(a){return new Rectangle(this.__left-a,this.__top-a,this.__right+a,this.__bottom+a)},Rectangle.prototype.getPointsScaledToGrid=function(a){var b=new Point(this.__left+.5*(this.__right-this.__left),this.__top+.5*(this.__bottom-this.__top)),c=(this.__right-b.getX()+a)/(this.__right-b.getX()),d=(this.__bottom-b.getY()+a)/(this.__bottom-b.getY()),e=[new Point((this.__left-b.getX())*c+b.getX(),(this.__top-b.getY())*d+b.getY()),new Point((this.__right-b.getX())*c+b.getX(),(this.__top-b.getY())*d+b.getY()),new Point((this.__right-b.getX())*c+b.getX(),(this.__bottom-b.getY())*d+b.getY()),new Point((this.__left-b.getX())*c+b.getX(),(this.__bottom-b.getY())*d+b.getY())];return e},Rectangle.prototype.checkIntersect=function(a){return !(this.__bottom<a.getTop())&&!(this.__top>a.getBottom())&&!(this.__right<a.getLeft())&&!(this.__left>a.getRight())},Rectangle.prototype.checkIsPointWithin=function(a){return !!(a.getX()>=this.__left&&a.getX()<=this.__right&&a.getY()>=this.__top&&a.getY()<=this.__bottom)},Rectangle.prototype.checkIsWithin=function(a){return !!(this.__bottom<=a.getBottom()&&this.__top>=a.getTop()&&this.__right<=a.getRight()&&this.__left>=a.getLeft())};\n\n    function DescriptorCollection(a){var b=this,c=[];this.getId=function(){return a},this.getDescriptorIndex=function(a){return b.getDescriptorIndexById(a.id)},this.getDescriptorIndexById=function(a){for(var b=0;b<c.length;b++)if(c[b].id===a)return b;return null},this.addDescriptor=function(a){return !(null!==b.getDescriptorIndex(a))&&(c.push(a),!0)},this.getDescriptors=function(){return c},this.getIds=function(){var a=[];return c.forEach(function(b){a.push(b.id);}),a},this.removeById=function(a){var d=b.getDescriptorIndexById(a);return null!==d&&(c.splice(d,1),!0)},this.removeAll=function(){c.length=0;};}\n\n    function Cluster(a){var b=new DescriptorCollection(a);this.getId=function(){return a},this.getEntityIndex=function(a){return b.getDescriptorIndex(a)},this.getEntityIndexById=function(a){return b.getDescriptorIndexById(a)},this.addEntity=function(a){return b.addDescriptor(a)},this.getEntities=function(){return b.getDescriptors()},this.getEntityIds=function(){return b.getIds()},this.removeEntityById=function(a){return b.removeById(a)},this.removeAllEntities=function(){return b.removeAll()},this.hasEntities=function(a){for(var c=!0,d=0;d<a.length;d++)if(null===b.getDescriptorIndexById(a[d])){c=!1;break}return c},this.toJSON=function(){return {id:a,entities:b.getDescriptors()}};}Cluster.fromJSON=function(a){var b=new Cluster(a.id);return a.entities.forEach(function(a){b.addEntity(a);}),b};\n\n    function BoxClusterDetector(a){var b=this,c=function getEntityIndexFromArray(a,b){for(var c=0;c<b.length;c++)if(b[c].id===a.id)return c;return -1},d=function removeEntitiesFromArray(a,b){for(var d,e=0;e<a.length;e++)d=c(a[e],b),-1!==d&&b.splice(d,1);return b},e=function getClusterWithMostEntitiesFromClusterMap(a){var b=0,c=null;return a.forEach(function(a,d,e){a>b&&(b=a,c=d);}),c},f=function computeDiffBetweenArrays(a,b){var c=[],d=[];return b.forEach(function(b){-1===a.indexOf(b)&&d.push(b);}),a.forEach(function(a){-1===b.indexOf(a)&&c.push(a);}),{onlyInA:c,onlyInB:d}};this.areEntitiesClose=function(b,c){var d=new Rectangle(b.x-a,b.y-a,b.x+b.width+a,b.y+b.height+a),e=new Rectangle(c.x-a,c.y-a,c.x+c.width+a,c.y+c.height+a);return d.checkIntersect(e)},this.getAllEntitiesCloseTo=function(a,c){for(var d=[],e=0;e<c.length;e++)a.id!==c[e].id&&b.areEntitiesClose(a,c[e])&&d.push(c[e]);return d},this.getClusterEntitiesFromSeed=function(a,c,e){var f=b.getAllEntitiesCloseTo(a,c);return 0===f.length?[]:void(d(f.concat([a]),c),f.forEach(function(a){e.push(a),b.getClusterEntitiesFromSeed(a,c,e);}))},this.findIntersectingClustersForEntities=function(a,b){var c=new Map;return b.forEach(function(b){for(var d=b.getEntities(),e=0;e<d.length;e++)for(var f=0;f<a.length;f++)if(d[e].id===a[f].id)if(c.has(b)){var g=c.get(b);c.set(b,g+1);}else c.set(b,1);}),c},this.removeEntityFromClusters=function(a,b){var c=[];return b.forEach(function(b){var d=b.removeEntityById(a.id);d&&c.push(b.getId());}),c},this.mapToClustersWithOldEntitiesRemoved=function(a,b){var c=b.map(function(b){for(var c=b.getEntityIds(),d=0;d<c.length;d++)-1===a.indexOf(c[d])&&b.removeEntityById(c[d]);return b});return c},this.computeClusters=function(a,c,g){for(var h=new Set,i=new Set,j=new Set,k=new Map,l=new Map,m=a.map(function(a){return a}),n=a.map(function(a){return a.id}),o=b.mapToClustersWithOldEntitiesRemoved(n,c),p=function _loop(){var a=m.pop(),c=[a];if(b.getClusterEntitiesFromSeed(a,m,c),1<c.length){var t=b.findIntersectingClustersForEntities(c,o);if(0===t.size){var j=g(),n=new Cluster(j);c.forEach(function(a){n.addEntity(a);}),o.push(n),h.add(j);}else {var p=e(t),q=p.getEntityIds();if(p.removeAllEntities(),c.forEach(function(a){var c=b.removeEntityFromClusters(a,o);c.forEach(function(a){i.add(a);}),p.addEntity(a);}),p.getEntityIds().length===q.length&&p.hasEntities(q));else {i.add(p.getId());var r=p.getEntityIds(),s=f(q,r);l.set(p.getId(),s.onlyInA),k.set(p.getId(),s.onlyInB);}}d(c,m);}else {var u=b.removeEntityFromClusters(a,o);u.forEach(function(b){i.add(b);var c=l.get(b);c?c.push(a.id):l.set(b,[a.id]),\"undefined\"==typeof k.get(b)&&k.set(b,[]);});}};0<m.length;)p();var q=o.filter(function(a){return !!(2>a.getEntities().length)});q.forEach(function(a){i.delete(a.getId()),k.delete(a.getId()),l.delete(a.getId()),j.add(a.getId());}),h.forEach(function(a){i.delete(a),k.delete(a),l.delete(a);});var r=o.filter(function(a){return !!(2<=a.getEntities().length)});return {clusters:r,newClusterIds:h,updatedClusterIds:i,deletedClusterIds:j,updatedClusterToRemovedEntitites:l,updatedClusterToAddedEntitites:k}};}\n\n    var UUID={v4:function v4(){return \"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g,function(a){var b=0|16*Math.random(),c=\"x\"==a?b:8|3&b;return c.toString(16)})}};\n\n    function EntityOverlapFinder(){var b=function addOverlapMapEntries(a,b,c){if(a.has(b)){var d=a.get(b);d.push(c);}else a.set(b,[c]);if(a.has(c)){var e=a.get(c);e.push(b);}else a.set(c,[b]);};this.findOverlappingEntities=function(a){for(var c=new Map,d=0;d<a.length;d++)for(var e=a[d],f=new Rectangle(e.x,e.y,e.x+e.width,e.y+e.height),g=d+1;g<a.length;g++){var h=a[g],k=new Rectangle(h.x,h.y,h.x+h.width,h.y+h.height),l=f.checkIntersect(k);l&&b(c,e.id,h.id);}return c};}\n\n    var workerData={requestQueue:[],knownClusters:[]},clustersToTransferrableMap=function clustersToTransferrableMap(a){for(var b=new Map,c=0;c<a.length;c++)b.set(a[c].getId(),a[c].toJSON());return b},processRequestQueue=function processRequestQueue(){if(0!==workerData.requestQueue.length){var a={overallTime:null},b=workerData.requestQueue.pop();workerData.requestQueue.length=0;var c=b.entityDescriptors,d=new BoxClusterDetector(12);if(null!==b.knownClustersOverwrite){var h=function toClusterArray(a){var b=[];return a.forEach(function(a){b.push(Cluster.fromJSON(a));}),b};workerData.knownClusters=h(b.knownClustersOverwrite);}var e=new Date,f=d.computeClusters(c,workerData.knownClusters,UUID.v4);a.computeClustersTime=new Date-e;var g=new EntityOverlapFinder().findOverlappingEntities(c);postMessage({metrics:a,clusters:clustersToTransferrableMap(f.clusters),newClusterIds:f.newClusterIds,updatedClusterIds:f.updatedClusterIds,deletedClusterIds:f.deletedClusterIds,updatedClusterToRemovedEntitites:f.updatedClusterToRemovedEntitites,updatedClusterToAddedEntitites:f.updatedClusterToAddedEntitites,overlappingEntities:g}),workerData.knownClusters=f.clusters;}};setInterval(processRequestQueue,50),onmessage=function onmessage(a){workerData.requestQueue.push(a.data);};\n\n}());\n`; export { ClusterDetectionWorkerJsString }","const ConnectorRoutingWorkerJsString = String.raw`(function () {\n  'use strict';\n\n  function _slicedToArray(arr, i) {\n    return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n  }\n\n  function _toConsumableArray(arr) {\n    return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n  }\n\n  function _arrayWithoutHoles(arr) {\n    if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n  }\n\n  function _arrayWithHoles(arr) {\n    if (Array.isArray(arr)) return arr;\n  }\n\n  function _iterableToArray(iter) {\n    if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n  }\n\n  function _iterableToArrayLimit(arr, i) {\n    var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"];\n\n    if (_i == null) return;\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n\n    var _s, _e;\n\n    try {\n      for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n        _arr.push(_s.value);\n\n        if (i && _arr.length === i) break;\n      }\n    } catch (err) {\n      _d = true;\n      _e = err;\n    } finally {\n      try {\n        if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n\n    return _arr;\n  }\n\n  function _unsupportedIterableToArray(o, minLen) {\n    if (!o) return;\n    if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n    var n = Object.prototype.toString.call(o).slice(8, -1);\n    if (n === \"Object\" && o.constructor) n = o.constructor.name;\n    if (n === \"Map\" || n === \"Set\") return Array.from(o);\n    if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n  }\n\n  function _arrayLikeToArray(arr, len) {\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }\n\n  function _nonIterableSpread() {\n    throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n\n  function _nonIterableRest() {\n    throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n\n  function _createForOfIteratorHelper(o, allowArrayLike) {\n    var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"];\n\n    if (!it) {\n      if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n        if (it) o = it;\n        var i = 0;\n\n        var F = function () {};\n\n        return {\n          s: F,\n          n: function () {\n            if (i >= o.length) return {\n              done: true\n            };\n            return {\n              done: false,\n              value: o[i++]\n            };\n          },\n          e: function (e) {\n            throw e;\n          },\n          f: F\n        };\n      }\n\n      throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n    }\n\n    var normalCompletion = true,\n        didErr = false,\n        err;\n    return {\n      s: function () {\n        it = it.call(o);\n      },\n      n: function () {\n        var step = it.next();\n        normalCompletion = step.done;\n        return step;\n      },\n      e: function (e) {\n        didErr = true;\n        err = e;\n      },\n      f: function () {\n        try {\n          if (!normalCompletion && it.return != null) it.return();\n        } finally {\n          if (didErr) throw err;\n        }\n      }\n    };\n  }\n\n  function Point(a,b){this.__x=a,this.__y=b;}Point.prototype.getX=function(){return this.__x},Point.prototype.getY=function(){return this.__y},Point.prototype.isEqual=function(a){return !(this.__x!==a.getX()||this.__y!==a.getY())},Point.prototype.getCartesianPoint=function(a,b){return new Point(this.__x-.5*a,-this.__y+.5*b)},Point.prototype.toString=function(){return this.__x+\" \"+this.__y},Point.prototype.toArray=function(){return [this.__x,this.__y]},Point.fromArray=function(a){return new Point(a[0],a[1])};\n\n  var LINE_INTERSECTION_TYPE=Object.freeze({PARALLEL:\"parallel\",COINCIDENT:\"coincident\",LINE:\"line\",LINESEG:\"lineseg\"});function LineIntersection(a,b){this.__type=a,this.__intersectionPoint=b;}LineIntersection.prototype.getType=function(){return this.__type},LineIntersection.prototype.getIntersectionPoint=function(){return this.__intersectionPoint};\n\n  function Line(a,b){if(\"undefined\"==typeof a||null===a)throw \"Line missing _startPoint\";if(\"undefined\"==typeof b||null===b)throw \"Line missing _endPoint\";this.__startPoint=a,this.__endPoint=b;}Line.prototype.getStartPoint=function(){return this.__startPoint},Line.prototype.getEndPoint=function(){return this.__endPoint},Line.prototype.isEqual=function(a){return !!(this.getStartPoint().isEqual(a.getStartPoint())&&this.getEndPoint().isEqual(a.getEndPoint()))},Line.prototype.getLength=function(){return Math.sqrt(Math.pow(this.__endPoint.getX()-this.__startPoint.getX(),2)+Math.pow(this.__endPoint.getY()-this.__startPoint.getY(),2))},Line.prototype.getMinX=function(){return Math.min(this.getStartPoint().getX(),this.getEndPoint().getX())},Line.prototype.getMaxX=function(){return Math.max(this.getStartPoint().getX(),this.getEndPoint().getX())},Line.prototype.getMinY=function(){return Math.min(this.getStartPoint().getY(),this.getEndPoint().getY())},Line.prototype.getMaxY=function(){return Math.max(this.getStartPoint().getY(),this.getEndPoint().getY())},Line.prototype.getDirection=function(){var a=this.__endPoint.getX()-this.__startPoint.getX(),b=this.__endPoint.getY()-this.__startPoint.getY(),c=Math.sqrt(a*a+b*b);return new Point(a/c,b/c)},Line.prototype.createShortenedLine=function(a,b){var c=this.__endPoint.getX()-this.__startPoint.getX(),d=this.__endPoint.getY()-this.__startPoint.getY(),e=this.getDirection();return new Line(new Point(this.__startPoint.getX()+a*e.getX(),this.__startPoint.getY()+a*e.getY()),new Point(this.__startPoint.getX()+c-b*e.getX(),this.__startPoint.getY()+d-b*e.getY()))},Line.prototype.computeIntersectionType=function(a){var b=this.__startPoint.getX(),c=this.__startPoint.getY(),d=this.__endPoint.getX(),e=this.__endPoint.getY(),f=a.getStartPoint().getX(),g=a.getStartPoint().getY(),h=a.getEndPoint().getX(),i=a.getEndPoint().getY(),j=(i-g)*(d-b)-(h-f)*(e-c),k=(h-f)*(c-g)-(i-g)*(b-f),l=(d-b)*(c-g)-(e-c)*(b-f);if(0==j)return 0==j&&0==k&&0==l?LINE_INTERSECTION_TYPE.COINCIDENT:LINE_INTERSECTION_TYPE.PARALLEL;var m=k/j,n=l/j;return 1<m||0>m||1<n||0>n?LINE_INTERSECTION_TYPE.LINE:LINE_INTERSECTION_TYPE.LINESEG},Line.prototype.computeIntersection=function(a){var b=this.__startPoint.getX(),c=this.__startPoint.getY(),d=this.__endPoint.getX(),e=this.__endPoint.getY(),f=a.getStartPoint().getX(),g=a.getStartPoint().getY(),h=a.getEndPoint().getX(),i=a.getEndPoint().getY(),j=(i-g)*(d-b)-(h-f)*(e-c),k=(h-f)*(c-g)-(i-g)*(b-f),l=(d-b)*(c-g)-(e-c)*(b-f);if(0==j)return 0==j&&0==k&&0==l?new LineIntersection(LINE_INTERSECTION_TYPE.COINCIDENT,null):new LineIntersection(LINE_INTERSECTION_TYPE.PARALLEL,null);var m=k/j,n=l/j,o=this.__startPoint.getX()+m*(this.__endPoint.getX()-this.__startPoint.getX()),p=this.__startPoint.getY()+m*(this.__endPoint.getY()-this.__startPoint.getY());return 1<m||0>m||1<n||0>n?new LineIntersection(LINE_INTERSECTION_TYPE.LINE,new Point(o,p)):new LineIntersection(LINE_INTERSECTION_TYPE.LINESEG,new Point(o,p))};\n\n  function PointSet(a){var b=this,c=[];this.push=function(a){for(var b=0;b<c.length;b++)if(a.isEqual(c[b]))return !1;return c.push(a),!0},this.pushPointSet=function(a){for(var c=a.toArray(),d=0;d<c.length;d++)b.push(c[d]);},this.findPointClosestTo=function(a){var b=null,d=Number.MAX_SAFE_INTEGER;return c.forEach(function(c){var e=new Line(a,c);e.getLength()<d&&(b=c,d=e.getLength());}),b},this.findDistanceToPointClosestTo=function(a){var b=Number.MAX_SAFE_INTEGER;return c.forEach(function(c){var d=new Line(a,c);d.getLength()<b&&(b=d.getLength());}),b},this.findPointsCloseTo=function(a,b){var d=new PointSet;return c.forEach(function(c){var e=new Line(a,c);e.getLength()<=b&&d.push(c);}),d},this.toArray=function(){return c},this.toFloat64Array=function(){for(var a=new Float64Array(2*c.length),b=0;b<c.length;b++)a[0+2*b]=c[b].getX(),a[1+2*b]=c[b].getY();return a};var d=function fromFloat64Array(a){c.length=0;for(var b=0;b<a.length;b+=2)c.push(new Point(a[b],a[b+1]));};this.count=function(){return c.length},a&&Array.isArray(a)?a.forEach(b.push):a&&\"[object Float64Array]\"===Object.prototype.toString.call(a)&&d(a);}\n\n  function Rectangle(a,b,c,d){this.__left=a,this.__top=b,this.__right=c,this.__bottom=d;}Rectangle.prototype.getLeft=function(){return this.__left},Rectangle.prototype.getTop=function(){return this.__top},Rectangle.prototype.getRight=function(){return this.__right},Rectangle.prototype.getBottom=function(){return this.__bottom},Rectangle.prototype.getWidth=function(){return this.__right-this.__left},Rectangle.prototype.getHeight=function(){return this.__bottom-this.__top},Rectangle.prototype.getPoints=function(){return [new Point(this.__left,this.__top),new Point(this.__right,this.__top),new Point(this.__right,this.__bottom),new Point(this.__left,this.__bottom)]},Rectangle.prototype.getLines=function(){return [new Line(new Point(this.__left,this.__top),new Point(this.__right,this.__top)),new Line(new Point(this.__right,this.__top),new Point(this.__right,this.__bottom)),new Line(new Point(this.__right,this.__bottom),new Point(this.__left,this.__bottom)),new Line(new Point(this.__left,this.__bottom),new Point(this.__left,this.__top))]},Rectangle.prototype.getUniformlyResizedCopy=function(a){return new Rectangle(this.__left-a,this.__top-a,this.__right+a,this.__bottom+a)},Rectangle.prototype.getPointsScaledToGrid=function(a){var b=new Point(this.__left+.5*(this.__right-this.__left),this.__top+.5*(this.__bottom-this.__top)),c=(this.__right-b.getX()+a)/(this.__right-b.getX()),d=(this.__bottom-b.getY()+a)/(this.__bottom-b.getY()),e=[new Point((this.__left-b.getX())*c+b.getX(),(this.__top-b.getY())*d+b.getY()),new Point((this.__right-b.getX())*c+b.getX(),(this.__top-b.getY())*d+b.getY()),new Point((this.__right-b.getX())*c+b.getX(),(this.__bottom-b.getY())*d+b.getY()),new Point((this.__left-b.getX())*c+b.getX(),(this.__bottom-b.getY())*d+b.getY())];return e},Rectangle.prototype.checkIntersect=function(a){return !(this.__bottom<a.getTop())&&!(this.__top>a.getBottom())&&!(this.__right<a.getLeft())&&!(this.__left>a.getRight())},Rectangle.prototype.checkIsPointWithin=function(a){return !!(a.getX()>=this.__left&&a.getX()<=this.__right&&a.getY()>=this.__top&&a.getY()<=this.__bottom)},Rectangle.prototype.checkIsWithin=function(a){return !!(this.__bottom<=a.getBottom()&&this.__top>=a.getTop()&&this.__right<=a.getRight()&&this.__left>=a.getLeft())};\n\n  var AccessibleRoutingPointsFinder={find:function find(a,b,c){var d=new Map,e=[],f=new PointSet;return a.forEach(function(a){var b=a.connectorAnchors;b.forEach(function(a){{var c=new PointSet(a.routingPointsFloat64Arr).toArray();c.forEach(function(b){e.push({routingPoint:b,parentAnchorId:a.id});}),d.set(a.id,c.length);}});}),e.forEach(function(a){for(var c=!1,e=0;e<b.length;e++){var g=b[e],h=new Rectangle(g.x,g.y,g.x+g.width,g.y+g.height);if(h.checkIsPointWithin(a.routingPoint)){c=!0;var j=d.get(a.parentAnchorId)||0;d.set(a.parentAnchorId,Math.max(0,j-1));}}c||f.push(a.routingPoint);}),{connectorAnchorToNumValidRoutingPoints:d,accessibleRoutingPoints:f}}};\n\n  function LineSet(a){var b=this,c=[];this.push=function(a){for(var b=0;b<c.length;b++)if(a.isEqual(c[b]))return !1;return c.push(a),!0},this.toArray=function(){return c},this.count=function(){return c.length},this.toFloat64Array=function(){for(var a=new Float64Array(4*c.length),b=0;b<c.length;b++)a[0+4*b]=c[b].getStartPoint().getX(),a[1+4*b]=c[b].getStartPoint().getY(),a[2+4*b]=c[b].getEndPoint().getX(),a[3+4*b]=c[b].getEndPoint().getY();return a};var d=function fromFloat64Array(a){c.length=0;for(var b=0;b<a.length;b+=4)c.push(new Line(new Point(a[b],a[b+1]),new Point(a[b+2],a[b+3])));};a&&Array.isArray(a)?a.forEach(b.push):a&&\"[object Float64Array]\"===Object.prototype.toString.call(a)&&d(a);}\n\n  var PointVisibilityMapRouteOptimizer={optimize:function optimize(a,b){for(var c=0,d=a.length-1;!(1>=d-c&&(c++,d=a.length-1,c>=a.length-2));)b(a[c],a[d])?(a.splice(c+1,d-c-1),d=a.length-1):d--;}};\n\n  function Vec2(a,b){this.__x=a,this.__y=b;}Vec2.prototype=Object.create(Point.prototype,{}),Vec2.prototype.normalize=function(){var a=Math.sqrt(this.__x*this.__x+this.__y*this.__y);return 0===a?this:(this.__x/=a,this.__y/=a,this)},Vec2.prototype.dot=function(a){return this.__x*a.getX()+this.__y*a.getY()};\n\n  var ConnectorRoutingAlgorithm=Object.freeze({STRAIGHT_LINE:0,STRAIGHT_LINE_BETWEEN_ANCHORS:1,STRAIGHT_LINE_BETWEEN_ANCHORS_AVOID_SELF_INTERSECTION:2,ASTAR:3,ASTAR_WITH_ROUTE_OPTIMIZATION:4,ASTAR_THETA_WITH_ROUTE_OPTIMIZATION:5});\n\n  var PointInfo={point:null,visiblePoints:null};function PointVisibilityMap(){var a=this,b=new Map,c=new Map,d=new Map,e=0,f=0,g=function doesLineIntersectAnyBoundaryLines(a){var b,e=_createForOfIteratorHelper(c);try{for(e.s();!(b=e.n()).done;){var f=_slicedToArray(b.value,2),g=f[0],h=f[1],j=d.get(g);if(!(a.getMinX()>j.outerBoundingRect.maxX)&&!(a.getMaxX()<j.outerBoundingRect.minX)&&!(a.getMinY()>j.outerBoundingRect.maxY)&&!(a.getMaxY()<j.outerBoundingRect.minY))for(var k,l=h.toArray(),m=0;m<l.length;m++)if(k=l[m].computeIntersectionType(a),k===LINE_INTERSECTION_TYPE.LINESEG)return !0}}catch(a){e.e(a);}finally{e.f();}return !1},h=function computePointsVisibilityForPoint(a){a.visiblePoints.points.length=0;var c,d=_createForOfIteratorHelper(b);try{for(d.s();!(c=d.n()).done;){var e,f=_slicedToArray(c.value,2),h=f[0],i=f[1],j=_createForOfIteratorHelper(i);try{for(j.s();!(e=j.n()).done;){var k=_slicedToArray(e.value,2),l=k[0],m=k[1],n=new Line(a.point,l);0<n.getLength()&&!g(n)&&a.visiblePoints.points.push(l);}}catch(a){j.e(a);}finally{j.f();}}}catch(a){d.e(a);}finally{d.f();}a.visiblePoints.isValid=!0;},i=function arePointsVisibleToEachOther(a,b){for(var c=o(a),d=j(c),e=0;e<d.length;e++)if(d[e].isEqual(b))return !0;return !1},j=function getVisiblePointsRelativeTo(a){return a.visiblePoints.isValid||h(a),a.visiblePoints.points},k=function isPointInArray(a,b){for(var c=0;c<b.length;c++)if(a.isEqual(b[c]))return !0;return !1},l=function routeToEndpoint(a,b,c,d,e,f,g){for(var h,l=c.point,m=j(c),n=Number.MAX_SAFE_INTEGER,o=null,p=new Vec2(e.getX()-l.getX(),e.getY()-l.getY()).normalize(),q=0;q<m.length;q++)if(h=m[q],!k(h,b)){var r=new Line(l,h).getLength(),s=r+a,t=new Line(h,e).getLength(),u=0;if(g===ConnectorRoutingAlgorithm.ASTAR_THETA_WITH_ROUTE_OPTIMIZATION){var v=new Vec2(h.getX()-l.getX(),h.getY()-l.getY()).normalize();u=p.dot(v)*r,e.getX()>l.getX()&&h.getX()>e.getX()&&(u=0),e.getX()<l.getX()&&h.getX()<e.getX()&&(u=0),e.getY()>l.getY()&&h.getY()>e.getY()&&(u=0),e.getY()<l.getY()&&h.getY()<e.getY()&&(u=0);}s+t-u<n&&(n=s+t-u,o=h);}return n===Number.MAX_SAFE_INTEGER?null:{cost:n,point:o}},m=function getBoundaryLinesFromEntityDescriptor(a){var b=new LineSet,c=new Rectangle(a.x,a.y,a.x+a.width,a.y+a.height),d=c.getLines();d.forEach(function(a){b.push(a);});var e=a.connectorAnchors;return e.forEach(function(a){var c=new Rectangle(a.x,a.y,a.x+a.width,a.y+a.height),d=c.getLines();d.forEach(function(a){b.push(a);});}),b},n=function hasEntityMutated(a,b){return !(a.x===b.x&&a.y===b.y&&a.width===b.width&&a.height===b.height)},o=function fetchPointInfoForPoint(a){var c,d=_createForOfIteratorHelper(b);try{for(d.s();!(c=d.n()).done;){var e,f=_slicedToArray(c.value,2),g=f[0],h=f[1],i=_createForOfIteratorHelper(h);try{for(i.s();!(e=i.n()).done;){var j=_slicedToArray(e.value,2),k=j[0],l=j[1];if(k===a)return p(k,l)}}catch(a){i.e(a);}finally{i.f();}}}catch(a){d.e(a);}finally{d.f();}return null},p=function buildPointInfo(a,b){var c=Object.create(PointInfo);return c.point=a,c.visiblePoints=b,c},q=function buildEmptyRoutingPointToVisibleSetMap(a,b,c,d){for(var e=new Rectangle(a.x,a.y,a.x+a.width,a.y+a.height),f=AccessibleRoutingPointsFinder.find([a],b,c),g=f.accessibleRoutingPoints.toArray(),h=new Map,i=0;i<g.length;i++)h.set(g[i],{isValid:!1,points:[]});var k=e.getPointsScaledToGrid(c*d);return k.forEach(function(a){h.set(a,{isValid:!1,points:[]});}),h},s=function doesRoutingAlgorithmRequireOptimization(a){return !(a!==ConnectorRoutingAlgorithm.ASTAR_WITH_ROUTE_OPTIMIZATION&&a!==ConnectorRoutingAlgorithm.ASTAR_THETA_WITH_ROUTE_OPTIMIZATION)};this.updateRoutingPointsAndBoundaryLinesFromEntityDescriptors=function(a,g,h){\"undefined\"==typeof h&&(h=1),e=0,f=0;for(var j,k=[],l=[],o=[],p=0;p<a.length;p++){j=a[p].id,k.push(j);var r=c.get(j),s=d.get(j);if(r&&!n(s,a[p])){f+=r.count();continue}var A=m(a[p]);c.set(j,A),f+=A.count();}for(var B=0;B<a.length;B++){var t=a[B].id,u=d.get(t);!u||n(u,a[B]);var C=q(a[B],a,g,h);b.set(t,C),d.set(t,a[B]),l.push(t),e+=C.size;}var v,w=_createForOfIteratorHelper(d);try{for(w.s();!(v=w.n()).done;){var x=_slicedToArray(v.value,2),y=x[0],z=x[1];k.includes(y)||(l.push(y),o.push(y));}}catch(a){w.e(a);}finally{w.f();}return o.forEach(function(a){d.delete(a),c.delete(a),b.delete(a);}),l.length},this.getCurrentNumRoutingPoints=function(){return e},this.getCurrentNumBoundaryLines=function(){return f},this.findVisiblePointInfoClosestTo=function(a){var c,d=null,e=Number.MAX_SAFE_INTEGER,f=_createForOfIteratorHelper(b);try{for(f.s();!(c=f.n()).done;){var h,i=_slicedToArray(c.value,2),j=i[0],k=i[1],l=_createForOfIteratorHelper(k);try{for(l.s();!(h=l.n()).done;){var m=_slicedToArray(h.value,2),n=m[0],o=m[1],q=new Line(a,n),r=q.getLength();r<e&&!g(q)&&(d=p(n,o),e=r);;}}catch(a){l.e(a);}finally{l.f();}}}catch(a){f.e(a);}finally{f.f();}return d},this.computeRoute=function(b,c,d){if(null===b||null===c)return new PointSet;var e=a.findVisiblePointInfoClosestTo(b);if(null===e)return new PointSet;for(var f,h=new Vec2(c.getX()-b.getX(),c.getY()-b.getY()).normalize(),j=[e.point],k=0,m=e;!0;){if(f=l(k,j,m,b,c,h,d),null===f){var n=new Line(j[j.length-1],c);if(g(n))return new PointSet;break}if(k+=new Line(m.point,f.point).getLength(),j.push(f.point),m=o(f.point),1>new Line(m.point,c).getLength())break}return s(d)&&PointVisibilityMapRouteOptimizer.optimize(j,i),new PointSet(j)};}\n\n  var SvgPathBuilder={pointToLineTo:function pointToLineTo(a,b){return 0===b?\"M\"+a.getX()+\" \"+a.getY():\"L\"+a.getX()+\" \"+a.getY()},pointTripletToTesselatedCurvePoints:function pointTripletToTesselatedCurvePoints(a,b){if(3!==a.length)throw new Error(\"_points must be array of exactly 3 points\");var c=a[1],d=new Line(a[0],a[1]),e=new Line(a[1],a[2]),f=d.createShortenedLine(0,.5*b),g=e.createShortenedLine(.5*b,0);return [f.getStartPoint(),f.getEndPoint(),g.getStartPoint(),g.getEndPoint()]},pointsToPath:function pointsToPath(a,b){b=b||0;var c=[],d=0;if(0<b){for(;3<=a.length;){var e=a.shift(),f=a.shift(),g=a.shift(),h=SvgPathBuilder.pointTripletToTesselatedCurvePoints([e,f,g],b);a.unshift(h[3]),a.unshift(h[2]);for(var k=0;k<h.length-2;k++)c.push(SvgPathBuilder.pointToLineTo(h[k],d++));}for(;0<a.length;){var j=a.shift();c.push(SvgPathBuilder.pointToLineTo(j,d++));}}else for(var l,m=0;m<a.length;m++)l=a[m],c.push(SvgPathBuilder.pointToLineTo(l,m));return c.join(\" \")}};\n\n  var workerData={pointVisibilityMap:new PointVisibilityMap,requestQueue:[]},computeConnectorPath=function computeConnectorPath(a,b,c){var d=Point.fromArray(a.anchor_start_centroid_arr),e=Point.fromArray(a.anchor_end_centroid_arr),f=a.marker_start_size,g=a.marker_end_size,h=a.curvature_px,i=a.routing_algorithm,j=b.findDistanceToPointClosestTo(d),k=b.findDistanceToPointClosestTo(e),l=b.findPointsCloseTo(d,j).findPointClosestTo(e),m=b.findPointsCloseTo(e,k).findPointClosestTo(d),n=new PointSet;if(i==ConnectorRoutingAlgorithm.STRAIGHT_LINE_BETWEEN_ANCHORS)n=new PointSet([l,m]);else if(i===ConnectorRoutingAlgorithm.ASTAR||i===ConnectorRoutingAlgorithm.ASTAR_WITH_ROUTE_OPTIMIZATION||i===ConnectorRoutingAlgorithm.ASTAR_THETA_WITH_ROUTE_OPTIMIZATION)n=c.computeRoute(l,m,i);else throw \"Invalid routing algorithm\";var o=n.toArray(),p=d,q=e;if(0<f&&1<=o.length){var s=new Line(o[0],d).createShortenedLine(0,f);p=s.getEndPoint();}if(0<g&&1<=o.length){var t=new Line(o[o.length-1],e).createShortenedLine(0,g);q=t.getEndPoint();}var r=[p].concat(_toConsumableArray(o),[q]);return {svgPath:SvgPathBuilder.pointsToPath(r,h),pointsInPath:r}},getConnectorRoutingPointsAroundAnchor=function getConnectorRoutingPointsAroundAnchor(a,b){var c=AccessibleRoutingPointsFinder.find(a,a,b);return c.accessibleRoutingPoints},processRequestQueue=function processRequestQueue(){if(0!==workerData.requestQueue.length){var a=workerData.requestQueue.pop();workerData.requestQueue.length=0;var b={overallTime:null},c=new Date,d=a.gridSize,e=a.connectorDescriptors,f=a.entityDescriptors,g=a.boundingExtentRoutingPointScaleFactor,h=new Date,i=getConnectorRoutingPointsAroundAnchor(f,d);b.msgDecodeTime=new Date-h;var j=new Date;workerData.pointVisibilityMap.updateRoutingPointsAndBoundaryLinesFromEntityDescriptors(f,d,g),b.pointVisibilityMapCreationTime=new Date-j;var k=new Date;e.forEach(function(a){var b=computeConnectorPath(a,i,workerData.pointVisibilityMap),c=new PointSet(b.pointsInPath);a.svgPath=b.svgPath,a.pointsInPath=c.toFloat64Array().buffer;}),b.allPathsComputationTime=new Date-k,b.numRoutingPoints=workerData.pointVisibilityMap.getCurrentNumRoutingPoints(),b.numBoundaryLines=workerData.pointVisibilityMap.getCurrentNumBoundaryLines(),b.overallTime=new Date-c,postMessage({connectorDescriptors:e,metrics:b});}};setInterval(processRequestQueue,6),onmessage=function onmessage(a){workerData.requestQueue.push(a.data);};\n\n}());\n`; export { ConnectorRoutingWorkerJsString }","/**\r\n * \r\n * @param {String} _collectionId\r\n */\r\n function DescriptorCollection(_collectionId) {\r\n    const self = this;\r\n\r\n    /**\r\n     * @type {Object[]}\r\n     */\r\n    const descriptors = [];\r\n\r\n    /**\r\n     * @returns {String}\r\n     */\r\n    this.getId = function() {\r\n        return _collectionId;\r\n    };\r\n\r\n    /**\r\n     * @param {Object} _descriptor\r\n     * @returns {Number|null}\r\n     */\r\n    this.getDescriptorIndex = function(_descriptor) {\r\n        return self.getDescriptorIndexById(_descriptor.id);\r\n    };\r\n\r\n    /**\r\n     * @param {String} _descriptorId\r\n     * @returns {Number|null}\r\n     */\r\n    this.getDescriptorIndexById = function(_descriptorId) {\r\n        for(let i=0; i<descriptors.length; i++) {\r\n            if(descriptors[i].id === _descriptorId) {\r\n                return i;\r\n            }\r\n        }\r\n\r\n        return null;\r\n    };\r\n\r\n    /**\r\n     * @param {Object} _descriptor\r\n     * @returns {Boolean}\r\n     */\r\n    this.addDescriptor = function(_descriptor) {\r\n        if(self.getDescriptorIndex(_descriptor) !== null) {\r\n            return false;\r\n        }\r\n\r\n        descriptors.push(_descriptor);\r\n        return true;\r\n    };\r\n\r\n    /**\r\n     * @returns {Object[]}\r\n     */\r\n    this.getDescriptors = function() {\r\n        return descriptors;\r\n    };\r\n\r\n    /**\r\n     * @returns {String[]}\r\n     */\r\n    this.getIds = function() {\r\n        const ids = [];\r\n        descriptors.forEach(function(_d) {\r\n            ids.push(_d.id);\r\n        });\r\n\r\n        return ids;\r\n    };    \r\n\r\n    /**\r\n     * @param {String} _id\r\n     * @returns {Boolean}\r\n     */\r\n    this.removeById = function(_id) {\r\n        const idx = self.getDescriptorIndexById(_id);\r\n        if(idx === null) {\r\n            return false;\r\n        }\r\n\r\n        descriptors.splice(idx, 1);\r\n        return true;\r\n    };\r\n\r\n    this.removeAll = function() {\r\n        descriptors.length = 0;\r\n    };\r\n};\r\n\r\nexport { DescriptorCollection };\r\n","import {DescriptorCollection} from './DescriptorCollection';\r\n\r\n/**\r\n * \r\n * @param {String} _clusterId\r\n */\r\nfunction Cluster(_clusterId) {\r\n    const entityDescriptorCollection = new DescriptorCollection(_clusterId);\r\n\r\n    /**\r\n     * @returns {String}\r\n     */\r\n    this.getId = function() {\r\n        return _clusterId;\r\n    };\r\n\r\n    /**\r\n     * @param {Object} _entity\r\n     * @returns {Number|null}\r\n     */\r\n    this.getEntityIndex = function(_entity) {\r\n        return entityDescriptorCollection.getDescriptorIndex(_entity);\r\n    };\r\n\r\n    /**\r\n     * @param {String} _entityId\r\n     * @returns {Number|null}\r\n     */\r\n    this.getEntityIndexById = function(_entityId) {\r\n        return entityDescriptorCollection.getDescriptorIndexById(_entityId);\r\n    };\r\n\r\n    /**\r\n     * @param {Object} _entity\r\n     * @returns {Boolean}\r\n     */\r\n    this.addEntity = function(_entity) {\r\n        return entityDescriptorCollection.addDescriptor(_entity);\r\n    };\r\n\r\n    /**\r\n     * @returns {Object[]}\r\n     */\r\n    this.getEntities = function() {\r\n        return entityDescriptorCollection.getDescriptors();\r\n    };\r\n\r\n    /**\r\n     * @returns {String[]}\r\n     */\r\n    this.getEntityIds = function() {\r\n        return entityDescriptorCollection.getIds();\r\n    };    \r\n\r\n    /**\r\n     * @param {String} _id\r\n     * @returns {Boolean}\r\n     */\r\n    this.removeEntityById = function(_id) {\r\n        return entityDescriptorCollection.removeById(_id);\r\n    };\r\n\r\n    this.removeAllEntities = function() {\r\n        return entityDescriptorCollection.removeAll();\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {String[]} _entityIds \r\n     * @returns {Boolean}\r\n     */\r\n    this.hasEntities = function(_entityIds) {\r\n        let isEquivalent = true;\r\n        for(let i=0; i<_entityIds.length; i++) {\r\n            if(entityDescriptorCollection.getDescriptorIndexById(_entityIds[i]) === null) {\r\n                isEquivalent = false;\r\n                break;\r\n            }\r\n        }\r\n\r\n        return isEquivalent;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @returns {Object}\r\n     */\r\n    this.toJSON = function() {\r\n        return {\r\n            \"id\": _clusterId,\r\n            \"entities\": entityDescriptorCollection.getDescriptors()\r\n        };\r\n    };\r\n};\r\n\r\nCluster.fromJSON = function(_clusterJSON) {\r\n    const result = new Cluster(_clusterJSON.id);\r\n    _clusterJSON.entities.forEach((_entityDescriptor) => {\r\n        result.addEntity(_entityDescriptor);\r\n    });\r\n\r\n    return result;\r\n};\r\n\r\nexport { Cluster };\r\n","/**\r\n * @readonly\r\n * @enum {Number}\r\n */\r\nconst Originator = Object.freeze({\r\n    PROGRAM: 0,\r\n    USER: 1,\r\n});\r\n\r\n\r\nexport { Originator };\r\n","import {MatrixMath} from './MatrixMath';\r\nimport {BestToConnectEntitiesFinder} from './ConnectorAnchorFinder/BestToConnectEntitiesFinder';\r\nimport {SheetEvent} from './SheetEvent';\r\nimport {Entity} from './Entity';\r\nimport {EntityEvent} from './EntityEvent';\r\nimport {DebugMetricsPanel} from './DebugMetricsPanel/DebugMetricsPanel';\r\nimport {DoubleTapDetector} from './DoubleTapDetector';\r\nimport {Rectangle} from './Rectangle';\r\nimport {Point} from './Point';\r\nimport {PointSet} from './PointSet';\r\nimport {GroupTransformationContainer} from './GroupTransformationContainer';\r\nimport {Connector} from './Connector';\r\nimport {GRID_STYLE, Grid} from './Grid';\r\nimport {GroupTransformationContainerEvent } from './GroupTransformationContainerEvent';\r\nimport {ClusterDetectionWorkerJsString} from './Workers/ClusterDetectionWorker.string';\r\nimport {ConnectorRoutingWorkerJsString} from './Workers/ConnectorRoutingWorker.string';\r\nimport {Cluster} from './Cluster';\r\nimport {Originator} from './Originator';\r\n\r\n/**\r\n * @callback HandleSheetInteractionCallback\r\n * @param {String} interactionType\r\n * @param {Object} interactionData\r\n */ \r\n\r\n /**\r\n * @param {Element} _sheetDomElement \r\n * @param {Window} _window\r\n */\r\nfunction Sheet(_sheetDomElement, _window) {\r\n    const self = this;\r\n\r\n    // Create container for SVG connectors\r\n    const svgElem = _window.document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\r\n    svgElem.style.width = \"100%\";\r\n    svgElem.style.height = \"100%\";\r\n    const connectorsContainerDomElement = _sheetDomElement.appendChild(svgElem);\r\n\r\n    // Selection box element\r\n    var selectionBoxElem = null;\r\n\r\n    // GroupTransformationContainers\r\n    const groupTransformationContainers = [];\r\n    var currentGroupTransformationContainerBeingDragged = null;\r\n  \r\n    /**\r\n     * @type {Grid}\r\n     */\r\n    var grid = null;\r\n\r\n    var transitionCss = \"transform 0.55s ease-in-out, transform-origin 0.55s ease-in-out\";\r\n\r\n    var transformOriginX = 0;\r\n    var transformOriginY = 0;\r\n\r\n    var touchMoveLastX = 0.0;\r\n    var touchMoveLastY = 0.0;\r\n\r\n    var translateX = 0;\r\n    var translateY = 0;\r\n    var scaleFactor = 1.0;\r\n    var invScaleFactor = 1.0;\r\n\r\n    let boundingExtentRoutingPointScaleFactor = 1.0;\r\n\r\n    const invTransformationMatrixStack = [];\r\n    var currentInvTransformationMatrix = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\r\n    var currentTransformationMatrix = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\r\n\r\n    var connectorRefreshBufferTime = 6.94;\r\n    var useTranslate3d = false; // better performance w/o it\r\n    const sheetEntities = [];\r\n\r\n    /**\r\n     * @type {Connector[]}\r\n     */\r\n    const objectConnectors = [];\r\n\r\n    var objectIdBeingDragged = null;\r\n    var objectIdBeingResized = null;\r\n    var objectResizeCursor = \"default\";\r\n    \r\n    var objectDragX = 0.0;\r\n    var objectDragY = 0.0;\r\n    var objectDragStartX = 0.0;\r\n    var objectDragStartY = 0.0;\r\n\r\n    var doubleTapDetector = null;\r\n    const debugMetricsPanel = new DebugMetricsPanel(_window);\r\n\r\n    const metrics = {\r\n        connectorRoutingWorker: {\r\n            executionTime: null,\r\n            numRoutingPoints: null,\r\n            numBoundaryLines: null,\r\n            msgDecodeTime: null,\r\n            pointVisibilityMapCreationTime: null,\r\n            allPathsComputationTime: null\r\n        },\r\n        clusterDetectionWorker: {\r\n            computeClustersTime: null,\r\n        },\r\n        refreshAllConnectorsInternal: {\r\n            executionTime: null\r\n        },\r\n        findBestConnectorAnchorsToConnectEntities: {\r\n            batchSize: null,\r\n            searchFuncExecutionTime: null\r\n        },\r\n        connectorsRefreshTime: null\r\n    };\r\n\r\n    var touchHoldDelayTimeMs = 750.0;\r\n    var touchHoldStartInterval = null;\r\n\r\n    var multiObjectSelectionStartX = 0.0;\r\n    var multiObjectSelectionStartY = 0.0;\r\n    var multiObjectSelectionEndX = 0.0;\r\n    var multiObjectSelectionEndY = 0.0;\r\n    var multiObjectSelectionStarted = false;\r\n\r\n    const connectorAnchorsSelected = [];\r\n\r\n    // DOM attribute cache to prevent reflow\r\n    let isDomMetricsLockActive = false;\r\n    let sheetOffsetLeft = null;\r\n    let sheetOffsetTop = null;\r\n    let sheetPageScrollXOffset = null;\r\n    let sheetPageScrollYOffset = null;\r\n\r\n    /**\r\n     * Event name -> Callback map\r\n     */\r\n    const eventHandlers = new Map();\r\n    var connectorRefreshStartTime = null;\r\n    var connectorRefreshTimeout = null;\r\n    let pendingConnectorRedraw = false;\r\n\r\n\r\n    const bestConnectorAnchorsForEntityConnectionsFinder = new BestToConnectEntitiesFinder();\r\n\r\n    // Setup ClusterDetectionWorker\r\n\r\n    /**\r\n     * JSON representation of known clusters\r\n     * @type {Object[]|null}\r\n     */\r\n    let knownClustersOverwrite = null;\r\n\r\n    const clusterDetectionWorkerUrl = URL.createObjectURL(new Blob([ ClusterDetectionWorkerJsString ]));\r\n    let clusterDetectionWorker = null;\r\n\r\n    this.initClusterDetectionWorker = function() {\r\n        clusterDetectionWorker = new Worker(clusterDetectionWorkerUrl);\r\n        \r\n        clusterDetectionWorker.onmessage = function(_msg) {\r\n            const data = _msg.data;\r\n\r\n            data.newClusterIds.forEach((_cId) => {\r\n                emitEvent(SheetEvent.CLUSTER_CREATED, { 'cluster': Cluster.fromJSON(data.clusters.get(_cId)) });\r\n            });\r\n\r\n            data.updatedClusterIds.forEach((_cId) => {\r\n                const eventObj = { \r\n                    \"cluster\": Cluster.fromJSON(data.clusters.get(_cId)),\r\n                    \"entitiesAdded\": data.updatedClusterToAddedEntitites.get(_cId),\r\n                    \"entitiesRemoved\": data.updatedClusterToRemovedEntitites.get(_cId),\r\n                };\r\n\r\n                emitEvent(\r\n                    SheetEvent.CLUSTER_UPDATED, \r\n                    eventObj\r\n                );\r\n            });\r\n\r\n            data.deletedClusterIds.forEach((_cId) => {\r\n                emitEvent(SheetEvent.CLUSTER_DELETED, { 'clusterId': _cId });\r\n            });\r\n\r\n            for(let [entityId, overlappingEntityIds] of data.overlappingEntities) {\r\n                emitEvent(\r\n                    SheetEvent.ENTITY_OVERLAP_DETECTED, \r\n                    { \r\n                        \"entityId\": entityId,\r\n                        \"overlappingEntityIds\": overlappingEntityIds,\r\n                    }\r\n                );\r\n            }\r\n\r\n            metrics.clusterDetectionWorker.computeClustersTime = data.metrics.computeClustersTime;\r\n\r\n            knownClustersOverwrite = null;\r\n        };\r\n    };\r\n\r\n    /**\r\n     * @param {Cluster[]} _clusters \r\n     */\r\n     this.overwriteClusterDetectorKnownClusters = function(_clusters) {\r\n        const _clusterJSON = [];\r\n        _clusters.forEach((_c) => {\r\n            _clusterJSON.push(_c.toJSON());\r\n        });\r\n\r\n        knownClustersOverwrite = _clusterJSON;\r\n    };\r\n\r\n    /**\r\n     * @param {Cluster} _cluster\r\n     */\r\n     this.updateClusterDetectorKnownCluster = function(_cluster) {\r\n        if(knownClustersOverwrite === null) {\r\n            knownClustersOverwrite = [];\r\n        }\r\n\r\n        let foundMatch = false;\r\n        for(let i=0; i<knownClustersOverwrite.length; i++) {\r\n            if(knownClustersOverwrite[i].id === _cluster.getId()) {\r\n                foundMatch = true;\r\n                knownClustersOverwrite[i] = _cluster.toJSON();\r\n                break;\r\n            }\r\n        }\r\n\r\n        if(!foundMatch) {\r\n            knownClustersOverwrite.push(_cluster.toJSON());\r\n        }\r\n    };\r\n\r\n    /**\r\n     * @param {Cluster} _cluster\r\n     * @returns {Boolean}\r\n     */\r\n     this.deleteClusterDetectorKnownCluster = function(_cluster) {\r\n        if(knownClustersOverwrite === null) {\r\n            return false;\r\n        }\r\n\r\n        let foundMatch = false;\r\n        for(let i=0; i<knownClustersOverwrite.length; i++) {\r\n            if(knownClustersOverwrite[i].id === _cluster.getId()) {\r\n                foundMatch = true;\r\n                knownClustersOverwrite.splice(i, 1);\r\n                break;\r\n            }\r\n        }\r\n\r\n        return foundMatch;\r\n    };\r\n\r\n    // Setup ConnectorRoutingWorker\r\n    const connectorRoutingWorkerUrl = URL.createObjectURL(new Blob([ ConnectorRoutingWorkerJsString ]));\r\n    let connectorRoutingWorker = null;\r\n\r\n    this.initConnectorRoutingWorker = function() {\r\n        connectorRoutingWorker = new Worker(connectorRoutingWorkerUrl);\r\n    \r\n        connectorRoutingWorker.onmessage = function(_msg) {\r\n            const connectorsRefreshTimeT1 = new Date();\r\n            const connectorDescriptors = _msg.data.connectorDescriptors;\r\n            const refreshCalls = [];\r\n\r\n            const getConnectorDescriptorById = function(_id) {\r\n                for(let i=0; i<connectorDescriptors.length; i++) {\r\n                    if(connectorDescriptors[i].id === _id) {\r\n                        return connectorDescriptors[i];\r\n                    }\r\n                }\r\n\r\n                return null;\r\n            };\r\n\r\n            const renderInternal = function() {\r\n                refreshCalls.forEach((_rc) => {\r\n                    _rc();\r\n                });\r\n                pendingConnectorRedraw = false;\r\n            };\r\n\r\n\r\n            objectConnectors.forEach(function(_c) {\r\n                const descriptor = getConnectorDescriptorById(_c.getId());\r\n                if(descriptor) {\r\n                    const ps = new PointSet(new Float64Array(descriptor.pointsInPath));\r\n                    _c.updatePathPoints(ps.toArray());\r\n\r\n                    refreshCalls.push(() => {\r\n                        _c.refresh(descriptor.svgPath);\r\n                    });\r\n\r\n                    // May want defer this, rendering affected if consumer has a long-running handler\r\n                    emitEvent(SheetEvent.CONNECTOR_UPDATED, { 'connector': _c });\r\n                }\r\n            });\r\n            \r\n            if(pendingConnectorRedraw) {\r\n                cancelAnimationFrame(renderInternal);\r\n            }\r\n\r\n            pendingConnectorRedraw = true;\r\n            requestAnimationFrame(renderInternal);\r\n\r\n            metrics.connectorsRefreshTime = (new Date()) - connectorsRefreshTimeT1;\r\n\r\n            metrics.connectorRoutingWorker.executionTime = _msg.data.metrics.overallTime;\r\n            metrics.connectorRoutingWorker.numBoundaryLines = _msg.data.metrics.numBoundaryLines;\r\n            metrics.connectorRoutingWorker.numRoutingPoints = _msg.data.metrics.numRoutingPoints;\r\n            metrics.connectorRoutingWorker.msgDecodeTime = _msg.data.metrics.msgDecodeTime;\r\n            metrics.connectorRoutingWorker.pointVisibilityMapCreationTime = _msg.data.metrics.pointVisibilityMapCreationTime;\r\n            metrics.connectorRoutingWorker.allPathsComputationTime = _msg.data.metrics.allPathsComputationTime;\r\n\r\n            debugMetricsPanel.refresh(metrics);\r\n        };\r\n    };\r\n\r\n    /**\r\n     * @param {Grid} _grid\r\n     */\r\n    this.setGrid = function(_grid) {\r\n        grid = _grid;\r\n        _sheetDomElement.style.backgroundImage = \"url('data:image/svg+xml;base64,\" + _window.btoa(grid.getSvgImageTile()) + \"')\";\r\n        _sheetDomElement.style.backgroundRepeat = \"repeat\";\r\n        _sheetDomElement.style.backgroundColor = \"#fff\";\r\n    };\r\n\r\n    /**\r\n     * @returns {Grid}\r\n     */\r\n    this.getGrid = function() {\r\n        return grid;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getGridSize = function() {\r\n        return grid.getSize();\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Number} _scaleFactor \r\n     */\r\n    this.setBoundingExtentRoutingPointScaleFactor = function(_scaleFactor) {\r\n        boundingExtentRoutingPointScaleFactor = _scaleFactor;\r\n    };\r\n\r\n    const lockDomMetrics = function() {\r\n        sheetOffsetLeft = _sheetDomElement.offsetLeft;\r\n        sheetOffsetTop = _sheetDomElement.offsetTop;\r\n        sheetPageScrollXOffset = _window.pageXOffset;\r\n        sheetPageScrollYOffset = _window.pageYOffset;\r\n\r\n        isDomMetricsLockActive = true;\r\n    };\r\n\r\n    const unlockDomMetrics = function() {\r\n        isDomMetricsLockActive = false;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @returns {Boolean}\r\n     */\r\n    this.hasDomMetricsLock = function() {\r\n        return isDomMetricsLockActive;\r\n    };\r\n\r\n    const refreshAllClustersInternal = function() {\r\n        if(clusterDetectionWorker === null) {\r\n            return;\r\n        }\r\n\r\n        lockDomMetrics();\r\n\r\n        const gridSize = self.getGridSize();\r\n\r\n        const entityDescriptors = [];\r\n        sheetEntities.forEach(function(_e) {\r\n            entityDescriptors.push(_e.getDescriptor(gridSize));\r\n        });\r\n\r\n        const postData = {\r\n            \"gridSize\": gridSize,\r\n            \"entityDescriptors\": entityDescriptors,\r\n            \"knownClustersOverwrite\": knownClustersOverwrite\r\n        };\r\n\r\n        clusterDetectionWorker.postMessage(postData, []);\r\n        unlockDomMetrics();\r\n    };\r\n\r\n    const refreshAllConnectorsInternal = function() {\r\n        if(connectorRoutingWorker === null) {\r\n            return;\r\n        }\r\n\r\n        lockDomMetrics();\r\n\r\n        const executionTimeT1 = new Date();\r\n        const connectorDescriptors = [];\r\n        objectConnectors.forEach(function(_c) {\r\n            connectorDescriptors.push(_c.getDescriptor());\r\n        });\r\n\r\n        const entityDescriptors = [];\r\n        sheetEntities.forEach(function(_e) {\r\n            entityDescriptors.push(_e.getDescriptor(self.getGridSize()));\r\n        });\r\n\r\n        connectorRoutingWorker.postMessage(\r\n            {\r\n                \"gridSize\": self.getGridSize(),\r\n                \"connectorDescriptors\": connectorDescriptors,\r\n                \"entityDescriptors\": entityDescriptors,\r\n                \"boundingExtentRoutingPointScaleFactor\": boundingExtentRoutingPointScaleFactor\r\n            },\r\n            [\r\n\r\n            ]\r\n        );\r\n\r\n        metrics.refreshAllConnectorsInternal.executionTime = (new Date()) - executionTimeT1;\r\n        \r\n        unlockDomMetrics();\r\n    };\r\n\r\n    /**\r\n     * @param {Number} _bufferTimeMs\r\n     */\r\n    this.setConnectorRefreshBufferTime = function(_bufferTimeMs) {\r\n        connectorRefreshBufferTime = _bufferTimeMs;\r\n    };\r\n\r\n    this.refreshAllConnectors = function() {\r\n        // We'll try to coalesce refresh calls within refreshBatchBufferTimeMs \r\n        // Default is 6.944ms, for continuous calls, this corresponds to 144Hz, but actual\r\n        // performance is less given web worker overhead, path computation cost, and browser minimum limit on setTimeout\r\n\r\n        if(connectorRefreshStartTime !== null) {\r\n            const tdelta = (new Date()) - connectorRefreshStartTime;\r\n            if(tdelta < connectorRefreshBufferTime) {\r\n                return; // already scheduled\r\n            }\r\n        }\r\n\r\n        connectorRefreshStartTime = new Date();        \r\n        connectorRefreshTimeout = setTimeout(function() {\r\n            connectorRefreshTimeout = null;\r\n            connectorRefreshStartTime = null;\r\n            refreshAllConnectorsInternal();\r\n        }, connectorRefreshBufferTime);\r\n    };\r\n\r\n    var makeNewConnector = function(_anchorStart, _anchorEnd, _containerDomElement) {\r\n        return new Connector(_anchorStart, _anchorEnd, _containerDomElement);\r\n    };\r\n\r\n    /**\r\n     * @callback ConnectorFactory\r\n     * @param {ConnectorAnchor} _anchorStart\r\n     * @param {ConnectorAnchor} _anchorEnd\r\n     * @param {Element} _containerDomElement\r\n     */\r\n\r\n    /**\r\n     * @param {ConnectorFactory} _connectorFactory\r\n     */\r\n    this.setConnectorFactory = function(_newConnectorFactory) {\r\n        makeNewConnector = _newConnectorFactory;\r\n    };    \r\n\r\n\r\n    /**\r\n     * @returns {String}\r\n     */\r\n    this.getTransitionCss = function() {\r\n        return transitionCss;\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {String} _css \r\n     */\r\n    this.setTransitionCss = function(_css) {\r\n        transitionCss = _css;\r\n        _sheetDomElement.style.transition = transitionCss;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */    \r\n    this.getTransformOriginX = function() {\r\n        return transformOriginX;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */    \r\n    this.getTransformOriginY = function() {\r\n        return transformOriginY;\r\n    };    \r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getScaleFactor = function() {\r\n        return scaleFactor;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getTranslateX = function() {\r\n        return translateX;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */    \r\n    this.getTranslateY = function() {\r\n        return translateY;\r\n    };    \r\n\r\n    /**\r\n     * \r\n     * @param {Number} _x \r\n     * @param {Number} _y \r\n     */\r\n    this.setTransformOrigin = function(_x, _y) {\r\n        transformOriginX = _x;\r\n        transformOriginY = _y;\r\n        _sheetDomElement.style.transformOrigin = `${transformOriginX}px ${transformOriginY}px`;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Number} _scaleFactor \r\n     * @param {Boolean} _adjustFactorToPreserveIntegerGrid \r\n     */\r\n    this.scale = function(_scaleFactor, _adjustFactorToPreserveIntegerGrid) {\r\n        _adjustFactorToPreserveIntegerGrid = _adjustFactorToPreserveIntegerGrid || false;\r\n\r\n        if(_adjustFactorToPreserveIntegerGrid) {\r\n            const newGridSize = self.getGridSize() * _scaleFactor;\r\n            const roundedGridSize = Math.round(newGridSize);\r\n            _scaleFactor = roundedGridSize / self.getGridSize();\r\n        }\r\n\r\n        scaleFactor = _scaleFactor;\r\n        invScaleFactor = 1.0 / scaleFactor;        \r\n\r\n        const scaleMat = \r\n            [\r\n                scaleFactor, 0, 0, 0, \r\n                0, scaleFactor, 0, 0, \r\n                0, 0, scaleFactor, 1, \r\n                0, 0, 0, 1\r\n            ];\r\n\r\n        currentTransformationMatrix = MatrixMath.mat4Multiply(\r\n            currentTransformationMatrix, \r\n            scaleMat\r\n        );\r\n\r\n        invTransformationMatrixStack.push(\r\n            [\r\n                invScaleFactor, 0, 0, 0, \r\n                0, invScaleFactor, 0, 0, \r\n                0, 0, invScaleFactor, 1, \r\n                0, 0, 0, 1\r\n            ]\r\n        );\r\n\r\n        return self;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Number} _x \r\n     * @param {Number} _y \r\n     */\r\n    this.translate = function(_x, _y) {\r\n        translateX = _x;\r\n        translateY = _y;\r\n\r\n        const translateMatrix =             \r\n            [\r\n                1, 0, 0, 0, \r\n                0, 1, 0, 0, \r\n                0, 0, 1, 0, \r\n                translateX, translateY, 0, 1\r\n            ];\r\n\r\n        currentTransformationMatrix = MatrixMath.mat4Multiply(\r\n            currentTransformationMatrix, \r\n            translateMatrix\r\n        ); \r\n\r\n        invTransformationMatrixStack.push(\r\n            [\r\n                1, 0, 0, -translateX, \r\n                0, 1, 0, -translateY, \r\n                0, 0, 1, 0, \r\n                0, 0, 0, 1\r\n            ]\r\n        );\r\n\r\n        return self;\r\n    };\r\n\r\n    this.applyTransform = function() {\r\n        _sheetDomElement.style.transform = self.getTransformMatrixCss();\r\n        currentInvTransformationMatrix = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\r\n        for(let i=0; i<invTransformationMatrixStack.length; i++) {\r\n            currentInvTransformationMatrix = MatrixMath.mat4Multiply(currentInvTransformationMatrix, invTransformationMatrixStack[i]);\r\n        }\r\n    };\r\n\r\n    /**\r\n     * @returns {Array}\r\n     */\r\n    this.getTransformMatrix = function() {\r\n        return currentTransformationMatrix;\r\n    };\r\n\r\n    /**\r\n     * @returns {String}\r\n     */    \r\n    this.getTransformMatrixCss = function() {\r\n        const matElems = currentTransformationMatrix.join(\",\");\r\n        return `matrix3d(${matElems})`;\r\n    };\r\n\r\n    /**\r\n     * @param {DOMRect} _domRect\r\n     * @returns {Rectangle}\r\n     */\r\n    this.transformDomRectToPageSpaceRect = function(_domRect) {\r\n        const pageOffset = self.getPageOffset();\r\n        const sheetOffset = self.getSheetOffset();\r\n\r\n        const left = _domRect.left - sheetOffset.getX() + pageOffset.getX();\r\n        const top = _domRect.top - sheetOffset.getY() + pageOffset.getY();\r\n        const right = _domRect.right - sheetOffset.getX() + pageOffset.getX();\r\n        const bottom = _domRect.bottom - sheetOffset.getY() + pageOffset.getY();\r\n\r\n        // inv transform\r\n        const invTransformedPosLeftTop = MatrixMath.vecMat4Multiply(\r\n            [left, top, 0, 1],\r\n            currentInvTransformationMatrix\r\n        );\r\n\r\n        const invTransformedPosRightBottom = MatrixMath.vecMat4Multiply(\r\n            [right, bottom, 0, 1],\r\n            currentInvTransformationMatrix\r\n        );\r\n\r\n        // we have Sheet space coordinates, transform to Page space and return\r\n        return new Rectangle(\r\n            invTransformedPosLeftTop[0] + sheetOffset.getX(), \r\n            invTransformedPosLeftTop[1] + sheetOffset.getY(), \r\n            invTransformedPosRightBottom[0] + sheetOffset.getX(), \r\n            invTransformedPosRightBottom[1] + sheetOffset.getY()\r\n        );\r\n    };\r\n\r\n    this.resetTransform = function() {\r\n        scaleFactor = 1.0;\r\n        invScaleFactor = 1.0;\r\n        translateX = 0.0;\r\n        translateY = 0.0;\r\n        currentTransformationMatrix = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\r\n        currentInvTransformationMatrix = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\r\n        invTransformationMatrixStack.length = 0;\r\n        _sheetDomElement.style.transform = \"none\";\r\n    };\r\n\r\n    /**\r\n     * @returns {Point}\r\n     */\r\n    this.getPageOffset = function() {\r\n        if(self.hasDomMetricsLock()) {\r\n            return new Point(sheetPageScrollXOffset, sheetPageScrollYOffset);\r\n        }\r\n\r\n        return new Point(_window.pageXOffset, _window.pageYOffset);\r\n    };\r\n\r\n    /**\r\n     * @param {Number} _p \r\n     * @returns {Number}\r\n     */\r\n    this.snapToGrid = function(_p) {\r\n        var ret = Math.round(_p/self.getGridSize()) * self.getGridSize();\r\n        return Math.max(0, ret - 1);\r\n    };\r\n\r\n    /**\r\n     * @returns {Point}\r\n     */\r\n    this.getSheetOffset = function() {\r\n        if(self.hasDomMetricsLock()) {\r\n            return new Point(sheetOffsetLeft, sheetOffsetTop);\r\n        }\r\n        \r\n        return new Point(_sheetDomElement.offsetLeft, _sheetDomElement.offsetTop);\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getOffsetLeft = function() {\r\n        return _sheetDomElement.offsetLeft;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getOffsetTop = function() {\r\n        return _sheetDomElement.offsetTop;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getWidth = function() {\r\n        return _sheetDomElement.offsetWidth;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getHeight = function() {\r\n        return _sheetDomElement.offsetHeight;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Number} _newWidth \r\n     * @param {Number} _newHeight \r\n     */\r\n    this.resize = function(_newWidth, _newHeight) {\r\n        _sheetDomElement.style.width = `${_newWidth}px`;\r\n        _sheetDomElement.style.height = `${_newHeight}px`;\r\n    };\r\n\r\n    /**\r\n     * @param {Entity[]} _objs \r\n     * @returns {Rectangle}\r\n     */\r\n    this.calcBoundingRectForEntities = function(_entities) {\r\n        var minTop = null;\r\n        var minLeft = null;\r\n        var maxBottom = null;\r\n        var maxRight = null;\r\n\r\n        _entities.forEach(function(_obj, index, array) {\r\n            const objRect = _obj.getBoundingRectange();\r\n            const left = objRect.getLeft();\r\n            const top = objRect.getTop();  \r\n            const right = objRect.getRight();\r\n            const bottom = objRect.getBottom();\r\n\r\n            if(minLeft === null || left < minLeft) {\r\n                minLeft = left;\r\n            }\r\n\r\n            if(minTop === null || top < minTop) {\r\n                minTop = top;\r\n            }\r\n\r\n            if(maxBottom === null || bottom > maxBottom) {\r\n                maxBottom = bottom;\r\n            }        \r\n\r\n            if(maxRight === null || right > maxRight) {\r\n                maxRight = right;\r\n            }\r\n        });\r\n\r\n        if(minTop === null || minLeft === null || maxBottom === null || maxRight === null) {\r\n            minTop = 0;\r\n            minLeft = 0;\r\n            maxBottom = 0;\r\n            maxRight = 0;            \r\n        }\r\n\r\n        return new Rectangle(minLeft, minTop, maxRight, maxBottom);\r\n    };\r\n\r\n    /**\r\n     * @returns {Rectangle}\r\n     */\r\n    this.calcBoundingBox = function() {\r\n        if(sheetEntities.length === 0) {    \r\n            return new Rectangle(0, 0, self.getWidth(), self.getHeight());     \r\n        }\r\n\r\n        return self.calcBoundingRectForEntities(sheetEntities);\r\n    };\r\n\r\n    /**\r\n     * @param {Number} _x\r\n     * @param {Number} _y\r\n     * @param {Number} _radius\r\n     * @returns {Entity[]}\r\n     */\r\n    this.getEntitiesAroundPoint = function(_x, _y, _radius) {\r\n        _radius = _radius || 1.0;\r\n\r\n        const result = [];\r\n\r\n        const ptRect = new Rectangle(\r\n            _x - _radius, \r\n            _y - _radius, \r\n            _x + _radius, \r\n            _y + _radius\r\n        );\r\n\r\n        sheetEntities.forEach(function(_obj) {\r\n            if(ptRect.checkIntersect(_obj.getBoundingRectange())) {\r\n                result.push(_obj);\r\n            }\r\n        });\r\n\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * @param {Rectangle} _rect\r\n     * @returns {Entity[]}\r\n     */\r\n    this.getEntitiesWithinRect = function(_rect) {\r\n        const result = [];\r\n\r\n        sheetEntities.forEach(function(_obj) {\r\n            if(_obj.getBoundingRectange().checkIsWithin(_rect)) {\r\n                result.push(_obj);\r\n            }\r\n        });\r\n\r\n        return result;\r\n    };    \r\n      \r\n    /**\r\n     * @returns {Entity[]}\r\n     */\r\n    this.getAllEntities = function() {    \r\n        return sheetEntities;\r\n    };\r\n\r\n    /**\r\n     * @deprecated\r\n     * Helper method to publish an object change to all objects\r\n     * \r\n     * @param {String} _eventName\r\n     * @param {*} _eventData\r\n     */\r\n    this.publishSiblingObjectChange = function(_eventName, _eventData) {\r\n        sheetEntities.forEach(function(_obj) {\r\n            _obj.handleSiblingObjectChange(_eventName, _eventData);\r\n        });\r\n    };\r\n\r\n    /**\r\n     * @param {String} _id\r\n     * @returns {Entity|null}\r\n     */   \r\n    this.getEntityById = function(_id) {\r\n        var foundEntity = null;\r\n        sheetEntities.forEach(function(obj, index, array) {\r\n            if(foundEntity === null && obj.getId() === _id) {\r\n                foundEntity = obj;\r\n            }            \r\n        });\r\n        \r\n        return foundEntity;\r\n    };\r\n\r\n    /**\r\n     * @param {Entity} _obj\r\n     */\r\n    this.addEntity = function(_obj) {\r\n        _obj.on(EntityEvent.RESIZE_START, handleResizeStart);\r\n\r\n        _obj.on(EntityEvent.RESIZE, function(e) {\r\n            emitEvent(SheetEvent.ENTITY_RESIZED, \r\n                { \r\n                    \"entity\": e.obj,\r\n                    \"originator\": e.originator,\r\n                }\r\n            );\r\n            self.refreshAllConnectors();\r\n            refreshAllClustersInternal();\r\n        });\r\n\r\n        _obj.on(EntityEvent.TRANSLATE_START, handleMoveStart);\r\n\r\n        _obj.on(EntityEvent.TRANSLATE, function(e) {\r\n            emitEvent(\r\n                SheetEvent.ENTITY_TRANSLATED, \r\n                { \r\n                    \"object\": e.obj,\r\n                    \"withinGroupTransformation\": e.withinGroupTransformation,\r\n                    \"originator\": e.originator,\r\n                }\r\n            );\r\n\r\n            if(!e.withinGroupTransformation) { // don't refresh, we only want to refresh when the entire group has been translated\r\n                self.refreshAllConnectors();\r\n                refreshAllClustersInternal();\r\n            }\r\n        });\r\n\r\n        sheetEntities.push(_obj);\r\n        self.refreshAllConnectors();\r\n        refreshAllClustersInternal();\r\n\r\n        emitEvent(SheetEvent.ENTITY_ADDED, { \"object\":_obj });\r\n    };    \r\n\r\n    /**\r\n     * Remove object from the sheet\r\n     * Note: as caller is responsible for putting object into the DOM, caller is responsible for removing it from the DOM\r\n     * \r\n     * @param {String} _entityId\r\n     * @returns {Boolean} \r\n     */\r\n    this.removeEntity = function(_entityId) {\r\n        for(let i=0; i<sheetEntities.length; i++) {\r\n            if(sheetEntities[i].getId() === _entityId) {\r\n                sheetEntities.splice(i, 1);\r\n                self.refreshAllConnectors();\r\n                refreshAllClustersInternal();\r\n                emitEvent(SheetEvent.ENTITY_REMOVED, { \"object\":sheetEntities[i] });\r\n                return true;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    };\r\n\r\n    /**\r\n     * @param {String} _id\r\n     * @returns {Connector|null}\r\n     */    \r\n    this.getConnector = function(_id) {\r\n        for(let c=0; c<objectConnectors.length; c++) {\r\n            if(objectConnectors[c].getId() === _id) {\r\n                return objectConnectors[c];\r\n            }\r\n        }\r\n\r\n        return null;\r\n    };\r\n\r\n    /**\r\n     * @returns {Connector[]}\r\n     */\r\n    this.getAllConnectors = function() {\r\n        return objectConnectors;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Entity} _objA \r\n     * @param {Entity} _objB \r\n     * @returns {Connector[]}\r\n     */\r\n    this.getConnectorsBetweenEntities = function(_entityA, _entityB) {\r\n        const foundConnectors = [];\r\n\r\n        objectConnectors.forEach((_conn) => {\r\n            const aS = _conn.getAnchorStart();\r\n            const aE = _conn.getAnchorEnd();\r\n\r\n            if(_entityA.hasConnectorAnchor(aS) && _entityB.hasConnectorAnchor(aE)) {\r\n                foundConnectors.push(_conn);\r\n            }\r\n\r\n            if(_entityA.hasConnectorAnchor(aE) && _entityB.hasConnectorAnchor(aS)) {\r\n                foundConnectors.push(_conn);\r\n            }            \r\n        });\r\n\r\n        return foundConnectors;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {ConnectorAnchor} _anchorA \r\n     * @param {ConnectorAnchor} _anchorB \r\n     * @returns {Connector[]}\r\n     */\r\n    this.getConnectorsBetweenAnchors = function(_anchorA, _anchorB) {\r\n        const foundConnectors = [];\r\n\r\n        objectConnectors.forEach((_conn) => {\r\n            const aS = _conn.getAnchorStart();\r\n            const aE = _conn.getAnchorEnd();\r\n\r\n            if(aS === _anchorA && aE === _anchorB) {\r\n                foundConnectors.push(_conn);\r\n            }\r\n\r\n            if(aS === _anchorB && aE === _anchorA) {\r\n                foundConnectors.push(_conn);\r\n            }\r\n        });\r\n\r\n        return foundConnectors;\r\n    };    \r\n\r\n    /**\r\n     * \r\n     * @param {Entity[]} _entitySet\r\n     * @returns {Connector[]}\r\n     */\r\n    this.getConnectorsInEntitySet = function(_entitySet) {\r\n        const foundConnectors = [];\r\n\r\n        for(let i=0; i<_entitySet.length; i++) {\r\n            for(let j=i+1; j<_entitySet.length; j++) {\r\n                const connectorsBetween = self.getConnectorsBetweenEntities(_entitySet[i], _entitySet[j]);\r\n                foundConnectors.push(...connectorsBetween);\r\n            }\r\n        }\r\n\r\n        return foundConnectors;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {String} _connectorId\r\n     * @returns {Entity[]} \r\n     */\r\n    this.getEntitiesConnectedViaConnector = function(_connectorId) {\r\n        const foundEntities = [];\r\n        const allEntities = self.getAllEntities();\r\n\r\n        objectConnectors.forEach((_conn) => {\r\n            if(_conn.getId() !== _connectorId) {\r\n                return;\r\n            }\r\n\r\n            const aS = _conn.getAnchorStart();\r\n            const aE = _conn.getAnchorEnd();\r\n\r\n            allEntities.forEach((_o) => {\r\n                if(_o.hasConnectorAnchor(aS) || _o.hasConnectorAnchor(aE)) {\r\n                    foundEntities.push(_o);\r\n                }\r\n            });\r\n        });\r\n\r\n        return foundEntities;        \r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Entity} _obj\r\n     * @returns {Connector[]} \r\n     */\r\n    this.getConnectorsConnectedToEntity = function(_entity) {\r\n        const foundConnectors = [];\r\n\r\n        objectConnectors.forEach((_conn) => {\r\n            const aS = _conn.getAnchorStart();\r\n            const aE = _conn.getAnchorEnd();\r\n\r\n            if(_entity.hasConnectorAnchor(aS) || _entity.hasConnectorAnchor(aE)) {\r\n                foundConnectors.push(_conn);\r\n            }\r\n\r\n        });\r\n\r\n        return foundConnectors;        \r\n    };\r\n\r\n    /**\r\n     * @param {String} _connectorAnchorId\r\n     * @returns {Entity|null} \r\n     */\r\n    this.getEntityWithConnectorAnchor = function(_connectorAnchorId) {\r\n        const allEntities = self.getAllEntities();\r\n        for(let i=0; i<allEntities.length; i++) {                \r\n            const anchors = allEntities[i].getConnectorAnchors();\r\n            for(let j=0; j<anchors.length; j++) {\r\n                if(anchors[j].getId() === _connectorAnchorId) {\r\n                    return allEntities[i];\r\n                }\r\n            }\r\n        }\r\n\r\n        return null;\r\n    };    \r\n\r\n    this.removeAllConnectors = function() {\r\n        objectConnectors.forEach(function(_conn) {\r\n            _conn.removePathElement();\r\n        });\r\n\r\n        objectConnectors.splice(0, objectConnectors.length);\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Connector} _connector\r\n     * @returns {Boolean}\r\n     */\r\n    this.removeConnector = function(_connector) {\r\n        for(let i=0; i<objectConnectors.length; i++) {\r\n            if(objectConnectors[i] === _connector) {\r\n                _connector.removePathElement();\r\n                objectConnectors.splice(i, 1);\r\n                return true;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {ConnectorAnchor} _anchorA \r\n     * @param {ConnectorAnchor} _anchorB \r\n     * @returns {Connector}\r\n     */\r\n    this.makeNewConnectorFromAnchors = function(_anchorA, _anchorB) {\r\n        const newConnector = makeNewConnector(_anchorA, _anchorB, connectorsContainerDomElement);\r\n        const foundConnector = self.getConnector(newConnector.getId());\r\n\r\n        if(foundConnector === null) {\r\n            objectConnectors.push(newConnector);\r\n            newConnector.appendPathToContainerDomElement();\r\n            self.refreshAllConnectors();\r\n            return newConnector;\r\n        }\r\n\r\n        return foundConnector;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Entity} _objA \r\n     * @param {Entity} _objB\r\n     */\r\n    this.findBestConnectorAnchorsToConnectEntities = function(_entityA, _entityB, _onFound) {\r\n        bestConnectorAnchorsForEntityConnectionsFinder.findBest(_entityA, _entityB, _onFound, sheetEntities, self.getGridSize());\r\n        metrics.findBestConnectorAnchorsToConnectEntities.batchSize = bestConnectorAnchorsForEntityConnectionsFinder.getSearchFuncBatchSize();\r\n        metrics.findBestConnectorAnchorsToConnectEntities.searchFuncExecutionTime = bestConnectorAnchorsForEntityConnectionsFinder.getSearchFuncExecutionTime();\r\n    };\r\n\r\n    /**\r\n     * @param {ConnectorAnchor} _anchor\r\n     */\r\n    this.addConnectionAnchorToSelectionStack = function(_anchor) {\r\n        connectorAnchorsSelected.push(_anchor);\r\n\r\n        if(connectorAnchorsSelected.length === 2) {\r\n            self.makeNewConnectorFromAnchors(connectorAnchorsSelected[0], connectorAnchorsSelected[1]);\r\n            connectorAnchorsSelected.length = 0;\r\n        }\r\n    };\r\n\r\n    /**\r\n     * @param {Number} _posX \r\n     * @param {Number} _posY \r\n     */\r\n    const dblClickTapHandler = function(_posX, _posY) {\r\n        const entitiesAroundPoint = self.getEntitiesAroundPoint(_posX, _posY);\r\n\r\n        const eventData = {\r\n            'targetPoint': new Point(_posX, _posY),\r\n            'objectsAroundPoint': entitiesAroundPoint, // deprecated\r\n            'entitiesAroundPoint': entitiesAroundPoint\r\n        };\r\n\r\n        emitEvent(SheetEvent.DBLCLICK, eventData);\r\n    };\r\n\r\n    this.initDebugMetricsPanel = function() {\r\n        debugMetricsPanel.init();\r\n        debugMetricsPanel.show();\r\n    };\r\n\r\n    /**\r\n     * @param {Number} _dblTapSpeed\r\n     * @param {Number} _dblTapRadius\r\n     */\r\n    this.initInteractionHandlers = function(_dblTapSpeed, _dblTapRadius) {\r\n        doubleTapDetector = new DoubleTapDetector(_dblTapSpeed, _dblTapRadius);\r\n\r\n        // dblclick on empty area of the sheet\r\n        _sheetDomElement.addEventListener('dblclick', function (e) {\r\n\r\n            const invTransformedPos = MatrixMath.vecMat4Multiply(\r\n                [e.pageX - self.getOffsetLeft(), e.pageY - self.getOffsetTop(), 0, 1],\r\n                currentInvTransformationMatrix\r\n            );\r\n\r\n            dblClickTapHandler(invTransformedPos[0], invTransformedPos[1]);\r\n        });\r\n\r\n        // click anywhere on sheet\r\n        _sheetDomElement.addEventListener('click', function (e) {\r\n            let sheetEntityClicked = false;\r\n            if(e.target !== _sheetDomElement) {\r\n                sheetEntityClicked = true;\r\n            }\r\n\r\n            const invTransformedPos = MatrixMath.vecMat4Multiply(\r\n                [e.pageX - self.getOffsetLeft(), e.pageY - self.getOffsetTop(), 0, 1],\r\n                currentInvTransformationMatrix\r\n            );\r\n\r\n            const eventData = {\r\n                'targetPoint': new Point(invTransformedPos[0], invTransformedPos[1]),\r\n                'entityClicked': sheetEntityClicked,\r\n                'canvasObjectClicked': sheetEntityClicked // deprecated\r\n            };\r\n    \r\n            emitEvent(SheetEvent.CLICK, eventData);\r\n        });\r\n\r\n        // touchend on sheet, logic to see if there was a double-tap\r\n        _sheetDomElement.addEventListener('touchend', function(e) {\r\n            const detectResult = doubleTapDetector.processTap(\r\n                e,\r\n                new Point(self.getOffsetLeft(), self.getOffsetTop()),\r\n                currentInvTransformationMatrix,\r\n            );\r\n\r\n            if(detectResult.doubleTapDetected) {\r\n                dblClickTapHandler(detectResult.touchX, detectResult.touchY);\r\n            }\r\n        });\r\n    };\r\n\r\n    const setCurrentGroupTransformationContainerBeingDragged = function(e) {\r\n        currentGroupTransformationContainerBeingDragged = e.container;\r\n    };\r\n\r\n    /**\r\n     * @param {GroupTransformationContainer} _groupTransformationContainer\r\n     */\r\n    this.attachGroupTransformationContainer = function(_groupTransformationContainer) {\r\n        _sheetDomElement.appendChild(_groupTransformationContainer.getContainerDomElement());\r\n        groupTransformationContainers.push(_groupTransformationContainer);\r\n\r\n        _groupTransformationContainer.on(GroupTransformationContainerEvent.TRANSLATE_START, setCurrentGroupTransformationContainerBeingDragged);\r\n        _groupTransformationContainer.on(GroupTransformationContainerEvent.TRANSLATE, self.refreshAllConnectors);\r\n        _groupTransformationContainer.on(GroupTransformationContainerEvent.TRANSLATE, refreshAllClustersInternal);\r\n    };\r\n\r\n    /**\r\n     * @param {GroupTransformationContainer} _groupTransformationContainer\r\n     * @returns {Boolean}\r\n     */\r\n    this.detachGroupTransformationContainer = function(_groupTransformationContainer) {\r\n        for(let i=0; i<groupTransformationContainers.length; i++) {\r\n            if(groupTransformationContainers[i] === _groupTransformationContainer) {\r\n                _groupTransformationContainer.off(GroupTransformationContainerEvent.TRANSLATE_START, setCurrentGroupTransformationContainerBeingDragged);\r\n                _groupTransformationContainer.off(GroupTransformationContainerEvent.TRANSLATE, self.refreshAllConnectors);\r\n                _groupTransformationContainer.off(GroupTransformationContainerEvent.TRANSLATE, refreshAllClustersInternal);\r\n                _sheetDomElement.removeChild(_groupTransformationContainer.getContainerDomElement());\r\n                groupTransformationContainers.splice(i, 1);\r\n                return true;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Number} _dx \r\n     * @param {Number} _dy \r\n     */\r\n    const handleGroupTransformationContainerMove = function(_dx, _dy) {\r\n        const gtc = currentGroupTransformationContainerBeingDragged;        \r\n        gtc.translateByOffset(_dx, _dy);\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Object} _e\r\n     */\r\n    const handleMoveStart = function(_e) {     \r\n        objectIdBeingDragged = _e.obj.getId();\r\n        objectDragX = _e.x;\r\n        objectDragY = _e.y;\r\n        objectDragStartX = _e.x;\r\n        objectDragStartY = _e.y;        \r\n    };    \r\n\r\n    /**\r\n     * \r\n     * @param {Number} _x \r\n     * @param {Number} _y \r\n     */\r\n    const handleMove = function(_x, _y) {\r\n        const entity = self.getEntityById(objectIdBeingDragged);\r\n        const translateOffset = entity.getTranslateHandleOffset();\r\n        const mx = self.snapToGrid(_x + translateOffset.getX());\r\n        const my = self.snapToGrid(_y + translateOffset.getY());\r\n        \r\n        objectDragX = mx;\r\n        objectDragY = my;\t\t\r\n\r\n        entity.translate(mx, my, false, Originator.USER);\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Number} _x \r\n     * @param {Number} _y \r\n     */\r\n    const handleMoveEnd = function(_x, _y) {\r\n        const entity = self.getEntityById(objectIdBeingDragged);\r\n        const translateOffset = entity.getTranslateHandleOffset();\r\n        const mx = self.snapToGrid(_x + translateOffset.getX());\r\n        const my = self.snapToGrid(_y + translateOffset.getY());\r\n        entity.translate(mx, my, false, Originator.USER);       \r\n    };         \r\n\r\n    /**\r\n     * \r\n     * @param {Object} _e \r\n     */\r\n    const handleResizeStart = function(_e) {       \r\n        objectIdBeingResized = _e.obj.getId();\r\n        objectResizeCursor = _e.resizeCursor;\r\n\r\n        _sheetDomElement.style.cursor = objectResizeCursor;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Number} _x \r\n     * @param {Number} _y \r\n     */    \r\n    const handleResize = function(_x, _y) {\r\n        const entity = self.getEntityById(objectIdBeingResized);\r\n\r\n        const mx = self.snapToGrid(_x);\r\n        const my = self.snapToGrid(_y);\r\n\r\n        const top = entity.getY();\r\n        const left = entity.getX();\r\n        const newWidth = ((mx - left)+1);\r\n        const newHeight = ((my - top)+1);\r\n\r\n        entity.resize(newWidth, newHeight, Originator.USER);\r\n    };\r\n\r\n    const handleResizeEnd = function() {\r\n        objectIdBeingResized = null;\r\n        _sheetDomElement.style.cursor = \"\";\r\n    };    \r\n\r\n    /**\r\n     * \r\n     * @param {Number} _x \r\n     * @param {Number} _y \r\n     * @param {Element} _targetElem \r\n     * @returns {Boolean}\r\n     */\r\n    const handleMultiEntitySelectionStart = function(_x, _y, _targetElem) {\r\n        if(multiObjectSelectionStarted) {\r\n            return false; // already doing selection\r\n        }\r\n\r\n        if(_targetElem !== svgElem) { // hacky, but b/c of the SVG overlay, events propagate from the overlay\r\n            return false;\r\n        }\r\n\r\n        if(objectIdBeingDragged !== null) {\r\n            return false;\r\n        }\r\n\r\n        if(objectIdBeingResized !== null) {\r\n            return false;\r\n        }        \r\n\r\n        const invTransformedPos = MatrixMath.vecMat4Multiply(\r\n            [_x, _y, 0, 1],\r\n            currentInvTransformationMatrix\r\n        );\r\n\r\n        multiObjectSelectionStartX = invTransformedPos[0];\r\n        multiObjectSelectionStartY = invTransformedPos[1];\r\n        multiObjectSelectionEndX = invTransformedPos[0];\r\n        multiObjectSelectionEndY = invTransformedPos[1];\r\n        multiObjectSelectionStarted = true;\r\n\r\n        selectionBoxElem.style.left = `${multiObjectSelectionStartX}px`;\r\n        selectionBoxElem.style.top = `${multiObjectSelectionStartY}px`;\r\n        selectionBoxElem.style.width = `0px`;\r\n        selectionBoxElem.style.height = `0px`;\r\n        selectionBoxElem.style.display = \"block\";\r\n\r\n        emitEvent(\r\n            SheetEvent.MULTIPLE_ENTITY_SELECTION_STARTED,\r\n            { \r\n                'x': invTransformedPos[0],\r\n                'y': invTransformedPos[1]\r\n            }\r\n        );\r\n\r\n        return true;\r\n    };\r\n\r\n    const handleMultiEntitySelectionEnd = function() {\r\n        multiObjectSelectionStarted = false;\r\n\r\n        const selectionRect = new Rectangle(\r\n            Math.min(multiObjectSelectionStartX, multiObjectSelectionEndX), \r\n            Math.min(multiObjectSelectionStartY, multiObjectSelectionEndY),\r\n            Math.max(multiObjectSelectionStartX, multiObjectSelectionEndX), \r\n            Math.max(multiObjectSelectionStartY, multiObjectSelectionEndY)\r\n        );\r\n\r\n        const selectedEntities = self.getEntitiesWithinRect(selectionRect);\r\n        const boundingRect = self.calcBoundingRectForEntities(selectedEntities);\r\n\r\n        selectionBoxElem.style.left = `${boundingRect.getLeft()}px`;\r\n        selectionBoxElem.style.top = `${boundingRect.getTop()}px`;\r\n        selectionBoxElem.style.width = `${boundingRect.getWidth()}px`;\r\n        selectionBoxElem.style.height = `${boundingRect.getHeight()}px`;\r\n        selectionBoxElem.style.display = \"none\";\r\n\r\n        emitEvent(\r\n            SheetEvent.MULTIPLE_ENTITIES_SELECTED, \r\n            { \r\n                'selectedObjects': selectedEntities, // deprecated\r\n                'selectedEntities': selectedEntities,\r\n                'boundingRect': boundingRect\r\n            }\r\n        );\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Number} _endX \r\n     * @param {Number} _endY \r\n     */\r\n    const updateSelectionBoxEndPoint = function(_endX, _endY) {\r\n\r\n        const invTransformedPos = MatrixMath.vecMat4Multiply(\r\n            [_endX, _endY, 0, 1],\r\n            currentInvTransformationMatrix\r\n        );\r\n\r\n        multiObjectSelectionEndX = invTransformedPos[0];\r\n        multiObjectSelectionEndY = invTransformedPos[1];\r\n        const width = multiObjectSelectionEndX - multiObjectSelectionStartX;\r\n        const height = multiObjectSelectionEndY - multiObjectSelectionStartY;\r\n\r\n        if(width >= 0) {\r\n            selectionBoxElem.style.width = `${width}px`;\r\n        } else {\r\n            selectionBoxElem.style.left = `${invTransformedPos[0]}px`;\r\n            selectionBoxElem.style.width = `${Math.abs(width)}px`;\r\n        }\r\n\r\n        if(height >= 0) {\r\n            selectionBoxElem.style.height = `${height}px`;\r\n        } else {\r\n            selectionBoxElem.style.top = `${invTransformedPos[1]}px`;\r\n            selectionBoxElem.style.height = `${Math.abs(height)}px`;\r\n        }\r\n    };\r\n\r\n    /**\r\n     * @param {String[]} _selectionRectStyleCssClasses\r\n     */\r\n    this.initMultiEntitySelectionHandler = function(_selectionRectStyleCssClasses) {\r\n        // Create selection box DOM element\r\n        const selBox = _window.document.createElement(\"div\");\r\n        selBox.classList.add(\"ia-selection-box\");\r\n        selBox.style.display = \"none\";\r\n        selBox.style.position = \"absolute\";\r\n        selBox.style.left = \"0px\";\r\n        selBox.style.top = \"0px\";\r\n\r\n        if(typeof _selectionRectStyleCssClasses === 'undefined' || _selectionRectStyleCssClasses.length === 0) {\r\n            selBox.style.border = \"1px solid rgb(158, 158, 158)\";\r\n            selBox.style.background = \"rgba(153, 153, 153, 0.5)\";            \r\n        } else {\r\n            // CSS classes will control styling for things GraphPaper doesn't care about\r\n            // (GraphPaper style concerns are handled via inline styles which will always take precedance)\r\n            _selectionRectStyleCssClasses.forEach(function(_class) {\r\n                selBox.classList.add(_class);\r\n            });\r\n        }\r\n\r\n        selectionBoxElem = _sheetDomElement.appendChild(selBox);\r\n\r\n        const handleTouchSelectionStart = function(e) {\r\n            const hasSelectionStarted = handleMultiEntitySelectionStart(e.touches[0].pageX - self.getOffsetLeft(), e.touches[0].pageY - self.getOffsetTop(), e.target);\r\n        };\r\n\r\n        _sheetDomElement.addEventListener('mousedown', function(e) {\r\n            if (e.which !== 1) {\r\n                return;\r\n            }\r\n\r\n            const hasSelectionStarted = handleMultiEntitySelectionStart(e.pageX - self.getOffsetLeft(), e.pageY - self.getOffsetTop(), e.target);\r\n            if(hasSelectionStarted) {\r\n                e.preventDefault(); // prevents text selection from triggering\r\n            }\r\n        });\r\n\r\n        _sheetDomElement.addEventListener('touchstart', function(e) {\r\n            touchHoldStartInterval = setInterval(function() {\r\n                handleTouchSelectionStart(e);\r\n            }, touchHoldDelayTimeMs);\r\n        });\r\n\r\n        _sheetDomElement.addEventListener('touchend', function(e) {\r\n            clearInterval(touchHoldStartInterval);\r\n        });\r\n\r\n        _sheetDomElement.addEventListener('touchmove', function(e) {\r\n            clearInterval(touchHoldStartInterval);\r\n        });        \r\n    };\r\n\r\n    this.initTransformationHandlers = function() {\r\n        _sheetDomElement.addEventListener('touchstart', function(e) {\r\n            touchMoveLastX = e.touches[0].pageX - self.getOffsetLeft();\r\n            touchMoveLastY = e.touches[0].pageY - self.getOffsetTop();\r\n        });\r\n\r\n        _sheetDomElement.addEventListener('touchmove', function (e) {\r\n            if (objectIdBeingDragged !== null) {\r\n                const invTransformedPos = MatrixMath.vecMat4Multiply(\r\n                    [e.touches[0].pageX - self.getOffsetLeft(), e.touches[0].pageY - self.getOffsetTop(), 0, 1],\r\n                    currentInvTransformationMatrix\r\n                );                    \r\n\r\n                handleMove(invTransformedPos[0], invTransformedPos[1]);\r\n                // if we're transforming an object, make sure we don't scroll the sheet\r\n                e.preventDefault();\r\n            }\r\n\r\n            if(objectIdBeingResized !== null) {\r\n                const invTransformedPos = MatrixMath.vecMat4Multiply(\r\n                    [e.touches[0].pageX - self.getOffsetLeft(), e.touches[0].pageY - self.getOffsetTop(), 0, 1],\r\n                    currentInvTransformationMatrix\r\n                );     \r\n\r\n                handleResize(invTransformedPos[0], invTransformedPos[1]);\r\n                e.preventDefault();\r\n            }\r\n\r\n            if(currentGroupTransformationContainerBeingDragged !== null) {\r\n                const dx = (e.touches[0].pageX - self.getOffsetLeft()) - touchMoveLastX;\r\n                const dy = (e.touches[0].pageY - self.getOffsetTop()) - touchMoveLastY;\r\n\r\n                const invTransformedPos = MatrixMath.vecMat4Multiply(\r\n                    [dx, dy, 0, 1],\r\n                    currentInvTransformationMatrix\r\n                );                    \r\n\r\n                handleGroupTransformationContainerMove(invTransformedPos[0], invTransformedPos[1]);        \r\n                e.preventDefault();        \r\n            }\r\n\r\n            if(multiObjectSelectionStarted) {\r\n                updateSelectionBoxEndPoint(e.touches[0].pageX - self.getOffsetLeft(), e.touches[0].pageY - self.getOffsetTop());\r\n                e.preventDefault();\r\n            }\r\n\r\n            touchMoveLastX = e.touches[0].pageX - self.getOffsetLeft();\r\n            touchMoveLastY = e.touches[0].pageY - self.getOffsetTop();\r\n        });\r\n\r\n        _sheetDomElement.addEventListener('mousemove', function (e) {\r\n            if (objectIdBeingDragged !== null) {\t\t\r\n                const invTransformedPos = MatrixMath.vecMat4Multiply(\r\n                    [e.pageX - self.getOffsetLeft(), e.pageY - self.getOffsetTop(), 0, 1],\r\n                    currentInvTransformationMatrix\r\n                );                    \r\n\r\n                handleMove(invTransformedPos[0], invTransformedPos[1]);\r\n            }\r\n\r\n            if(objectIdBeingResized !== null) {\r\n                const invTransformedPos = MatrixMath.vecMat4Multiply(\r\n                    [e.pageX - self.getOffsetLeft(), e.pageY - self.getOffsetTop(), 0, 1],\r\n                    currentInvTransformationMatrix\r\n                );     \r\n\r\n                handleResize(invTransformedPos[0], invTransformedPos[1]);\r\n            }\r\n\r\n            if(currentGroupTransformationContainerBeingDragged !== null) {\r\n                const invTransformedPos = MatrixMath.vecMat4Multiply(\r\n                    [e.movementX, e.movementY, 0, 1],\r\n                    currentInvTransformationMatrix\r\n                );                    \r\n\r\n                handleGroupTransformationContainerMove(invTransformedPos[0], invTransformedPos[1]);                \r\n            }\r\n\r\n            if(multiObjectSelectionStarted) {\r\n                updateSelectionBoxEndPoint(e.pageX - self.getOffsetLeft(), e.pageY - self.getOffsetTop());\r\n            }\r\n        });\r\n\r\n        _sheetDomElement.addEventListener('touchend', function (e) {\r\n\r\n            // e.touches is empty..\r\n            // Need to use e.changedTouches for final x,y ???\r\n\r\n            if(objectIdBeingDragged !== null) {\r\n                objectIdBeingDragged = null;\r\n            }           \r\n            \r\n            if(objectIdBeingResized !== null) {\r\n                handleResizeEnd();\r\n            }\r\n\r\n            if(currentGroupTransformationContainerBeingDragged !== null) {\r\n                currentGroupTransformationContainerBeingDragged.endTranslate();\r\n                currentGroupTransformationContainerBeingDragged = null;\r\n            }            \r\n\r\n            if(multiObjectSelectionStarted) {\r\n                handleMultiEntitySelectionEnd();\r\n            }\r\n        });\r\n\r\n        _sheetDomElement.addEventListener('mouseup', function (e) {\r\n            if (e.which === 1) {\r\n                if(objectIdBeingDragged !== null) {\r\n\r\n                    const invTransformedPos = MatrixMath.vecMat4Multiply(\r\n                        [e.pageX - self.getOffsetLeft(), e.pageY - self.getOffsetTop(), 0, 1],\r\n                        currentInvTransformationMatrix\r\n                    );\r\n\r\n                    handleMoveEnd(invTransformedPos[0], invTransformedPos[1]);\r\n                }\r\n\r\n                if(objectIdBeingResized !== null) {\r\n                    handleResizeEnd();\r\n                }\r\n\r\n                if(currentGroupTransformationContainerBeingDragged !== null) {\r\n                    currentGroupTransformationContainerBeingDragged.endTranslate();\r\n                    currentGroupTransformationContainerBeingDragged = null;\r\n                }\r\n\r\n                if(multiObjectSelectionStarted) {\r\n                    handleMultiEntitySelectionEnd();\r\n                }\r\n\r\n                objectIdBeingDragged = null;\r\n                objectIdBeingResized = null;\r\n            }\r\n        });\r\n\r\n        _sheetDomElement.addEventListener('mousedown', function (e) {\r\n            // if we're dragging something, stop propagation\r\n            if(currentGroupTransformationContainerBeingDragged !== null || objectIdBeingDragged !== null || objectIdBeingResized !== null) {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n            }\r\n        });\r\n    };\r\n\r\n    const emitEvent = function(_eventName, _eventData) {\r\n        const allCallbacks = eventHandlers.get(_eventName) || [];\r\n\r\n        for(let i=0; i<allCallbacks.length; i++) {\r\n            const cbFunc = allCallbacks[i];\r\n            cbFunc(_eventData);\r\n        }\r\n    };\r\n\r\n    this.off = function(_eventName, _callback) {\r\n        const allCallbacks = eventHandlers.get(_eventName) || [];\r\n\r\n        for(let i=0; i<allCallbacks.length; i++) {\r\n            if(allCallbacks[i] === _callback) {\r\n                allCallbacks.splice(i, 1);\r\n                break;\r\n            }\r\n        }\r\n\r\n        eventHandlers.set(_eventName, allCallbacks);\r\n    };\r\n\r\n    this.on = function(_eventName, _callback) {\r\n        const allCallbacks = eventHandlers.get(_eventName) || [];\r\n        allCallbacks.push(_callback);\r\n        eventHandlers.set(_eventName, allCallbacks);\r\n    };\r\n\r\n    self.setGrid(new Grid(12.0, '#424242', GRID_STYLE.DOT));\r\n    self.resetTransform();\r\n    self.setTransformOrigin(0, 0);\r\n    self.setTransitionCss(transitionCss);\r\n};\r\n\r\nexport { Sheet };\r\n","import {EntityEvent} from './EntityEvent';\r\nimport {Point} from './Point';\r\nimport {Rectangle} from './Rectangle';\r\nimport {Sheet} from './Sheet';\r\nimport {ConnectorAnchor} from './ConnectorAnchor';\r\nimport {PointSet} from './PointSet';\r\nimport {Originator} from './Originator';\r\n\r\n/**\r\n * \r\n * @param {String} _id\r\n * @param {Number} _x\r\n * @param {Number} _y\r\n * @param {Number} _width\r\n * @param {Number} _height\r\n * @param {Sheet} _sheet\r\n * @param {Element} _domElement\r\n * @param {Element[]} _translateHandleDomElements\r\n * @param {Element[]} _resizeHandleDomElements\r\n */\r\nfunction Entity(_id, _x, _y, _width, _height, _sheet, _domElement, _translateHandleDomElements, _resizeHandleDomElements) {\r\n    const self = this;\r\n\r\n    const MOUSE_MIDDLE_BUTTON = 1;\r\n\r\n    /**\r\n     * @type {ConnectorAnchor[]}\r\n     */\r\n    const connectorAnchors = [];\r\n\r\n    /**\r\n     * @type {Number}\r\n     */\r\n    var nextConnectorAnchorIdSuffix = 1000;\r\n\r\n    /**\r\n     * @type {Element}\r\n     */\r\n    var currentTranslateHandleElementActivated = null;\r\n\r\n    /**\r\n     * @type {Element}\r\n     */\r\n    var currentResizeHandleElementActivated = null;\r\n\r\n    const eventNameToHandlerFunc = new Map();\r\n\r\n    let x = null;\r\n    let y = null;\r\n    let width = null;\r\n    let height = null;\r\n    let hasPendingFrame = false;\r\n    let overwrittenRenderStyles = {};\r\n\r\n    /**\r\n     * @param {Element} _connectorAnchorDomElement\r\n     * @param {Number} _routingPointOffsetX\r\n     * @param {Number} _routingPointOffsetY\r\n     * @returns {ConnectorAnchor}\r\n     */    \r\n    this.addNonInteractableConnectorAnchor = function(_connectorAnchorDomElement, _routingPointOffsetX, _routingPointOffsetY) {\r\n        const newAnchor = new ConnectorAnchor(_id + `-${nextConnectorAnchorIdSuffix}`, _connectorAnchorDomElement, _sheet, _routingPointOffsetX, _routingPointOffsetY);\r\n        connectorAnchors.push(newAnchor);\r\n        nextConnectorAnchorIdSuffix++;\r\n        return newAnchor;\r\n    };\r\n\r\n    /**\r\n     * @param {Element} _connectorAnchorDomElement\r\n     * @param {Number} _routingPointOffsetX\r\n     * @param {Number} _routingPointOffsetY \r\n     * @returns {ConnectorAnchor}\r\n     */    \r\n    this.addInteractableConnectorAnchor = function(_connectorAnchorDomElement, _routingPointOffsetX, _routingPointOffsetY) {     \r\n        const anchor = new ConnectorAnchor(_id + `-${nextConnectorAnchorIdSuffix}`, _connectorAnchorDomElement, _sheet, _routingPointOffsetX, _routingPointOffsetY);\r\n\r\n        _connectorAnchorDomElement.addEventListener('click', function(e) {\r\n            _sheet.addConnectionAnchorToSelectionStack(anchor);\r\n        });\r\n\r\n        connectorAnchors.push(anchor);\r\n        nextConnectorAnchorIdSuffix++;\r\n        return anchor;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @returns {Point[]}\r\n     */\r\n    this.getConnectorAnchorRoutingPoints = function() {\r\n        const allRoutingPoints = [];\r\n        connectorAnchors.forEach(function(_anchor) {\r\n            const anchorPoints = _anchor.getRoutingPoints();\r\n            anchorPoints.forEach(function(_pt) {\r\n                allRoutingPoints.push(_pt);\r\n            });\r\n        });\r\n\r\n        return allRoutingPoints;\r\n    };\r\n\r\n    /**\r\n     * @returns {ConnectorAnchor[]}\r\n     */\r\n    this.getConnectorAnchors = function() {\r\n        return connectorAnchors;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {ConnectorAnchor} _anchor \r\n     * @returns {Boolean}\r\n     */\r\n    this.hasConnectorAnchor = function(_anchor) {\r\n        const anchors = self.getConnectorAnchors();\r\n        for(let i=0; i<anchors.length; i++) {\r\n            if(anchors[i] === _anchor) {\r\n                return true;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    };\r\n\r\n    /**\r\n     * @returns {Point|null}\r\n     */    \r\n    this.getTranslateHandleOffset = function() {\r\n        if(currentTranslateHandleElementActivated) {\r\n            return new Point(\r\n                -(currentTranslateHandleElementActivated.offsetLeft + currentTranslateHandleElementActivated.offsetWidth * 0.5),\r\n                -(currentTranslateHandleElementActivated.offsetTop  + currentTranslateHandleElementActivated.offsetHeight * 0.5)\r\n            );\r\n        }\r\n\r\n        return null;\r\n    };\r\n\r\n    /**\r\n     * @returns {String}\r\n     */\r\n    this.getId = function() {\r\n        return _id;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getX = function() {\r\n        return x;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getY = function() {\r\n        return y;\r\n    };\r\n\r\n    /**\r\n     * @returns {Point}\r\n     */\r\n    this.getPositionOnPage = function() {\r\n        const window = _domElement.ownerDocument.defaultView;\r\n        const boundingRect = _domElement.getBoundingClientRect();\r\n        return new Point(boundingRect.left + window.scrollX, boundingRect.top + window.scrollY);\r\n    };\r\n\r\n    this.renderImmediate = function() {\r\n        if(overwrittenRenderStyles.left) {\r\n            _domElement.style.left = overwrittenRenderStyles.left;\r\n        } else {\r\n            _domElement.style.left = x + 'px';\r\n        }\r\n\r\n        if(overwrittenRenderStyles.top) {\r\n            _domElement.style.top = overwrittenRenderStyles.top;\r\n        } else {\r\n            _domElement.style.top = y + 'px';\r\n        }\r\n\r\n        if(overwrittenRenderStyles.width) {\r\n            _domElement.style.width = overwrittenRenderStyles.width;\r\n        } else {\r\n            _domElement.style.width = width + 'px';\r\n        }\r\n\r\n        if(overwrittenRenderStyles.height) {\r\n            _domElement.style.height = overwrittenRenderStyles.height;\r\n        } else {\r\n            _domElement.style.height = height + 'px';\r\n        }\r\n        \r\n        hasPendingFrame = false;\r\n    };\r\n\r\n    this.render = function() {\r\n        if(hasPendingFrame) {\r\n            cancelAnimationFrame(self.renderImmediate);\r\n        }\r\n\r\n        hasPendingFrame = true;\r\n        requestAnimationFrame(self.renderImmediate);\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {String} _style \r\n     * @param {String} _value \r\n     */\r\n    this.overwriteRenderStyle = function(_style, _value) {\r\n        overwrittenRenderStyles[_style] = _value;\r\n    };\r\n\r\n    /**\r\n     * @param {Number} _x\r\n     * @param {Number} _y\r\n     * @param {Boolean} [_withinGroupTransformation=false]\r\n     * @param {Originator} [_originator=Originator.PROGRAM]\r\n     */\r\n    this.translate = function(_x, _y, _withinGroupTransformation, _originator) {\r\n        if(_x === x && _y === y) {\r\n            return;\r\n        }\r\n\r\n        x = _x;\r\n        y = _y;\r\n\r\n        self.render();       \r\n\r\n        const observers = eventNameToHandlerFunc.get(EntityEvent.TRANSLATE) || [];\r\n        observers.forEach(function(handler) {\r\n            handler(\r\n                {\r\n                    \"obj\": self, \r\n                    \"x\": _x, \r\n                    \"y\": _y,\r\n                    \"withinGroupTransformation\": _withinGroupTransformation ? true : false,\r\n                    \"originator\": _originator ? _originator : Originator.PROGRAM,\r\n                }\r\n            );\r\n        });\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getWidth = function() {\r\n        return width;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getHeight = function() {\r\n        return height;\r\n    };\r\n\r\n    /**\r\n     * @param {Number} _width\r\n     * @param {Number} _height\r\n     * @param {Originator} [_source=Originator.PROGRAM]\r\n     */\r\n    this.resize = function(_width, _height, _originator) {            \r\n        width = _width;\r\n        height = _height;\r\n\r\n        self.render();\r\n\r\n        const observers = eventNameToHandlerFunc.get(EntityEvent.RESIZE) || [];\r\n        observers.forEach(function(handler) {\r\n            handler(\r\n                {\r\n                    \"obj\": self, \r\n                    \"width\": _width, \r\n                    \"height\": _height,\r\n                    \"originator\": _originator ? _originator : Originator.PROGRAM,\r\n                }\r\n            );\r\n        });\r\n    };\r\n\r\n    /**\r\n     * @returns {Element}\r\n     */\r\n    this.getDomElement = function() {\r\n        return _domElement;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {String} _eventName\r\n     * @param {*} _eventData\r\n     */\r\n    this.handleSiblingObjectChange = function(_eventName, _eventData) { \r\n\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @returns {Rectangle}\r\n     */\r\n    this.getBoundingRectange = function() {\r\n        const left = x;\r\n        const top = y;\r\n        const right = left + width;\r\n        const bottom = top + height;\r\n\r\n        return new Rectangle(left, top, right, bottom);\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @returns {Rectangle}\r\n     */\r\n    this.getBoundingRectangeInPageSpace = function() {\r\n        const pagePos = self.getPositionOnPage();\r\n        const left = pagePos.getX();\r\n        const top = pagePos.getY();\r\n        const right = left + width;\r\n        const bottom = top + height;\r\n        return new Rectangle(left, top, right, bottom);\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Rectangle} _rectInPageSpace\r\n     * @returns {Rectangle}\r\n     */\r\n    this.computePageToEntitySpaceTransformedRectangle = function(_rectInPageSpace) {\r\n        const noteBoundingRect = self.getBoundingRectangeInPageSpace();\r\n        const rectRelativeToNote = new GraphPaper.Rectangle(\r\n            _rectInPageSpace.getLeft() - noteBoundingRect.getLeft(),\r\n            _rectInPageSpace.getTop() - noteBoundingRect.getTop(),\r\n            _rectInPageSpace.getRight() - noteBoundingRect.getRight(),\r\n            _rectInPageSpace.getBottom() - noteBoundingRect.getBottom()\r\n        );\r\n\r\n        return rectRelativeToNote;\r\n    };\r\n\r\n    /**\r\n     * @returns {Point[]}\r\n     */\r\n    this.getBoundingPoints = function() {\r\n        const topLeft = new Point(self.getX(), self.getY());\r\n        const topRight = new Point(self.getX() + self.getWidth(), self.getY());\r\n        const bottomLeft = new Point(self.getX(), self.getY() + self.getWidth());\r\n        const bottomRight = new Point(self.getX() + self.getWidth(), self.getY() + self.getWidth());\r\n\r\n        return [\r\n            topLeft,\r\n            topRight,\r\n            bottomLeft,\r\n            bottomRight\r\n        ];\r\n    };\r\n\r\n    /**\r\n     * @returns {Object}\r\n     */\r\n    this.getDescriptor = function() {\r\n        let outerBoundMinX = self.getX();\r\n        let outerBoundMinY = self.getY();\r\n        let outerBoundMaxX = self.getX() + self.getWidth();\r\n        let outerBoundMaxY = self.getY() + self.getHeight();\r\n\r\n        const anchors = [];\r\n        for(let i=0; i<connectorAnchors.length; i++) {\r\n            const boundingRect = connectorAnchors[i].getBoundingRectange();\r\n            let routingPoints = new PointSet(connectorAnchors[i].getRoutingPoints());\r\n            anchors.push(\r\n                {\r\n                    \"id\": connectorAnchors[i].getId(),\r\n                    \"x\": boundingRect.getLeft(),\r\n                    \"y\": boundingRect.getTop(),\r\n                    \"width\": boundingRect.getWidth(),\r\n                    \"height\": boundingRect.getHeight(),\r\n                    \"routingPointsFloat64Arr\": routingPoints.toFloat64Array()\r\n                }\r\n            );\r\n\r\n            if(boundingRect.getLeft() < outerBoundMinX) {\r\n                outerBoundMinX = boundingRect.getLeft();\r\n            }\r\n\r\n            if(boundingRect.getTop() < outerBoundMinY) {\r\n                outerBoundMinY = boundingRect.getTop();\r\n            }\r\n\r\n            if((boundingRect.getLeft() + boundingRect.getWidth()) > outerBoundMaxX) {\r\n                outerBoundMaxX = (boundingRect.getLeft() + boundingRect.getWidth());\r\n            }\r\n\r\n            if((boundingRect.getTop() + boundingRect.getHeight()) > outerBoundMaxY) {\r\n                outerBoundMaxY = (boundingRect.getTop() + boundingRect.getHeight());\r\n            }\r\n        }\r\n\r\n        return {\r\n            \"id\": self.getId(),\r\n            \"x\": self.getX(),\r\n            \"y\": self.getY(),\r\n            \"width\": self.getWidth(),\r\n            \"height\": self.getHeight(),\r\n            \"connectorAnchors\": anchors,\r\n            \"outerBoundingRect\": {\r\n                \"minX\": outerBoundMinX,\r\n                \"minY\": outerBoundMinY,\r\n                \"maxX\": outerBoundMaxX,\r\n                \"maxY\": outerBoundMaxY\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {String} _eventName \r\n     * @param {*} _handlerFunc \r\n     */\r\n    this.on = function(_eventName, _handlerFunc) {\r\n        const allHandlers = eventNameToHandlerFunc.get(_eventName) || [];\r\n        allHandlers.push(_handlerFunc);\r\n        eventNameToHandlerFunc.set(_eventName, allHandlers);    \r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {String} _eventName \r\n     * @param {*} _callback \r\n     */\r\n    this.off = function(_eventName, _callback) {\r\n        const allCallbacks = eventNameToHandlerFunc.get(_eventName) || [];\r\n\r\n        for(let i=0; i<allCallbacks.length; i++) {\r\n            if(allCallbacks[i] === _callback) {\r\n                allCallbacks.splice(i, 1);\r\n                break;\r\n            }\r\n        }\r\n\r\n        eventNameToHandlerFunc.set(_eventName, allCallbacks);\r\n    };\r\n\r\n    this.suspendTranslateInteractions = function() {\r\n        unbindTranslateHandleElements();\r\n    };\r\n\r\n    this.resumeTranslateInteractions = function() {\r\n        bindTranslateHandleElements();\r\n    };\r\n\r\n    const translateTouchStartHandler = function(e) {\r\n        currentTranslateHandleElementActivated = e.target;\r\n\r\n        const observers = eventNameToHandlerFunc.get(EntityEvent.TRANSLATE_START) || [];\r\n        observers.forEach(function(handler) {\r\n            handler({\r\n                \"obj\": self,\r\n                \"x\": e.touches[0].pageX, \r\n                \"y\": e.touches[0].pageY,\r\n                \"isTouch\": true,\r\n                \"originator\": Originator.USER,\r\n            });\r\n        });        \r\n\r\n    };\r\n\r\n    const translateMouseDownHandler = function(e) {\r\n        currentTranslateHandleElementActivated = e.target;\r\n        \r\n        const observers = eventNameToHandlerFunc.get(EntityEvent.TRANSLATE_START) || [];\r\n        observers.forEach(function(handler) {\r\n            handler({\r\n                \"obj\": self,\r\n                \"x\": e.pageX, \r\n                \"y\": e.pageY,\r\n                \"isTouch\": false,\r\n                \"originator\": Originator.USER,\r\n            });\r\n        });        \r\n        \r\n    };\r\n\r\n    const unbindTranslateHandleElements = function() {\r\n        _translateHandleDomElements.forEach((_el) => {\r\n            _el.removeEventListener('touchstart', translateTouchStartHandler);        \r\n            _el.removeEventListener('mousedown', translateMouseDownHandler);\r\n        });\r\n    };\r\n\r\n    const bindTranslateHandleElements = function() {\r\n        _translateHandleDomElements.forEach((_el) => {\r\n            _el.addEventListener('touchstart', translateTouchStartHandler);        \r\n            _el.addEventListener('mousedown', translateMouseDownHandler);\r\n        });\r\n    };\r\n\r\n    const resizeMouseDownHandler = function(_e, _triggeredByElement, _resizeCursor) {\r\n        if (_e.which !== MOUSE_MIDDLE_BUTTON) {\r\n            return;\r\n        }\r\n\r\n        currentResizeHandleElementActivated = _triggeredByElement;\r\n        \r\n        const observers = eventNameToHandlerFunc.get(EntityEvent.RESIZE_START) || [];\r\n        observers.forEach(function(handler) {\r\n            handler({\r\n                \"obj\": self,\r\n                \"x\": _e.pageX, \r\n                \"y\": _e.pageY,\r\n                \"resizeCursor\": _resizeCursor,\r\n                \"isTouch\": false,\r\n                \"originator\": Originator.USER,\r\n            });\r\n        });    \r\n    };\r\n\r\n    const resizeTouchStartHandler = function(_e, _triggeredByElement, _resizeCursor) {\r\n        currentResizeHandleElementActivated =_triggeredByElement;\r\n        \r\n        const observers = eventNameToHandlerFunc.get(EntityEvent.RESIZE_START) || [];\r\n        observers.forEach(function(handler) {\r\n            handler({\r\n                \"obj\": self,\r\n                \"x\": _e.touches[0].pageX,  \r\n                \"y\": _e.touches[0].pageY,\r\n                \"resizeCursor\": _resizeCursor,\r\n                \"isTouch\": true,\r\n                \"originator\": Originator.USER,\r\n            });\r\n        });\r\n    };\r\n\r\n    const bindResizeHandleElements = function() {\r\n        _resizeHandleDomElements.forEach((_el) => {\r\n            const cursor = window.getComputedStyle(_el)['cursor'];\r\n\r\n            _el.addEventListener('touchstart', (e) => {\r\n                resizeTouchStartHandler(e, _el, cursor);\r\n            });\r\n\r\n            _el.addEventListener('mousedown', (e) => {\r\n                resizeMouseDownHandler(e, _el, cursor);\r\n            });  \r\n        });\r\n    };\r\n\r\n\r\n    bindTranslateHandleElements();\r\n    bindResizeHandleElements();\r\n    self.translate(_x, _y, false, Originator.PROGRAM);\r\n    self.resize(_width, _height, Originator.PROGRAM);\r\n};\r\n\r\nexport { Entity };\r\n","import {Entity} from './Entity';\r\nimport {Originator} from './Originator';\r\nimport {GroupTransformationContainerEvent} from './GroupTransformationContainerEvent';\r\nimport {Rectangle} from './Rectangle';\r\n\r\n/**\r\n * @param {Sheet} _sheet\r\n * @param {Entity[]} _entities\r\n * @param {String[]} _containerStyleCssClasses\r\n * @param {Number} _sizeAdjustmentPx\r\n */\r\nfunction GroupTransformationContainer(_sheet, _entities, _containerStyleCssClasses, _sizeAdjustmentPx)  {\r\n    const self = this;\r\n    const eventNameToHandlerFunc = new Map();\r\n\r\n    /**\r\n     * \r\n     * @returns {Rectangle}\r\n     */\r\n    const calculateBoundingRect = function() {\r\n        var r = _sheet.calcBoundingRectForEntities(_entities);\r\n        if(_sizeAdjustmentPx) {\r\n            r = r.getUniformlyResizedCopy(_sizeAdjustmentPx);\r\n        }\r\n\r\n        return r;\r\n    };\r\n\r\n    var boundingRect = calculateBoundingRect();\r\n\r\n    var accTranslateX = 0.0;\r\n    var accTranslateY = 0.0;    \r\n\r\n    var currentLeft = boundingRect.getLeft();\r\n    var currentTop = boundingRect.getTop();\r\n\r\n    const entityPositionRelativeToBoundingRect = [];\r\n\r\n    _entities.forEach(function(_obj) {\r\n        const rp = {\r\n            \"x\": _obj.getX() - currentLeft,\r\n            \"y\": _obj.getY() - currentTop\r\n        };\r\n\r\n        entityPositionRelativeToBoundingRect.push(rp);\r\n    });\r\n\r\n    const selBox = window.document.createElement(\"div\");\r\n    selBox.classList.add('ia-group-transformation-container');\r\n    selBox.style.display = \"none\";\r\n    selBox.style.position = \"absolute\";\r\n    selBox.style.left = `${currentLeft}px`;\r\n    selBox.style.top = `${currentTop}px`;\r\n    selBox.style.width = `${boundingRect.getWidth()}px`;\r\n    selBox.style.height = `${boundingRect.getHeight()}px`;    \r\n\r\n    // only display the container if we have 1+ entity in the group\r\n    if(_entities.length > 0) {\r\n        selBox.style.display = \"block\";\r\n    }\r\n\r\n    if(typeof _containerStyleCssClasses === 'undefined' || _containerStyleCssClasses.length === 0) {\r\n        // default styling if no classes are provided\r\n        selBox.style.border = \"1px solid rgb(158, 158, 158)\";\r\n        selBox.style.backgroundColor = \"rgba(153, 153, 153, 0.5)\";       \r\n    } else {\r\n        // CSS classes will control styling for things GraphPaper doesn't care about\r\n        // (GraphPaper style concerns are handled via inline styles which will always take precedance)\r\n        _containerStyleCssClasses.forEach(function(_class) {\r\n            selBox.classList.add(_class);\r\n        });\r\n    }\r\n\r\n\r\n    this.getContainerDomElement = function() {\r\n        return selBox;\r\n    };\r\n    \r\n    /**\r\n     * @returns {Entity[]}\r\n     */\r\n    this.getEntities = function() {\r\n        return _entities;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @returns {Rectangle}\r\n     */\r\n    this.getBoundingRect = function() {\r\n        return boundingRect;\r\n    };\r\n\r\n    /**\r\n     * @param {Number} _dx\r\n     * @param {Number} _dy\r\n     */\r\n    this.translateByOffset = function(_dx, _dy) {\r\n        accTranslateX += _dx;\r\n        accTranslateY += _dy;\r\n\r\n        const newLeft = _sheet.snapToGrid(boundingRect.getLeft() + accTranslateX);\r\n        const newTop = _sheet.snapToGrid(boundingRect.getTop() + accTranslateY);\r\n\r\n        if(currentLeft === newLeft && currentTop === newTop) {\r\n            // no translation\r\n            return;\r\n        }\r\n\r\n        currentLeft = newLeft;\r\n        currentTop = newTop;\r\n\r\n        selBox.style.left = `${currentLeft}px`;\r\n        selBox.style.top = `${currentTop}px`;        \r\n\r\n        for(let i=0; i<_entities.length; i++) {\r\n            const rp = entityPositionRelativeToBoundingRect[i];\r\n            _entities[i].translate(\r\n                _sheet.snapToGrid(currentLeft + rp.x), \r\n                _sheet.snapToGrid(currentTop + rp.y),\r\n                true,\r\n                Originator.USER,\r\n            );\r\n        }\r\n\r\n        const observers = eventNameToHandlerFunc.get(GroupTransformationContainerEvent.TRANSLATE) || [];\r\n        observers.forEach(function(handler) {\r\n            handler({\r\n                \"container\": self,\r\n                \"x\": currentLeft, \r\n                \"y\": currentTop\r\n            });\r\n        });\r\n    };\r\n\r\n    this.endTranslate = function() {\r\n        accTranslateX = 0.0;\r\n        accTranslateY = 0.0;\r\n        boundingRect = calculateBoundingRect();\r\n    };\r\n\r\n    this.initTranslateInteractionHandler = function() {\r\n        selBox.addEventListener('touchstart', translateTouchStartHandler);        \r\n        selBox.addEventListener('mousedown', translateMouseDownHandler);\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {String} _eventName \r\n     * @param {*} _handlerFunc \r\n     */\r\n    this.on = function(_eventName, _handlerFunc) {\r\n        const allHandlers = eventNameToHandlerFunc.get(_eventName) || [];\r\n        allHandlers.push(_handlerFunc);\r\n        eventNameToHandlerFunc.set(_eventName, allHandlers);        \r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {String} _eventName \r\n     * @param {*} _callback \r\n     */\r\n    this.off = function(_eventName, _callback) {\r\n        const allCallbacks = eventNameToHandlerFunc.get(_eventName) || [];\r\n\r\n        for(let i=0; i<allCallbacks.length; i++) {\r\n            if(allCallbacks[i] === _callback) {\r\n                allCallbacks.splice(i, 1);\r\n                break;\r\n            }\r\n        }\r\n\r\n        eventNameToHandlerFunc.set(_eventName, allCallbacks);\r\n    };\r\n\r\n    const translateTouchStartHandler = function(e) {\r\n        const observers = eventNameToHandlerFunc.get(GroupTransformationContainerEvent.TRANSLATE_START) || [];\r\n        observers.forEach(function(handler) {\r\n            handler({\r\n                \"container\": self,\r\n                \"x\": e.touches[0].pageX, \r\n                \"y\": e.touches[0].pageY,\r\n                \"isTouch\": true\r\n            });\r\n        });\r\n    };\r\n\r\n    const translateMouseDownHandler = function(e) {       \r\n        const observers = eventNameToHandlerFunc.get(GroupTransformationContainerEvent.TRANSLATE_START) || [];\r\n        observers.forEach(function(handler) {\r\n            handler({\r\n                \"container\": self,\r\n                \"x\": e.pageX, \r\n                \"y\": e.pageY,\r\n                \"isTouch\": false\r\n            });\r\n        });\r\n    };\r\n};\r\n\r\nexport {GroupTransformationContainer}\r\n","import {Rectangle} from './Rectangle';\r\nimport {Cluster} from './Cluster';\r\n\r\nfunction BoxClusterDetector(_boxExtentOffset) {\r\n    const self = this;\r\n\r\n    /**\r\n     * \r\n     * @param {Object} _entityDescriptor \r\n     * @param {Object[]} _sheetEntityDescriptorsArray \r\n     * @returns {Number}\r\n     */\r\n    const getEntityIndexFromArray = function(_entityDescriptor, _sheetEntityDescriptorsArray) {\r\n        for(let i=0; i<_sheetEntityDescriptorsArray.length; i++) {\r\n            if(_sheetEntityDescriptorsArray[i].id === _entityDescriptor.id) {\r\n                return i;\r\n            }\r\n        }\r\n\r\n        return -1;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Object} _entityDescriptor \r\n     * @param {Object[]} _sheetEntityDescriptorsArray\r\n     * @returns {Object[]}\r\n     */\r\n    const removeEntitiesFromArray = function(_entityDescriptor, _sheetEntityDescriptorsArray) {\r\n        for(let i=0; i<_entityDescriptor.length; i++) {\r\n            const idx = getEntityIndexFromArray(_entityDescriptor[i], _sheetEntityDescriptorsArray);\r\n            if(idx !== -1) {\r\n                _sheetEntityDescriptorsArray.splice(idx, 1);\r\n            }\r\n        }\r\n\r\n        return _sheetEntityDescriptorsArray;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Map<Cluster, Number>} _clusterToEntityCountMap \r\n     * @returns {Cluster}\r\n     */\r\n    const getClusterWithMostEntitiesFromClusterMap = function(_clusterToEntityCountMap) {\r\n        var curMaxObjs = 0;\r\n        var curClusterWithMax = null;\r\n\r\n        _clusterToEntityCountMap.forEach(function(_numObjs, _cluster, _map) {\r\n            if(_numObjs > curMaxObjs) {\r\n                curMaxObjs = _numObjs;\r\n                curClusterWithMax = _cluster;\r\n            }\r\n        });\r\n\r\n        return curClusterWithMax;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {String[]} _arrA \r\n     * @param {String[]} _arrB \r\n     * @returns {Object}\r\n     */\r\n    const computeDiffBetweenArrays = function(_arrA, _arrB) {\r\n        const onlyInA = [];\r\n        const onlyInB = [];\r\n\r\n        _arrB.forEach((_postItem) => {\r\n            if(_arrA.indexOf(_postItem) === -1) {\r\n                onlyInB.push(_postItem);\r\n            }\r\n        });\r\n\r\n        _arrA.forEach((_preItem) => {\r\n            if(_arrB.indexOf(_preItem) === -1) {\r\n                onlyInA.push(_preItem);\r\n            }\r\n        });\r\n\r\n        return {\r\n            \"onlyInA\": onlyInA,\r\n            \"onlyInB\": onlyInB\r\n        };\r\n    };\r\n\r\n    /**\r\n     * @param {Map<Cluster, Number>} _clusterToEntityCountMap \r\n     * @returns {Cluster[]}\r\n     */\r\n    const getClusterArrayFromClusterMap = function(_clusterToEntityCountMap) {\r\n        const resultSet = [];\r\n        _clusterToEntityCountMap.keys().forEach(function(_cluster) {\r\n            resultSet.push(_cluster);\r\n        });\r\n\r\n        return resultSet;\r\n    };\r\n\r\n    /**\r\n     * @param {Object} _entityA\r\n     * @param {Object} _entityB\r\n     * @returns {Boolean}\r\n     */\r\n    this.areEntitiesClose = function(_entityA, _entityB) {\r\n        const nA = new Rectangle(\r\n            _entityA.x - _boxExtentOffset, \r\n            _entityA.y - _boxExtentOffset, \r\n            _entityA.x + _entityA.width + _boxExtentOffset, \r\n            _entityA.y + _entityA.height + _boxExtentOffset\r\n        );\r\n\r\n        const nB = new Rectangle(\r\n            _entityB.x - _boxExtentOffset, \r\n            _entityB.y - _boxExtentOffset, \r\n            _entityB.x + _entityB.width + _boxExtentOffset, \r\n            _entityB.y + _entityB.height + _boxExtentOffset\r\n        );\r\n        \r\n        return nA.checkIntersect(nB);\r\n    };\r\n   \r\n    /**\r\n     * @param {Object} _entityDescriptor\r\n     * @param {Object[]} _entitiesUnderConsideration\r\n     * @returns {Object[]}\r\n     */\r\n    this.getAllEntitiesCloseTo = function(_entityDescriptor, _entitiesUnderConsideration) {\r\n        const resultSet = [];\r\n        for(let i=0; i<_entitiesUnderConsideration.length; i++) {\r\n            if(_entityDescriptor.id === _entitiesUnderConsideration[i].id) {\r\n                continue;\r\n            }\r\n\r\n            if(self.areEntitiesClose(_entityDescriptor, _entitiesUnderConsideration[i])) {\r\n                resultSet.push(_entitiesUnderConsideration[i]);\r\n            }\r\n        }\r\n\r\n        return resultSet;\r\n    };\r\n\r\n    /**\r\n     * @param {Object} _seedEntity\r\n     * @param {Object[]} _entitiesUnderConsideration\r\n     * @param {Object[]} _resultSet\r\n     */\r\n    this.getClusterEntitiesFromSeed = function(_seedEntity, _entitiesUnderConsideration, _resultSet) {\r\n        const closeByEntities = self.getAllEntitiesCloseTo(_seedEntity, _entitiesUnderConsideration);\r\n        if(closeByEntities.length === 0) {\r\n            return [];\r\n        } else {\r\n            removeEntitiesFromArray(closeByEntities.concat([_seedEntity]), _entitiesUnderConsideration);\r\n\r\n            closeByEntities.forEach(function(_entity) {\r\n                _resultSet.push(_entity);\r\n                self.getClusterEntitiesFromSeed(_entity, _entitiesUnderConsideration, _resultSet);\r\n            });\r\n        }\r\n    };\r\n\r\n    /**\r\n     * @param {Object[]} _entityDescriptors\r\n     * @param {Cluster[]} _clusters\r\n     * @returns {Map<Cluster,Number>}\r\n     */\r\n    this.findIntersectingClustersForEntities = function(_entityDescriptors, _clusters) {\r\n        // Map of Cluster that is intersecting to number of entities in _objs that is intersecting the given Cluster\r\n        const intersectingClusterToNumEntitiesIntersecting = new Map();\r\n\r\n        _clusters.forEach(function(_cluster) {\r\n            const clusterEntities = _cluster.getEntities();\r\n\r\n            for(let i=0; i<clusterEntities.length; i++) {\r\n                for(let j=0; j<_entityDescriptors.length; j++) {\r\n\r\n                    if(clusterEntities[i].id !== _entityDescriptors[j].id) {\r\n                        continue;\r\n                    }\r\n\r\n                    if(intersectingClusterToNumEntitiesIntersecting.has(_cluster)) {\r\n                        const count = intersectingClusterToNumEntitiesIntersecting.get(_cluster);\r\n                        intersectingClusterToNumEntitiesIntersecting.set(_cluster, count+1);\r\n                    } else {\r\n                        intersectingClusterToNumEntitiesIntersecting.set(_cluster, 1);\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        return intersectingClusterToNumEntitiesIntersecting;\r\n    };\r\n\r\n    /**\r\n     * @param {Object} _entityDescriptor\r\n     * @param {Cluster[]} _clusters\r\n     * @returns {String[]}\r\n     */\r\n    this.removeEntityFromClusters = function(_entityDescriptor, _clusters) {\r\n        const mutatedClusterIds = [];\r\n        _clusters.forEach(function(_c) {\r\n            const wasFoundAndRemoved = _c.removeEntityById(_entityDescriptor.id);\r\n            if(wasFoundAndRemoved) {\r\n                mutatedClusterIds.push(_c.getId());\r\n            }\r\n        });\r\n\r\n        return mutatedClusterIds;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {String[]} _currentEntityIds \r\n     * @param {Cluster[]} _clusters\r\n     * @returns {Cluster[]}\r\n     */\r\n    this.mapToClustersWithOldEntitiesRemoved = function(_currentEntityIds, _clusters) {\r\n        const result = _clusters.map(function(_c) {\r\n            const clusterEntityIds = _c.getEntityIds();\r\n            for(let i=0; i<clusterEntityIds.length; i++) {\r\n                if(_currentEntityIds.indexOf(clusterEntityIds[i]) === -1) {\r\n                    _c.removeEntityById(clusterEntityIds[i]);\r\n                }\r\n            }\r\n\r\n            return _c;\r\n        });\r\n\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * @param {Object[]} _entityDescriptors\r\n     * @param {Cluster[]} _knownClusters\r\n     * @param {Function} _getNewIdFunc\r\n     */\r\n    this.computeClusters = function(_entityDescriptors, _knownClusters, _getNewIdFunc) {\r\n        const newClusterIds = new Set();\r\n        const updatedClusterIds = new Set();\r\n        const deletedClusterIds = new Set();\r\n        const updatedClusterToAddedEntitites = new Map();\r\n        const updatedClusterToRemovedEntitites = new Map();\r\n\r\n        const entitiesUnderConsideration = _entityDescriptors.map(function(_e) {\r\n            return _e;\r\n        });\r\n\r\n        const entitiesUnderConsiderationIds = _entityDescriptors.map(function(_e) {\r\n            return _e.id;\r\n        });        \r\n\r\n        const clusters = self.mapToClustersWithOldEntitiesRemoved(entitiesUnderConsiderationIds, _knownClusters);\r\n\r\n        while(entitiesUnderConsideration.length > 0) {\r\n            const entityDescriptor = entitiesUnderConsideration.pop();\r\n\r\n            const entitiesForCluster = [entityDescriptor];\r\n            self.getClusterEntitiesFromSeed(entityDescriptor, entitiesUnderConsideration, entitiesForCluster);\r\n\r\n            if(entitiesForCluster.length > 1) {\r\n                const intersectingClusterToNumEntitiesIntersecting = self.findIntersectingClustersForEntities(entitiesForCluster, clusters);\r\n\r\n                if(intersectingClusterToNumEntitiesIntersecting.size === 0) {\r\n                    const clusterId = _getNewIdFunc();\r\n                    const newCluster = new Cluster(clusterId);\r\n                    entitiesForCluster.forEach(function(_clusterEntity) {\r\n                        newCluster.addEntity(_clusterEntity);\r\n                    });    \r\n\r\n                    clusters.push(newCluster);\r\n                    newClusterIds.add(clusterId);\r\n                } else {\r\n                    const clusterToModify = getClusterWithMostEntitiesFromClusterMap(intersectingClusterToNumEntitiesIntersecting);\r\n                    const preEntityIds = clusterToModify.getEntityIds();\r\n\r\n                    // Clear out entities in cluster\r\n                    clusterToModify.removeAllEntities();\r\n\r\n                    // Remove entity from any cluster it's currently in, add it to clusterToModify\r\n                    entitiesForCluster.forEach(function(_clusterEntity) {\r\n                        const clustersMutated = self.removeEntityFromClusters(_clusterEntity, clusters);\r\n                        clustersMutated.forEach((_clusterId) => {\r\n                            updatedClusterIds.add(_clusterId);\r\n                        });\r\n\r\n                        clusterToModify.addEntity(_clusterEntity);\r\n                    });\r\n\r\n                    if(clusterToModify.getEntityIds().length === preEntityIds.length && clusterToModify.hasEntities(preEntityIds)) {\r\n                        // we ended up with the same cluster, no update\r\n                    } else {\r\n                        updatedClusterIds.add(clusterToModify.getId());\r\n\r\n                        const postUpdateEntityIds = clusterToModify.getEntityIds();\r\n                        const diffResult = computeDiffBetweenArrays(preEntityIds, postUpdateEntityIds);\r\n\r\n                        updatedClusterToRemovedEntitites.set(clusterToModify.getId(), diffResult.onlyInA);\r\n                        updatedClusterToAddedEntitites.set(clusterToModify.getId(), diffResult.onlyInB);\r\n                    }\r\n                }\r\n\r\n                removeEntitiesFromArray(entitiesForCluster, entitiesUnderConsideration);\r\n            } else {\r\n                const clustersMutated = self.removeEntityFromClusters(entityDescriptor, clusters);\r\n                clustersMutated.forEach((_clusterId) => {                    \r\n                    updatedClusterIds.add(_clusterId);\r\n\r\n                    const existingEntry = updatedClusterToRemovedEntitites.get(_clusterId);\r\n                    if(existingEntry) {\r\n                        existingEntry.push(entityDescriptor.id);\r\n                    } else {\r\n                        updatedClusterToRemovedEntitites.set(_clusterId, [entityDescriptor.id]);\r\n                    }\r\n\r\n                    // make sure updatedClusterToAddedEntitites entry is set\r\n                    if(typeof updatedClusterToAddedEntitites.get(_clusterId) === 'undefined') {\r\n                        updatedClusterToAddedEntitites.set(_clusterId, []);\r\n                    }\r\n                });\r\n            }\r\n        }\r\n\r\n        // Get IDs of empty and singleton clusters\r\n        const emptyAndSingletonClusters = \r\n            clusters\r\n                .filter(function(_c) {\r\n                    if(_c.getEntities().length < 2) {\r\n                        return true;\r\n                    }\r\n\r\n                    return false;\r\n                });\r\n\r\n        // Mark empty and single clusters as deleted clusters\r\n        emptyAndSingletonClusters.forEach((_c) => {\r\n            updatedClusterIds.delete(_c.getId());\r\n            updatedClusterToAddedEntitites.delete(_c.getId());\r\n            updatedClusterToRemovedEntitites.delete(_c.getId());\r\n\r\n            deletedClusterIds.add(_c.getId());\r\n        });\r\n\r\n        // Don't mark new clusters as also being updated clusters\r\n        newClusterIds.forEach((_cId) => {\r\n            updatedClusterIds.delete(_cId);\r\n            updatedClusterToAddedEntitites.delete(_cId);\r\n            updatedClusterToRemovedEntitites.delete(_cId);            \r\n        });\r\n\r\n        // Filter out clusters w/o any entities\r\n        const nonEmptyNonSingletonClusters = clusters.filter(function(_c) {\r\n            if(_c.getEntities().length >= 2) {\r\n                return true;\r\n            }\r\n\r\n            return false;\r\n        });  \r\n\r\n        return {\r\n            \"clusters\": nonEmptyNonSingletonClusters,\r\n            \"newClusterIds\": newClusterIds,\r\n            \"updatedClusterIds\": updatedClusterIds,\r\n            \"deletedClusterIds\": deletedClusterIds,\r\n            \"updatedClusterToRemovedEntitites\": updatedClusterToRemovedEntitites,\r\n            \"updatedClusterToAddedEntitites\": updatedClusterToAddedEntitites,\r\n        };\r\n    };\r\n};\r\n\r\nexport { BoxClusterDetector };\r\n","import {Point} from './Point';\r\n\r\nconst PointVisibilityMapRouteOptimizer = {\r\n\r\n    /**\r\n     * \r\n     * @param {Point[]} _pointsInRoute\r\n     * @param {Function} _arePointsVisibleToEachOther\r\n     */\r\n    optimize: function(_pointsInRoute, _arePointsVisibleToEachOther) {\r\n        let start = 0;\r\n        let end = _pointsInRoute.length - 1;\r\n\r\n        while(true) {\r\n            if((end-start) <= 1) {\r\n                start++;\r\n                end = _pointsInRoute.length - 1;\r\n\r\n                if(start >= _pointsInRoute.length-2) {\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if(_arePointsVisibleToEachOther(_pointsInRoute[start], _pointsInRoute[end])) {\r\n                _pointsInRoute.splice(start + 1, (end-start) - 1);\r\n                end = _pointsInRoute.length - 1;\r\n            } else {\r\n                end--;\r\n            }\r\n        }\r\n    }\r\n\r\n};\r\n\r\nexport { PointVisibilityMapRouteOptimizer }\r\n","import  {Point} from './Point';\r\nimport  {Line} from './Line';\r\n\r\n/**\r\n * Unique collection of Line objects\r\n * \r\n * @param {Line[]|Float64Array|undefined} _linesInput\r\n */\r\nfunction LineSet(_linesInput) {\r\n\r\n    const self = this;\r\n    \r\n    /**\r\n     * @type {Line[]}\r\n     */\r\n    const lines = [];    \r\n\r\n    /**\r\n     * @param {Line} _newLine\r\n     * @returns {Boolean}\r\n     */\r\n    this.push = function(_newLine) {\r\n        for(let i=0; i<lines.length; i++) {\r\n            if(_newLine.isEqual(lines[i])) {\r\n                // line already in set\r\n                return false;\r\n            }\r\n        }\r\n\r\n        lines.push(_newLine);\r\n        return true;\r\n    };\r\n  \r\n    /**\r\n     * @returns {Line[]}\r\n     */\r\n    this.toArray = function() {\r\n        return lines;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.count = function() {\r\n        return lines.length;\r\n    };\r\n\r\n    /**\r\n     * @returns {Float64Array}\r\n     */\r\n    this.toFloat64Array = function() {\r\n        const result = new Float64Array(lines.length * 4);\r\n        for(let i=0; i<lines.length; i++) {\r\n            result[0 + (i*4)] = lines[i].getStartPoint().getX();\r\n            result[1 + (i*4)] = lines[i].getStartPoint().getY();\r\n            result[2 + (i*4)] = lines[i].getEndPoint().getX();\r\n            result[3 + (i*4)] = lines[i].getEndPoint().getY();\r\n        }\r\n\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * @param {Float64Array} _float64Array\r\n     */\r\n    const fromFloat64Array = function(_float64Array) {\r\n        lines.length = 0;\r\n        for(let i=0; i<_float64Array.length; i+=4) {\r\n            lines.push(\r\n                new Line(\r\n                    new Point(_float64Array[i], _float64Array[i+1]),\r\n                    new Point(_float64Array[i+2], _float64Array[i+3])\r\n                )\r\n            );\r\n        }\r\n    };\r\n\r\n    if(_linesInput && Array.isArray(_linesInput)) {\r\n        _linesInput.forEach(self.push);\r\n    } else if(_linesInput && Object.prototype.toString.call(_linesInput) === '[object Float64Array]') {\r\n        fromFloat64Array(_linesInput);\r\n    } else { }    \r\n};\r\n\r\nexport { LineSet };\r\n","import {Point} from './Point';\r\n\r\n/**\r\n * \r\n * @param {Number} _x\r\n * @param {Number} _y\r\n */\r\nfunction Vec2(_x, _y) {\r\n    this.__x = _x;\r\n    this.__y = _y;\r\n};\r\n\r\nVec2.prototype = Object.create(Point.prototype, {});\r\n\r\nVec2.prototype.normalize = function() {\r\n    const len = Math.sqrt((this.__x * this.__x) + (this.__y * this.__y));\r\n    if(len === 0) {\r\n        return this;\r\n    }\r\n\r\n    this.__x = this.__x / len;\r\n    this.__y = this.__y / len;\r\n    return this;\r\n};\r\n\r\nVec2.prototype.dot = function(_v) {\r\n    return ((this.__x * _v.getX()) + (this.__y * _v.getY()));\r\n};\r\n\r\nexport {Vec2}\r\n","import {AccessibleRoutingPointsFinder} from './AccessibleRoutingPointsFinder';\r\nimport {Point} from './Point';\r\nimport {Line} from './Line';\r\nimport {PointSet} from './PointSet';\r\nimport {PointVisibilityMapRouteOptimizer} from './PointVisibilityMapRouteOptimizer';\r\nimport {LineSet} from './LineSet';\r\nimport {LINE_INTERSECTION_TYPE, LineIntersection} from './LineIntersection';\r\nimport {Rectangle} from './Rectangle';\r\nimport {Vec2} from './Vec2';\r\nimport { ConnectorRoutingAlgorithm } from './ConnectorRoutingAlgorithm';\r\n\r\nconst VisiblePoints = {\r\n    isValid: false,\r\n    points: []\r\n};\r\n\r\nconst PointInfo = {\r\n    point: null,\r\n    visiblePoints: null\r\n};\r\n\r\nfunction PointVisibilityMap() {\r\n    const self = this;\r\n\r\n    const entityIdToPointVisibility = new Map();\r\n    const entityIdToBoundaryLineSet = new Map();\r\n    const entityIdToDescriptor = new Map();\r\n    let currentNumRoutingPoints = 0;\r\n    let currentNumOfBoundaryLines = 0;\r\n\r\n    /**\r\n     * @param {Line} _theLine\r\n     * @returns {Boolean}\r\n     */\r\n    const doesLineIntersectAnyBoundaryLines = function(_theLine) {\r\n        for (let [_eid, _boundaryLineSet] of entityIdToBoundaryLineSet) {\r\n            const descriptor = entityIdToDescriptor.get(_eid);\r\n\r\n            if(_theLine.getMinX() > descriptor.outerBoundingRect.maxX) {\r\n                continue;\r\n            }\r\n            \r\n            if(_theLine.getMaxX() < descriptor.outerBoundingRect.minX) {\r\n                continue;\r\n            }\r\n\r\n            if(_theLine.getMinY() > descriptor.outerBoundingRect.maxY) {\r\n                continue;\r\n            }\r\n\r\n            if(_theLine.getMaxY() < descriptor.outerBoundingRect.minY) {\r\n                continue;\r\n            }\r\n\r\n            const boundaryLinesArr = _boundaryLineSet.toArray();\r\n            for(let i=0; i<boundaryLinesArr.length; i++) {\r\n                const intersectionType = boundaryLinesArr[i].computeIntersectionType(_theLine);\r\n                if(intersectionType === LINE_INTERSECTION_TYPE.LINESEG) {\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n\r\n        return false;\r\n    };\r\n\r\n    const computePointsVisibilityForPoint = function(_pointInfo) {\r\n        _pointInfo.visiblePoints.points.length = 0;\r\n\r\n        for (let [_eid, _pvMap] of entityIdToPointVisibility) {\r\n            for (let [_routingPoint, _visiblePoints] of _pvMap) {\r\n\r\n                const ijLine = new Line(_pointInfo.point, _routingPoint);\r\n                // Note: length check is to avoid adding point being tested to visiblePoints array\r\n                if(ijLine.getLength() > 0 && !doesLineIntersectAnyBoundaryLines(ijLine)) {\r\n                    _pointInfo.visiblePoints.points.push(_routingPoint);\r\n                }\r\n\r\n            }\r\n        }\r\n\r\n        _pointInfo.visiblePoints.isValid = true;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Point} _ptA \r\n     * @param {Point} _ptB\r\n     * @returns {Boolean} \r\n     */\r\n    const arePointsVisibleToEachOther = function(_ptA, _ptB) {\r\n        const ptAInfo = fetchPointInfoForPoint(_ptA);\r\n        const visiblePts = getVisiblePointsRelativeTo(ptAInfo);\r\n\r\n        for(let i=0; i<visiblePts.length; i++) {\r\n            if(visiblePts[i].isEqual(_ptB)) {\r\n                return true;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Object} _pointInfo\r\n     * @returns {Point[]}\r\n     */\r\n    const getVisiblePointsRelativeTo = function(_pointInfo) {\r\n        if(!_pointInfo.visiblePoints.isValid) {\r\n            computePointsVisibilityForPoint(_pointInfo);\r\n        }\r\n        \r\n        return _pointInfo.visiblePoints.points;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Point} _needle \r\n     * @param {Point[]} _haystack \r\n     */\r\n    const isPointInArray = function(_needle, _haystack) {\r\n        for(let i=0; i<_haystack.length; i++) {\r\n            if(_needle.isEqual(_haystack[i])) {\r\n                return true;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Number} _currentRouteLength \r\n     * @param {Point[]} _pointsInRoute \r\n     * @param {Object} _currentPointIndex \r\n     * @param {Point} _startPoint \r\n     * @param {Point} _endPoint \r\n     * @param {Vec2} _vecStartToEnd\r\n     * @param {Number|ConnectorRoutingAlgorithm} _routingAlgorithm\r\n     * @returns {Object|null}\r\n     */\r\n    const routeToEndpoint = function(_currentRouteLength, _pointsInRoute, _currentPointInfo, _startPoint, _endPoint, _vecStartToEnd, _routingAlgorithm) {\r\n        const currentPoint = _currentPointInfo.point;\r\n        const visiblePoints = getVisiblePointsRelativeTo(_currentPointInfo);\r\n        let curMinCost = Number.MAX_SAFE_INTEGER;\r\n        let visiblePointWithMinCost = null;\r\n\r\n        const vecToTargetIdeal = (new Vec2(_endPoint.getX() - currentPoint.getX(), _endPoint.getY() - currentPoint.getY())).normalize();\r\n\r\n        /*const dbgInterestAt = 1;\r\n        if(_pointsInRoute.length === dbgInterestAt) {\r\n            console.log('vecToTargetIdeal = ' + vecToTargetIdeal.toString());\r\n            console.log('currentPoint = ' + currentPoint.toString());\r\n        }*/\r\n\r\n        for(let i=0; i<visiblePoints.length; i++) {\r\n            const visiblePt = visiblePoints[i];\r\n\r\n            // ignore point if it's already in the route\r\n            if(isPointInArray(visiblePt, _pointsInRoute)) {\r\n                continue;\r\n            }\r\n\r\n            // g(n) = length/cost of _startPoint to _vp + _currentRouteLength\r\n            const currentToVisibleLength = (new Line(currentPoint, visiblePt)).getLength();\r\n            let gn = currentToVisibleLength + _currentRouteLength;\r\n\r\n            // h(n) = length/cost of _vp to _endPoint\r\n            let hn = (new Line(visiblePt, _endPoint)).getLength();\r\n\r\n            let tn = 0;\r\n            if(_routingAlgorithm === ConnectorRoutingAlgorithm.ASTAR_THETA_WITH_ROUTE_OPTIMIZATION) {\r\n                // t(n) = \r\n                // a. get the relationship between the 2 vectors (dot product)\r\n                // b. scale to give influence (scale by currentToVisibleLength)\r\n                //    .. using currentToVisibleLength as scaling factor is influence towards longer paths in good directions vs shorter paths in bad directions\r\n                const vecVisibleToEndpt = (new Vec2(visiblePt.getX() - currentPoint.getX(), visiblePt.getY() - currentPoint.getY())).normalize();\r\n                tn = vecToTargetIdeal.dot(vecVisibleToEndpt) * currentToVisibleLength;\r\n\r\n                if(_endPoint.getX() > currentPoint.getX() && visiblePt.getX() > _endPoint.getX()) {\r\n                    tn = 0;\r\n                }\r\n\r\n                if(_endPoint.getX() < currentPoint.getX() && visiblePt.getX() < _endPoint.getX()) {\r\n                    tn = 0;\r\n                }\r\n\r\n                if(_endPoint.getY() > currentPoint.getY() && visiblePt.getY() > _endPoint.getY()) {\r\n                    tn = 0;\r\n                }\r\n\r\n                if(_endPoint.getY() < currentPoint.getY() && visiblePt.getY() < _endPoint.getY()) {\r\n                    tn = 0;\r\n                }\r\n            }\r\n\r\n            // if we can go to the endpoint, let's do that\r\n            /*if(visiblePt.isEqual(_endPoint)) {\r\n                gn = 0;\r\n                hn = 0;\r\n            }*/\r\n\r\n            /*if(_pointsInRoute.length === dbgInterestAt) {\r\n                console.log('visiblePt = ' + visiblePt.toString());\r\n                console.log('vecVisibleToEndpt = ' + vecVisibleToEndpt.toString());\r\n                console.log(tn);\r\n            }*/        \r\n\r\n            // see if this is the new min\r\n            if((gn + hn - tn) < curMinCost) {\r\n                curMinCost = gn + hn - tn;\r\n                visiblePointWithMinCost = visiblePt;\r\n            }\r\n        }\r\n\r\n        /*if(_pointsInRoute.length === dbgInterestAt) {\r\n            console.log('winner = ' + visiblePointWithMinCost.toString());\r\n        }*/\r\n\r\n        if(curMinCost === Number.MAX_SAFE_INTEGER) {\r\n            return null;\r\n        }\r\n\r\n        return {\r\n            \"cost\": curMinCost,\r\n            \"point\": visiblePointWithMinCost\r\n        };\r\n    };\r\n\r\n    /**\r\n     * @param {Object} _ed\r\n     * @returns {LineSet}\r\n     */    \r\n    const getBoundaryLinesFromEntityDescriptor = function(_ed) {\r\n        const boundaryLines = new LineSet();\r\n\r\n        const entityBoundingRect = new Rectangle(_ed.x, _ed.y, _ed.x + _ed.width, _ed.y + _ed.height);\r\n        const lines = entityBoundingRect.getLines();\r\n        lines.forEach((_l) => {\r\n            boundaryLines.push(_l);\r\n        });\r\n\r\n        const anchors = _ed.connectorAnchors;\r\n        anchors.forEach(function(_anchor) {\r\n            const anchorBoundingRect = new Rectangle(_anchor.x, _anchor.y, _anchor.x + _anchor.width, _anchor.y + _anchor.height);\r\n            const lines = anchorBoundingRect.getLines();\r\n            lines.forEach((_l) => {\r\n                boundaryLines.push(_l);\r\n            });\r\n        });\r\n\r\n        return boundaryLines;\r\n    };    \r\n\r\n    const hasEntityMutated = function(_old, _new) {\r\n        if(_old.x !== _new.x || _old.y !== _new.y || _old.width !== _new.width || _old.height !== _new.height) {\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Point} _point \r\n     * @returns {PointInfo|null}\r\n     */\r\n    const fetchPointInfoForPoint = function(_point) {\r\n        for (let [_eid, _pvMap] of entityIdToPointVisibility) {\r\n            for (let [_routingPoint, _visiblePoints] of _pvMap) {\r\n                if(_routingPoint === _point) {\r\n                    return buildPointInfo(_routingPoint, _visiblePoints);\r\n                }\r\n            }\r\n        }\r\n\r\n        return null;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Point} _pt \r\n     * @param {VisiblePoints} _visiblePoints\r\n     * @returns {PointInfo}\r\n     */\r\n    const buildPointInfo = function(_pt, _visiblePoints) {\r\n        const result = Object.create(PointInfo);\r\n        result.point = _pt;\r\n        result.visiblePoints = _visiblePoints;\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Object[]} _entityDescriptor \r\n     * @param {Object[]} _allSiblingDescriptors \r\n     * @param {Number} _gridSize \r\n     * @param {Number} _boundingExtentRoutingPointScaleFactor \r\n     */\r\n    const buildEmptyRoutingPointToVisibleSetMap = function(_entityDescriptor, _allSiblingDescriptors, _gridSize, _boundingExtentRoutingPointScaleFactor) {\r\n        const entityBoundingRect = new Rectangle(_entityDescriptor.x, _entityDescriptor.y, _entityDescriptor.x + _entityDescriptor.width, _entityDescriptor.y + _entityDescriptor.height);\r\n        const foundPoints = AccessibleRoutingPointsFinder.find([_entityDescriptor], _allSiblingDescriptors, _gridSize);\r\n        const routingPoints = foundPoints.accessibleRoutingPoints.toArray();\r\n        const routingPointToVisibleSet = new Map();\r\n\r\n        for(let j=0; j<routingPoints.length; j++) {\r\n            routingPointToVisibleSet.set(routingPoints[j], { isValid:false, points:[] });\r\n        }\r\n\r\n        // bounding extent routing points\r\n        const scaledPoints = entityBoundingRect.getPointsScaledToGrid(_gridSize * _boundingExtentRoutingPointScaleFactor);\r\n        scaledPoints.forEach((_sp) => {\r\n            routingPointToVisibleSet.set(_sp, { isValid:false, points:[] });\r\n        }); \r\n\r\n        return routingPointToVisibleSet;\r\n    };\r\n\r\n    const invalidateSiblingPointVisibilityForMutatedEntities = function(_mutatedEntityIds, _gridSize) {\r\n        const allEntityDescriptors = [];\r\n        for (const [_eid, _descriptor] of entityIdToDescriptor) {\r\n            allEntityDescriptors.push(_descriptor);\r\n        }\r\n\r\n        for(let m=0; m<_mutatedEntityIds.length; m++) {\r\n            const descriptor = entityIdToDescriptor.get(_mutatedEntityIds[m]);\r\n            const boundingRect = new Rectangle(descriptor.x, descriptor.y, descriptor.x + descriptor.width, descriptor.y + descriptor.height);\r\n\r\n            for(let i=0; i<allEntityDescriptors.length-1; i++) {\r\n                for(let j=i+1; j<allEntityDescriptors.length; j++) {\r\n                    const spanningRect = new Rectangle(\r\n                        Math.min(allEntityDescriptors[i].outerBoundingRect.minX, allEntityDescriptors[j].outerBoundingRect.minX),\r\n                        Math.min(allEntityDescriptors[i].outerBoundingRect.minY, allEntityDescriptors[j].outerBoundingRect.minY),\r\n                        Math.max(allEntityDescriptors[i].outerBoundingRect.maxX, allEntityDescriptors[j].outerBoundingRect.maxX),\r\n                        Math.max(allEntityDescriptors[i].outerBoundingRect.maxY, allEntityDescriptors[j].outerBoundingRect.maxY),\r\n                    );\r\n\r\n                    if(boundingRect.checkIntersect(spanningRect)) {\r\n                        entityIdToPointVisibility.set(allEntityDescriptors[i].id, buildEmptyRoutingPointToVisibleSetMap(allEntityDescriptors[i], allEntityDescriptors, _gridSize));\r\n                        entityIdToPointVisibility.set(allEntityDescriptors[j].id, buildEmptyRoutingPointToVisibleSetMap(allEntityDescriptors[j], allEntityDescriptors, _gridSize));\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Number|ConnectorRoutingAlgorithm} _routingAlgorithm\r\n     * @returns {Boolean}\r\n     */\r\n    const doesRoutingAlgorithmRequireOptimization = function(_routingAlgorithm) {\r\n        if(_routingAlgorithm === ConnectorRoutingAlgorithm.ASTAR_WITH_ROUTE_OPTIMIZATION || _routingAlgorithm === ConnectorRoutingAlgorithm.ASTAR_THETA_WITH_ROUTE_OPTIMIZATION) {\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Object[]} _entityDescriptors \r\n     * @param {Number} _gridSize \r\n     * @param {Number} _boundingExtentRoutingPointScaleFactor \r\n     */\r\n    this.updateRoutingPointsAndBoundaryLinesFromEntityDescriptors = function(_entityDescriptors, _gridSize, _boundingExtentRoutingPointScaleFactor) {\r\n        if(typeof _boundingExtentRoutingPointScaleFactor === 'undefined') {\r\n            _boundingExtentRoutingPointScaleFactor = 1.0;\r\n        }\r\n\r\n        currentNumRoutingPoints = 0;\r\n        currentNumOfBoundaryLines = 0;\r\n\r\n        const aliveEntityIds = [];\r\n        const mutatedEntityIds = []; // a mutation is considered any addition, removal, or change\r\n        const deletedEntityIds = [];\r\n\r\n        // update boundary lines\r\n        for(let i=0; i<_entityDescriptors.length; i++) {\r\n            const entityId = _entityDescriptors[i].id;\r\n            aliveEntityIds.push(entityId);\r\n\r\n            const existingEntry = entityIdToBoundaryLineSet.get(entityId);\r\n            const existingDescriptor = entityIdToDescriptor.get(entityId);\r\n            if(existingEntry && !hasEntityMutated(existingDescriptor, _entityDescriptors[i])) {\r\n                currentNumOfBoundaryLines += existingEntry.count();\r\n                continue;\r\n            }\r\n\r\n            const boundaryLinesForEntity = getBoundaryLinesFromEntityDescriptor(_entityDescriptors[i]);\r\n            entityIdToBoundaryLineSet.set(entityId, boundaryLinesForEntity);\r\n\r\n            currentNumOfBoundaryLines += boundaryLinesForEntity.count();\r\n        }\r\n\r\n        // update routing points\r\n        for(let i=0; i<_entityDescriptors.length; i++) {\r\n            const entityId = _entityDescriptors[i].id;\r\n            const existingDescriptor = entityIdToDescriptor.get(entityId);\r\n            if(existingDescriptor && !hasEntityMutated(existingDescriptor, _entityDescriptors[i])) {\r\n                // This entity hasn't changed, but other mutated entities may have changed what's visible from this entity\r\n                //continue;\r\n            }\r\n\r\n            // Entity has been mutated, all routing points for the entity are invalid\r\n            // .. also the inverse relationship (sibling routing points that point to this entity) are also invalid\r\n            const routingPointToVisibleSet = buildEmptyRoutingPointToVisibleSetMap(_entityDescriptors[i], _entityDescriptors, _gridSize, _boundingExtentRoutingPointScaleFactor);\r\n            entityIdToPointVisibility.set(entityId, routingPointToVisibleSet);\r\n\r\n            entityIdToDescriptor.set(entityId, _entityDescriptors[i]); // take advantage of this loop to also, finally, update descriptors as we're done with mutation checks\r\n\r\n            mutatedEntityIds.push(entityId);\r\n            currentNumRoutingPoints += routingPointToVisibleSet.size;\r\n        }\r\n\r\n        // deal with dead entities\r\n        for (let [_eid, _descriptor] of entityIdToDescriptor) {\r\n            if(aliveEntityIds.includes(_eid)) {\r\n                continue;\r\n            }\r\n\r\n            // something has been remove, what gets invalidated?\r\n            // .. if visibility computations are alway nulled/reset, nothing else necessary\r\n            // .. else, need to figure out which computations are to be invalidated (overlapping rects tell if relationship between 2 entities is affected)\r\n            // .... this applies to additions and mutations as well\r\n\r\n            mutatedEntityIds.push(_eid);\r\n            deletedEntityIds.push(_eid);\r\n        }\r\n\r\n        // for future optimization..\r\n        //invalidateSiblingPointVisibilityForMutatedEntities(mutatedEntityIds, _gridSize);\r\n\r\n        deletedEntityIds.forEach((_eid) => {\r\n            entityIdToDescriptor.delete(_eid);\r\n            entityIdToBoundaryLineSet.delete(_eid);\r\n            entityIdToPointVisibility.delete(_eid);\r\n        });\r\n\r\n        return mutatedEntityIds.length;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getCurrentNumRoutingPoints = function() {\r\n        return currentNumRoutingPoints;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */    \r\n    this.getCurrentNumBoundaryLines = function() {\r\n        return currentNumOfBoundaryLines;\r\n    };\r\n\r\n    /**\r\n     * @param {Point} _point\r\n     * @returns {Point|null}\r\n     */\r\n    this.findVisiblePointInfoClosestTo = function(_point) {\r\n        var result = null;\r\n        var currentMaxLength = Number.MAX_SAFE_INTEGER;\r\n\r\n        for (let [_eid, _pvMap] of entityIdToPointVisibility) {\r\n            for (let [_routingPoint, _visiblePoints] of _pvMap) {\r\n                const lineOfSight = new Line(_point, _routingPoint);\r\n                const lineOfSightLength = lineOfSight.getLength();\r\n    \r\n                if(lineOfSightLength < currentMaxLength && !doesLineIntersectAnyBoundaryLines(lineOfSight)) {\r\n                    result = buildPointInfo(_routingPoint, _visiblePoints);\r\n                    currentMaxLength = lineOfSightLength;\r\n                };\r\n            }\r\n        }\r\n\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * @param {Point} _startPoint\r\n     * @param {Point} _endPoint\r\n     * @param {Number|ConnectorRoutingAlgorithm} _routingAlgorithm\r\n     * \r\n     * @return {PointSet}\r\n     */\r\n    this.computeRoute = function(_startPoint, _endPoint, _routingAlgorithm) {\r\n        // if no valid startpoint or endpoint, we can't route\r\n        if(_startPoint === null || _endPoint === null) {\r\n            return new PointSet();\r\n        }\r\n\r\n        // find closest visible point \r\n        const firstPointInfo = self.findVisiblePointInfoClosestTo(_startPoint);\r\n        if(firstPointInfo === null) {\r\n            return new PointSet();\r\n        }\r\n\r\n        const vecStartToEnd = (new Vec2(_endPoint.getX() - _startPoint.getX(), _endPoint.getY() - _startPoint.getY())).normalize();\r\n\r\n        const pointsInRoute = [firstPointInfo.point];\r\n        let currentRouteLen = 0;\r\n        let currentPointInfo = firstPointInfo;\r\n        while(true) {\r\n            const routeSegment = routeToEndpoint(currentRouteLen, pointsInRoute, currentPointInfo, _startPoint, _endPoint, vecStartToEnd, _routingAlgorithm);\r\n            if(routeSegment === null) {\r\n                // Is there unobstructed line to endpoint? \r\n                // If not, failed to find route\r\n                const lastSegmentToEndpoint = new Line(pointsInRoute[pointsInRoute.length-1], _endPoint);\r\n                if(doesLineIntersectAnyBoundaryLines(lastSegmentToEndpoint)) {\r\n                    return new PointSet();\r\n                }\r\n\r\n                break;\r\n            }\r\n\r\n            // update cur path length\r\n            currentRouteLen += (new Line(currentPointInfo.point, routeSegment.point)).getLength();\r\n\r\n            // add new point to path\r\n            pointsInRoute.push(routeSegment.point);\r\n\r\n            // update current point index\r\n            currentPointInfo = fetchPointInfoForPoint(routeSegment.point);\r\n\r\n            // check if we're done\r\n            if((new Line(currentPointInfo.point, _endPoint).getLength()) < 1.0) {\r\n                break;\r\n            }\r\n        }\r\n\r\n        if(doesRoutingAlgorithmRequireOptimization(_routingAlgorithm)) {\r\n            PointVisibilityMapRouteOptimizer.optimize(pointsInRoute, arePointsVisibleToEachOther);\r\n        }\r\n\r\n        return new PointSet(pointsInRoute);\r\n    };\r\n};\r\n   \r\nexport { PointVisibilityMap };\r\n"],"names":["MatrixMath","mat4Multiply","_a","_b","result","i","sum","j","k","vecMat4Multiply","_v","_m","vi","Point","_x","_y","__x","__y","prototype","getX","getY","isEqual","_otherPoint","getCartesianPoint","_sheetWidth","_sheetHeight","toString","toArray","fromArray","_arr","LINE_INTERSECTION_TYPE","Object","freeze","PARALLEL","COINCIDENT","LINE","LINESEG","LineIntersection","_type","_intersectionPoint","__type","__intersectionPoint","getType","getIntersectionPoint","Line","_startPoint","_endPoint","__startPoint","__endPoint","getStartPoint","getEndPoint","_otherLine","getLength","Math","sqrt","pow","getMinX","min","getMaxX","max","getMinY","getMaxY","getDirection","dx","dy","len","createShortenedLine","startReduceByPx","endReduceByPx","dir","computeIntersectionType","thisLineStartPointX","thisLineStartPointY","thisLineEndPointX","thisLineEndPointY","otherLineStartPointX","otherLineStartPointY","otherLineEndPointX","otherLineEndPointY","paramDenom","paramANumer","paramBNumer","paramA","paramB","computeIntersection","xIntersect","yIntersect","SvgPathBuilder","pointToLineTo","_pt","_ptIndex","pointTripletToTesselatedCurvePoints","_points","_curvaturePx","length","Error","controlPoint","lineA","lineB","lineAShortened","lineBShortened","pointsToPath","svgPathParts","ptIdx","ptA","shift","ptB","ptC","newPts","unshift","push","pt","p","join","Dimensions","_width","_height","getWidth","getHeight","Rectangle","_left","_top","_right","_bottom","__left","__top","__right","__bottom","getLeft","getTop","getRight","getBottom","getPoints","getLines","getUniformlyResizedCopy","_resizeByPx","getPointsScaledToGrid","_gridSize","centroid","scaleDx","scaleDy","scaledPoints","checkIntersect","_otherRectangle","checkIsPointWithin","_point","checkIsWithin","GroupTransformationContainerEvent","TRANSLATE_START","TRANSLATE","EntityEvent","RESIZE_START","RESIZE","PointSet","_pointsInput","self","points","_newPoint","pushPointSet","_ps","possibleNewPoints","findPointClosestTo","resultPoint","currentMinLength","Number","MAX_SAFE_INTEGER","forEach","lineToPt","findDistanceToPointClosestTo","findPointsCloseTo","_radius","resultSet","toFloat64Array","Float64Array","fromFloat64Array","_float64Array","count","Array","isArray","call","AccessibleRoutingPointsFinder","find","_subjectEntityDescriptors","_occluderEntityDescriptors","connectorAnchorToNumValidRoutingPoints","Map","allRoutingPoints","filteredRoutingPoints","_entityDescriptor","anchors","connectorAnchors","routingPoints","routingPointsFloat64Arr","_rp","id","set","isPointWithinObj","occluder","boundingRect","x","y","width","height","routingPoint","currentNumRoutingPoints","get","parentAnchorId","ConnectorAnchor","_id","_domElement","_sheet","_routingPointOffsetX","_routingPointOffsetY","routingPointDirections","getGridSize","getDimensions","r","transformDomRectToPageSpaceRect","getBoundingClientRect","routingPointDirectionToPoint","_direction","_centroid","_halfWidth","_halfHeight","setPossibleRoutingPointDirections","_directions","getId","getCentroid","sheetOffset","getSheetOffset","pageSpaceRect","halfWidth","halfHeight","getRoutingPoints","dimensions","_dir","getBoundingRectange","ClosestPairFinder","findClosestPairBetweenObjects","_objA","_objB","_connectorAnchorToNumValidRoutingPoints","objAConnectorAnchors","getConnectorAnchors","objBConnectorAnchors","startAnchorIdxWithMinDist","endAnchorIdxWithMinDist","minDist","MAX_VALUE","aCentroid","objANumValidRoutingPoints","bCentroid","d","objBNumValidRoutingPoints","BestToConnectEntitiesFinder","findBestTimeout","searchInputs","currentSheetEntities","currentGridSize","findBufferTime","metrics","batchSize","searchFuncExecutionTime","getSearchFuncExecutionTime","getSearchFuncBatchSize","alreadyInSearchInputs","_cb","entityA","entityB","cb","clearSearchInputs","search","exTimeT1","Date","inputBatchSize","gridSize","entityDescriptors","_e","getDescriptor","entityDescriptorsArr","values","accessibleRoutingPointsResult","ConnectorAnchorClosestPairFinder","findBest","_entityA","_entityB","_onFound","_sheetEntities","clearTimeout","searchFunc","setTimeout","SheetEvent","DBLCLICK","CLICK","CLUSTER_CREATED","CLUSTER_DELETED","CLUSTER_UPDATED","CONNECTOR_UPDATED","ENTITY_ADDED","ENTITY_REMOVED","ENTITY_RESIZED","ENTITY_TRANSLATED","ENTITY_OVERLAP_DETECTED","MULTIPLE_ENTITY_SELECTION_STARTED","MULTIPLE_ENTITIES_SELECTED","DebugMetricsPanel","_window","debugPanelElem","isVisible","objectHtmlDumpDepthFirst","_obj","_output","_parentName","keys","_k","prefix","metricName","init","document","createElement","classList","add","style","display","position","right","top","color","padding","backgroundColor","zIndex","body","appendChild","show","hide","refresh","_metrics","htmlStringsArr","innerHTML","DoubleTapDetector","_dblTapSpeed","_dblTapRadius","dblTapDetectVars","lastTouchX","lastTouchY","lastTouchTime","dblTapSpeed","dblTapRadius","processTap","_touchEndEvent","_sheetPageOffset","_currentInvTransformationMatrix","changedTouches","invTransformedPos","pageX","pageY","dblTapDetected","now","getTime","timeSinceLastTouch","lastX","lastY","distFromLastTouch","ConnectorEvent","MOUSE_ENTER","MOUSE_LEAVE","ConnectorRoutingAlgorithm","STRAIGHT_LINE","STRAIGHT_LINE_BETWEEN_ANCHORS","STRAIGHT_LINE_BETWEEN_ANCHORS_AVOID_SELF_INTERSECTION","ASTAR","ASTAR_WITH_ROUTE_OPTIMIZATION","ASTAR_THETA_WITH_ROUTE_OPTIMIZATION","Connector","_anchorStart","_anchorEnd","_containerDomElement","_routingAlgorithm","eventNameToHandlerFunc","markerStartSize","markerEndSize","defaultStrokeColor","defaultStrokeWidth","pathPoints","pathElem","window","createElementNS","setAttribute","stroke","strokeWidth","interactionElem","addEventListener","e","dispatchEvent","appendPathToContainerDomElement","setMarkerStart","_url","_size","unsetMarkerStart","removeAttribute","setMarkerEnd","unsetMarkerEnd","getPathPoints","getPathLines","lines","totalLength","pathLines","getMidpoint","lengthSoFar","curPathLineWithMidpoint","pathLineLength","lengthBeforeCur","midOnCurPath","getMidpointDirection","_svgPath","updatePathPoints","_pathPoints","anchorIds","sort","getAnchorStart","getAnchorEnd","removePathElement","remove","removeDefaultStyles","setInlineStyleOnPathElement","setInlineStyleOnInteractionElement","_key","_value","addStyleClassesToPathElement","_cssClassesToAdd","_cls","removeStyleClassesFromPathElement","_cssClassesToRemove","addStyleClassesToInteractionElement","removeStyleClassesFromInteractionElement","on","_eventName","_handlerFunc","allHandlers","off","_callback","allCallbacks","splice","_eventId","_eventData","observers","handler","GRID_STYLE","DOT","Grid","_color","_style","getSize","getStyle","getSvgImageTile","ClusterDetectionWorkerJsString","ConnectorRoutingWorkerJsString","DescriptorCollection","_collectionId","descriptors","getDescriptorIndex","_descriptor","getDescriptorIndexById","_descriptorId","addDescriptor","getDescriptors","getIds","ids","_d","removeById","idx","removeAll","Cluster","_clusterId","entityDescriptorCollection","getEntityIndex","_entity","getEntityIndexById","_entityId","addEntity","getEntities","getEntityIds","removeEntityById","removeAllEntities","hasEntities","_entityIds","isEquivalent","toJSON","fromJSON","_clusterJSON","entities","Originator","PROGRAM","USER","Sheet","_sheetDomElement","svgElem","connectorsContainerDomElement","selectionBoxElem","groupTransformationContainers","currentGroupTransformationContainerBeingDragged","grid","transitionCss","transformOriginX","transformOriginY","touchMoveLastX","touchMoveLastY","translateX","translateY","scaleFactor","invScaleFactor","boundingExtentRoutingPointScaleFactor","invTransformationMatrixStack","currentInvTransformationMatrix","currentTransformationMatrix","connectorRefreshBufferTime","sheetEntities","objectConnectors","objectIdBeingDragged","objectIdBeingResized","objectResizeCursor","objectDragX","objectDragY","objectDragStartX","objectDragStartY","doubleTapDetector","debugMetricsPanel","connectorRoutingWorker","executionTime","numRoutingPoints","numBoundaryLines","msgDecodeTime","pointVisibilityMapCreationTime","allPathsComputationTime","clusterDetectionWorker","computeClustersTime","refreshAllConnectorsInternal","findBestConnectorAnchorsToConnectEntities","connectorsRefreshTime","touchHoldDelayTimeMs","touchHoldStartInterval","multiObjectSelectionStartX","multiObjectSelectionStartY","multiObjectSelectionEndX","multiObjectSelectionEndY","multiObjectSelectionStarted","connectorAnchorsSelected","isDomMetricsLockActive","sheetOffsetLeft","sheetOffsetTop","sheetPageScrollXOffset","sheetPageScrollYOffset","eventHandlers","connectorRefreshStartTime","connectorRefreshTimeout","pendingConnectorRedraw","bestConnectorAnchorsForEntityConnectionsFinder","knownClustersOverwrite","clusterDetectionWorkerUrl","URL","createObjectURL","Blob","initClusterDetectionWorker","Worker","onmessage","_msg","data","newClusterIds","_cId","emitEvent","clusters","updatedClusterIds","eventObj","updatedClusterToAddedEntitites","updatedClusterToRemovedEntitites","deletedClusterIds","overlappingEntities","entityId","overlappingEntityIds","overwriteClusterDetectorKnownClusters","_clusters","_c","updateClusterDetectorKnownCluster","_cluster","foundMatch","deleteClusterDetectorKnownCluster","connectorRoutingWorkerUrl","initConnectorRoutingWorker","connectorsRefreshTimeT1","connectorDescriptors","refreshCalls","getConnectorDescriptorById","renderInternal","_rc","descriptor","ps","pointsInPath","svgPath","cancelAnimationFrame","requestAnimationFrame","overallTime","setGrid","_grid","backgroundImage","btoa","backgroundRepeat","getGrid","setBoundingExtentRoutingPointScaleFactor","_scaleFactor","lockDomMetrics","offsetLeft","offsetTop","pageXOffset","pageYOffset","unlockDomMetrics","hasDomMetricsLock","refreshAllClustersInternal","postData","postMessage","executionTimeT1","setConnectorRefreshBufferTime","_bufferTimeMs","refreshAllConnectors","tdelta","makeNewConnector","setConnectorFactory","_newConnectorFactory","getTransitionCss","setTransitionCss","_css","transition","getTransformOriginX","getTransformOriginY","getScaleFactor","getTranslateX","getTranslateY","setTransformOrigin","transformOrigin","scale","_adjustFactorToPreserveIntegerGrid","newGridSize","roundedGridSize","round","scaleMat","translate","translateMatrix","applyTransform","transform","getTransformMatrixCss","getTransformMatrix","matElems","_domRect","pageOffset","getPageOffset","left","bottom","invTransformedPosLeftTop","invTransformedPosRightBottom","resetTransform","snapToGrid","_p","ret","getOffsetLeft","getOffsetTop","offsetWidth","offsetHeight","resize","_newWidth","_newHeight","calcBoundingRectForEntities","_entities","minTop","minLeft","maxBottom","maxRight","index","array","objRect","calcBoundingBox","getEntitiesAroundPoint","ptRect","getEntitiesWithinRect","_rect","getAllEntities","publishSiblingObjectChange","handleSiblingObjectChange","getEntityById","foundEntity","obj","handleResizeStart","originator","handleMoveStart","withinGroupTransformation","removeEntity","getConnector","c","getAllConnectors","getConnectorsBetweenEntities","foundConnectors","_conn","aS","aE","hasConnectorAnchor","getConnectorsBetweenAnchors","_anchorA","_anchorB","getConnectorsInEntitySet","_entitySet","connectorsBetween","getEntitiesConnectedViaConnector","_connectorId","foundEntities","allEntities","_o","getConnectorsConnectedToEntity","getEntityWithConnectorAnchor","_connectorAnchorId","removeAllConnectors","removeConnector","_connector","makeNewConnectorFromAnchors","newConnector","foundConnector","addConnectionAnchorToSelectionStack","_anchor","dblClickTapHandler","_posX","_posY","entitiesAroundPoint","eventData","initDebugMetricsPanel","initInteractionHandlers","sheetEntityClicked","target","detectResult","doubleTapDetected","touchX","touchY","setCurrentGroupTransformationContainerBeingDragged","container","attachGroupTransformationContainer","_groupTransformationContainer","getContainerDomElement","detachGroupTransformationContainer","removeChild","handleGroupTransformationContainerMove","_dx","_dy","gtc","translateByOffset","handleMove","entity","translateOffset","getTranslateHandleOffset","mx","my","handleMoveEnd","resizeCursor","cursor","handleResize","newWidth","newHeight","handleResizeEnd","handleMultiEntitySelectionStart","_targetElem","handleMultiEntitySelectionEnd","selectionRect","selectedEntities","updateSelectionBoxEndPoint","_endX","_endY","abs","initMultiEntitySelectionHandler","_selectionRectStyleCssClasses","selBox","border","background","_class","handleTouchSelectionStart","hasSelectionStarted","touches","which","preventDefault","setInterval","clearInterval","initTransformationHandlers","movementX","movementY","endTranslate","stopPropagation","cbFunc","Entity","_translateHandleDomElements","_resizeHandleDomElements","MOUSE_MIDDLE_BUTTON","nextConnectorAnchorIdSuffix","currentTranslateHandleElementActivated","hasPendingFrame","overwrittenRenderStyles","addNonInteractableConnectorAnchor","_connectorAnchorDomElement","newAnchor","addInteractableConnectorAnchor","anchor","getConnectorAnchorRoutingPoints","anchorPoints","getPositionOnPage","ownerDocument","defaultView","scrollX","scrollY","renderImmediate","render","overwriteRenderStyle","_withinGroupTransformation","_originator","getDomElement","getBoundingRectangeInPageSpace","pagePos","computePageToEntitySpaceTransformedRectangle","_rectInPageSpace","noteBoundingRect","rectRelativeToNote","GraphPaper","getBoundingPoints","topLeft","topRight","bottomLeft","bottomRight","outerBoundMinX","outerBoundMinY","outerBoundMaxX","outerBoundMaxY","suspendTranslateInteractions","unbindTranslateHandleElements","resumeTranslateInteractions","bindTranslateHandleElements","translateTouchStartHandler","translateMouseDownHandler","_el","removeEventListener","resizeMouseDownHandler","_triggeredByElement","_resizeCursor","resizeTouchStartHandler","bindResizeHandleElements","getComputedStyle","GroupTransformationContainer","_containerStyleCssClasses","_sizeAdjustmentPx","calculateBoundingRect","accTranslateX","accTranslateY","currentLeft","currentTop","entityPositionRelativeToBoundingRect","rp","getBoundingRect","newLeft","newTop","initTranslateInteractionHandler","BoxClusterDetector","_boxExtentOffset","getEntityIndexFromArray","_sheetEntityDescriptorsArray","removeEntitiesFromArray","getClusterWithMostEntitiesFromClusterMap","_clusterToEntityCountMap","curMaxObjs","curClusterWithMax","_numObjs","_map","computeDiffBetweenArrays","_arrA","_arrB","onlyInA","onlyInB","_postItem","indexOf","_preItem","areEntitiesClose","nA","nB","getAllEntitiesCloseTo","_entitiesUnderConsideration","getClusterEntitiesFromSeed","_seedEntity","_resultSet","closeByEntities","concat","findIntersectingClustersForEntities","_entityDescriptors","intersectingClusterToNumEntitiesIntersecting","clusterEntities","has","removeEntityFromClusters","mutatedClusterIds","wasFoundAndRemoved","mapToClustersWithOldEntitiesRemoved","_currentEntityIds","map","clusterEntityIds","computeClusters","_knownClusters","_getNewIdFunc","Set","entitiesUnderConsideration","entitiesUnderConsiderationIds","entityDescriptor","pop","entitiesForCluster","size","clusterId","newCluster","_clusterEntity","clusterToModify","preEntityIds","clustersMutated","postUpdateEntityIds","diffResult","existingEntry","emptyAndSingletonClusters","filter","delete","nonEmptyNonSingletonClusters","PointVisibilityMapRouteOptimizer","optimize","_pointsInRoute","_arePointsVisibleToEachOther","start","end","LineSet","_linesInput","_newLine","Vec2","create","normalize","dot","VisiblePoints","PointInfo","point","visiblePoints","PointVisibilityMap","entityIdToPointVisibility","entityIdToBoundaryLineSet","entityIdToDescriptor","currentNumOfBoundaryLines","doesLineIntersectAnyBoundaryLines","_theLine","_eid","_boundaryLineSet","outerBoundingRect","maxX","minX","maxY","minY","intersectionType","boundaryLinesArr","computePointsVisibilityForPoint","_pointInfo","_pvMap","_routingPoint","_visiblePoints","ijLine","isValid","arePointsVisibleToEachOther","_ptA","_ptB","ptAInfo","fetchPointInfoForPoint","visiblePts","getVisiblePointsRelativeTo","isPointInArray","_needle","_haystack","routeToEndpoint","_currentRouteLength","_currentPointInfo","_vecStartToEnd","visiblePt","currentPoint","curMinCost","visiblePointWithMinCost","vecToTargetIdeal","currentToVisibleLength","gn","hn","tn","vecVisibleToEndpt","getBoundaryLinesFromEntityDescriptor","_ed","boundaryLines","entityBoundingRect","_l","anchorBoundingRect","hasEntityMutated","_old","_new","buildPointInfo","buildEmptyRoutingPointToVisibleSetMap","_allSiblingDescriptors","_boundingExtentRoutingPointScaleFactor","foundPoints","accessibleRoutingPoints","routingPointToVisibleSet","_sp","doesRoutingAlgorithmRequireOptimization","updateRoutingPointsAndBoundaryLinesFromEntityDescriptors","aliveEntityIds","mutatedEntityIds","deletedEntityIds","existingDescriptor","boundaryLinesForEntity","includes","getCurrentNumRoutingPoints","getCurrentNumBoundaryLines","findVisiblePointInfoClosestTo","currentMaxLength","lineOfSight","lineOfSightLength","computeRoute","firstPointInfo","routeSegment","vecStartToEnd","pointsInRoute","currentRouteLen","currentPointInfo","lastSegmentToEndpoint"],"mappings":"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"}