{"version":3,"file":"graphpaper.min.js","sources":["../src/MatrixMath.js","../src/Point.js","../src/LineIntersection.js","../src/Line.js","../src/SvgPathBuilder.js","../src/Dimensions.js","../src/Rectangle.js","../src/GroupTransformationContainerEvent.js","../src/CanvasEvent.js","../src/ConnectorAnchor.js","../src/ConnectorAnchorFinder/ClosestPairFinder.js","../src/PointSet.js","../src/LineSet.js","../src/ConnectorEvent.js","../src/Connector.js","../src/PointVisibilityMap.js","../src/Grid.js","../src/Workers/ConnectorRoutingWorker.string.js","../src/Canvas.js","../src/CanvasObject.js","../src/GroupTransformationContainer.js","../src/Cluster.js","../src/BoxClusterDetector.js"],"sourcesContent":["const MatrixMath = {\r\n\r\n    mat4Multiply: function(_a, _b) {\r\n\r\n        const result = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\r\n        for(let i=0; i<4; i++) {\r\n            for(let j=0; j<4; j++) {\r\n\r\n                var sum = 0;\r\n                for(let k=0; k<4; k++) {\r\n                    sum += _a[k + 4*i] * _b[j + 4*k];\r\n                }\r\n\r\n                result[j + 4*i] = sum;\r\n            }\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    vecMat4Multiply: function(_v, _m) {\r\n        const result = [0, 0, 0, 0];\r\n        for(let vi=0; vi<4; vi++) {\r\n            result[vi] = \r\n                (_v[0] * _m[(vi*4) + 0]) + \r\n                (_v[1] * _m[(vi*4) + 1]) + \r\n                (_v[2] * _m[(vi*4) + 2]) + \r\n                (_v[3] * _m[(vi*4) + 3]);\r\n        }\r\n\r\n        return result;\r\n    }\r\n};\r\n\r\nexport { MatrixMath };\r\n","/**\r\n * \r\n * @param {Number} _x\r\n * @param {Number} _y\r\n */\r\nfunction Point(_x, _y) {\r\n    this.__x = _x;\r\n    this.__y = _y;\r\n};\r\n\r\n/**\r\n * @returns {Number}\r\n */     \r\nPoint.prototype.getX = function() {\r\n    return this.__x;\r\n};\r\n\r\n/**\r\n * @returns {Number}\r\n */     \r\nPoint.prototype.getY = function() {\r\n    return this.__y;\r\n};\r\n\r\n/**\r\n * @param {Point} _otherPoint\r\n * @returns {Boolean}\r\n */\r\nPoint.prototype.isEqual = function(_otherPoint) {\r\n    if(this.__x === _otherPoint.getX() && this.__y === _otherPoint.getY()) {\r\n        return true;\r\n    }\r\n\r\n    return false;\r\n};\r\n\r\n/**\r\n * @returns {Point}\r\n */\r\nPoint.prototype.getCartesianPoint = function(_canvasWidth, _canvasHeight) {\r\n    return new Point(\r\n        this.__x - (_canvasWidth * 0.5),\r\n        -this.__y + (_canvasHeight * 0.5)\r\n    );\r\n};\r\n\r\n/**\r\n * @returns {String}\r\n */\r\nPoint.prototype.toString = function() {\r\n    return this.__x + \" \" + this.__y;\r\n};\r\n\r\n/**\r\n * @returns {Number[]}\r\n */\r\nPoint.prototype.toArray = function() {\r\n    return [this.__x, this.__y];\r\n};\r\n\r\n/**\r\n * @param {Number[]} _arr\r\n * @returns {Point}\r\n */\r\nPoint.fromArray = function(_arr) {\r\n    return new Point(_arr[0], _arr[1]);\r\n};\r\n\r\nexport { Point };\r\n","import  {Point} from './Point';\r\n\r\nconst LINE_INTERSECTION_TYPE = Object.freeze({\r\n\tPARALLEL: \"parallel\",\t\t// no intersection, lines are parallel\r\n    COINCIDENT: \"coincident\",\t// no intersection, lines are coincident\r\n\tLINE: \"line\",\t\t\t\t// the lines intersect, but the intersection point is beyond the bounds of the line segments\r\n\tLINESEG: \"lineseg\",\t\t\t// the lines intersect, and the intersection point is within the bounds of the line segments\r\n});\r\n\r\n/**\r\n * \r\n * @param {LINE_INTERSECTION_TYPE} _type \r\n * @param {Point} _intersectionPoint \r\n */\r\nfunction LineIntersection(_type, _intersectionPoint) {\r\n\r\n    /**\r\n     * @returns {LINE_INTERSECTION_TYPE}\r\n     */\r\n    this.getType = function() {\r\n        return _type;\r\n    };\r\n\r\n    /**\r\n     * @returns {Point|null}\r\n     */\r\n    this.getIntersectionPoint = function() {\r\n        return _intersectionPoint;\r\n    };\r\n};\r\n\r\nexport {LINE_INTERSECTION_TYPE, LineIntersection};\r\n","import  {Point} from './Point';\r\nimport  {LINE_INTERSECTION_TYPE, LineIntersection} from './LineIntersection';\r\n\r\n/**\r\n * \r\n * @param {Point} _startPoint\r\n * @param {Point} _endPoint\r\n */\r\nfunction Line(_startPoint, _endPoint) {   \r\n\r\n    if(typeof _startPoint === 'undefined' || _startPoint === null) {\r\n        throw \"Line missing _startPoint\";\r\n    }\r\n\r\n    if(typeof _endPoint === 'undefined' || _endPoint === null) {\r\n        throw \"Line missing _endPoint\";\r\n    }\r\n\r\n    this.__startPoint = _startPoint;\r\n    this.__endPoint = _endPoint;\r\n};\r\n\r\n\r\n/**\r\n * @returns {Point}\r\n */       \r\nLine.prototype.getStartPoint = function() {\r\n    return this.__startPoint;\r\n};\r\n\r\n/**\r\n * @returns {Point}\r\n */       \r\nLine.prototype.getEndPoint = function() {\r\n    return this.__endPoint;\r\n};\r\n\r\n/**\r\n * @param {Line} _otherLine\r\n * @returns {Boolean}\r\n */\r\nLine.prototype.isEqual = function(_otherLine) {\r\n    if(this.getStartPoint().isEqual(_otherLine.getStartPoint()) && this.getEndPoint().isEqual(_otherLine.getEndPoint())) {\r\n        return true;\r\n    }\r\n\r\n    return false;\r\n};\r\n\r\n/**\r\n * @returns {Number}\r\n */\r\nLine.prototype.getLength = function() {\r\n    return Math.sqrt(\r\n        Math.pow(this.__endPoint.getX() - this.__startPoint.getX(), 2) + Math.pow(this.__endPoint.getY() - this.__startPoint.getY(), 2)\r\n    );\r\n};\r\n\r\n/**\r\n * Calculate unit length direction vector\r\n * \r\n * @returns {Point}\r\n */\r\nLine.prototype.getDirection = function() {\r\n    const dx = this.__endPoint.getX() - this.__startPoint.getX();\r\n    const dy = this.__endPoint.getY() - this.__startPoint.getY();\r\n\r\n    const len = Math.sqrt(dx*dx + dy*dy);\r\n\r\n    return new Point(       \r\n        dx / len,\r\n        dy / len\r\n    );    \r\n};\r\n\r\n/**\r\n * Create a Line shorted at the start and end by the specified amounts\r\n * \r\n * @returns {Line}\r\n */\r\nLine.prototype.createShortenedLine = function(startReduceByPx, endReduceByPx) {\r\n    const dx = this.__endPoint.getX() - this.__startPoint.getX();\r\n    const dy = this.__endPoint.getY() - this.__startPoint.getY();    \r\n    const dir = this.getDirection();\r\n\r\n    return new Line(\r\n        new Point(\r\n            this.__startPoint.getX() + (startReduceByPx * dir.getX()), \r\n            this.__startPoint.getY() + (startReduceByPx * dir.getY())\r\n        ),\r\n        new Point(\r\n            (this.__startPoint.getX() + dx) - (endReduceByPx * dir.getX()), \r\n            (this.__startPoint.getY() + dy) - (endReduceByPx * dir.getY())\r\n        )\r\n    );\r\n};\r\n\r\n/**\r\n * @param {Line} _otherLine\r\n * @returns {LINE_INTERSECTION_TYPE}\r\n */\r\nLine.prototype.computeIntersectionType = function(_otherLine) {\r\n    const thisLineStartPointX = this.__startPoint.getX();\r\n    const thisLineStartPointY = this.__startPoint.getY();\r\n    const thisLineEndPointX = this.__endPoint.getX();\r\n    const thisLineEndPointY = this.__endPoint.getY();        \r\n    const otherLineStartPointX = _otherLine.getStartPoint().getX();\r\n    const otherLineStartPointY = _otherLine.getStartPoint().getY();\r\n    const otherLineEndPointX = _otherLine.getEndPoint().getX();\r\n    const otherLineEndPointY = _otherLine.getEndPoint().getY();\r\n\r\n    const paramDenom = (otherLineEndPointY-otherLineStartPointY)*(thisLineEndPointX-thisLineStartPointX) - (otherLineEndPointX-otherLineStartPointX)*(thisLineEndPointY-thisLineStartPointY);\r\n    const paramANumer = (otherLineEndPointX-otherLineStartPointX)*(thisLineStartPointY-otherLineStartPointY) - (otherLineEndPointY - otherLineStartPointY)*(thisLineStartPointX-otherLineStartPointX);\r\n    const paramBNumer = (thisLineEndPointX-thisLineStartPointX)*(thisLineStartPointY-otherLineStartPointY) - (thisLineEndPointY-thisLineStartPointY)*(thisLineStartPointX-otherLineStartPointX);\r\n\r\n    if(paramDenom == 0) {\r\n        if(paramDenom == 0 && paramANumer == 0 && paramBNumer==0)\r\n            return LINE_INTERSECTION_TYPE.COINCIDENT;\r\n        else\r\n            return LINE_INTERSECTION_TYPE.PARALLEL;\r\n    }\r\n\r\n    const paramA = paramANumer / paramDenom;\r\n    const paramB = paramBNumer / paramDenom;\r\n    \r\n    if(paramA > 1.0 || paramA < 0.0 || paramB > 1.0 || paramB < 0.0) {\r\n        return LINE_INTERSECTION_TYPE.LINE;\r\n    } else {\r\n        return LINE_INTERSECTION_TYPE.LINESEG;\r\n    }\r\n};\r\n    \r\n/**\r\n * @param {Line} _otherLine\r\n * @returns {LINE_INTERSECTION_RESULT}\r\n */\r\nLine.prototype.computeIntersection = function(_otherLine) {\r\n\r\n    const thisLineStartPointX = this.__startPoint.getX();\r\n    const thisLineStartPointY = this.__startPoint.getY();\r\n    const thisLineEndPointX = this.__endPoint.getX();\r\n    const thisLineEndPointY = this.__endPoint.getY();        \r\n    const otherLineStartPointX = _otherLine.getStartPoint().getX();\r\n    const otherLineStartPointY = _otherLine.getStartPoint().getY();\r\n    const otherLineEndPointX = _otherLine.getEndPoint().getX();\r\n    const otherLineEndPointY = _otherLine.getEndPoint().getY();\r\n\r\n    const paramDenom = (otherLineEndPointY-otherLineStartPointY)*(thisLineEndPointX-thisLineStartPointX) - (otherLineEndPointX-otherLineStartPointX)*(thisLineEndPointY-thisLineStartPointY);\r\n    const paramANumer = (otherLineEndPointX-otherLineStartPointX)*(thisLineStartPointY-otherLineStartPointY) - (otherLineEndPointY - otherLineStartPointY)*(thisLineStartPointX-otherLineStartPointX);\r\n    const paramBNumer = (thisLineEndPointX-thisLineStartPointX)*(thisLineStartPointY-otherLineStartPointY) - (thisLineEndPointY-thisLineStartPointY)*(thisLineStartPointX-otherLineStartPointX);\r\n\r\n    if(paramDenom == 0) {\r\n        if(paramDenom == 0 && paramANumer == 0 && paramBNumer==0)\r\n            return new LineIntersection(LINE_INTERSECTION_TYPE.COINCIDENT, null);\r\n        else\r\n            return new LineIntersection(LINE_INTERSECTION_TYPE.PARALLEL, null);\r\n    }\r\n\r\n    const paramA = paramANumer / paramDenom;\r\n    const paramB = paramBNumer / paramDenom;\r\n\r\n    const xIntersect = this.__startPoint.getX() + paramA*(this.__endPoint.getX()-this.__startPoint.getX());\r\n    const yIntersect = this.__startPoint.getY() + paramA*(this.__endPoint.getY()-this.__startPoint.getY());\r\n    \r\n    if(paramA > 1.0 || paramA < 0.0 || paramB > 1.0 || paramB < 0.0) {\r\n        return new LineIntersection(LINE_INTERSECTION_TYPE.LINE, new Point(xIntersect, yIntersect));\r\n    } else {\r\n        return new LineIntersection(LINE_INTERSECTION_TYPE.LINESEG, new Point(xIntersect, yIntersect));\r\n    }\r\n};\r\n\r\nexport { Line };\r\n","import { Line } from \"./Line\";\r\n\r\nconst SvgPathBuilder = {\r\n\r\n    /**\r\n     * \r\n     * @param {Point} _pt \r\n     * @returns {String}\r\n     */\r\n    pointToLineTo: function(_pt, _ptIndex) {\r\n        if(_ptIndex === 0) {\r\n            return \"M\" + _pt.getX() + \" \" + _pt.getY();\r\n        }\r\n\r\n        return \"L\" + _pt.getX() + \" \" + _pt.getY();\r\n    },\r\n\r\n    /**\r\n     * \r\n     * @param {Point[]} _points \r\n     * @param {Number} _curvaturePx \r\n     * @returns {Point[]}\r\n     */\r\n    pointTripletToTesselatedCurvePoints(_points, _curvaturePx) {\r\n        if(_points.length !== 3) {\r\n            throw new Error(\"_points must be array of exactly 3 points\");\r\n        }\r\n\r\n        const controlPoint = _points[1];\r\n\r\n        const lineA = new Line(_points[0], _points[1]);\r\n        const lineB = new Line(_points[1], _points[2]);\r\n\r\n        const lineAShortened = lineA.createShortenedLine(0, _curvaturePx * 0.5);\r\n        const lineBShortened = lineB.createShortenedLine(_curvaturePx * 0.5, 0);\r\n\r\n        return [\r\n            lineAShortened.getStartPoint(),\r\n            lineAShortened.getEndPoint(),\r\n            lineBShortened.getStartPoint(),\r\n            lineBShortened.getEndPoint(),\r\n        ];\r\n    },\r\n\r\n    /**\r\n     * \r\n     * @param {Point[]} _points\r\n     * @param {Number} _curvaturePx\r\n     * @returns {String}\r\n     */\r\n    pointsToPath: function(_points, _curvaturePx) {\r\n        _curvaturePx = _curvaturePx || 0.0;\r\n\r\n        const svgPathParts = [];\r\n\r\n        if(_curvaturePx > 0.0) {\r\n\r\n            let ptIdx = 0;\r\n\r\n            while(_points.length >= 3) {\r\n                const ptA = _points.shift();\r\n                const ptB = _points.shift();\r\n                const ptC = _points.shift();\r\n\r\n                const newPts = SvgPathBuilder.pointTripletToTesselatedCurvePoints(\r\n                    [\r\n                        ptA,\r\n                        ptB,\r\n                        ptC,\r\n                    ],\r\n                    _curvaturePx\r\n                );                \r\n\r\n                _points.unshift(newPts[3]);\r\n                _points.unshift(newPts[2]);\r\n\r\n                for(let j=0; j<newPts.length-2; j++) {\r\n                    svgPathParts.push(SvgPathBuilder.pointToLineTo(newPts[j], ptIdx++));\r\n                }\r\n            }\r\n\r\n            while(_points.length > 0) {\r\n                const pt = _points.shift();\r\n                svgPathParts.push(SvgPathBuilder.pointToLineTo(pt, ptIdx++));\r\n            }\r\n\r\n        } else {\r\n            for(let i=0; i<_points.length; i++) {\r\n                const p = _points[i];\r\n                svgPathParts.push(SvgPathBuilder.pointToLineTo(p, i));\r\n            }\r\n        }\r\n\r\n        return svgPathParts.join(\" \");        \r\n    },\r\n\r\n};\r\n\r\nexport { SvgPathBuilder };\r\n","/**\r\n * \r\n * @param {Number} _width\r\n * @param {Number} _height\r\n */\r\nfunction Dimensions(_width, _height) {\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */       \r\n    this.getWidth = function() {\r\n        return _width;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */       \r\n    this.getHeight = function() {\r\n        return _height;\r\n    };\r\n};\r\n\r\nexport { Dimensions };\r\n","import {Point} from './Point';\r\nimport {Line} from './Line';\r\nimport  {LINE_INTERSECTION_TYPE, LineIntersection} from './LineIntersection';\r\n\r\n/**\r\n * \r\n * @param {Number} _left\r\n * @param {Number} _top\r\n * @param {Number} _right\r\n * @param {Number} _bottom\r\n */\r\nfunction Rectangle(_left, _top, _right, _bottom)  {\r\n    \r\n    const self=this;\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getLeft = function() {\r\n        return _left;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getTop = function() {\r\n        return _top;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getRight = function() {\r\n        return _right;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getBottom = function() {\r\n        return _bottom;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */    \r\n    this.getWidth = function() {\r\n        return _right - _left;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */    \r\n    this.getHeight = function() {\r\n        return _bottom - _top;\r\n    };\r\n\r\n    /**\r\n     * @returns {Point[]}\r\n     */\r\n    this.getPoints = function() {\r\n        return [\r\n            new Point(_left, _top),\r\n            new Point(_right, _top),\r\n            new Point(_right, _bottom),\r\n            new Point(_left, _bottom)\r\n        ];\r\n    };\r\n\r\n    /**\r\n     * @returns {Line[]}\r\n     */\r\n    this.getLines = function() {\r\n        return [\r\n            new Line(new Point(_left, _top), new Point(_right, _top)),\r\n            new Line(new Point(_right, _top), new Point(_right, _bottom)),\r\n            new Line(new Point(_right, _bottom), new Point(_left, _bottom)),\r\n            new Line(new Point(_left, _bottom), new Point(_left, _top))\r\n        ];\r\n    };\r\n\r\n    /**\r\n     * @param {Number} _resizeByPx\r\n     * @returns {Rectangle}\r\n     */\r\n    this.getUniformlyResizedCopy = function(_resizeByPx) {\r\n        return new Rectangle(\r\n            _left - _resizeByPx, \r\n            _top - _resizeByPx, \r\n            _right + _resizeByPx, \r\n            _bottom + _resizeByPx\r\n        );\r\n    };\r\n\r\n    /**\r\n     * Scale the bounding box by _gridSize, and return the points comprising the box\r\n     * \r\n     * @param {Number} _gridSize\r\n     * @returns {Point[]}\r\n     */\r\n    this.getPointsScaledToGrid = function(_gridSize) {\r\n\r\n        const centroid = new Point(\r\n            _left + ((_right-_left)*0.5),\r\n            _top + ((_bottom-_top)*0.5)\r\n        );\r\n\r\n        const scaleDx = ((_right - centroid.getX()) + _gridSize) / (_right - centroid.getX());\r\n        const scaleDy = ((_bottom - centroid.getY()) + _gridSize) / (_bottom - centroid.getY());        \r\n       \r\n        const scaledPoints = [\r\n            new Point(\r\n                ((_left - centroid.getX())*scaleDx) + centroid.getX(), \r\n                ((_top - centroid.getY())*scaleDy) + centroid.getY()\r\n            ),\r\n\r\n            new Point(\r\n                ((_right - centroid.getX())*scaleDx) + centroid.getX(), \r\n                ((_top - centroid.getY())*scaleDy) + centroid.getY()\r\n            ),\r\n\r\n            new Point(\r\n                ((_right - centroid.getX())*scaleDx) + centroid.getX(), \r\n                ((_bottom - centroid.getY())*scaleDy) + centroid.getY()\r\n            ),\r\n\r\n            new Point(\r\n                ((_left - centroid.getX())*scaleDx) + centroid.getX(), \r\n                ((_bottom - centroid.getY())*scaleDy) + centroid.getY()\r\n            )\r\n        ];\r\n\r\n        return scaledPoints;\r\n    };    \r\n\r\n    /**\r\n     * \r\n     * @param {Rectangle} _otherRectangle\r\n     * @returns {Boolean}\r\n     */\r\n    this.checkIntersect = function(_otherRectangle) {\r\n        if(_bottom < _otherRectangle.getTop()) {\r\n            return false;\r\n        }\r\n\r\n        if(_top > _otherRectangle.getBottom()) {\r\n            return false;\r\n        }\r\n\r\n        if(_right < _otherRectangle.getLeft()) {\r\n            return false;\r\n        }\r\n\r\n        if(_left > _otherRectangle.getRight()) {\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    };\r\n\r\n\r\n    /**\r\n     * \r\n     * @param {Point} _point \r\n     */\r\n    this.checkIsPointWithin = function(_point) {\r\n        if(_point.getX() >= _left && _point.getX() <= _right && _point.getY() >= _top && _point.getY() <= _bottom) {\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Rectangle} _otherRectangle\r\n     * @returns {Boolean}\r\n     */\r\n    this.checkIsWithin = function(_otherRectangle) {\r\n        if( _bottom <= _otherRectangle.getBottom() &&\r\n            _top >= _otherRectangle.getTop() &&\r\n            _right <= _otherRectangle.getRight() &&\r\n            _left >= _otherRectangle.getLeft()\r\n        ) {\r\n\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    };\r\n};\r\n\r\nexport { Rectangle }\r\n","const GroupTransformationContainerEvent = Object.freeze({\r\n    TRANSLATE_START: 'group-transformation-container-translate-start'\r\n});\r\n\r\nexport { GroupTransformationContainerEvent };\r\n","const CanvasEvent = Object.freeze({\r\n    DBLCLICK: \"dblclick\",\r\n    CLICK: \"click\",\r\n    CONNECTOR_UPDATED: \"connector-updated\",\r\n    OBJECT_ADDED: \"object-added\",\r\n    OBJECT_REMOVED: \"object-removed\",\r\n    OBJECT_RESIZED: \"object-resized\",\r\n    OBJECT_TRANSLATED: \"object-translated\",\r\n    MULTIPLE_OBJECT_SELECTION_STARTED: \"multiple-object-selection-started\",\r\n    MULTIPLE_OBJECTS_SELECTED: \"multiple-objects-selected\",\r\n});\r\n\r\n\r\nexport { CanvasEvent };\r\n","import  {Point} from './Point';\r\nimport  {Rectangle} from './Rectangle';\r\n\r\n/**\r\n * @param {String} _id\r\n * @param {Element} _domElement\r\n * @param {Canvas} _canvas\r\n */\r\nfunction ConnectorAnchor(_id, _domElement, _canvas) {\r\n    \r\n    const self = this;\r\n\r\n    /**\r\n     * @returns {String}\r\n     */\r\n    this.getId = function() {\r\n        return _id;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */     \r\n    this.getX = function() {\r\n        return self.getCentroid().getX();\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */     \r\n    this.getY = function() {\r\n        return self.getCentroid().getY();\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getWidth = function() {\r\n        const r = _domElement.getBoundingClientRect();\r\n        return (r.right - r.left);\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getHeight = function() {\r\n        const r = _domElement.getBoundingClientRect();\r\n        return (r.bottom - r.top);\r\n    };\r\n\r\n    /**\r\n     * @returns {Point}\r\n     */\r\n    this.getCentroid = function() {\r\n        const viewportRelativeRect = _domElement.getBoundingClientRect();\r\n        const pageOffset = _canvas.getPageOffset();        \r\n        return new Point(\r\n            viewportRelativeRect.left + pageOffset.getX() + (self.getWidth() * 0.5), \r\n            viewportRelativeRect.top + pageOffset.getY() + (self.getHeight() * 0.5)\r\n        );\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Number} _gridSize \r\n     * @returns {Point[]}\r\n     */\r\n    this.getRoutingPoints = function(_gridSize) {\r\n\r\n        const centroid = self.getCentroid();\r\n        const halfWidth = self.getWidth() * 0.5;\r\n        const halfHeight = self.getHeight() * 0.5;\r\n\r\n        return [\r\n            new Point(centroid.getX() + halfWidth + _gridSize, centroid.getY()),\r\n            new Point(centroid.getX() - halfWidth - _gridSize, centroid.getY()),\r\n            new Point(centroid.getX(), centroid.getY() + halfHeight + _gridSize),\r\n            new Point(centroid.getX(), centroid.getY() - halfHeight - _gridSize),\r\n        ];\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @returns {Rectangle}\r\n     */\r\n    this.getBoundingRectange = function() {\r\n        const centroid = self.getCentroid();\r\n        const halfWidth = self.getWidth() * 0.5;\r\n        const halfHeight = self.getHeight() * 0.5;\r\n\r\n        return new Rectangle(\r\n            centroid.getX() - halfWidth, \r\n            centroid.getY() - halfHeight, \r\n            centroid.getX() + halfWidth, \r\n            centroid.getY() + halfHeight\r\n        );\r\n    };\r\n};\r\n\r\nexport { ConnectorAnchor };\r\n","import { CanvasObject } from \"../CanvasObject\";\r\nimport { ConnectorAnchor } from \"../ConnectorAnchor\";\r\n\r\nconst ClosestPairFinder = {   \r\n    /**\r\n     * \r\n     * @param {CanvasObject} _objA \r\n     * @param {CanvasObject} _objB\r\n     * @param {Map<ConnectorAnchor, Number>} _connectorAnchorToNumValidRoutingPoints\r\n     * @returns {Object}\r\n     */\r\n    findClosestPairBetweenObjects: function(_objA, _objB, _connectorAnchorToNumValidRoutingPoints) {\r\n        const objAConnectorAnchors = _objA.getConnectorAnchors();\r\n        const objBConnectorAnchors = _objB.getConnectorAnchors();\r\n\r\n        var startAnchorIdxWithMinDist = 0;\r\n        var endAnchorIdxWithMinDist = 0;\r\n        var minDist = Number.MAX_VALUE;\r\n        \r\n        // Find best anchor element to connect _objA and _objB            \r\n        // Find anchors that produce shortest straight line distance\r\n        for(let x=0; x<objAConnectorAnchors.length; x++) {\r\n            const aCentroid = objAConnectorAnchors[x].getCentroid();\r\n            const objANumValidRoutingPoints = _connectorAnchorToNumValidRoutingPoints.get(objAConnectorAnchors[x].getId()) || 0;\r\n            if(objANumValidRoutingPoints === 0) {\r\n                continue;\r\n            }\r\n\r\n            for(let y=0; y<objBConnectorAnchors.length; y++) {\r\n                const bCentroid = objBConnectorAnchors[y].getCentroid();\r\n                const d = Math.sqrt(Math.pow(bCentroid.getX()-aCentroid.getX(),2) + Math.pow(bCentroid.getY()-aCentroid.getY(),2));\r\n                const objBNumValidRoutingPoints = _connectorAnchorToNumValidRoutingPoints.get(objBConnectorAnchors[y].getId()) || 0;\r\n                \r\n                if(d < minDist && objBNumValidRoutingPoints > 0) {\r\n                    startAnchorIdxWithMinDist = x;\r\n                    endAnchorIdxWithMinDist = y;\r\n                    minDist = d;\r\n                }\r\n            }\r\n        }\r\n\r\n        return {\r\n            \"objectAAnchorIndex\": startAnchorIdxWithMinDist,\r\n            \"objectAAnchor\": objAConnectorAnchors[startAnchorIdxWithMinDist],\r\n            \"objectBAnchorIndex\": endAnchorIdxWithMinDist,\r\n            \"objectBAnchor\": objBConnectorAnchors[endAnchorIdxWithMinDist],\r\n        };\r\n    }\r\n};\r\n\r\nexport { ClosestPairFinder };\r\n","import  {Point} from './Point';\r\nimport  {Line} from './Line';\r\n\r\n/**\r\n * Unique collection of Point objects\r\n * \r\n * @param {Point[]|Float64Array|undefined} _pointsInput\r\n */\r\nfunction PointSet(_pointsInput) {\r\n\r\n    const self = this;\r\n\r\n    /**\r\n     * @type {Point[]}\r\n     */\r\n    const points = [];\r\n\r\n    /**\r\n     * @param {Point} _newPoint\r\n     */\r\n    this.push = function(_newPoint) {\r\n        for(let i=0; i<points.length; i++) {\r\n            if(_newPoint.isEqual(points[i])) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        points.push(_newPoint);\r\n        return true;\r\n    };\r\n\r\n    /**\r\n     * @param {PointSet} _ps\r\n     */\r\n    this.pushPointSet = function(_ps) {\r\n        const possibleNewPoints = _ps.toArray();\r\n        for(let i=0; i<possibleNewPoints.length; i++) {\r\n            self.push(possibleNewPoints[i]);\r\n        }\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Point} _point \r\n     * @returns {Point}\r\n     */\r\n    this.findPointClosestTo = function(_point) {\r\n        var resultPoint = null;\r\n        var currentMinLength = Number.MAX_SAFE_INTEGER;\r\n\r\n        points.forEach(function(_pt) {\r\n            const lineToPt = new Line(_point, _pt);\r\n            if(lineToPt.getLength() < currentMinLength) {\r\n                resultPoint = _pt;\r\n                currentMinLength = lineToPt.getLength();\r\n            }\r\n        });\r\n        \r\n        return resultPoint;        \r\n    };\r\n\r\n    this.findDistanceToPointClosestTo = function(_point) {\r\n        var currentMinLength = Number.MAX_SAFE_INTEGER;\r\n\r\n        points.forEach(function(_pt) {\r\n            const lineToPt = new Line(_point, _pt);\r\n            if(lineToPt.getLength() < currentMinLength) {\r\n                currentMinLength = lineToPt.getLength();\r\n            }\r\n        });\r\n        \r\n        return currentMinLength;        \r\n    };    \r\n\r\n    /**\r\n     * \r\n     * @param {Point} _point \r\n     * @returns {PointSet}\r\n     */\r\n    this.findPointsCloseTo = function(_point, _radius) {\r\n        const resultSet = new PointSet();\r\n\r\n        points.forEach(function(_pt) {\r\n            const lineToPt = new Line(_point, _pt);\r\n            if(lineToPt.getLength() <= _radius) {\r\n                resultSet.push(_pt);\r\n            }\r\n        });\r\n        \r\n        return resultSet;        \r\n    };    \r\n\r\n    /**\r\n     * @returns {Point[]}\r\n     */\r\n    this.toArray = function() {\r\n        return points;\r\n    };\r\n\r\n    /**\r\n     * @returns {Float64Array}\r\n     */\r\n    this.toFloat64Array = function() {\r\n\r\n        const result = new Float64Array(points.length * 2);\r\n        for(let i=0; i<points.length; i++) {\r\n            result[0 + (i*2)] = points[i].getX();\r\n            result[1 + (i*2)] = points[i].getY();\r\n        }\r\n\r\n        return result;\r\n    };\r\n    \r\n    /**\r\n     * @param {Float64Array} _float64Array\r\n     */\r\n    const fromFloat64Array = function(_float64Array) {\r\n        points.length = 0;\r\n        for(let i=0; i<_float64Array.length; i+=2) {\r\n            points.push(\r\n                new Point(_float64Array[i], _float64Array[i+1])\r\n            );\r\n        }\r\n    };    \r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.count = function() {\r\n        return points.length;\r\n    };\r\n\r\n    if(_pointsInput && Array.isArray(_pointsInput)) {\r\n        _pointsInput.forEach(self.push);\r\n    } else if(_pointsInput && Object.prototype.toString.call(_pointsInput) === '[object Float64Array]') {\r\n        fromFloat64Array(_pointsInput);\r\n    } else { }    \r\n\r\n};\r\n\r\nexport { PointSet };\r\n","import  {Point} from './Point';\r\nimport  {Line} from './Line';\r\n\r\n/**\r\n * Unique collection of Line objects\r\n * \r\n * @param {Line[]|Float64Array|undefined} _linesInput\r\n */\r\nfunction LineSet(_linesInput) {\r\n\r\n    const self = this;\r\n    \r\n    /**\r\n     * @type {Line[]}\r\n     */\r\n    const lines = [];    \r\n\r\n    /**\r\n     * @param {Line} _newLine\r\n     */\r\n    this.push = function(_newLine) {\r\n        var alreadyInLinesArray = false;\r\n        lines.forEach(function(_existingLine) {\r\n            if(_newLine.isEqual(_existingLine)) {\r\n                alreadyInLinesArray = true;\r\n            }\r\n        });        \r\n\r\n        if(alreadyInLinesArray) {\r\n            return false;\r\n        }\r\n\r\n        lines.push(_newLine);\r\n        return true;\r\n    };\r\n  \r\n    /**\r\n     * @returns {Line[]}\r\n     */\r\n    this.toArray = function() {\r\n        return lines;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.count = function() {\r\n        return lines.length;\r\n    };\r\n\r\n    /**\r\n     * @returns {Float64Array}\r\n     */\r\n    this.toFloat64Array = function() {\r\n        const result = new Float64Array(lines.length * 4);\r\n        for(let i=0; i<lines.length; i++) {\r\n            result[0 + (i*4)] = lines[i].getStartPoint().getX();\r\n            result[1 + (i*4)] = lines[i].getStartPoint().getY();\r\n            result[2 + (i*4)] = lines[i].getEndPoint().getX();\r\n            result[3 + (i*4)] = lines[i].getEndPoint().getY();\r\n        }\r\n\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * @param {Float64Array} _float64Array\r\n     */\r\n    const fromFloat64Array = function(_float64Array) {\r\n        lines.length = 0;\r\n        for(let i=0; i<_float64Array.length; i+=4) {\r\n            lines.push(\r\n                new Line(\r\n                    new Point(_float64Array[i], _float64Array[i+1]),\r\n                    new Point(_float64Array[i+2], _float64Array[i+3])\r\n                )\r\n            );\r\n        }\r\n    };\r\n\r\n    if(_linesInput && Array.isArray(_linesInput)) {\r\n        _linesInput.forEach(self.push);\r\n    } else if(_linesInput && Object.prototype.toString.call(_linesInput) === '[object Float64Array]') {\r\n        fromFloat64Array(_linesInput);\r\n    } else { }    \r\n};\r\n\r\nexport { LineSet };\r\n","const ConnectorEvent = Object.freeze({\r\n    CLICK: 'connector-click',\r\n    MOUSE_ENTER: 'connector-mouse-enter',\r\n    MOUSE_LEAVE: 'connector-mouse-leave'\r\n});\r\n\r\nexport { ConnectorEvent };\r\n","import {ConnectorAnchor} from './ConnectorAnchor';\r\nimport {ConnectorEvent} from './ConnectorEvent';\r\nimport {Line} from './Line';\r\nimport {Point} from './Point';\r\n\r\n/**\r\n * \r\n * @param {ConnectorAnchor} _anchorStart \r\n * @param {ConnectorAnchor} _anchorEnd\r\n * @param {Element} _containerDomElement\r\n * @param {String} _strokeColor\r\n * @param {String} _strokeWidth\r\n * @param {Number} _curvaturePx\r\n */\r\nfunction Connector(_anchorStart, _anchorEnd, _containerDomElement, _strokeColor, _strokeWidth, _curvaturePx) {\r\n    \r\n    const self = this;\r\n\r\n    const eventNameToHandlerFunc = new Map();\r\n    let markerStartSize = 0;\r\n    let markerEndSize = 0;\r\n\r\n    if(typeof _strokeColor === 'undefined') {\r\n        _strokeColor = '#000';\r\n    }\r\n\r\n    if(typeof _strokeWidth === 'undefined') {\r\n        _strokeWidth = '2px';\r\n    }\r\n\r\n    if(typeof _curvaturePx === 'undefined') {\r\n        _curvaturePx = 0;\r\n    }\r\n\r\n    /**\r\n     * @type {Point[]|null}\r\n     */\r\n    let pathPoints = null;\r\n\r\n    /**\r\n     * @type {Element}\r\n     */\r\n    const pathElem = window.document.createElementNS(\"http://www.w3.org/2000/svg\", 'path');\r\n    pathElem.setAttribute(\"d\", 'M0 0 L0 0');\r\n    pathElem.style.stroke = _strokeColor; \r\n    pathElem.style.strokeWidth = _strokeWidth;         \r\n\r\n    pathElem.addEventListener(\"click\", function(e) {\r\n        self.dispatchEvent(ConnectorEvent.CLICK, {\"connector\":self, \"clickedAtX\": e.pageX, \"clickedAtY\": e.pageY});\r\n    });\r\n\r\n    pathElem.addEventListener(\"mouseenter\", function(e) {\r\n        self.dispatchEvent(ConnectorEvent.MOUSE_ENTER, {\"connector\":self, \"pointerAtX\": e.pageX, \"pointerAtY\": e.pageY});\r\n    });\r\n\r\n    pathElem.addEventListener(\"mouseleave\", function(e) {\r\n        self.dispatchEvent(ConnectorEvent.MOUSE_LEAVE, {\"connector\":self });\r\n    });        \r\n\r\n    /**\r\n     * @type {Element}\r\n     */\r\n    var svgDomElem = null;\r\n\r\n    this.appendPathToContainerDomElement = function() {\r\n        svgDomElem = _containerDomElement.appendChild(pathElem);\r\n    };\r\n\r\n    /**\r\n     * @param {String} _url\r\n     * @param {Number} _size\r\n     */    \r\n    this.setMarkerStart = function(_url, _size) {\r\n        pathElem.setAttribute(`marker-start`, `url(${_url})`);\r\n        markerStartSize = _size;\r\n    };\r\n\r\n    this.unsetMarkerStart = function() {\r\n        pathElem.removeAttribute(`marker-start`);\r\n        markerStartSize = 0;\r\n    };\r\n\r\n    /**\r\n     * @param {String} _url\r\n     * @param {Number} _size\r\n     */\r\n    this.setMarkerEnd = function(_url, _size) {\r\n        pathElem.setAttribute(`marker-end`, `url(${_url})`);\r\n        markerEndSize = _size;\r\n    };\r\n\r\n    this.unsetMarkerEnd = function() {\r\n        pathElem.removeAttribute(`marker-end`);\r\n        markerEndSize = 0;\r\n    };    \r\n\r\n    /**\r\n     * @returns {Point[]|null}\r\n     */\r\n    this.getPathPoints = function() {\r\n        return pathPoints;\r\n    };\r\n\r\n    /**\r\n     * @returns {Line[]}\r\n     */\r\n    this.getPathLines = function() {\r\n        if(pathPoints === null || pathPoints.length < 2) {\r\n            return [];\r\n        }\r\n\r\n        const lines = [];\r\n        for(let i=0; i<pathPoints.length-1; i++) {\r\n            lines.push(new Line(pathPoints[i], pathPoints[i+1]));\r\n        }\r\n\r\n        return lines;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getLength = function() {\r\n        let totalLength = 0;\r\n\r\n        const pathLines = self.getPathLines();\r\n        for(let i=0; i<pathLines.length; i++) {\r\n            totalLength += pathLines[i].getLength();\r\n        }\r\n        \r\n        return totalLength;\r\n    };\r\n\r\n    /**\r\n     * @returns {Point}\r\n     */\r\n    this.getMidpoint = function() {\r\n        const totalLength = self.getLength();\r\n        const pathLines = self.getPathLines();\r\n\r\n        let lengthSoFar = 0;\r\n        let curPathLineWithMidpoint = null;\r\n\r\n        for(let i=0; i<pathLines.length; i++) {\r\n            curPathLineWithMidpoint = pathLines[i];\r\n            const pathLineLength = pathLines[i].getLength();\r\n            lengthSoFar += pathLineLength;\r\n\r\n            if(lengthSoFar >= totalLength/2.0) {\r\n                break;\r\n            }\r\n        }\r\n\r\n        const lengthBeforeCur = (lengthSoFar - curPathLineWithMidpoint.getLength());\r\n        const midOnCurPath = (totalLength / 2.0) - lengthBeforeCur; // i.e. distance to midpoint\r\n\r\n        const p = midOnCurPath / curPathLineWithMidpoint.getLength();\r\n\r\n        return new Point(\r\n            curPathLineWithMidpoint.getStartPoint().getX() + (p * (curPathLineWithMidpoint.getEndPoint().getX() - curPathLineWithMidpoint.getStartPoint().getX())),\r\n            curPathLineWithMidpoint.getStartPoint().getY() + (p * (curPathLineWithMidpoint.getEndPoint().getY() - curPathLineWithMidpoint.getStartPoint().getY()))\r\n        );\r\n    };\r\n\r\n    /**\r\n     * @returns {Point}\r\n     */\r\n    this.getMidpointDirection = function() {\r\n        const totalLength = self.getLength();\r\n        const pathLines = self.getPathLines();\r\n\r\n        let lengthSoFar = 0;\r\n        let curPathLineWithMidpoint = null;\r\n\r\n        for(let i=0; i<pathLines.length; i++) {\r\n            curPathLineWithMidpoint = pathLines[i];\r\n            const pathLineLength = pathLines[i].getLength();\r\n            lengthSoFar += pathLineLength;\r\n\r\n            if(lengthSoFar >= totalLength/2.0) {\r\n                break;\r\n            }\r\n        }\r\n\r\n        if(curPathLineWithMidpoint === null) {\r\n            return pathLines[0].getDirection();\r\n        }\r\n\r\n        return curPathLineWithMidpoint.getDirection();\r\n    };\r\n\r\n\r\n    /**\r\n     * @param {String} _svgPath\r\n     * @param {Point[]} _pathPoints\r\n     */\r\n    this.refresh = function(_svgPath, _pathPoints) {\r\n        pathPoints = _pathPoints;\r\n        pathElem.setAttribute(\"d\", _svgPath);\r\n    };\r\n\r\n    /**\r\n     * @returns {String}\r\n     */\r\n    this.getId = function() {\r\n        const anchorIds = [_anchorStart.getId(), _anchorEnd.getId()].sort();\r\n        return anchorIds.join(':');\r\n    };\r\n\r\n    /**\r\n     * @returns {ConnectorAnchor}\r\n     */\r\n    this.getAnchorStart = function() {\r\n        return _anchorStart;\r\n    };\r\n\r\n    /**\r\n     * @returns {ConnectorAnchor}\r\n     */    \r\n    this.getAnchorEnd = function() {\r\n        return _anchorEnd;\r\n    };\r\n\r\n    this.removePathElement = function() {\r\n        pathElem.remove();\r\n    };\r\n\r\n    /**\r\n     * @param {String} _cl\r\n     * @returns {undefined}\r\n     */\r\n    this.addClassToDomElement = function(_cl) {\r\n        pathElem.classList.add(_cl);\r\n    };\r\n\r\n    /**\r\n     * @param {String} _cl\r\n     * @returns {undefined}\r\n     */    \r\n    this.removeClassFromDomElement = function(_cl) {\r\n        pathElem.classList.remove(_cl);\r\n    };\r\n\r\n    /**\r\n     * @returns {Object}\r\n     */\r\n    this.getDescriptor = function() {\r\n        return {\r\n            \"id\": self.getId(),\r\n            \"anchor_start_centroid_arr\": _anchorStart.getCentroid().toArray(),\r\n            \"anchor_end_centroid_arr\": _anchorEnd.getCentroid().toArray(),\r\n            \"marker_start_size\": markerStartSize,\r\n            \"marker_end_size\": markerEndSize,\r\n            \"curvature_px\": _curvaturePx\r\n        };\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {String} _eventName \r\n     * @param {*} _handlerFunc \r\n     */\r\n    this.on = function(_eventName, _handlerFunc) {\r\n        const allHandlers = eventNameToHandlerFunc.get(_eventName) || [];\r\n        allHandlers.push(_handlerFunc);\r\n        eventNameToHandlerFunc.set(_eventName, allHandlers);        \r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {String} _eventName \r\n     * @param {*} _callback \r\n     */\r\n    this.off = function(_eventName, _callback) {\r\n        const allCallbacks = eventNameToHandlerFunc.get(_eventName) || [];\r\n\r\n        for(let i=0; i<allCallbacks.length; i++) {\r\n            if(allCallbacks[i] === _callback) {\r\n                allCallbacks.splice(i, 1);\r\n                break;\r\n            }\r\n        }\r\n\r\n        eventNameToHandlerFunc.set(_eventName, allCallbacks);\r\n    };\r\n\r\n    /**\r\n     * @param {String} _eventId\r\n     * @param {Object} _eventData\r\n     */\r\n    this.dispatchEvent = function(_eventId, _eventData) {\r\n        const observers = eventNameToHandlerFunc.get(_eventId) || [];\r\n        observers.forEach(function(handler) {\r\n            handler(_eventData);\r\n        });\r\n    };\r\n};\r\n\r\nexport { Connector };\r\n","import {Point} from './Point';\r\nimport {Line} from './Line';\r\nimport {PointSet} from './PointSet';\r\nimport {LineSet} from './LineSet';\r\nimport  {LINE_INTERSECTION_TYPE, LineIntersection} from './LineIntersection';\r\n\r\n/**\r\n * \r\n * @param {PointSet} _freePoints\r\n * @param {LineSet} _boundaryLines\r\n */\r\nfunction PointVisibilityMap(_freePoints, _boundaryLines) {\r\n\r\n    const self = this;\r\n\r\n    const boundaryLinesArr = _boundaryLines.toArray();\r\n    const freePointsArr = _freePoints.toArray();\r\n    const pointToVisibleSet = new Array(_freePoints.count()); // index represents entry in freePointsArr\r\n\r\n    /**\r\n     * @param {Line} _theLine\r\n     * @returns {Boolean}\r\n     */\r\n    const doesLineIntersectAnyBoundaryLines = function(_theLine) {\r\n\r\n        for(let b=0; b<boundaryLinesArr.length; b++) {\r\n            const intersectionType = boundaryLinesArr[b].computeIntersectionType(_theLine);\r\n            if(intersectionType === LINE_INTERSECTION_TYPE.LINESEG) {\r\n                return true;\r\n            }\r\n        };\r\n\r\n        return false;\r\n    };\r\n\r\n    const computePointsVisibility = function() {\r\n        for(let i=0; i<freePointsArr.length; i++) {\r\n            pointToVisibleSet[i] = [];   \r\n        }\r\n\r\n        for(let i=0; i<freePointsArr.length; i++) {            \r\n            for(let j=i+1; j<freePointsArr.length; j++) {\r\n\r\n                // line representing line-of-sight between the 2 points\r\n                const ijLine = new Line(freePointsArr[i], freePointsArr[j]);\r\n\r\n                if(!doesLineIntersectAnyBoundaryLines(ijLine)) {\r\n                    // record indices into freePointsArr\r\n                    pointToVisibleSet[i].push(j);\r\n                    pointToVisibleSet[j].push(i);\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    const getVisiblePointsFrom = function(_currentPoint) {\r\n        for(let i=0; i<freePointsArr.length; i++) {\r\n\r\n            if(freePointsArr[i].isEqual(_currentPoint)) {\r\n                const visiblePointIndices = pointToVisibleSet[i];\r\n                const visiblePoints = [];\r\n                visiblePointIndices.forEach((_vpIdx) => {\r\n                    visiblePoints.push(freePointsArr[_vpIdx]);\r\n                });\r\n\r\n                return visiblePoints;\r\n            }            \r\n        }\r\n\r\n        return [];\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Number} _currentRouteLength \r\n     * @param {Point[]} _pointsInRoute \r\n     * @param {Point} _currentPoint \r\n     * @param {Point} _endPoint \r\n     * @returns {Object|null}\r\n     */\r\n    const routeToEndpoint = function(_currentRouteLength, _pointsInRoute, _currentPoint, _endPoint) {\r\n\r\n        var visiblePoints = getVisiblePointsFrom(_currentPoint);       \r\n        var curMinCost = Number.MAX_SAFE_INTEGER;\r\n        var visiblePointWithMinCost = null;\r\n\r\n        visiblePoints.forEach(function(_vp) {\r\n            // ignore point if it's already in the route\r\n            for(let i=0; i<_pointsInRoute.length; i++) {\r\n                if(_vp.isEqual(_pointsInRoute[i])) {\r\n                    return; // point already in route, try another\r\n                }\r\n            }\r\n\r\n            // g(n) = length/cost of _startPoint to _vp + _currentRouteLength\r\n            const gn = (new Line(_currentPoint, _vp)).getLength() + _currentRouteLength;\r\n\r\n            // h(n) = length/cost of _vp to _endPoint\r\n            const hn = (new Line(_vp, _endPoint)).getLength();\r\n\r\n            // see if this is the new min\r\n            if((gn + hn) < curMinCost) {\r\n                curMinCost = gn + hn;\r\n                visiblePointWithMinCost = _vp;\r\n            }\r\n        });\r\n\r\n        if(curMinCost === Number.MAX_SAFE_INTEGER) {\r\n            return null;\r\n        }\r\n\r\n        return {\r\n            \"cost\": curMinCost,\r\n            \"point\": visiblePointWithMinCost\r\n        };\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Array} _pointsInRoute \r\n     */\r\n    const optimizeRoute = function(_pointsInRoute) {\r\n\r\n        let ptrA = 0;\r\n\r\n        while(true) {\r\n\r\n            if(ptrA+2 >= _pointsInRoute.length) {\r\n                break;\r\n            }            \r\n\r\n            const ln = new Line(_pointsInRoute[ptrA], _pointsInRoute[ptrA + 2]);\r\n\r\n            if(!doesLineIntersectAnyBoundaryLines(ln)) {\r\n                _pointsInRoute.splice(ptrA + 1, 1);\r\n            } else {\r\n                ptrA++;\r\n            }\r\n\r\n        }\r\n    };\r\n\r\n    /**\r\n     * @returns {Array}\r\n     */\r\n    this.getPointToVisibleSetData = function() {\r\n        return pointToVisibleSet;\r\n    };\r\n\r\n    /**\r\n     * @param {Point} _point\r\n     * @returns {Point|null}\r\n     */\r\n    this.findPointClosestTo = function(_point) {\r\n        var resultPoint = null;\r\n        var currentMaxLength = Number.MAX_SAFE_INTEGER;\r\n\r\n        freePointsArr.forEach(function(_ptKey) {\r\n            const lineOfSight = new Line(_point, _ptKey);\r\n            if(lineOfSight.getLength() < currentMaxLength) {\r\n                resultPoint = _ptKey;\r\n                currentMaxLength = lineOfSight.getLength();\r\n            }\r\n        });\r\n        \r\n        return resultPoint;\r\n    };\r\n\r\n    /**\r\n     * @param {Point} _point\r\n     * @returns {Point|null}\r\n     */\r\n    this.findVisiblePointClosestTo = function(_point) {\r\n\r\n        var resultPoint = null;\r\n        var currentMaxLength = Number.MAX_SAFE_INTEGER;\r\n\r\n        freePointsArr.forEach(function(_freePt) {\r\n\r\n            const lineOfSight = new Line(_point, _freePt);\r\n            const lineOfSightLength = lineOfSight.getLength();\r\n\r\n            if(lineOfSightLength < currentMaxLength && !doesLineIntersectAnyBoundaryLines(lineOfSight)) {\r\n                resultPoint = _freePt;\r\n                currentMaxLength = lineOfSightLength;\r\n            };\r\n\r\n        });\r\n        \r\n        return resultPoint;\r\n    };\r\n\r\n    /**\r\n     * @param {Point} _startPoint\r\n     * @param {Point} _endPoint\r\n     * \r\n     * @return {PointSet}\r\n     */\r\n    this.computeRoute = function(_startPoint, _endPoint) {\r\n\r\n        // if no valid startpoint or endpoint, we can't route\r\n        if(_startPoint === null || _endPoint === null) {\r\n            return new PointSet();\r\n        }\r\n\r\n        // find closest visible point \r\n        const firstRoutingPoint = self.findVisiblePointClosestTo(_startPoint);\r\n        if(firstRoutingPoint === null) {\r\n            return new PointSet();\r\n        }\r\n\r\n        var currentRouteLen = 0;\r\n        const pointsInRoute = [firstRoutingPoint];\r\n        var currentPoint = firstRoutingPoint;\r\n        while(true) {\r\n            const routeSegment = routeToEndpoint(currentRouteLen, pointsInRoute, currentPoint, _endPoint);\r\n            if(routeSegment === null) {\r\n\r\n                // Is there unobstructed line to endpoint? \r\n                // If not, failed to find route\r\n                const lastSegmentToEndpoint = new Line(pointsInRoute[pointsInRoute.length-1], _endPoint);\r\n                if(doesLineIntersectAnyBoundaryLines(lastSegmentToEndpoint)) {\r\n                    return new PointSet();\r\n                }\r\n\r\n                break;\r\n            }\r\n\r\n            currentRouteLen += (new Line(currentPoint, routeSegment.point)).getLength();\r\n            pointsInRoute.push(routeSegment.point);\r\n            currentPoint = routeSegment.point;\r\n\r\n            if((new Line(currentPoint, _endPoint).getLength()) < 1.0) {\r\n                break;\r\n            }\r\n        }\r\n\r\n        optimizeRoute(pointsInRoute);\r\n\r\n        return new PointSet(pointsInRoute);\r\n\r\n    };\r\n\r\n    computePointsVisibility();\r\n};\r\n    \r\nexport { PointVisibilityMap };\r\n","const GRID_STYLE = {\r\n    LINE: 'line',\r\n    DOT: 'dot'\r\n};\r\n\r\n/**\r\n * \r\n * @param {Number} _size\r\n * @param {String} _color\r\n * @param {String} _style\r\n */\r\nfunction Grid(_size, _color, _style) {\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getSize = function() {\r\n        return _size;\r\n    };\r\n\r\n    /**\r\n     * @returns {String}\r\n     */\r\n    this.getStyle = function() {\r\n        return _style;\r\n    };\r\n\r\n    /**\r\n     * @returns {String}\r\n     */\r\n    this.getSvgImageTile = function() {\r\n        if(_style === GRID_STYLE.LINE) {\r\n            return '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"' + _size + '\" height=\"' + _size + '\"><rect width=\"' + _size + '\" height=\"1\" x=\"0\" y=\"' + (_size-1.0) + '\" style=\"fill:' + _color + '\" /><rect width=\"1\" height=\"' + _size + '\" x=\"' + (_size-1.0) + '\" y=\"0\" style=\"fill:' + _color + '\" /></svg>';\r\n        } else {\r\n            return '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"' + _size + '\" height=\"' + _size + '\"><rect width=\"1\" height=\"1\" x=\"' + (_size-1.0) + '\" y=\"' + (_size-1.0) + '\" style=\"fill:' + _color + '\" /></svg>';\r\n        }\r\n    };\r\n\r\n};\r\n    \r\nexport { GRID_STYLE, Grid };\r\n","const ConnectorRoutingWorkerJsString = `(function () {\n  'use strict';\n\n  function _toConsumableArray(arr) {\n    return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();\n  }\n\n  function _arrayWithoutHoles(arr) {\n    if (Array.isArray(arr)) {\n      for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) arr2[i] = arr[i];\n\n      return arr2;\n    }\n  }\n\n  function _iterableToArray(iter) {\n    if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter);\n  }\n\n  function _nonIterableSpread() {\n    throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n  }\n\n  function Point(a,b){this.__x=a,this.__y=b;}Point.prototype.getX=function(){return this.__x},Point.prototype.getY=function(){return this.__y},Point.prototype.isEqual=function(a){return !(this.__x!==a.getX()||this.__y!==a.getY())},Point.prototype.getCartesianPoint=function(a,b){return new Point(this.__x-.5*a,-this.__y+.5*b)},Point.prototype.toString=function(){return this.__x+\" \"+this.__y},Point.prototype.toArray=function(){return [this.__x,this.__y]},Point.fromArray=function(a){return new Point(a[0],a[1])};\n\n  var LINE_INTERSECTION_TYPE=Object.freeze({PARALLEL:\"parallel\",COINCIDENT:\"coincident\",LINE:\"line\",LINESEG:\"lineseg\"});function LineIntersection(a,b){this.getType=function(){return a},this.getIntersectionPoint=function(){return b};}\n\n  function Line(a,b){if(\"undefined\"==typeof a||null===a)throw \"Line missing _startPoint\";if(\"undefined\"==typeof b||null===b)throw \"Line missing _endPoint\";this.__startPoint=a,this.__endPoint=b;}Line.prototype.getStartPoint=function(){return this.__startPoint},Line.prototype.getEndPoint=function(){return this.__endPoint},Line.prototype.isEqual=function(a){return !!(this.getStartPoint().isEqual(a.getStartPoint())&&this.getEndPoint().isEqual(a.getEndPoint()))},Line.prototype.getLength=function(){return Math.sqrt(Math.pow(this.__endPoint.getX()-this.__startPoint.getX(),2)+Math.pow(this.__endPoint.getY()-this.__startPoint.getY(),2))},Line.prototype.getDirection=function(){var a=this.__endPoint.getX()-this.__startPoint.getX(),b=this.__endPoint.getY()-this.__startPoint.getY(),c=Math.sqrt(a*a+b*b);return new Point(a/c,b/c)},Line.prototype.createShortenedLine=function(a,b){var c=this.__endPoint.getX()-this.__startPoint.getX(),d=this.__endPoint.getY()-this.__startPoint.getY(),e=this.getDirection();return new Line(new Point(this.__startPoint.getX()+a*e.getX(),this.__startPoint.getY()+a*e.getY()),new Point(this.__startPoint.getX()+c-b*e.getX(),this.__startPoint.getY()+d-b*e.getY()))},Line.prototype.computeIntersectionType=function(a){var b=this.__startPoint.getX(),c=this.__startPoint.getY(),d=this.__endPoint.getX(),e=this.__endPoint.getY(),f=a.getStartPoint().getX(),g=a.getStartPoint().getY(),h=a.getEndPoint().getX(),i=a.getEndPoint().getY(),j=(i-g)*(d-b)-(h-f)*(e-c),k=(h-f)*(c-g)-(i-g)*(b-f),l=(d-b)*(c-g)-(e-c)*(b-f);if(0==j)return 0==j&&0==k&&0==l?LINE_INTERSECTION_TYPE.COINCIDENT:LINE_INTERSECTION_TYPE.PARALLEL;var m=k/j,n=l/j;return 1<m||0>m||1<n||0>n?LINE_INTERSECTION_TYPE.LINE:LINE_INTERSECTION_TYPE.LINESEG},Line.prototype.computeIntersection=function(a){var b=this.__startPoint.getX(),c=this.__startPoint.getY(),d=this.__endPoint.getX(),e=this.__endPoint.getY(),f=a.getStartPoint().getX(),g=a.getStartPoint().getY(),h=a.getEndPoint().getX(),i=a.getEndPoint().getY(),j=(i-g)*(d-b)-(h-f)*(e-c),k=(h-f)*(c-g)-(i-g)*(b-f),l=(d-b)*(c-g)-(e-c)*(b-f);if(0==j)return 0==j&&0==k&&0==l?new LineIntersection(LINE_INTERSECTION_TYPE.COINCIDENT,null):new LineIntersection(LINE_INTERSECTION_TYPE.PARALLEL,null);var m=k/j,n=l/j,o=this.__startPoint.getX()+m*(this.__endPoint.getX()-this.__startPoint.getX()),p=this.__startPoint.getY()+m*(this.__endPoint.getY()-this.__startPoint.getY());return 1<m||0>m||1<n||0>n?new LineIntersection(LINE_INTERSECTION_TYPE.LINE,new Point(o,p)):new LineIntersection(LINE_INTERSECTION_TYPE.LINESEG,new Point(o,p))};\n\n  function PointSet(a){var b=this,c=[];this.push=function(a){for(var b=0;b<c.length;b++)if(a.isEqual(c[b]))return !1;return c.push(a),!0},this.pushPointSet=function(a){for(var c=a.toArray(),d=0;d<c.length;d++)b.push(c[d]);},this.findPointClosestTo=function(a){var b=null,d=Number.MAX_SAFE_INTEGER;return c.forEach(function(c){var e=new Line(a,c);e.getLength()<d&&(b=c,d=e.getLength());}),b},this.findDistanceToPointClosestTo=function(a){var b=Number.MAX_SAFE_INTEGER;return c.forEach(function(c){var d=new Line(a,c);d.getLength()<b&&(b=d.getLength());}),b},this.findPointsCloseTo=function(a,b){var d=new PointSet;return c.forEach(function(c){var e=new Line(a,c);e.getLength()<=b&&d.push(c);}),d},this.toArray=function(){return c},this.toFloat64Array=function(){for(var a=new Float64Array(2*c.length),b=0;b<c.length;b++)a[0+2*b]=c[b].getX(),a[1+2*b]=c[b].getY();return a};var d=function fromFloat64Array(a){c.length=0;for(var b=0;b<a.length;b+=2)c.push(new Point(a[b],a[b+1]));};this.count=function(){return c.length},a&&Array.isArray(a)?a.forEach(b.push):a&&\"[object Float64Array]\"===Object.prototype.toString.call(a)&&d(a);}\n\n  function LineSet(a){var b=this,c=[];this.push=function(a){var b=!1;return (c.forEach(function(c){a.isEqual(c)&&(b=!0);}),!b)&&(c.push(a),!0)},this.toArray=function(){return c},this.count=function(){return c.length},this.toFloat64Array=function(){for(var a=new Float64Array(4*c.length),b=0;b<c.length;b++)a[0+4*b]=c[b].getStartPoint().getX(),a[1+4*b]=c[b].getStartPoint().getY(),a[2+4*b]=c[b].getEndPoint().getX(),a[3+4*b]=c[b].getEndPoint().getY();return a};var d=function fromFloat64Array(a){c.length=0;for(var b=0;b<a.length;b+=4)c.push(new Line(new Point(a[b],a[b+1]),new Point(a[b+2],a[b+3])));};a&&Array.isArray(a)?a.forEach(b.push):a&&\"[object Float64Array]\"===Object.prototype.toString.call(a)&&d(a);}\n\n  function PointVisibilityMap(a,b){var c=this,d=b.toArray(),e=a.toArray(),f=Array(a.count()),g=function doesLineIntersectAnyBoundaryLines(a){for(var c,e=0;e<d.length;e++)if(c=d[e].computeIntersectionType(a),c===LINE_INTERSECTION_TYPE.LINESEG)return !0;return !1},h=function computePointsVisibility(){for(var a=0;a<e.length;a++)f[a]=[];for(var b=0;b<e.length;b++)for(var c,d=b+1;d<e.length;d++)c=new Line(e[b],e[d]),g(c)||(f[b].push(d),f[d].push(b));},i=function getVisiblePointsFrom(a){for(var c=0;c<e.length;c++)if(e[c].isEqual(a)){var b=function(){var a=f[c],b=[];return a.forEach(function(a){b.push(e[a]);}),{v:b}}();if(\"object\"==typeof b)return b.v}return []},j=function routeToEndpoint(a,b,c,d){var e=i(c),f=Number.MAX_SAFE_INTEGER,g=null;return e.forEach(function(e){for(var k=0;k<b.length;k++)if(e.isEqual(b[k]))return;var h=new Line(c,e).getLength()+a,j=new Line(e,d).getLength();h+j<f&&(f=h+j,g=e);}),f===Number.MAX_SAFE_INTEGER?null:{cost:f,point:g}},k=function optimizeRoute(a){for(var b=0;!(b+2>=a.length);){var c=new Line(a[b],a[b+2]);g(c)?b++:a.splice(b+1,1);}};this.getPointToVisibleSetData=function(){return f},this.findPointClosestTo=function(a){var b=null,c=Number.MAX_SAFE_INTEGER;return e.forEach(function(d){var e=new Line(a,d);e.getLength()<c&&(b=d,c=e.getLength());}),b},this.findVisiblePointClosestTo=function(a){var b=null,c=Number.MAX_SAFE_INTEGER;return e.forEach(function(d){var e=new Line(a,d),f=e.getLength();f<c&&!g(e)&&(b=d,c=f);}),b},this.computeRoute=function(a,b){if(null===a||null===b)return new PointSet;var d=c.findVisiblePointClosestTo(a);if(null===d)return new PointSet;for(var e,f=0,h=[d],i=d;!0;){if(e=j(f,h,i,b),null===e){var l=new Line(h[h.length-1],b);if(g(l))return new PointSet;break}if(f+=new Line(i,e.point).getLength(),h.push(e.point),i=e.point,1>new Line(i,b).getLength())break}return k(h),new PointSet(h)},h();}\n\n  var SvgPathBuilder={pointToLineTo:function pointToLineTo(a,b){return 0===b?\"M\"+a.getX()+\" \"+a.getY():\"L\"+a.getX()+\" \"+a.getY()},pointTripletToTesselatedCurvePoints:function pointTripletToTesselatedCurvePoints(a,b){if(3!==a.length)throw new Error(\"_points must be array of exactly 3 points\");var c=a[1],d=new Line(a[0],a[1]),e=new Line(a[1],a[2]),f=d.createShortenedLine(0,.5*b),g=e.createShortenedLine(.5*b,0);return [f.getStartPoint(),f.getEndPoint(),g.getStartPoint(),g.getEndPoint()]},pointsToPath:function pointsToPath(a,b){b=b||0;var c=[];if(0<b){for(var h=0;3<=a.length;){var d=a.shift(),e=a.shift(),f=a.shift(),g=SvgPathBuilder.pointTripletToTesselatedCurvePoints([d,e,f],b);a.unshift(g[3]),a.unshift(g[2]);for(var k=0;k<g.length-2;k++)c.push(SvgPathBuilder.pointToLineTo(g[k],h++));}for(;0<a.length;){var j=a.shift();c.push(SvgPathBuilder.pointToLineTo(j,ptIdx++));}}else for(var l,m=0;m<a.length;m++)l=a[m],c.push(SvgPathBuilder.pointToLineTo(l,m));return c.join(\" \")}};\n\n  var computeConnectorPath=function computeConnectorPath(a,b,c){var d=Point.fromArray(a.anchor_start_centroid_arr),e=Point.fromArray(a.anchor_end_centroid_arr),f=a.marker_start_size,g=a.marker_end_size,h=a.curvature_px,i=b.findDistanceToPointClosestTo(d),j=b.findPointsCloseTo(d,i).findPointClosestTo(e),k=b.findPointsCloseTo(e,i).findPointClosestTo(d),l=c.computeRoute(j,k),m=l.toArray(),n=d,o=e;if(0<f&&1<=m.length){var q=new Line(m[0],d).createShortenedLine(0,f);n=q.getEndPoint();}if(0<g&&1<=m.length){var r=new Line(m[m.length-1],e).createShortenedLine(0,g);o=r.getEndPoint();}var p=[n].concat(_toConsumableArray(m),[o]);return {svgPath:SvgPathBuilder.pointsToPath(p,h),pointsInPath:p}},convertArrayBufferToFloat64Array=function convertArrayBufferToFloat64Array(a){return new Float64Array(a)},requestQueue=[],processRequestQueue=function processRequestQueue(){if(0!==requestQueue.length){var a=requestQueue.pop();requestQueue.length=0;var b={overallTime:null},c=new Date,d=a.gridSize,e=a.connectorDescriptors,f=new Date,g=new PointSet(convertArrayBufferToFloat64Array(a.routingPoints)),h=new LineSet(convertArrayBufferToFloat64Array(a.boundaryLines)),i=new PointSet(convertArrayBufferToFloat64Array(a.routingPointsAroundAnchor));b.msgDecodeTime=new Date-f;var j=new Date,k=new PointVisibilityMap(g,h);b.pointVisibilityMapCreationTime=new Date-j,e.forEach(function(a){var b=computeConnectorPath(a,i,k),c=new PointSet(b.pointsInPath);a.svgPath=b.svgPath,a.pointsInPath=c.toFloat64Array().buffer;}),b.numRoutingPoints=g.count(),b.numBoundaryLines=h.count(),b.overallTime=new Date-c,postMessage({pointVisibilityMapData:k.getPointToVisibleSetData(),connectorDescriptors:e,metrics:b});}};setInterval(processRequestQueue,6),onmessage=function onmessage(a){requestQueue.push(a.data);};\n\n}());\n`; export { ConnectorRoutingWorkerJsString }","import {MatrixMath} from './MatrixMath';\r\nimport {CanvasEvent} from './CanvasEvent';\r\nimport {CanvasObject} from './CanvasObject';\r\nimport {ClosestPairFinder as ConnectorAnchorClosestPairFinder} from './ConnectorAnchorFinder/ClosestPairFinder';\r\nimport {Rectangle} from './Rectangle';\r\nimport {Point} from './Point';\r\nimport {Line} from './Line';\r\nimport {PointSet} from './PointSet';\r\nimport {LineSet} from './LineSet';\r\nimport {GroupTransformationContainer} from './GroupTransformationContainer';\r\nimport {Connector} from './Connector';\r\nimport {PointVisibilityMap} from './PointVisibilityMap';\r\nimport {GRID_STYLE, Grid} from './Grid';\r\nimport {GroupTransformationContainerEvent } from './GroupTransformationContainerEvent';\r\nimport {ConnectorRoutingWorkerJsString} from './Workers/ConnectorRoutingWorker.string';\r\n\r\n/**\r\n * @callback HandleCanvasInteractionCallback\r\n * @param {String} interactionType\r\n * @param {Object} interactionData\r\n */ \r\n\r\n /**\r\n * @param {Element} _canvasDomElement \r\n * @param {Window} _window\r\n */\r\nfunction Canvas(_canvasDomElement, _window) {\r\n\r\n    const self = this;\r\n\r\n    // Create container for SVG connectors\r\n    const svgElem = _window.document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\r\n    svgElem.style.width = \"100%\";\r\n    svgElem.style.height = \"100%\";\r\n    const connectorsContainerDomElement = _canvasDomElement.appendChild(svgElem);\r\n\r\n    // Selection box element\r\n    var selectionBoxElem = null;\r\n\r\n    // GroupTransformationContainers\r\n    const groupTransformationContainers = [];\r\n    var currentGroupTransformationContainerBeingDragged = null;\r\n  \r\n    /**\r\n     * @type {Grid}\r\n     */\r\n    var grid = null;\r\n\r\n    var transitionCss = \"transform 0.55s ease-in-out, transform-origin 0.55s ease-in-out\";\r\n\r\n    var transformOriginX = 0;\r\n    var transformOriginY = 0;\r\n\r\n    var touchMoveLastX = 0.0;\r\n    var touchMoveLastY = 0.0;\r\n\r\n    var translateX = 0;\r\n    var translateY = 0;\r\n    var scaleFactor = 1.0;\r\n    var invScaleFactor = 1.0;    \r\n\r\n    const invTransformationMatrixStack = [];\r\n    var currentInvTransformationMatrix = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\r\n    var currentTransformationMatrix = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\r\n\r\n    var currentPointVisiblityMap = null;\r\n\r\n    var connectorRefreshBufferTime = 6.94;\r\n    var useTranslate3d = false; // better performance w/o it\r\n    const canvasObjects = [];\r\n\r\n    /**\r\n     * @type {Connector[]}\r\n     */\r\n    const objectConnectors = [];\r\n\r\n    var objectIdBeingDragged = null;\r\n    var objectIdBeingResized = null;\r\n    \r\n    var objectDragX = 0.0;\r\n    var objectDragY = 0.0;\r\n    var objectDragStartX = 0.0;\r\n    var objectDragStartY = 0.0;\r\n\r\n    var dblTapDetectVars = {\r\n        lastTouchX: null,\r\n        lastTouchY: null,\r\n        lastTouchTime: null\r\n    };\r\n\r\n    var debugPanelElem  = null;\r\n    var isShowingDebugPanel = false;\r\n\r\n    const metrics = {\r\n        connectorRoutingWorker: {\r\n            executionTime: null,\r\n            numRoutingPoints: null,\r\n            numBoundaryLines: null,\r\n            msgDecodeTime: null,\r\n            pointVisibilityMapCreationTime: null\r\n        },\r\n        refreshAllConnectorsInternal: {\r\n            executionTime: null\r\n        },\r\n        connectorsRefreshTime: null\r\n    };\r\n\r\n    var touchHoldDelayTimeMs = 750.0;\r\n    var touchHoldStartInterval = null;\r\n\r\n    var multiObjectSelectionStartX = 0.0;\r\n    var multiObjectSelectionStartY = 0.0;\r\n    var multiObjectSelectionEndX = 0.0;\r\n    var multiObjectSelectionEndY = 0.0;\r\n    var multiObjectSelectionStarted = false;\r\n\r\n    const connectorAnchorsSelected = [];\r\n\r\n    /**\r\n     * Event name -> Callback map\r\n     */\r\n    const eventHandlers = new Map();\r\n\r\n    /**\r\n     * ConnectorAnchor -> Number map\r\n     */\r\n    const connectorAnchorToNumValidRoutingPoints = new Map();\r\n\r\n    var connectorRefreshStartTime = null;\r\n    var connectorRefreshTimeout = null;\r\n\r\n    // Setup ConnectorRoutingWorker\r\n    const workerUrl = URL.createObjectURL(new Blob([ ConnectorRoutingWorkerJsString ]));\r\n    \r\n    /*const connectorCompleteComputeWorker = new Worker(workerUrl);\r\n    connectorCompleteComputeWorker.onmessage = function(_msg) {\r\n\r\n    };*/\r\n\r\n    const connectorRoutingWorker = new Worker(workerUrl);\r\n    connectorRoutingWorker.onmessage = function(_msg) {\r\n        const connectorsRefreshTimeT1 = new Date();\r\n\r\n        const connectorDescriptors = _msg.data.connectorDescriptors;\r\n        const getConnectorDescriptorById = function(_id) {\r\n            for(let i=0; i<connectorDescriptors.length; i++) {\r\n                if(connectorDescriptors[i].id === _id) {\r\n                    return connectorDescriptors[i];\r\n                }\r\n            }\r\n\r\n            return null;\r\n        };\r\n\r\n        objectConnectors.forEach(function(_c) {\r\n            const descriptor = getConnectorDescriptorById(_c.getId());\r\n            if(descriptor) {\r\n                const ps = new PointSet(new Float64Array(descriptor.pointsInPath));\r\n                _c.refresh(descriptor.svgPath, ps.toArray());\r\n                emitEvent(CanvasEvent.CONNECTOR_UPDATED, { 'connector': _c });\r\n            }\r\n        });        \r\n\r\n        metrics.connectorsRefreshTime = (new Date()) - connectorsRefreshTimeT1;\r\n\r\n        metrics.connectorRoutingWorker.executionTime = _msg.data.metrics.overallTime;\r\n        metrics.connectorRoutingWorker.numBoundaryLines = _msg.data.metrics.numBoundaryLines;\r\n        metrics.connectorRoutingWorker.numRoutingPoints = _msg.data.metrics.numRoutingPoints;\r\n        metrics.connectorRoutingWorker.msgDecodeTime = _msg.data.metrics.msgDecodeTime;\r\n        metrics.connectorRoutingWorker.pointVisibilityMapCreationTime = _msg.data.metrics.pointVisibilityMapCreationTime;\r\n\r\n        refreshDebugMetricsPanel();\r\n    };    \r\n\r\n    /**\r\n     * @returns {PointVisibilityMap}\r\n     */\r\n    this.getCurrentPointVisibilityMap = function() {\r\n        return currentPointVisiblityMap;\r\n    };\r\n\r\n    /**\r\n     * @param {Grid} _grid\r\n     */\r\n    this.setGrid = function(_grid) {\r\n        grid = _grid;\r\n        _canvasDomElement.style.backgroundImage = \"url('data:image/svg+xml;base64,\" + _window.btoa(grid.getSvgImageTile()) + \"')\";\r\n        _canvasDomElement.style.backgroundRepeat = \"repeat\";\r\n        _canvasDomElement.style.backgroundColor = \"#fff\";\r\n    };\r\n\r\n    /**\r\n     * @returns {Grid}\r\n     */\r\n    this.getGrid = function() {\r\n        return grid;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getGridSize = function() {\r\n        return grid.getSize();\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {CanvasObject[]} _objs \r\n     * @returns {Point[]}\r\n     */\r\n    const getAccessibleRoutingPointsFromObjectAnchors = function(_objs) {\r\n\r\n        connectorAnchorToNumValidRoutingPoints.clear();\r\n\r\n        const allRoutingPoints = [];\r\n        const filteredRoutingPoints = [];\r\n\r\n        _objs.forEach((_o) => {\r\n            const anchors = _o.getConnectorAnchors();\r\n\r\n            anchors.forEach((_a) => {\r\n                const routingPoints = _a.getRoutingPoints(self.getGridSize());\r\n                routingPoints.forEach((_rp) => {\r\n                    allRoutingPoints.push(\r\n                        {\r\n                            \"routingPoint\": _rp,\r\n                            \"parentAnchor\": _a\r\n                        }\r\n                    );\r\n                });      \r\n\r\n                connectorAnchorToNumValidRoutingPoints.set(_a.getId(), routingPoints.length);\r\n            });\r\n\r\n        });\r\n\r\n\r\n        allRoutingPoints.forEach((_rp) => {\r\n\r\n            let isPointWithinObj = false;\r\n\r\n            for(let i=0; i<_objs.length; i++) {\r\n                const obj = _objs[i];\r\n                const boundingRect = obj.getBoundingRectange();\r\n                if(boundingRect.checkIsPointWithin(_rp.routingPoint)) {\r\n                    isPointWithinObj = true;\r\n\r\n                    const currentNumRoutingPoints = connectorAnchorToNumValidRoutingPoints.get(_rp.parentAnchor.getId()) || 0;\r\n                    connectorAnchorToNumValidRoutingPoints.set(_rp.parentAnchor.getId(), currentNumRoutingPoints - 1);\r\n                }\r\n            }\r\n\r\n            if(!isPointWithinObj) {\r\n                filteredRoutingPoints.push(_rp.routingPoint);\r\n            }\r\n            \r\n        });\r\n\r\n        return filteredRoutingPoints;\r\n    };\r\n\r\n    /**\r\n     * @returns {PointSet}\r\n     */\r\n    const getObjectExtentRoutingPoints = function() {\r\n        const pointSet = new PointSet();\r\n        canvasObjects.forEach(function(_obj) {\r\n            const scaledPoints = _obj.getBoundingRectange().getPointsScaledToGrid(self.getGridSize());\r\n            scaledPoints.forEach((_sp) => {\r\n                pointSet.push(_sp);\r\n            });\r\n        });\r\n\r\n        return pointSet;\r\n    };\r\n\r\n    /**\r\n     * @returns {PointSet}\r\n     */    \r\n    const getConnectorRoutingPointsAroundAnchor = function() {\r\n        const pointSet = new PointSet();\r\n        \r\n        const routingPoints = getAccessibleRoutingPointsFromObjectAnchors(canvasObjects);\r\n        routingPoints.forEach((_rp) => {\r\n            pointSet.push(_rp);\r\n        });\r\n\r\n        return pointSet;\r\n    };\r\n\r\n    /**\r\n     * @returns {Line[]}\r\n     */    \r\n    const getConnectorBoundaryLines = function() {\r\n        const boundaryLines = [];\r\n        canvasObjects.forEach(function(_obj) {\r\n            const lines = _obj.getBoundingRectange().getLines();\r\n            lines.forEach((_l) => {\r\n                boundaryLines.push(_l);\r\n            });\r\n\r\n            const anchors = _obj.getConnectorAnchors();\r\n            anchors.forEach(function(_anchor) {\r\n                const lines = _anchor.getBoundingRectange().getLines();\r\n                lines.forEach((_l) => {\r\n                    boundaryLines.push(_l);\r\n                });                \r\n            });\r\n        });\r\n\r\n        return new LineSet(boundaryLines);\r\n    };    \r\n\r\n    const refreshAllConnectorsInternal = function() {\r\n        const executionTimeT1 = new Date();\r\n        const connectorDescriptors = [];\r\n        objectConnectors.forEach(function(_c) {\r\n            connectorDescriptors.push(_c.getDescriptor());\r\n        });\r\n\r\n        const routingPointsAroundAnchor = getConnectorRoutingPointsAroundAnchor();\r\n        const objectExtentRoutingPoints = getObjectExtentRoutingPoints();\r\n\r\n        const allRoutingPoints = new PointSet();        \r\n        allRoutingPoints.pushPointSet(routingPointsAroundAnchor);\r\n        allRoutingPoints.pushPointSet(objectExtentRoutingPoints);\r\n\r\n        const routingPointsAroundAnchorFloat64Array = routingPointsAroundAnchor.toFloat64Array();\r\n        const routingPointsFloat64Array = allRoutingPoints.toFloat64Array();\r\n        const boundaryLinesFloat64Array = (getConnectorBoundaryLines()).toFloat64Array();\r\n        connectorRoutingWorker.postMessage(\r\n            {\r\n                \"gridSize\": self.getGridSize(),\r\n                \"connectorDescriptors\": connectorDescriptors,\r\n                \"routingPoints\": routingPointsFloat64Array.buffer,\r\n                \"boundaryLines\": boundaryLinesFloat64Array.buffer,\r\n                \"routingPointsAroundAnchor\": routingPointsAroundAnchorFloat64Array.buffer\r\n            },\r\n            [\r\n                routingPointsFloat64Array.buffer,\r\n                boundaryLinesFloat64Array.buffer,\r\n                routingPointsAroundAnchorFloat64Array.buffer\r\n            ]\r\n        );\r\n\r\n        metrics.refreshAllConnectorsInternal.executionTime = (new Date()) - executionTimeT1;\r\n    };\r\n\r\n    /**\r\n     * @param {Number} _bufferTimeMs\r\n     */\r\n    this.setConnectorRefreshBufferTime = function(_bufferTimeMs) {\r\n        connectorRefreshBufferTime = _bufferTimeMs;\r\n    };\r\n\r\n    this.refreshAllConnectors = function() {\r\n        // We'll try to coalesce refresh calls within refreshBatchBufferTimeMs \r\n        // Default is 6.944ms, for continuous calls, this corresponds to 144Hz, but actual\r\n        // performance is less given web worker overhead, path computation cost, and browser minimum limit on setTimeout\r\n\r\n        if(connectorRefreshStartTime !== null) {\r\n            const tdelta = (new Date()) - connectorRefreshStartTime;\r\n            if(tdelta < connectorRefreshBufferTime) {\r\n                return; // already scheduled\r\n            }\r\n        }\r\n\r\n        connectorRefreshStartTime = new Date();        \r\n        connectorRefreshTimeout = setTimeout(function() {\r\n            connectorRefreshTimeout = null;\r\n            connectorRefreshStartTime = null;\r\n            refreshAllConnectorsInternal();\r\n        }, connectorRefreshBufferTime);\r\n    };\r\n\r\n    var makeNewConnector = function(_anchorStart, _anchorEnd, _containerDomElement) {\r\n        return new Connector(_anchorStart, _anchorEnd, _containerDomElement);\r\n    };\r\n\r\n    /**\r\n     * @callback ConnectorFactory\r\n     * @param {ConnectorAnchor} _anchorStart\r\n     * @param {ConnectorAnchor} _anchorEnd\r\n     * @param {Element} _containerDomElement\r\n     */\r\n\r\n    /**\r\n     * @param {ConnectorFactory} _connectorFactory\r\n     */\r\n    this.setConnectorFactory = function(_newConnectorFactory) {\r\n        makeNewConnector = _newConnectorFactory;\r\n    };    \r\n\r\n\r\n    /**\r\n     * @returns {String}\r\n     */\r\n    this.getTransitionCss = function() {\r\n        return transitionCss;\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {String} _css \r\n     */\r\n    this.setTransitionCss = function(_css) {\r\n        transitionCss = _css;\r\n        _canvasDomElement.style.transition = transitionCss;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */    \r\n    this.getTransformOriginX = function() {\r\n        return transformOriginX;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */    \r\n    this.getTransformOriginY = function() {\r\n        return transformOriginY;\r\n    };    \r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getScaleFactor = function() {\r\n        return scaleFactor;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getTranslateX = function() {\r\n        return translateX;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */    \r\n    this.getTranslateY = function() {\r\n        return translateY;\r\n    };    \r\n\r\n    /**\r\n     * \r\n     * @param {Number} _x \r\n     * @param {Number} _y \r\n     */\r\n    this.setTransformOrigin = function(_x, _y) {\r\n        transformOriginX = _x;\r\n        transformOriginY = _y;\r\n        _canvasDomElement.style.transformOrigin = `${transformOriginX}px ${transformOriginY}px`;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Number} _scaleFactor \r\n     * @param {Boolean} _adjustFactorToPreserveIntegerGrid \r\n     */\r\n    this.scale = function(_scaleFactor, _adjustFactorToPreserveIntegerGrid) {\r\n        _adjustFactorToPreserveIntegerGrid = _adjustFactorToPreserveIntegerGrid || false;\r\n\r\n        if(_adjustFactorToPreserveIntegerGrid) {\r\n            const newGridSize = self.getGridSize() * _scaleFactor;\r\n            const roundedGridSize = Math.round(newGridSize);\r\n            _scaleFactor = roundedGridSize / self.getGridSize();\r\n        }\r\n\r\n        scaleFactor = _scaleFactor;\r\n        invScaleFactor = 1.0 / scaleFactor;        \r\n\r\n        const scaleMat = \r\n            [\r\n                scaleFactor, 0, 0, 0, \r\n                0, scaleFactor, 0, 0, \r\n                0, 0, scaleFactor, 1, \r\n                0, 0, 0, 1\r\n            ];\r\n\r\n        currentTransformationMatrix = MatrixMath.mat4Multiply(\r\n            currentTransformationMatrix, \r\n            scaleMat\r\n        );\r\n\r\n        invTransformationMatrixStack.push(\r\n            [\r\n                invScaleFactor, 0, 0, 0, \r\n                0, invScaleFactor, 0, 0, \r\n                0, 0, invScaleFactor, 1, \r\n                0, 0, 0, 1\r\n            ]\r\n        );\r\n\r\n        return self;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Number} _x \r\n     * @param {Number} _y \r\n     */\r\n    this.translate = function(_x, _y) {\r\n        translateX = _x;\r\n        translateY = _y;\r\n\r\n        const translateMatrix =             \r\n            [\r\n                1, 0, 0, 0, \r\n                0, 1, 0, 0, \r\n                0, 0, 1, 0, \r\n                translateX, translateY, 0, 1\r\n            ];\r\n\r\n        currentTransformationMatrix = MatrixMath.mat4Multiply(\r\n            currentTransformationMatrix, \r\n            translateMatrix\r\n        ); \r\n\r\n        invTransformationMatrixStack.push(\r\n            [\r\n                1, 0, 0, -translateX, \r\n                0, 1, 0, -translateY, \r\n                0, 0, 1, 0, \r\n                0, 0, 0, 1\r\n            ]\r\n        );\r\n\r\n        return self;\r\n    };\r\n\r\n    this.applyTransform = function() {\r\n        _canvasDomElement.style.transform = self.getTranformMatrixCss();\r\n        currentInvTransformationMatrix = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\r\n        for(let i=0; i<invTransformationMatrixStack.length; i++) {\r\n            currentInvTransformationMatrix = MatrixMath.mat4Multiply(currentInvTransformationMatrix, invTransformationMatrixStack[i]);\r\n        }\r\n    };\r\n\r\n    /**\r\n     * @returns {Array}\r\n     */\r\n    this.getTransformMatrix = function() {\r\n        return currentTransformationMatrix;\r\n    };\r\n\r\n    /**\r\n     * @returns {String}\r\n     */    \r\n    this.getTranformMatrixCss = function() {\r\n        const matElems = currentTransformationMatrix.join(\",\");\r\n        return `matrix3d(${matElems})`;\r\n    };\r\n\r\n    this.resetTransform = function() {\r\n        scaleFactor = 1.0;\r\n        invScaleFactor = 1.0;\r\n        translateX = 0.0;\r\n        translateY = 0.0;\r\n        currentTransformationMatrix = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\r\n        currentInvTransformationMatrix = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\r\n        invTransformationMatrixStack.length = 0;\r\n        _canvasDomElement.style.transform = \"none\";\r\n    };\r\n\r\n    /**\r\n     * @returns {Point}\r\n     */\r\n    this.getPageOffset = function() {\r\n        return new Point(window.pageXOffset, window.pageYOffset);\r\n    };\r\n\r\n    /**\r\n     * @param {Number} _p \r\n     * @returns {Number}\r\n     */\r\n    this.snapToGrid = function(_p) {\r\n        var ret = Math.round(_p/self.getGridSize()) * self.getGridSize();\r\n        return Math.max(0, ret - 1);\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getOffsetLeft = function() {\r\n        return _canvasDomElement.offsetLeft;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getOffsetTop = function() {\r\n        return _canvasDomElement.offsetTop;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getWidth = function() {\r\n        return _canvasDomElement.offsetWidth;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getHeight = function() {\r\n        return _canvasDomElement.offsetHeight;\r\n    };\r\n\r\n    /**\r\n     * @param {Object[]} _objs \r\n     * @returns {Rectangle}\r\n     */\r\n    this.calcBoundingRectForObjects = function(_objs) {\r\n        var minTop = null;\r\n        var minLeft = null;\r\n        var maxBottom = null;\r\n        var maxRight = null;\r\n\r\n        _objs.forEach(function(_obj, index, array) {\r\n            const objRect = _obj.getBoundingRectange();\r\n            const left = objRect.getLeft();\r\n            const top = objRect.getTop();  \r\n            const right = objRect.getRight();\r\n            const bottom = objRect.getBottom();\r\n\r\n            if(minLeft === null || left < minLeft) {\r\n                minLeft = left;\r\n            }\r\n\r\n            if(minTop === null || top < minTop) {\r\n                minTop = top;\r\n            }\r\n\r\n            if(maxBottom === null || bottom > maxBottom) {\r\n                maxBottom = bottom;\r\n            }        \r\n\r\n            if(maxRight === null || right > maxRight) {\r\n                maxRight = right;\r\n            }\r\n        });\r\n\r\n        if(minTop === null || minLeft === null || maxBottom === null || maxRight === null) {\r\n            minTop = 0;\r\n            minLeft = 0;\r\n            maxBottom = 0;\r\n            maxRight = 0;            \r\n        }\r\n\r\n        return new Rectangle(minLeft, minTop, maxRight, maxBottom);\r\n    };\r\n\r\n    /**\r\n     * @returns {Rectangle}\r\n     */\r\n    this.calcBoundingBox = function() {\r\n        if(canvasObjects.length === 0) {    \r\n            return new Rectangle(0, 0, self.getWidth(), self.getHeight());     \r\n        }\r\n\r\n        return self.calcBoundingRectForObjects(canvasObjects);\r\n    };\r\n\r\n    /**\r\n     * @param {Number} _x\r\n     * @param {Number} _y\r\n     * @param {Number} _radius\r\n     * @returns {CanvasObject[]}\r\n     */\r\n    this.getObjectsAroundPoint = function(_x, _y, _radius) {\r\n\r\n        _radius = _radius || 1.0;\r\n\r\n        const result = [];\r\n\r\n        const ptRect = new Rectangle(\r\n            _x - _radius, \r\n            _y - _radius, \r\n            _x + _radius, \r\n            _y + _radius\r\n        );\r\n\r\n        canvasObjects.forEach(function(_obj) {\r\n            if(ptRect.checkIntersect(_obj.getBoundingRectange())) {\r\n                result.push(_obj);\r\n            }\r\n        });\r\n\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * @param {Rectangle} _rect\r\n     * @returns {CanvasObject[]}\r\n     */\r\n    this.getObjectsWithinRect = function(_rect) {\r\n        const result = [];\r\n\r\n        canvasObjects.forEach(function(_obj) {\r\n            if(_obj.getBoundingRectange().checkIsWithin(_rect)) {\r\n                result.push(_obj);\r\n            }\r\n        });\r\n\r\n        return result;\r\n    };    \r\n      \r\n    /**\r\n     * @returns {CanvasObject[]}\r\n     */\r\n    this.getAllObjects = function() {    \r\n        return canvasObjects;\r\n    };\r\n\r\n    /**\r\n     * Helper method to publish an object change to all objects\r\n     * \r\n     * @param {String} _eventName\r\n     * @param {*} _eventData\r\n     */\r\n    this.publishSiblingObjectChange = function(_eventName, _eventData) {\r\n        canvasObjects.forEach(function(_obj) {\r\n            _obj.handleSiblingObjectChange(_eventName, _eventData);\r\n        });\r\n    };\r\n\r\n    /**\r\n     * @param {String} _id\r\n     * @returns {CanvasObject|null}\r\n     */   \r\n    this.getObjectById = function(_id) {\r\n        var foundObject = null;\r\n        canvasObjects.forEach(function(obj, index, array) {\r\n            if(foundObject === null && obj.getId() === _id) {\r\n                foundObject = obj;\r\n            }            \r\n        });\r\n        \r\n        return foundObject;\r\n    };\r\n\r\n    /**\r\n     * @param {CanvasObject} _obj\r\n     */\r\n    this.addObject = function(_obj) {\r\n        _obj.on('obj-resize-start', handleResizeStart);\r\n        _obj.on('obj-resize', function(e) {\r\n            emitEvent(CanvasEvent.OBJECT_RESIZED, { 'object': e.obj });\r\n            self.refreshAllConnectors();    \r\n        });\r\n\r\n        _obj.on('obj-translate-start', handleMoveStart);\r\n        _obj.on('obj-translate', function(e) {\r\n            emitEvent(CanvasEvent.OBJECT_TRANSLATED, { 'object': e.obj });\r\n            self.refreshAllConnectors();    \r\n        });\r\n\r\n        canvasObjects.push(_obj);\r\n        self.refreshAllConnectors();       \r\n\r\n        emitEvent(CanvasEvent.OBJECT_ADDED, { \"object\":_obj });\r\n    };\r\n\r\n    /**\r\n     * Remove object from the canvas\r\n     * Note: as caller is responsible for putting object into the DOM, caller is responsible for removing it from the DOM\r\n     * \r\n     * @param {String} _objId\r\n     * @returns {Boolean} \r\n     */\r\n    this.removeObject = function(_objId) {\r\n        for(let i=0; i<canvasObjects.length; i++) {\r\n            if(canvasObjects[i].getId() === _objId) {\r\n                canvasObjects.splice(i, 1);\r\n                self.refreshAllConnectors();\r\n                emitEvent(CanvasEvent.OBJECT_REMOVED, { \"object\":canvasObjects[i] });\r\n                return true;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    };\r\n\r\n    /**\r\n     * @param {String} _id\r\n     * @returns {Connector|null}\r\n     */    \r\n    this.getConnector = function(_id) {\r\n        for(let c=0; c<objectConnectors.length; c++) {\r\n            if(objectConnectors[c].getId() === _id) {\r\n                return objectConnectors[c];\r\n            }\r\n        }\r\n\r\n        return null;\r\n    };\r\n\r\n    /**\r\n     * @returns {Connector[]}\r\n     */\r\n    this.getAllConnectors = function() {\r\n        return objectConnectors;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {CanvasObject} _objA \r\n     * @param {CanvasObject} _objB \r\n     * @returns {Connector[]}\r\n     */\r\n    this.getConnectorsBetweenObjects = function(_objA, _objB) {\r\n\r\n        const foundConnectors = [];\r\n\r\n        objectConnectors.forEach((_conn) => {\r\n            const aS = _conn.getAnchorStart();\r\n            const aE = _conn.getAnchorEnd();\r\n\r\n            if(_objA.hasConnectorAnchor(aS) && _objB.hasConnectorAnchor(aE)) {\r\n                foundConnectors.push(_conn);\r\n            }\r\n\r\n            if(_objA.hasConnectorAnchor(aE) && _objB.hasConnectorAnchor(aS)) {\r\n                foundConnectors.push(_conn);\r\n            }            \r\n        });\r\n\r\n        return foundConnectors;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {String} _connectorId\r\n     * @returns {Array} \r\n     */\r\n    this.getObjectsConnectedViaConnector = function(_connectorId) {\r\n        const foundObjects = [];\r\n\r\n        const allObjs = self.getAllObjects();\r\n\r\n        objectConnectors.forEach((_conn) => {\r\n\r\n            if(_conn.getId() !== _connectorId) {\r\n                return;\r\n            }\r\n\r\n            const aS = _conn.getAnchorStart();\r\n            const aE = _conn.getAnchorEnd();\r\n\r\n            allObjs.forEach((_o) => {\r\n                if(_o.hasConnectorAnchor(aS) || _o.hasConnectorAnchor(aE)) {\r\n                    foundObjects.push(_o);\r\n                }\r\n            });\r\n\r\n        });\r\n\r\n        return foundObjects;        \r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {CanvasObject} _obj\r\n     * @returns {Connector[]} \r\n     */\r\n    this.getConnectorsConnectedToObject = function(_obj) {\r\n        const foundConnectors = [];\r\n\r\n        objectConnectors.forEach((_conn) => {\r\n            const aS = _conn.getAnchorStart();\r\n            const aE = _conn.getAnchorEnd();\r\n\r\n            if(_obj.hasConnectorAnchor(aS) || _obj.hasConnectorAnchor(aE)) {\r\n                foundConnectors.push(_conn);\r\n            }\r\n\r\n        });\r\n\r\n        return foundConnectors;        \r\n    };\r\n\r\n    /**\r\n     * @param {String} _connectorAnchorId\r\n     * @returns {Object|null} \r\n     */\r\n    this.getObjectWithConnectorAnchor = function(_connectorAnchorId) {\r\n        const allObjects = self.getAllObjects();\r\n        for(let i=0; i<allObjects.length; i++) {                \r\n            const anchors = allObjects[i].getConnectorAnchors();\r\n            for(let j=0; j<anchors.length; j++) {\r\n                if(anchors[j].getId() === _connectorAnchorId) {\r\n                    return allObjects[i];\r\n                }\r\n            }\r\n        }\r\n\r\n        return null;\r\n    };    \r\n\r\n    this.removeAllConnectors = function() {\r\n        objectConnectors.forEach(function(_conn) {\r\n            _conn.removePathElement();\r\n        });\r\n\r\n        objectConnectors.splice(0, objectConnectors.length);\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Connector} _connector\r\n     * @returns {Boolean}\r\n     */\r\n    this.removeConnector = function(_connector) {\r\n        for(let i=0; i<objectConnectors.length; i++) {\r\n            if(objectConnectors[i] === _connector) {\r\n                _connector.removePathElement();\r\n                objectConnectors.splice(i, 1);\r\n                return true;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {ConnectorAnchor} _anchorA \r\n     * @param {ConnectorAnchor} _anchorB \r\n     * @returns {Connector}\r\n     */\r\n    this.makeNewConnectorFromAnchors = function(_anchorA, _anchorB) {\r\n        const newConnector = makeNewConnector(_anchorA, _anchorB, connectorsContainerDomElement);\r\n        const foundConnector = self.getConnector(newConnector.getId());\r\n\r\n        if(foundConnector === null) {\r\n            objectConnectors.push(newConnector);\r\n            newConnector.appendPathToContainerDomElement();\r\n            self.refreshAllConnectors();\r\n            return newConnector;\r\n        }\r\n\r\n        return foundConnector;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Object} _objA \r\n     * @param {Object} _objB\r\n     * @returns {Object} \r\n     */\r\n    this.findBestConnectorAnchorsToConnectObjects = function(_objA, _objB, _onFound) {\r\n        const searchFunc = (_searchData) => {\r\n            // !!! Note that a Canvas.getAccessibleRoutingPointsFromObjectAnchors() call must precede in order for connectorAnchorToNumValidRoutingPoints map to be populated and up-to-date\r\n            getAccessibleRoutingPointsFromObjectAnchors([_objA, _objB]);\r\n\r\n            const result = ConnectorAnchorClosestPairFinder.findClosestPairBetweenObjects(_searchData.objectA, _searchData.objectB, connectorAnchorToNumValidRoutingPoints);\r\n    \r\n            _searchData.cb(result);\r\n        };\r\n\r\n        setTimeout(function() {\r\n            searchFunc(\r\n                {\r\n                    \"objectA\": _objA,\r\n                    \"objectB\": _objB,\r\n                    \"cb\": _onFound\r\n                }\r\n            );\r\n        }, connectorRefreshBufferTime);\r\n    };\r\n\r\n    /**\r\n     * @param {ConnectorAnchor} _anchor\r\n     */\r\n    this.addConnectionAnchorToSelectionStack = function(_anchor) {\r\n        connectorAnchorsSelected.push(_anchor);\r\n\r\n        if(connectorAnchorsSelected.length === 2) {\r\n            self.makeNewConnectorFromAnchors(connectorAnchorsSelected[0], connectorAnchorsSelected[1]);\r\n            connectorAnchorsSelected.length = 0;\r\n        }\r\n    };\r\n\r\n    /**\r\n     * @param {Number} _posX \r\n     * @param {Number} _posY \r\n     */\r\n    const dblClickTapHandler = function(_posX, _posY) {\r\n        const objectsAroundPoint = self.getObjectsAroundPoint(_posX, _posY);\r\n\r\n        const eventData = {\r\n            'targetPoint': new Point(_posX, _posY),\r\n            'objectsAroundPoint': objectsAroundPoint\r\n        };\r\n\r\n        emitEvent(CanvasEvent.DBLCLICK, eventData);\r\n    };\r\n\r\n    const refreshDebugMetricsPanel = function() {\r\n        if(!isShowingDebugPanel) {\r\n            return;\r\n        }\r\n\r\n        debugPanelElem.innerHTML = `\r\n            <p>refreshAllConnectorsInternal.executionTime = ${metrics.refreshAllConnectorsInternal.executionTime}</p>\r\n            <p>connectorRoutingWorker.executionTime = ${metrics.connectorRoutingWorker.executionTime}</p>            \r\n            <p>-- connectorRoutingWorker.msgDecodeTime = ${metrics.connectorRoutingWorker.msgDecodeTime}</p>\r\n            <p>-- connectorRoutingWorker.pointVisibilityMapCreationTime = ${metrics.connectorRoutingWorker.pointVisibilityMapCreationTime}</p>\r\n            <p>-- connectorRoutingWorker.numRoutingPoints = ${metrics.connectorRoutingWorker.numRoutingPoints}</p>\r\n            <p>-- connectorRoutingWorker.numBoundaryLines = ${metrics.connectorRoutingWorker.numBoundaryLines}</p>\r\n            <p>connectorsRefreshTime = ${metrics.connectorsRefreshTime}</p>\r\n        `;\r\n    };\r\n\r\n    this.initDebugMetricsPanel = function() {\r\n        debugPanelElem = _window.document.createElement(\"div\");\r\n        debugPanelElem.classList.add(\"graphpaper-debug-panel\");\r\n        debugPanelElem.style.display = \"block\";\r\n        debugPanelElem.style.position = \"fixed\";\r\n        debugPanelElem.style.right = \"0px\";\r\n        debugPanelElem.style.top = \"0px\";\r\n        debugPanelElem.style.width = \"450px\";\r\n        debugPanelElem.style.height = \"200px\";\r\n        debugPanelElem.style.color = \"#fff\";\r\n        debugPanelElem.style.padding = \"15px\";\r\n        debugPanelElem.style.backgroundColor = \"rgba(0,0,0,0.75)\";\r\n        document.body.appendChild(debugPanelElem);\r\n\r\n        isShowingDebugPanel = true;\r\n    };\r\n\r\n    /**\r\n     * @param {Number} _dblTapSpeed\r\n     * @param {Number} _dblTapRadius\r\n     */\r\n    this.initInteractionHandlers = function(_dblTapSpeed, _dblTapRadius) {\r\n\r\n        // dblclick on empty area of canvas\r\n        _canvasDomElement.addEventListener('dblclick', function (e) {\r\n\r\n            const invTransformedPos = MatrixMath.vecMat4Multiply(\r\n                [e.pageX, e.pageY, 0, 1],\r\n                currentInvTransformationMatrix\r\n            );\r\n\r\n            dblClickTapHandler(invTransformedPos[0], invTransformedPos[1]);\r\n        });\r\n\r\n        // click anywhere on canvas\r\n        _canvasDomElement.addEventListener('click', function (e) {\r\n            let canvasObjectClicked = false;\r\n            if(e.target !== _canvasDomElement) {\r\n                canvasObjectClicked = true;\r\n            }\r\n\r\n            const invTransformedPos = MatrixMath.vecMat4Multiply(\r\n                [e.pageX, e.pageY, 0, 1],\r\n                currentInvTransformationMatrix\r\n            );\r\n\r\n            const eventData = {\r\n                'targetPoint': new Point(invTransformedPos[0], invTransformedPos[1]),\r\n                'canvasObjectClicked': canvasObjectClicked\r\n            };\r\n    \r\n            emitEvent(CanvasEvent.CLICK, eventData);\r\n        });\r\n\r\n        // touchend on canvas, logic to see if there was a double-tap\r\n        _canvasDomElement.addEventListener('touchend', function(e) {\r\n            if(e.changedTouches.length <= 0) {\r\n                return false; // we have nothing to work with\r\n            }\r\n\r\n            var dblTapDetected = false;  // flag specifying if we detected a double-tap\r\n\r\n            // Position of the touch\r\n            const invTransformedPos = MatrixMath.vecMat4Multiply(\r\n                [e.changedTouches[0].pageX, e.changedTouches[0].pageY, 0, 1],\r\n                currentInvTransformationMatrix\r\n            );            \r\n\r\n            var x = invTransformedPos[0];\r\n            var y = invTransformedPos[1];            \r\n\r\n            var now = new Date().getTime();\r\n\r\n            // Check if we have stored data for a previous touch (indicating we should test for a double-tap)\r\n            if(dblTapDetectVars.lastTouchTime !== null) {\r\n\r\n                var lastTouchTime = dblTapDetectVars.lastTouchTime;\r\n\r\n                // Compute time since the previous touch\r\n                var timeSinceLastTouch = now - lastTouchTime;\r\n\r\n                // Get the position of the last touch on the element\r\n                var lastX = dblTapDetectVars.lastTouchX;\r\n                var lastY = dblTapDetectVars.lastTouchY;\r\n\r\n                // Compute the distance from the last touch on the element\r\n                var distFromLastTouch = Math.sqrt( Math.pow(x-lastX,2) + Math.pow(y-lastY,2) );\r\n\r\n                if(timeSinceLastTouch <= _dblTapSpeed && distFromLastTouch <= _dblTapRadius) {\r\n                    // Flag that we detected a double tap\r\n                    dblTapDetected = true;\r\n\r\n                    // Call handler\r\n                    dblClickTapHandler(x, y);\r\n\r\n                    // Remove last touch info from element\r\n                    dblTapDetectVars.lastTouchTime = null;\r\n                    dblTapDetectVars.lastTouchX = null;\r\n                    dblTapDetectVars.lastTouchY = null;\r\n                }\r\n            }\r\n\r\n            if(!dblTapDetected) {\r\n                dblTapDetectVars.lastTouchTime = now;\r\n                dblTapDetectVars.lastTouchX = x;\r\n                dblTapDetectVars.lastTouchY = y;\r\n            }\r\n        });\r\n    };\r\n\r\n    /**\r\n     * @param {GroupTransformationContainer} _groupTransformationContainer\r\n     */\r\n    this.attachGroupTransformationContainer = function(_groupTransformationContainer) {\r\n        _canvasDomElement.appendChild(_groupTransformationContainer.getContainerDomElement());\r\n        groupTransformationContainers.push(_groupTransformationContainer);\r\n\r\n        _groupTransformationContainer.on(GroupTransformationContainerEvent.TRANSLATE_START, function(e) {\r\n            currentGroupTransformationContainerBeingDragged = e.container;\r\n        });\r\n    };\r\n\r\n    /**\r\n     * @param {GroupTransformationContainer} _groupTransformationContainer\r\n     * @returns {Boolean}\r\n     */\r\n    this.detachGroupTransformationContainer = function(_groupTransformationContainer) {\r\n        for(let i=0; i<groupTransformationContainers.length; i++) {\r\n            if(groupTransformationContainers[i] === _groupTransformationContainer) {\r\n                _canvasDomElement.removeChild(_groupTransformationContainer.getContainerDomElement());\r\n                groupTransformationContainers.splice(i, 1);\r\n                return true;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Number} _dx \r\n     * @param {Number} _dy \r\n     */\r\n    const handleGroupTransformationContainerMove = function(_dx, _dy) {\r\n        const gtc = currentGroupTransformationContainerBeingDragged;        \r\n        gtc.translateByOffset(_dx, _dy);\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Object} _e \r\n     */\r\n    const handleResizeStart = function(_e) {       \r\n        objectIdBeingResized = _e.obj.getId();\r\n    };    \r\n\r\n    /**\r\n     * \r\n     * @param {Object} _e\r\n     */\r\n    const handleMoveStart = function(_e) {     \r\n        objectIdBeingDragged = _e.obj.getId();\r\n        objectDragX = _e.x;\r\n        objectDragY = _e.y;\r\n        objectDragStartX = _e.x;\r\n        objectDragStartY = _e.y;        \r\n    };    \r\n\r\n    /**\r\n     * \r\n     * @param {Number} _x \r\n     * @param {Number} _y \r\n     */\r\n    const handleMove = function(_x, _y) {\r\n        const obj = self.getObjectById(objectIdBeingDragged);\r\n        const translateOffset = obj.getTranslateHandleOffset();\r\n        const mx = self.snapToGrid(_x + translateOffset.getX());\r\n        const my = self.snapToGrid(_y + translateOffset.getY());\r\n        \r\n        objectDragX = mx;\r\n        objectDragY = my;\t\t\r\n\r\n        obj.translate(mx, my);\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Number} _x \r\n     * @param {Number} _y \r\n     */\r\n    const handleMoveEnd = function(_x, _y) {\r\n        const obj = self.getObjectById(objectIdBeingDragged);\r\n        const translateOffset = obj.getTranslateHandleOffset();\r\n        const mx = self.snapToGrid(_x + translateOffset.getX());\r\n        const my = self.snapToGrid(_y + translateOffset.getY());\r\n        obj.translate(mx, my);       \r\n    };         \r\n\r\n    /**\r\n     * \r\n     * @param {Number} _x \r\n     * @param {Number} _y \r\n     */    \r\n    const handleResize = function(_x, _y) {\r\n        const obj = self.getObjectById(objectIdBeingResized);\r\n\r\n        const mx = self.snapToGrid(_x);\r\n        const my = self.snapToGrid(_y);\r\n\r\n        const top = obj.getY();\r\n        const left = obj.getX();\r\n        const newWidth = ((mx - left)+1);\r\n        const newHeight = ((my - top)+1);\r\n\r\n        obj.resize(newWidth, newHeight);\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Number} _x \r\n     * @param {Number} _y \r\n     * @param {Element} _targetElem \r\n     * @returns {Boolean}\r\n     */\r\n    const handleMultiObjectSelectionStart = function(_x, _y, _targetElem) {\r\n        if(multiObjectSelectionStarted) {\r\n            return false; // already doing selection\r\n        }\r\n\r\n        if(_targetElem !== svgElem) { // hacky, but b/c of the SVG overlay, events propagate from the overlay\r\n            return false;\r\n        }\r\n\r\n        if(objectIdBeingDragged !== null) {\r\n            return false;\r\n        }\r\n\r\n        if(objectIdBeingResized !== null) {\r\n            return false;\r\n        }        \r\n\r\n        multiObjectSelectionStartX = _x;\r\n        multiObjectSelectionStartY = _y;\r\n        multiObjectSelectionEndX = _x;\r\n        multiObjectSelectionEndY = _y;\r\n        multiObjectSelectionStarted = true;\r\n\r\n        selectionBoxElem.style.left = `${multiObjectSelectionStartX}px`;\r\n        selectionBoxElem.style.top = `${multiObjectSelectionStartY}px`;\r\n        selectionBoxElem.style.width = `0px`;\r\n        selectionBoxElem.style.height = `0px`;\r\n        selectionBoxElem.style.display = \"block\";\r\n\r\n        emitEvent(\r\n            CanvasEvent.MULTIPLE_OBJECT_SELECTION_STARTED,\r\n            { \r\n                'x': _x,\r\n                'y': _y\r\n            }\r\n        );\r\n\r\n        return true;\r\n    };\r\n\r\n    const handleMultiObjectSelectionEnd = function() {\r\n        multiObjectSelectionStarted = false;\r\n\r\n        const selectionRect = new Rectangle(\r\n            Math.min(multiObjectSelectionStartX, multiObjectSelectionEndX), \r\n            Math.min(multiObjectSelectionStartY, multiObjectSelectionEndY),\r\n            Math.max(multiObjectSelectionStartX, multiObjectSelectionEndX), \r\n            Math.max(multiObjectSelectionStartY, multiObjectSelectionEndY)\r\n        );\r\n\r\n        const selectedObjects = self.getObjectsWithinRect(selectionRect);\r\n        const boundingRect = self.calcBoundingRectForObjects(selectedObjects);\r\n\r\n        selectionBoxElem.style.left = `${boundingRect.getLeft()}px`;\r\n        selectionBoxElem.style.top = `${boundingRect.getTop()}px`;\r\n        selectionBoxElem.style.width = `${boundingRect.getWidth()}px`;\r\n        selectionBoxElem.style.height = `${boundingRect.getHeight()}px`;\r\n        selectionBoxElem.style.display = \"none\";\r\n\r\n        emitEvent(\r\n            CanvasEvent.MULTIPLE_OBJECTS_SELECTED, \r\n            { \r\n                'selectedObjects': selectedObjects,\r\n                'boundingRect': boundingRect\r\n            }\r\n        );\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Number} _endX \r\n     * @param {Number} _endY \r\n     */\r\n    const updateSelectionBoxEndPoint = function(_endX, _endY) {\r\n        multiObjectSelectionEndX = _endX;\r\n        multiObjectSelectionEndY = _endY;\r\n        const width = multiObjectSelectionEndX - multiObjectSelectionStartX;\r\n        const height = multiObjectSelectionEndY - multiObjectSelectionStartY;\r\n\r\n        if(width >= 0) {\r\n            selectionBoxElem.style.width = `${width}px`;\r\n        } else {\r\n            selectionBoxElem.style.left = `${_endX}px`;\r\n            selectionBoxElem.style.width = `${Math.abs(width)}px`;\r\n        }\r\n\r\n        if(height >= 0) {\r\n            selectionBoxElem.style.height = `${height}px`;\r\n        } else {\r\n            selectionBoxElem.style.top = `${_endY}px`;\r\n            selectionBoxElem.style.height = `${Math.abs(height)}px`;\r\n        }\r\n    };\r\n\r\n    /**\r\n     * @param {String[]} _selectionRectStyleCssClasses\r\n     */\r\n    this.initMultiObjectSelectionHandler = function(_selectionRectStyleCssClasses) {\r\n        // Create selection box DOM element\r\n        const selBox = _window.document.createElement(\"div\");\r\n        selBox.classList.add(\"ia-selection-box\");\r\n        selBox.style.display = \"none\";\r\n        selBox.style.position = \"absolute\";\r\n        selBox.style.left = \"0px\";\r\n        selBox.style.top = \"0px\";\r\n\r\n        if(typeof _selectionRectStyleCssClasses === 'undefined' || _selectionRectStyleCssClasses.length === 0) {\r\n            selBox.style.border = \"1px solid rgb(158, 158, 158)\";\r\n            selBox.style.background = \"rgba(153, 153, 153, 0.5)\";            \r\n        } else {\r\n            // CSS classes will control styling for things GraphPaper doesn't care about\r\n            // (GraphPaper style concerns are handled via inline styles which will always take precedance)\r\n            _selectionRectStyleCssClasses.forEach(function(_class) {\r\n                selBox.classList.add(_class);\r\n            });\r\n        }\r\n\r\n        selectionBoxElem = _canvasDomElement.appendChild(selBox);\r\n\r\n        const handleTouchSelectionStart = function(e) {\r\n            const hasSelectionStarted = handleMultiObjectSelectionStart(e.touches[0].pageX, e.touches[0].pageY, e.target);\r\n        };\r\n\r\n        _canvasDomElement.addEventListener('mousedown', function(e) {\r\n            if (e.which !== 1) {\r\n                return;\r\n            }\r\n\r\n            const hasSelectionStarted = handleMultiObjectSelectionStart(e.pageX, e.pageY, e.target);\r\n            if(hasSelectionStarted) {\r\n                e.preventDefault(); // prevents text selection from triggering\r\n            }\r\n        });\r\n\r\n        _canvasDomElement.addEventListener('touchstart', function(e) {\r\n            touchHoldStartInterval = setInterval(function() {\r\n                handleTouchSelectionStart(e);\r\n            }, touchHoldDelayTimeMs);\r\n        });\r\n\r\n        _canvasDomElement.addEventListener('touchend', function(e) {\r\n            clearInterval(touchHoldStartInterval);\r\n        });\r\n\r\n        _canvasDomElement.addEventListener('touchmove', function(e) {\r\n            clearInterval(touchHoldStartInterval);\r\n        });        \r\n    };\r\n\r\n    this.initTransformationHandlers = function() {\r\n        _canvasDomElement.addEventListener('touchstart', function(e) {\r\n            touchMoveLastX = e.touches[0].pageX;\r\n            touchMoveLastY = e.touches[0].pageY;\r\n        });\r\n\r\n        _canvasDomElement.addEventListener('touchmove', function (e) {\r\n            if (objectIdBeingDragged !== null) {\r\n                const invTransformedPos = MatrixMath.vecMat4Multiply(\r\n                    [e.touches[0].pageX, e.touches[0].pageY, 0, 1],\r\n                    currentInvTransformationMatrix\r\n                );                    \r\n\r\n                handleMove(invTransformedPos[0], invTransformedPos[1]);\r\n                // if we're transforming an object, make sure we don't scroll the canvas\r\n                e.preventDefault();\r\n            }\r\n\r\n            if(objectIdBeingResized !== null) {\r\n                const invTransformedPos = MatrixMath.vecMat4Multiply(\r\n                    [e.touches[0].pageX, e.touches[0].pageY, 0, 1],\r\n                    currentInvTransformationMatrix\r\n                );     \r\n\r\n                handleResize(invTransformedPos[0], invTransformedPos[1]);\r\n                e.preventDefault();\r\n            }\r\n\r\n            if(currentGroupTransformationContainerBeingDragged !== null) {\r\n                const dx = e.touches[0].pageX - touchMoveLastX;\r\n                const dy = e.touches[0].pageY - touchMoveLastY;\r\n\r\n                const invTransformedPos = MatrixMath.vecMat4Multiply(\r\n                    [dx, dy, 0, 1],\r\n                    currentInvTransformationMatrix\r\n                );                    \r\n\r\n                handleGroupTransformationContainerMove(invTransformedPos[0], invTransformedPos[1]);        \r\n                e.preventDefault();        \r\n            }\r\n\r\n            if(multiObjectSelectionStarted) {\r\n                updateSelectionBoxEndPoint(e.touches[0].pageX, e.e.touches[0].pageY);\r\n                e.preventDefault();\r\n            }\r\n\r\n            touchMoveLastX = e.touches[0].pageX;\r\n            touchMoveLastY = e.touches[0].pageY;\r\n        });\r\n\r\n        _canvasDomElement.addEventListener('mousemove', function (e) {\r\n            if (objectIdBeingDragged !== null) {\t\t\r\n                const invTransformedPos = MatrixMath.vecMat4Multiply(\r\n                    [e.pageX, e.pageY, 0, 1],\r\n                    currentInvTransformationMatrix\r\n                );                    \r\n\r\n                handleMove(invTransformedPos[0], invTransformedPos[1]);\r\n            }\r\n\r\n            if(objectIdBeingResized !== null) {\r\n                const invTransformedPos = MatrixMath.vecMat4Multiply(\r\n                    [e.pageX, e.pageY, 0, 1],\r\n                    currentInvTransformationMatrix\r\n                );     \r\n\r\n                handleResize(invTransformedPos[0], invTransformedPos[1]);\r\n            }\r\n\r\n            if(currentGroupTransformationContainerBeingDragged !== null) {\r\n                const invTransformedPos = MatrixMath.vecMat4Multiply(\r\n                    [e.movementX, e.movementY, 0, 1],\r\n                    currentInvTransformationMatrix\r\n                );                    \r\n\r\n                handleGroupTransformationContainerMove(invTransformedPos[0], invTransformedPos[1]);                \r\n            }\r\n\r\n            if(multiObjectSelectionStarted) {\r\n                updateSelectionBoxEndPoint(e.pageX, e.pageY);\r\n            }\r\n        });\r\n\r\n        _canvasDomElement.addEventListener('touchend', function (e) {\r\n\r\n            // e.touches is empty..\r\n            // Need to use e.changedTouches for final x,y ???\r\n\r\n            if(objectIdBeingDragged !== null) {\r\n                objectIdBeingDragged = null;\r\n            }           \r\n            \r\n            if(objectIdBeingResized !== null) {\r\n                objectIdBeingResized = null;  \r\n            }\r\n\r\n            if(currentGroupTransformationContainerBeingDragged !== null) {\r\n                currentGroupTransformationContainerBeingDragged.endTranslate();\r\n                currentGroupTransformationContainerBeingDragged = null;\r\n            }            \r\n\r\n            if(multiObjectSelectionStarted) {\r\n                handleMultiObjectSelectionEnd();\r\n            }\r\n        });\r\n\r\n        _canvasDomElement.addEventListener('mouseup', function (e) {\r\n            if (e.which === 1) {\r\n                if(objectIdBeingDragged !== null) {\r\n\r\n                    const invTransformedPos = MatrixMath.vecMat4Multiply(\r\n                        [e.pageX, e.pageY, 0, 1],\r\n                        currentInvTransformationMatrix\r\n                    );                      \r\n\r\n                    handleMoveEnd(invTransformedPos[0], invTransformedPos[1]);\r\n                }\r\n\r\n                if(objectIdBeingResized !== null) {\r\n                }\r\n\r\n                if(currentGroupTransformationContainerBeingDragged !== null) {\r\n                    currentGroupTransformationContainerBeingDragged.endTranslate();\r\n                    currentGroupTransformationContainerBeingDragged = null;\r\n                }\r\n\r\n                if(multiObjectSelectionStarted) {\r\n                    handleMultiObjectSelectionEnd();\r\n                }\r\n\r\n                objectIdBeingDragged = null;\r\n                objectIdBeingResized = null;\r\n            }\r\n        });  \r\n\r\n        _canvasDomElement.addEventListener('mousedown', function (e) {\r\n            // if we're dragging something, stop propagation\r\n            if(currentGroupTransformationContainerBeingDragged !== null || objectIdBeingDragged !== null || objectIdBeingResized !== null) {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n            }\r\n        });\r\n    };\r\n\r\n    const emitEvent = function(_eventName, _eventData) {\r\n        const allCallbacks = eventHandlers.get(_eventName) || [];\r\n\r\n        for(let i=0; i<allCallbacks.length; i++) {\r\n            const cbFunc = allCallbacks[i];\r\n            cbFunc(_eventData);\r\n        }\r\n    };\r\n\r\n    this.off = function(_eventName, _callback) {\r\n        const allCallbacks = eventHandlers.get(_eventName) || [];\r\n\r\n        for(let i=0; i<allCallbacks.length; i++) {\r\n            if(allCallbacks[i] === _callback) {\r\n                allCallbacks.splice(i, 1);\r\n                break;\r\n            }\r\n        }\r\n\r\n        eventHandlers.set(_eventName, allCallbacks);\r\n    };\r\n\r\n    this.on = function(_eventName, _callback) {\r\n        const allCallbacks = eventHandlers.get(_eventName) || [];\r\n        allCallbacks.push(_callback);\r\n        eventHandlers.set(_eventName, allCallbacks);\r\n    };\r\n\r\n    self.setGrid(new Grid(12.0, '#424242', GRID_STYLE.DOT));\r\n    self.resetTransform();\r\n    self.setTransformOrigin(0, 0);\r\n    self.setTransitionCss(transitionCss);\r\n};\r\n\r\nexport { Canvas };\r\n","import {Point} from './Point';\r\nimport {Rectangle} from './Rectangle';\r\nimport {Canvas} from './Canvas';\r\nimport {ConnectorAnchor} from './ConnectorAnchor';\r\n\r\n/**\r\n * \r\n * @param {String} _id\r\n * @param {Number} _x\r\n * @param {Number} _y\r\n * @param {Number} _width\r\n * @param {Number} _height\r\n * @param {Canvas} _canvas\r\n * @param {Element} _domElement\r\n * @param {Element[]} _translateHandleDomElements\r\n * @param {Element[]} _resizeHandleDomElements\r\n */\r\nfunction CanvasObject(_id, _x, _y, _width, _height, _canvas, _domElement, _translateHandleDomElements, _resizeHandleDomElements) {\r\n\r\n    const self = this;\r\n\r\n    const MOUSE_MIDDLE_BUTTON = 1;\r\n\r\n    /**\r\n     * @type {ConnectorAnchor[]}\r\n     */\r\n    const connectorAnchors = [];\r\n\r\n    /**\r\n     * @type {Number}\r\n     */\r\n    var nextConnectorAnchorIdSuffix = 1000;\r\n\r\n    /**\r\n     * @type {Element}\r\n     */\r\n    var currentTranslateHandleElementActivated = null;\r\n\r\n    /**\r\n     * @type {Element}\r\n     */\r\n    var currentResizeHandleElementActivated = null;\r\n\r\n    const Event = {\r\n        TRANSLATE_START: 'obj-translate-start',\r\n        TRANSLATE: 'obj-translate',\r\n        RESIZE_START: 'obj-resize-start',\r\n        RESIZE: 'obj-resize'\r\n    };\r\n\r\n    const eventNameToHandlerFunc = new Map();\r\n\r\n    let x = null;\r\n    let y = null;\r\n    let width = null;\r\n    let height = null;\r\n\r\n    /**\r\n     * @param {Element} _connectorAnchorDomElement\r\n     * @returns {ConnectorAnchor}\r\n     */    \r\n    this.addNonInteractableConnectorAnchor = function(_connectorAnchorDomElement) {\r\n        const newAnchor = new ConnectorAnchor(_id + `-${nextConnectorAnchorIdSuffix}`, _connectorAnchorDomElement, _canvas);\r\n        connectorAnchors.push(newAnchor);\r\n        nextConnectorAnchorIdSuffix++;\r\n        return newAnchor;\r\n    };\r\n\r\n    /**\r\n     * @param {Element} _connectorAnchorDomElement\r\n     * @returns {ConnectorAnchor}\r\n     */    \r\n    this.addInteractableConnectorAnchor = function(_connectorAnchorDomElement) {     \r\n        const anchor = new ConnectorAnchor(_id + `-${nextConnectorAnchorIdSuffix}`, _connectorAnchorDomElement, _canvas);\r\n\r\n        _connectorAnchorDomElement.addEventListener('click', function(e) {\r\n            _canvas.addConnectionAnchorToSelectionStack(anchor);\r\n        });\r\n\r\n        connectorAnchors.push(anchor);\r\n        nextConnectorAnchorIdSuffix++;\r\n        return anchor;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Number} _gridSize \r\n     * @returns {Point[]}\r\n     */\r\n    this.getConnectorAnchorRoutingPoints = function(_gridSize) {\r\n        const allRoutingPoints = [];\r\n        connectorAnchors.forEach(function(_anchor) {\r\n            const anchorPoints = _anchor.getRoutingPoints(_gridSize);\r\n            anchorPoints.forEach(function(_pt) {\r\n                allRoutingPoints.push(_pt);\r\n            });\r\n        });\r\n\r\n        return allRoutingPoints;\r\n    };\r\n\r\n    /**\r\n     * @returns {ConnectorAnchor[]}\r\n     */\r\n    this.getConnectorAnchors = function() {\r\n        return connectorAnchors;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {ConnectorAnchor} _anchor \r\n     * @returns {Boolean}\r\n     */\r\n    this.hasConnectorAnchor = function(_anchor) {\r\n        const anchors = self.getConnectorAnchors();\r\n        for(let i=0; i<anchors.length; i++) {\r\n            if(anchors[i] === _anchor) {\r\n                return true;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    };\r\n\r\n    /**\r\n     * @returns {Point|null}\r\n     */    \r\n    this.getTranslateHandleOffset = function() {\r\n        if(currentTranslateHandleElementActivated) {\r\n            return new Point(\r\n                -(currentTranslateHandleElementActivated.offsetLeft + currentTranslateHandleElementActivated.offsetWidth * 0.5),\r\n                -(currentTranslateHandleElementActivated.offsetTop  + currentTranslateHandleElementActivated.offsetHeight * 0.5)\r\n            );\r\n        }\r\n\r\n        return null;\r\n    };\r\n\r\n    /**\r\n     * @returns {String}\r\n     */\r\n    this.getId = function() {\r\n        return _id;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getX = function() {\r\n        return x;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getY = function() {\r\n        return y;\r\n    };\r\n\r\n    /**\r\n     * @param {Number} _x\r\n     * @param {Number} _y\r\n     */\r\n    this.translate = function(_x, _y) {\r\n\r\n        if(_x === x && _y === y) {\r\n            return;\r\n        }\r\n\r\n        x = _x;\r\n        y = _y;\r\n\r\n        _domElement.style.left = x + 'px';\r\n        _domElement.style.top = y + 'px';\r\n\r\n        const observers = eventNameToHandlerFunc.get(Event.TRANSLATE) || [];\r\n        observers.forEach(function(handler) {\r\n            handler({\"obj\":self, \"x\": _x, \"y\": _y});\r\n        });\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getWidth = function() {\r\n        return width;\r\n    };\r\n\r\n    /**\r\n     * @returns {Number}\r\n     */\r\n    this.getHeight = function() {\r\n        return height;\r\n    };\r\n\r\n    /**\r\n     * @param {Number} _width\r\n     * @param {Number} _height\r\n     * @param {Function} _domElementStyleUpdateOverrideFunc\r\n     */\r\n    this.resize = function(_width, _height, _domElementStyleUpdateOverrideFunc) {            \r\n        width = _width;\r\n        height = _height;\r\n\r\n        if(_domElementStyleUpdateOverrideFunc) {\r\n            _domElementStyleUpdateOverrideFunc(_domElement);\r\n        } else {\r\n            _domElement.style.width = width + 'px';\r\n            _domElement.style.height = height + 'px';\r\n        }\r\n\r\n        const observers = eventNameToHandlerFunc.get(Event.RESIZE) || [];\r\n        observers.forEach(function(handler) {\r\n            handler({\"obj\":self, \"width\": _width, \"height\": _height});\r\n        });\r\n    };\r\n\r\n    /**\r\n     * @returns {Element}\r\n     */\r\n    this.getDomElement = function() {\r\n        return _domElement;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {String} _eventName\r\n     * @param {*} _eventData\r\n     */\r\n    this.handleSiblingObjectChange = function(_eventName, _eventData) { \r\n\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @returns {Rectangle}\r\n     */\r\n    this.getBoundingRectange = function() {\r\n        const left = x;\r\n        const top = y;\r\n        const right = left + width;\r\n        const bottom = top + height;\r\n\r\n        return new Rectangle(left, top, right, bottom);\r\n    };\r\n\r\n    /**\r\n     * @returns {Point[]}\r\n     */\r\n    this.getBoundingPoints = function() {\r\n        const topLeft = new Point(self.getX(), self.getY());\r\n        const topRight = new Point(self.getX() + self.getWidth(), self.getY());\r\n        const bottomLeft = new Point(self.getX(), self.getY() + self.getWidth());\r\n        const bottomRight = new Point(self.getX() + self.getWidth(), self.getY() + self.getWidth());\r\n\r\n        return [\r\n            topLeft,\r\n            topRight,\r\n            bottomLeft,\r\n            bottomRight\r\n        ];\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {String} _eventName \r\n     * @param {*} _handlerFunc \r\n     */\r\n    this.on = function(_eventName, _handlerFunc) {\r\n        const allHandlers = eventNameToHandlerFunc.get(_eventName) || [];\r\n        allHandlers.push(_handlerFunc);\r\n        eventNameToHandlerFunc.set(_eventName, allHandlers);    \r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {String} _eventName \r\n     * @param {*} _callback \r\n     */\r\n    this.off = function(_eventName, _callback) {\r\n        const allCallbacks = eventNameToHandlerFunc.get(_eventName) || [];\r\n\r\n        for(let i=0; i<allCallbacks.length; i++) {\r\n            if(allCallbacks[i] === _callback) {\r\n                allCallbacks.splice(i, 1);\r\n                break;\r\n            }\r\n        }\r\n\r\n        eventNameToHandlerFunc.set(_eventName, allCallbacks);\r\n    };\r\n\r\n    this.suspendTranslateInteractions = function() {\r\n        unbindTranslateHandleElements();\r\n    };\r\n\r\n    this.resumeTranslateInteractions = function() {\r\n        bindTranslateHandleElements();\r\n    };\r\n\r\n    const translateTouchStartHandler = function(e) {\r\n        currentTranslateHandleElementActivated = e.target;\r\n\r\n        const observers = eventNameToHandlerFunc.get(Event.TRANSLATE_START) || [];\r\n        observers.forEach(function(handler) {\r\n            handler({\r\n                \"obj\": self,\r\n                \"x\": e.touches[0].pageX, \r\n                \"y\": e.touches[0].pageY,\r\n                \"isTouch\": true\r\n            });\r\n        });        \r\n\r\n    };\r\n\r\n    const translateMouseDownHandler = function(e) {\r\n        currentTranslateHandleElementActivated = e.target;\r\n        \r\n        const observers = eventNameToHandlerFunc.get(Event.TRANSLATE_START) || [];\r\n        observers.forEach(function(handler) {\r\n            handler({\r\n                \"obj\": self,\r\n                \"x\": e.pageX, \r\n                \"y\": e.pageY,\r\n                \"isTouch\": false\r\n            });\r\n        });        \r\n        \r\n    };\r\n\r\n    const unbindTranslateHandleElements = function() {\r\n        _translateHandleDomElements.forEach((_el) => {\r\n            _el.removeEventListener('touchstart', translateTouchStartHandler);        \r\n            _el.removeEventListener('mousedown', translateMouseDownHandler);\r\n        });\r\n    };\r\n\r\n    const bindTranslateHandleElements = function() {\r\n        _translateHandleDomElements.forEach((_el) => {\r\n            _el.addEventListener('touchstart', translateTouchStartHandler);        \r\n            _el.addEventListener('mousedown', translateMouseDownHandler);\r\n        });\r\n    };\r\n\r\n    const resizeMouseDownHandler = function(e) {\r\n        if (e.which !== MOUSE_MIDDLE_BUTTON) {\r\n            return;\r\n        }\r\n\r\n        currentResizeHandleElementActivated = e.target;\r\n        \r\n        const observers = eventNameToHandlerFunc.get(Event.RESIZE_START) || [];\r\n        observers.forEach(function(handler) {\r\n            handler({\r\n                \"obj\": self,\r\n                \"x\": e.pageX, \r\n                \"y\": e.pageY,\r\n                \"isTouch\": false\r\n            });\r\n        });    \r\n    };\r\n\r\n    const resizeTouchStartHandler = function(e) {\r\n        currentResizeHandleElementActivated = e.target;\r\n        \r\n        const observers = eventNameToHandlerFunc.get(Event.RESIZE_START) || [];\r\n        observers.forEach(function(handler) {\r\n            handler({\r\n                \"obj\": self,\r\n                \"x\": e.touches[0].pageX,  \r\n                \"y\": e.touches[0].pageY, \r\n                \"isTouch\": true\r\n            });\r\n        });    \r\n    };    \r\n\r\n    const bindResizeHandleElements = function() {\r\n        _resizeHandleDomElements.forEach((_el) => {\r\n            _el.addEventListener('touchstart', resizeTouchStartHandler);  \r\n            _el.addEventListener('mousedown', resizeMouseDownHandler);  \r\n        });\r\n    };\r\n\r\n\r\n    bindTranslateHandleElements();\r\n    bindResizeHandleElements();\r\n    self.translate(_x, _y);\r\n    self.resize(_width, _height);\r\n};\r\n\r\nexport { CanvasObject };\r\n","import {CanvasObject} from './CanvasObject';\r\nimport {GroupTransformationContainerEvent} from './GroupTransformationContainerEvent';\r\n\r\n/**\r\n * @param {Canvas} _canvas\r\n * @param {CanvasObject[]} _objects\r\n * @param {String[]} _containerStyleCssClasses\r\n * @param {Number} _sizeAdjustmentPx\r\n */\r\nfunction GroupTransformationContainer(_canvas, _objects, _containerStyleCssClasses, _sizeAdjustmentPx)  {\r\n    const self = this;\r\n    const eventNameToHandlerFunc = new Map();\r\n\r\n    const calculateBoundingRect = function() {\r\n        var r = _canvas.calcBoundingRectForObjects(_objects);\r\n        if(_sizeAdjustmentPx) {\r\n            r = r.getUniformlyResizedCopy(_sizeAdjustmentPx);\r\n        }\r\n\r\n        return r;\r\n    };\r\n\r\n    var boundingRect = calculateBoundingRect();\r\n\r\n    var accTranslateX = 0.0;\r\n    var accTranslateY = 0.0;    \r\n\r\n    var currentLeft = boundingRect.getLeft();\r\n    var currentTop = boundingRect.getTop();\r\n\r\n    const objPositionRelativeToBoundingRect = [];\r\n\r\n    _objects.forEach(function(_obj) {\r\n        const rp = {\r\n            \"x\": _obj.getX() - currentLeft,\r\n            \"y\": _obj.getY() - currentTop\r\n        };\r\n\r\n        objPositionRelativeToBoundingRect.push(rp);\r\n    });\r\n\r\n    const selBox = window.document.createElement(\"div\");\r\n    selBox.classList.add('ia-group-transformation-container');\r\n    selBox.style.display = \"none\";\r\n    selBox.style.position = \"absolute\";\r\n    selBox.style.left = `${currentLeft}px`;\r\n    selBox.style.top = `${currentTop}px`;\r\n    selBox.style.width = `${boundingRect.getWidth()}px`;\r\n    selBox.style.height = `${boundingRect.getHeight()}px`;    \r\n\r\n    // only display the container if we have 1+ object in the group\r\n    if(_objects.length > 0) {\r\n        selBox.style.display = \"block\";\r\n    }\r\n\r\n    if(typeof _containerStyleCssClasses === 'undefined' || _containerStyleCssClasses.length === 0) {\r\n        // default styling if no classes are provided\r\n        selBox.style.border = \"1px solid rgb(158, 158, 158)\";\r\n        selBox.style.backgroundColor = \"rgba(153, 153, 153, 0.5)\";       \r\n    } else {\r\n        // CSS classes will control styling for things GraphPaper doesn't care about\r\n        // (GraphPaper style concerns are handled via inline styles which will always take precedance)\r\n        _containerStyleCssClasses.forEach(function(_class) {\r\n            selBox.classList.add(_class);\r\n        });\r\n    }\r\n\r\n\r\n    this.getContainerDomElement = function() {\r\n        return selBox;\r\n    };\r\n    \r\n    /**\r\n     * @returns {CanvasObject[]}\r\n     */\r\n    this.getObjects = function() {\r\n        return _objects;\r\n    };\r\n\r\n    /**\r\n     * @param {Number} _dx\r\n     * @param {Number} _dy\r\n     */\r\n    this.translateByOffset = function(_dx, _dy) {\r\n        accTranslateX += _dx;\r\n        accTranslateY += _dy;\r\n\r\n        currentLeft = _canvas.snapToGrid(boundingRect.getLeft() + accTranslateX);\r\n        currentTop = _canvas.snapToGrid(boundingRect.getTop() + accTranslateY);\r\n        selBox.style.left = `${currentLeft}px`;\r\n        selBox.style.top = `${currentTop}px`;        \r\n\r\n        for(let i=0; i<_objects.length; i++) {\r\n            const obj = _objects[i];\r\n            const rp = objPositionRelativeToBoundingRect[i];\r\n\r\n            obj.translate(\r\n                _canvas.snapToGrid(currentLeft + rp.x), \r\n                _canvas.snapToGrid(currentTop + rp.y)\r\n            );\r\n        }\r\n    };\r\n\r\n    this.endTranslate = function() {\r\n        accTranslateX = 0.0;\r\n        accTranslateY = 0.0;\r\n        boundingRect = calculateBoundingRect();\r\n    };\r\n\r\n    this.initTranslateInteractionHandler = function() {\r\n        selBox.addEventListener('touchstart', translateTouchStartHandler);        \r\n        selBox.addEventListener('mousedown', translateMouseDownHandler);\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {String} _eventName \r\n     * @param {*} _handlerFunc \r\n     */\r\n    this.on = function(_eventName, _handlerFunc) {\r\n        const allHandlers = eventNameToHandlerFunc.get(_eventName) || [];\r\n        allHandlers.push(_handlerFunc);\r\n        eventNameToHandlerFunc.set(_eventName, allHandlers);        \r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {String} _eventName \r\n     * @param {*} _callback \r\n     */\r\n    this.off = function(_eventName, _callback) {\r\n        const allCallbacks = eventNameToHandlerFunc.get(_eventName) || [];\r\n\r\n        for(let i=0; i<allCallbacks.length; i++) {\r\n            if(allCallbacks[i] === _callback) {\r\n                allCallbacks.splice(i, 1);\r\n                break;\r\n            }\r\n        }\r\n\r\n        eventNameToHandlerFunc.set(_eventName, allCallbacks);\r\n    };\r\n\r\n    const translateTouchStartHandler = function(e) {\r\n        const observers = eventNameToHandlerFunc.get(GroupTransformationContainerEvent.TRANSLATE_START) || [];\r\n        observers.forEach(function(handler) {\r\n            handler({\r\n                \"container\": self,\r\n                \"x\": e.touches[0].pageX, \r\n                \"y\": e.touches[0].pageY,\r\n                \"isTouch\": true\r\n            });\r\n        });        \r\n\r\n    };\r\n\r\n    const translateMouseDownHandler = function(e) {       \r\n        const observers = eventNameToHandlerFunc.get(GroupTransformationContainerEvent.TRANSLATE_START) || [];\r\n        observers.forEach(function(handler) {\r\n            handler({\r\n                \"container\": self,\r\n                \"x\": e.pageX, \r\n                \"y\": e.pageY,\r\n                \"isTouch\": false\r\n            });\r\n        });        \r\n        \r\n    };    \r\n};\r\n\r\nexport {GroupTransformationContainer}\r\n","/**\r\n * \r\n * @param {String} _id \r\n */\r\nfunction Cluster(_id) {\r\n\r\n    const self = this;\r\n\r\n    /**\r\n     * @type {CanvasObjects[]}\r\n     */\r\n    const canvasObjects = [];\r\n\r\n    /**\r\n     * @returns {String}\r\n     */\r\n    this.getId = function() {\r\n        return _id;\r\n    };\r\n\r\n    /**\r\n     * @param {CanvasObject} _obj\r\n     * @returns {Number|null}\r\n     */\r\n    this.getObjectIndex = function(_obj) {\r\n        return self.getObjectIndexById(_obj.getId());\r\n    };\r\n\r\n    /**\r\n     * @param {String} _objId\r\n     * @returns {Number|null}\r\n     */\r\n    this.getObjectIndexById = function(_objId) {\r\n        for(let i=0; i<canvasObjects.length; i++) {\r\n            if(canvasObjects[i].getId() === _objId) {\r\n                return i;\r\n            }\r\n        }\r\n\r\n        return null;\r\n    };\r\n\r\n    /**\r\n     * @param {CanvasObject} _o\r\n     * @returns {Boolean}\r\n     */\r\n    this.addObject = function(_o) {\r\n\r\n        if(self.getObjectIndex(_o) !== null) {\r\n            return false;\r\n        }\r\n\r\n        canvasObjects.push(_o);\r\n        return true;\r\n    };\r\n\r\n    /**\r\n     * @returns {CanvasObjects[]}\r\n     */\r\n    this.getObjects = function() {\r\n        return canvasObjects;\r\n    };\r\n\r\n    /**\r\n     * @returns {String[]}\r\n     */\r\n    this.getObjectIds = function() {\r\n        const ids = [];\r\n        canvasObjects.forEach(function(_o) {\r\n            ids.push(_o.getId());\r\n        });\r\n\r\n        return ids;\r\n    };    \r\n\r\n    /**\r\n     * @param {String} _id\r\n     * @returns {Boolean}\r\n     */\r\n    this.removeObjectById = function(_id) {\r\n        const idx = self.getObjectIndexById(_id);\r\n        if(idx === null) {\r\n            return false;\r\n        }\r\n\r\n        canvasObjects.splice(idx, 1);\r\n        return true;\r\n    };\r\n\r\n    this.removeAllObjects = function() {\r\n        canvasObjects.length = 0;\r\n    };\r\n};\r\n\r\nexport { Cluster };\r\n","import {Rectangle} from './Rectangle';\r\nimport  {CanvasObject} from './CanvasObject';\r\nimport  {Cluster} from './Cluster';\r\n\r\nfunction BoxClusterDetector(_boxExtentOffset) {\r\n\r\n    const self = this;\r\n\r\n    /**\r\n     * \r\n     * @param {CanvasObject} _obj \r\n     * @param {CanvasObject[]} _canvasObjectsArray \r\n     * @returns {Number}\r\n     */\r\n    const getObjectIndexFromArray = function(_obj, _canvasObjectsArray) {\r\n        for(let i=0; i<_canvasObjectsArray.length; i++) {\r\n            if(_canvasObjectsArray[i].getId() === _obj.getId()) {\r\n                return i;\r\n            }\r\n        }\r\n\r\n        return -1;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {CanvasObject[]} _objects \r\n     * @param {CanvasObject[]} _canvasObjectsArray \r\n     * @returns {CanvasObject[]}\r\n     */\r\n    const removeObjectsFromArray = function(_objects, _canvasObjectsArray) {\r\n        for(let i=0; i<_objects.length; i++) {\r\n            const idx = getObjectIndexFromArray(_objects[i], _canvasObjectsArray);\r\n            if(idx !== -1) {\r\n                _canvasObjectsArray.splice(idx, 1);\r\n            }\r\n        }\r\n\r\n        return _canvasObjectsArray;\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @param {Map<Cluster, Number>} _clusterToObjectCountMap \r\n     * @returns {Cluster}\r\n     */\r\n    const getClusterWithMostObjectsFromClusterMap = function(_clusterToObjectCountMap)\r\n    {\r\n        var curMaxObjs = 0;\r\n        var curClusterWithMax = null;\r\n\r\n        _clusterToObjectCountMap.forEach(function(_numObjs, _cluster, _map) {\r\n            if(_numObjs > curMaxObjs) {\r\n                curMaxObjs = _numObjs;\r\n                curClusterWithMax = _cluster;\r\n            }\r\n        });\r\n\r\n        return curClusterWithMax;\r\n    };\r\n\r\n    /**\r\n     * @param {Map<Cluster, Number>} _clusterToObjectCountMap \r\n     * @returns {Cluster[]}\r\n     */\r\n    const getClusterArrayFromClusterMap = function(_clusterToObjectCountMap) {\r\n        const resultSet = [];\r\n        _clusterToObjectCountMap.keys().forEach(function(_cluster) {\r\n            resultSet.push(_cluster);\r\n        });\r\n\r\n        return resultSet;\r\n    };\r\n\r\n    /**\r\n     * @param {CanvasObject} _objA\r\n     * @param {CanvasObject} _objB\r\n     * @returns {Boolean}\r\n     */\r\n    this.areObjectsClose = function(_objA, _objB) {\r\n\r\n        const nA = new Rectangle(\r\n            _objA.getX() - _boxExtentOffset, \r\n            _objA.getY() - _boxExtentOffset, \r\n            _objA.getX() + _objA.getWidth() + _boxExtentOffset, \r\n            _objA.getY() + _objA.getHeight() + _boxExtentOffset\r\n        );\r\n\r\n        const nB = new Rectangle(\r\n            _objB.getX() - _boxExtentOffset, \r\n            _objB.getY() - _boxExtentOffset, \r\n            _objB.getX() + _objB.getWidth() + _boxExtentOffset, \r\n            _objB.getY() + _objB.getHeight() + _boxExtentOffset\r\n        );\r\n        \r\n        return nA.checkIntersect(nB);\r\n    };\r\n   \r\n    /**\r\n     * @param {CanvasObject} _obj\r\n     * @param {CanvasObject[]} _objectsUnderConsideration\r\n     * @returns {CanvasObject[]}\r\n     */\r\n    this.getAllObjectsCloseTo = function(_obj, _objectsUnderConsideration) {\r\n        const resultSet = [];\r\n        for(let i=0; i<_objectsUnderConsideration.length; i++) {\r\n            if(_obj.getId() === _objectsUnderConsideration[i].getId()) {\r\n                continue;\r\n            }\r\n\r\n            if(self.areObjectsClose(_obj, _objectsUnderConsideration[i])) {\r\n                resultSet.push(_objectsUnderConsideration[i]);\r\n            }\r\n        }\r\n\r\n        return resultSet;\r\n    };\r\n\r\n    /**\r\n     * @param {CanvasObject} _seedObj\r\n     * @param {CanvasObject[]} _objectsUnderConsideration\r\n     * @param {CanvasObject[]} _resultSet\r\n     */\r\n    this.getClusterObjectsFromSeed = function(_seedObj, _objectsUnderConsideration, _resultSet) {\r\n        const closeByObjects = self.getAllObjectsCloseTo(_seedObj, _objectsUnderConsideration);\r\n        if(closeByObjects.length === 0) {\r\n            return [];\r\n        } else {\r\n            removeObjectsFromArray(closeByObjects.concat([_seedObj]), _objectsUnderConsideration);\r\n\r\n            closeByObjects.forEach(function(_o) {\r\n                _resultSet.push(_o);\r\n                self.getClusterObjectsFromSeed(_o, _objectsUnderConsideration, _resultSet);\r\n            });\r\n        }\r\n    };\r\n\r\n\r\n    /**\r\n     * @param {CanvasObject[]} _objs\r\n     * @param {Cluster[]} _clusters\r\n     * @returns {Map<Cluster,Number>}\r\n     */\r\n    this.findIntersectingClustersForObjects = function(_objs, _clusters) {\r\n\r\n        // Map of Cluster that is intersecting to number of objects in _objs that is intersecting the given Cluster\r\n        const intersectingClusterToNumObjectsIntersecting = new Map();\r\n\r\n        _clusters.forEach(function(_cluster) {\r\n\r\n            const clusterObjs = _cluster.getObjects();\r\n\r\n            for(let i=0; i<clusterObjs.length; i++) {\r\n                for(let j=0; j<_objs.length; j++) {\r\n\r\n                    if(clusterObjs[i].getId() !== _objs[j].getId()) {\r\n                        continue;\r\n                    }\r\n\r\n                    if(intersectingClusterToNumObjectsIntersecting.has(_cluster)) {\r\n                        const count = intersectingClusterToNumObjectsIntersecting.get(_cluster);\r\n                        intersectingClusterToNumObjectsIntersecting.set(_cluster, count+1);\r\n                    } else {\r\n                        intersectingClusterToNumObjectsIntersecting.set(_cluster, 1);\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        return intersectingClusterToNumObjectsIntersecting;\r\n    };\r\n\r\n    /**\r\n     * @param {CanvasObject} _obj\r\n     * @param {Cluster[]} _clusters\r\n     */\r\n    this.removeObjectFromClusters = function(_obj, _clusters) {\r\n        _clusters.forEach(function(_c) {\r\n            _c.removeObjectById(_obj.getId());\r\n        });\r\n    };    \r\n\r\n    this.computeClusters = function(_objects, _knownClusters, _getNewIdFunc) {\r\n        const clusters = _knownClusters.map(function(_c) {\r\n            return _c;\r\n        });\r\n\r\n        const objectsUnderConsideration = _objects.map(function(_o) {\r\n            return _o;\r\n        });\r\n\r\n        while(objectsUnderConsideration.length > 0) {\r\n            const obj = objectsUnderConsideration.pop();\r\n\r\n            const objsForCluster = [obj];\r\n            self.getClusterObjectsFromSeed(obj, objectsUnderConsideration, objsForCluster);\r\n\r\n            if(objsForCluster.length > 1) {\r\n\r\n                const intersectingClusterToNumObjectsIntersecting = self.findIntersectingClustersForObjects(objsForCluster, clusters);\r\n\r\n                if(intersectingClusterToNumObjectsIntersecting.size === 0) {\r\n                    const newCluster = new Cluster(_getNewIdFunc());\r\n                    objsForCluster.forEach(function(_clusterObject) {\r\n                        newCluster.addObject(_clusterObject);\r\n                    });    \r\n\r\n                    clusters.push(newCluster);\r\n                } else {\r\n                    const clusterToModify = getClusterWithMostObjectsFromClusterMap(intersectingClusterToNumObjectsIntersecting);\r\n\r\n                    // Clear out objects in cluster\r\n                    clusterToModify.removeAllObjects();\r\n\r\n                    // Remove object from any cluster it's currently in, add it to clusterToModify\r\n                    objsForCluster.forEach(function(_clusterObject) {\r\n                        self.removeObjectFromClusters(_clusterObject, clusters);                    \r\n                        clusterToModify.addObject(_clusterObject);\r\n                    });\r\n\r\n                }\r\n\r\n                removeObjectsFromArray(objsForCluster, objectsUnderConsideration);\r\n\r\n            } else {\r\n                self.removeObjectFromClusters(obj, clusters);\r\n            }\r\n\r\n        }\r\n\r\n        // Filter out clusters w/o any objects\r\n        const nonEmptyClusters = clusters.filter(function(_c) {\r\n            if(_c.getObjects().length >= 2) {\r\n                return true;\r\n            }\r\n\r\n            return false;\r\n        });\r\n\r\n        return nonEmptyClusters;\r\n    };\r\n    \r\n};\r\n\r\nexport { BoxClusterDetector };\r\n"],"names":["MatrixMath","mat4Multiply","_a","_b","result","i","sum","j","k","vecMat4Multiply","_v","_m","vi","Point","_x","_y","__x","__y","prototype","getX","getY","isEqual","_otherPoint","getCartesianPoint","_canvasWidth","_canvasHeight","toString","toArray","fromArray","_arr","LINE_INTERSECTION_TYPE","Object","freeze","PARALLEL","COINCIDENT","LINE","LINESEG","LineIntersection","_type","_intersectionPoint","getType","getIntersectionPoint","Line","_startPoint","_endPoint","__startPoint","__endPoint","getStartPoint","getEndPoint","_otherLine","getLength","Math","sqrt","pow","getDirection","dx","dy","len","createShortenedLine","startReduceByPx","endReduceByPx","dir","computeIntersectionType","thisLineStartPointX","thisLineStartPointY","thisLineEndPointX","thisLineEndPointY","otherLineStartPointX","otherLineStartPointY","otherLineEndPointX","otherLineEndPointY","paramDenom","paramANumer","paramBNumer","paramA","paramB","computeIntersection","xIntersect","yIntersect","SvgPathBuilder","pointToLineTo","_pt","_ptIndex","pointTripletToTesselatedCurvePoints","_points","_curvaturePx","length","Error","controlPoint","lineA","lineB","lineAShortened","lineBShortened","pointsToPath","svgPathParts","ptIdx","ptA","shift","ptB","ptC","newPts","unshift","push","pt","p","join","Dimensions","_width","_height","getWidth","getHeight","Rectangle","_left","_top","_right","_bottom","getLeft","getTop","getRight","getBottom","getPoints","getLines","getUniformlyResizedCopy","_resizeByPx","getPointsScaledToGrid","_gridSize","centroid","scaleDx","scaleDy","scaledPoints","checkIntersect","_otherRectangle","checkIsPointWithin","_point","checkIsWithin","GroupTransformationContainerEvent","TRANSLATE_START","CanvasEvent","DBLCLICK","CLICK","CONNECTOR_UPDATED","OBJECT_ADDED","OBJECT_REMOVED","OBJECT_RESIZED","OBJECT_TRANSLATED","MULTIPLE_OBJECT_SELECTION_STARTED","MULTIPLE_OBJECTS_SELECTED","ConnectorAnchor","_id","_domElement","_canvas","self","getId","getCentroid","r","getBoundingClientRect","right","left","bottom","top","viewportRelativeRect","pageOffset","getPageOffset","getRoutingPoints","halfWidth","halfHeight","getBoundingRectange","ClosestPairFinder","findClosestPairBetweenObjects","_objA","_objB","_connectorAnchorToNumValidRoutingPoints","objAConnectorAnchors","getConnectorAnchors","objBConnectorAnchors","startAnchorIdxWithMinDist","endAnchorIdxWithMinDist","minDist","Number","MAX_VALUE","x","aCentroid","objANumValidRoutingPoints","get","y","bCentroid","d","objBNumValidRoutingPoints","PointSet","_pointsInput","points","_newPoint","pushPointSet","_ps","possibleNewPoints","findPointClosestTo","resultPoint","currentMinLength","MAX_SAFE_INTEGER","forEach","lineToPt","findDistanceToPointClosestTo","findPointsCloseTo","_radius","resultSet","toFloat64Array","Float64Array","fromFloat64Array","_float64Array","count","Array","isArray","call","LineSet","_linesInput","lines","_newLine","alreadyInLinesArray","_existingLine","ConnectorEvent","MOUSE_ENTER","MOUSE_LEAVE","Connector","_anchorStart","_anchorEnd","_containerDomElement","_strokeColor","_strokeWidth","eventNameToHandlerFunc","Map","markerStartSize","markerEndSize","pathPoints","pathElem","window","document","createElementNS","setAttribute","style","stroke","strokeWidth","addEventListener","e","dispatchEvent","pageX","pageY","svgDomElem","appendPathToContainerDomElement","appendChild","setMarkerStart","_url","_size","unsetMarkerStart","removeAttribute","setMarkerEnd","unsetMarkerEnd","getPathPoints","getPathLines","totalLength","pathLines","getMidpoint","lengthSoFar","curPathLineWithMidpoint","pathLineLength","lengthBeforeCur","midOnCurPath","getMidpointDirection","refresh","_svgPath","_pathPoints","anchorIds","sort","getAnchorStart","getAnchorEnd","removePathElement","remove","addClassToDomElement","_cl","classList","add","removeClassFromDomElement","getDescriptor","on","_eventName","_handlerFunc","allHandlers","set","off","_callback","allCallbacks","splice","_eventId","_eventData","observers","handler","PointVisibilityMap","_freePoints","_boundaryLines","boundaryLinesArr","freePointsArr","pointToVisibleSet","doesLineIntersectAnyBoundaryLines","_theLine","intersectionType","b","computePointsVisibility","ijLine","getVisiblePointsFrom","_currentPoint","visiblePointIndices","visiblePoints","_vpIdx","routeToEndpoint","_currentRouteLength","_pointsInRoute","curMinCost","visiblePointWithMinCost","_vp","gn","hn","optimizeRoute","ptrA","ln","getPointToVisibleSetData","currentMaxLength","_ptKey","lineOfSight","findVisiblePointClosestTo","_freePt","lineOfSightLength","computeRoute","firstRoutingPoint","routeSegment","currentRouteLen","pointsInRoute","currentPoint","lastSegmentToEndpoint","point","GRID_STYLE","DOT","Grid","_color","_style","getSize","getStyle","getSvgImageTile","ConnectorRoutingWorkerJsString","Canvas","_canvasDomElement","_window","svgElem","width","height","connectorsContainerDomElement","selectionBoxElem","groupTransformationContainers","currentGroupTransformationContainerBeingDragged","grid","transitionCss","transformOriginX","transformOriginY","touchMoveLastX","touchMoveLastY","translateX","translateY","scaleFactor","invScaleFactor","invTransformationMatrixStack","currentInvTransformationMatrix","currentTransformationMatrix","currentPointVisiblityMap","connectorRefreshBufferTime","canvasObjects","objectConnectors","objectIdBeingDragged","objectIdBeingResized","objectDragX","objectDragY","objectDragStartX","objectDragStartY","dblTapDetectVars","lastTouchX","lastTouchY","lastTouchTime","debugPanelElem","isShowingDebugPanel","metrics","connectorRoutingWorker","executionTime","numRoutingPoints","numBoundaryLines","msgDecodeTime","pointVisibilityMapCreationTime","refreshAllConnectorsInternal","connectorsRefreshTime","touchHoldDelayTimeMs","touchHoldStartInterval","multiObjectSelectionStartX","multiObjectSelectionStartY","multiObjectSelectionEndX","multiObjectSelectionEndY","multiObjectSelectionStarted","connectorAnchorsSelected","eventHandlers","connectorAnchorToNumValidRoutingPoints","connectorRefreshStartTime","connectorRefreshTimeout","workerUrl","URL","createObjectURL","Blob","Worker","onmessage","_msg","connectorsRefreshTimeT1","Date","connectorDescriptors","data","getConnectorDescriptorById","id","_c","descriptor","ps","pointsInPath","svgPath","emitEvent","overallTime","refreshDebugMetricsPanel","getCurrentPointVisibilityMap","setGrid","_grid","backgroundImage","btoa","backgroundRepeat","backgroundColor","getGrid","getGridSize","getAccessibleRoutingPointsFromObjectAnchors","_objs","clear","allRoutingPoints","filteredRoutingPoints","_o","anchors","routingPoints","_rp","isPointWithinObj","obj","boundingRect","routingPoint","currentNumRoutingPoints","parentAnchor","getObjectExtentRoutingPoints","pointSet","_obj","_sp","getConnectorRoutingPointsAroundAnchor","getConnectorBoundaryLines","boundaryLines","_l","_anchor","executionTimeT1","routingPointsAroundAnchor","objectExtentRoutingPoints","routingPointsAroundAnchorFloat64Array","routingPointsFloat64Array","boundaryLinesFloat64Array","postMessage","buffer","setConnectorRefreshBufferTime","_bufferTimeMs","refreshAllConnectors","tdelta","setTimeout","makeNewConnector","setConnectorFactory","_newConnectorFactory","getTransitionCss","setTransitionCss","_css","transition","getTransformOriginX","getTransformOriginY","getScaleFactor","getTranslateX","getTranslateY","setTransformOrigin","transformOrigin","scale","_scaleFactor","_adjustFactorToPreserveIntegerGrid","newGridSize","roundedGridSize","round","scaleMat","translate","translateMatrix","applyTransform","transform","getTranformMatrixCss","getTransformMatrix","matElems","resetTransform","pageXOffset","pageYOffset","snapToGrid","_p","ret","max","getOffsetLeft","offsetLeft","getOffsetTop","offsetTop","offsetWidth","offsetHeight","calcBoundingRectForObjects","minTop","minLeft","maxBottom","maxRight","index","array","objRect","calcBoundingBox","getObjectsAroundPoint","ptRect","getObjectsWithinRect","_rect","getAllObjects","publishSiblingObjectChange","handleSiblingObjectChange","getObjectById","foundObject","addObject","handleResizeStart","handleMoveStart","removeObject","_objId","getConnector","c","getAllConnectors","getConnectorsBetweenObjects","foundConnectors","_conn","aS","aE","hasConnectorAnchor","getObjectsConnectedViaConnector","_connectorId","foundObjects","allObjs","getConnectorsConnectedToObject","getObjectWithConnectorAnchor","_connectorAnchorId","allObjects","removeAllConnectors","removeConnector","_connector","makeNewConnectorFromAnchors","_anchorA","_anchorB","newConnector","foundConnector","findBestConnectorAnchorsToConnectObjects","_onFound","searchFunc","_searchData","ConnectorAnchorClosestPairFinder","objectA","objectB","cb","addConnectionAnchorToSelectionStack","dblClickTapHandler","_posX","_posY","objectsAroundPoint","eventData","innerHTML","initDebugMetricsPanel","createElement","display","position","color","padding","body","initInteractionHandlers","_dblTapSpeed","_dblTapRadius","invTransformedPos","canvasObjectClicked","target","changedTouches","dblTapDetected","now","getTime","timeSinceLastTouch","lastX","lastY","distFromLastTouch","attachGroupTransformationContainer","_groupTransformationContainer","getContainerDomElement","container","detachGroupTransformationContainer","removeChild","handleGroupTransformationContainerMove","_dx","_dy","gtc","translateByOffset","_e","handleMove","translateOffset","getTranslateHandleOffset","mx","my","handleMoveEnd","handleResize","newWidth","newHeight","resize","handleMultiObjectSelectionStart","_targetElem","handleMultiObjectSelectionEnd","selectionRect","min","selectedObjects","updateSelectionBoxEndPoint","_endX","_endY","abs","initMultiObjectSelectionHandler","_selectionRectStyleCssClasses","selBox","border","background","_class","handleTouchSelectionStart","hasSelectionStarted","touches","which","preventDefault","setInterval","clearInterval","initTransformationHandlers","movementX","movementY","endTranslate","stopPropagation","cbFunc","CanvasObject","_translateHandleDomElements","_resizeHandleDomElements","MOUSE_MIDDLE_BUTTON","connectorAnchors","nextConnectorAnchorIdSuffix","currentTranslateHandleElementActivated","currentResizeHandleElementActivated","Event","TRANSLATE","RESIZE_START","RESIZE","addNonInteractableConnectorAnchor","_connectorAnchorDomElement","newAnchor","addInteractableConnectorAnchor","anchor","getConnectorAnchorRoutingPoints","anchorPoints","_domElementStyleUpdateOverrideFunc","getDomElement","getBoundingPoints","topLeft","topRight","bottomLeft","bottomRight","suspendTranslateInteractions","unbindTranslateHandleElements","resumeTranslateInteractions","bindTranslateHandleElements","translateTouchStartHandler","translateMouseDownHandler","_el","removeEventListener","resizeMouseDownHandler","resizeTouchStartHandler","bindResizeHandleElements","GroupTransformationContainer","_objects","_containerStyleCssClasses","_sizeAdjustmentPx","calculateBoundingRect","accTranslateX","accTranslateY","currentLeft","currentTop","objPositionRelativeToBoundingRect","rp","getObjects","initTranslateInteractionHandler","Cluster","getObjectIndex","getObjectIndexById","getObjectIds","ids","removeObjectById","idx","removeAllObjects","BoxClusterDetector","_boxExtentOffset","getObjectIndexFromArray","_canvasObjectsArray","removeObjectsFromArray","getClusterWithMostObjectsFromClusterMap","_clusterToObjectCountMap","curMaxObjs","curClusterWithMax","_numObjs","_cluster","_map","areObjectsClose","nA","nB","getAllObjectsCloseTo","_objectsUnderConsideration","getClusterObjectsFromSeed","_seedObj","_resultSet","closeByObjects","concat","findIntersectingClustersForObjects","_clusters","intersectingClusterToNumObjectsIntersecting","clusterObjs","has","removeObjectFromClusters","computeClusters","_knownClusters","_getNewIdFunc","clusters","map","objectsUnderConsideration","pop","objsForCluster","size","newCluster","_clusterObject","clusterToModify","nonEmptyClusters","filter"],"mappings":"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"}